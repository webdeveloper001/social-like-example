function calculateAge(e){var t=Date.now()-e.getTime(),a=new Date(t);return Math.abs(a.getUTCFullYear()-1970)}!function(){"use strict";angular.module("app",["angulike","color.picker","ngFileUpload","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMessages","pascalprecht.translate","tmh.dynamicLocale","login","ui.router","ui.bootstrap.modal","mgcrea.ngStrap","720kb.datepicker","720kb.socialshare","ngFacebook","ui.select","infinite-scroll"])}(),function(){"use strict";function e(e){function t(t,i){for(var r=t.length,l=r*(r-1)/2,c=i.length,d=0,g=0,u=0,m=0,p=0;p<r;p++){a[p]=new Array(r),n[p]=new Array(r);for(var v=0;v<r;v++)a[p][v]=0,n[p][v]=0;s[p]=t[p].id}for(p=0;p<c;p++)d=s.indexOf(i[p].hs),g=s.indexOf(i[p].ls),d>=0&&g>=0&&(i[p].sel==i[p].hs?a[d][g]++:i[p].sel==i[p].ls&&a[g][d]++,n[d][g]++,n[g][d]++);for(u=0,p=0;p<r;p++)for(v=0;v<r;v++)u+=n[p][v];for(m=u/(4*l),p=0;p<r;p++){for(t[p].Rank=0,u=0,v=0;v<r;v++)t[p].Rank=t[p].Rank+a[p][v],u+=n[p][v];t[p].Rank=t[p].Rank/u,u<m&&(t[p].Rank=t[p].Rank*(u/m))}for(var h=0;h<r;h++)for(v=0;v<r;v++)h!=v&&t[v].Rank>=t[h].Rank&&a[h][v]>a[v][h]&&n[h][v]>=m&&(t[h].Rank=t[v].Rank+.01);o=t,e.answersR=o,e.R=a,e.GP=n,e.A=s}e.A=[];var a=[],n=[],s=[],o=[];return{computeRanking:t}}angular.module("app").service("rank",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(t){function n(e){return a.DEBUG_MODE&&console.log("creating match record was succesful"),e.data}var s={};s.resource=[],s.resource.push(t),c.push.apply(c,t);var o=d;return e.post(o,t,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,r)}function s(a){function n(e){return c=e.data.resource}if(l()&&!a)return t.when(c);var s=d;return e.get(s).then(n,r)}function o(t){function n(e){a.DEBUG_MODE&&console.log("deleting match records succesful")}for(var s=0;s<c.length;s++)c[s].ls!=t&&c[s].hs!=t||c.splice(s,1);var o=d+"?filter=(ls="+t+") OR (hs="+t+")";return e.delete(o).then(n,r)}function i(t,n){function s(e){console.log("deleting match records category-hs pair succesful")}function o(e){a.DEBUG_MODE&&console.log("deleting match records category-ls pair succesful")}for(var i=0;i<c.length;i++)c[i].ls!=n&&c[i].hs!=n||c.splice(i,1);var l=d+"?filter=(category="+t+") AND (hs="+n+")";e.delete(l).then(s,r);var g=d+"?filter=(category="+t+") AND (ls="+n+")";e.delete(g).then(o,r)}function r(e){throw e}function l(){return c.length>0}var c=[],d="/api/v2/mysql/_table/matchtable";return{GetMatchTable:s,postRec:n,deleteRecordsbyAnswer:o,deleteRecordsbyCatans:i}}angular.module("app").factory("matchrec",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m,p,v,h,f,b,y,w,k,x,D){function C(){Q=p.answers,J=p.catansrecs,Z=p.alluseractivity,ee=p.mrecs,p.inFavMode=!1,se=void 0!=p.rankIsNearMe&&p.rankIsNearMe,g.scrollTo(0,0),p.$emit("showLogo"),p.rankIsActive=!0,p.objNumAct=p.objNum,M(),m.$parent.$parent.$parent.seo={pageTitle:p.cCategory.title,metaDescription:p.cCategory.question},0==X.answers.length?X.noAnswers=!0:X.noAnswers=!1,E(),I(),B(),r.computeRanking(p.canswers,p.cmrecs);for(var e=0;e<X.answers.length;e++)X.answers[e].Rank=e+1;if(T(),void 0==p.cCategory.numcom?X.numcom=0:X.numcom=p.cCategory.numcom,1==p.cCategory.isatomic&&!ne)for(var e=0;e<X.answers.length;e++)X.answers[e].Rank!=X.answers[e].catansrank&&void 0!=X.answers[e].catans&&(p.DEBUG_MODE&&console.log("RS-1"),n.updateRec(X.answers[e].catans,["rank"],[X.answers[e].Rank]));if(0==X.answers.length&&(X.numAns=0,ne||c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,"","",""])),1==X.answers.length&&(X.numAns=1,"Short-Phrase"==p.cCategory.type?(X.isShortPhrase=!0,X.title1=X.answers[0].name,X.addinfo1=X.answers[0].addinfo,X.image1=X.title1+"##"+X.addinfo1):(X.isShortPhrase=!1,void 0!=X.answers[0].imageurl&&null!=X.answers[0].imageurl&&""!=X.answers[0].imageurl?(X.image1=X.answers[0].imageurl,X.image1ok=!0):X.image1ok=!1),ne||c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,X.image1,"",""])),2==X.answers.length&&(X.numAns=2,"Short-Phrase"==p.cCategory.type?(X.isShortPhrase=!0,X.title1=X.answers[0].name,X.addinfo1=X.answers[0].addinfo,X.image1=X.title1+"##"+X.addinfo1,X.title2=X.answers[1].name,X.addinfo2=X.answers[1].addinfo,X.image2=X.title2+"##"+X.addinfo2):(X.isShortPhrase=!1,void 0!=X.answers[0].imageurl&&null!=X.answers[0].imageurl&&""!=X.answers[0].imageurl?(X.image1=X.answers[0].imageurl,X.image1ok=!0):X.image1ok=!1,void 0!=X.answers[1].imageurl&&null!=X.answers[1].imageurl&&""!=X.answers[1].imageurl?(X.image2=X.answers[1].imageurl,X.image2ok=!0):X.image2ok=!1),ne||c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,X.image1,X.image2,""])),X.answers.length>2){if(X.numAns=3,"Short-Phrase"==p.cCategory.type)X.isShortPhrase=!0,X.title1=X.answers[0].name,X.addinfo1=X.answers[0].addinfo,X.image1=X.title1+"##"+X.addinfo1,X.title2=X.answers[1].name,X.addinfo2=X.answers[1].addinfo,X.image2=X.title2+"##"+X.addinfo2,X.title3=X.answers[2].name,X.addinfo3=X.answers[2].addinfo,X.image3=X.title3+"##"+X.addinfo3;else{X.isShortPhrase=!1,X.image1=p.EMPTY_IMAGE,X.image2=p.EMPTY_IMAGE,X.image3=p.EMPTY_IMAGE,X.image1ok=!0,X.image2ok=!0,X.image3ok=!0;for(var t=1,a=0;a<X.answers.length;a++)if(void 0!=X.answers[a].imageurl&&null!=X.answers[a].imageurl&&""!=X.answers[a].imageurl&&X.answers[a].imageurl!=p.EMPTY_IMAGE){if(3==t){X.image3=X.answers[a].imageurl;break}2==t&&(X.image2=X.answers[a].imageurl,t++),1==t&&(X.image1=X.answers[a].imageurl,t++)}}ne||c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,X.image1,X.image2,X.image3])}if(void 0!=p.cCategory.fimage&&""!=p.cCategory.fimage)X.image3=X.image2,X.image2=X.image1,X.image1=p.cCategory.fimage,X.bc=p.cCategory.bc,X.fc=p.cCategory.fc,X.shade=p.cCategory.shade;else{var s=o.defaultRankColor(p.cCategory);X.bc=s[0],X.fc=s[1],X.shade=-4}p.DEBUG_MODE&&console.log("foodNearMe, ",ne),p.DEBUG_MODE&&console.log("rankIsNearMe, ",se),(ne||se)&&L(),X.isE&&U(),ne&&(X.showR=!1),ne||X.isE||(X.showR=!0),p.modeIsImage=!0,p.DEBUG_MODE&&console.log("Rank Summary Loaded!"),window.prerenderReady=!0}function S(){p.canswers4rank=[];for(var e=0;e<p.cvotes.length;e++)if(1==p.cvotes[e].vote)for(var t=0;t<p.canswers.length;t++)if(p.cvotes[e].answer==p.canswers[t].id){var a=p.catansrecs.map(function(e){return e.id}).indexOf(p.cvotes[e].catans);p.catansrecs[a].category==p.cCategory.id&&p.canswers4rank.push(p.canswers[t])}p.canswers4rank.length>1?X.rankDisabled="":X.rankDisabled="disabled",p.canswers4rank.length>0?X.commentAllowed=!0:X.commentAllowed=!1}function O(){f.loadVotesByUser().then(function(e){p.cvotes=e,S()})}function E(){if(p.canswers4rank=[],p.isLoggedIn){O();for(var e=0;e<p.editvotes.length;e++)if(p.editvotes[e].category==p.cCategory.id){var t=p.editvotes[e];p.ceditvotes.push(t)}p.cmrecs_user=[];for(var e=0;e<p.cmrecs.length;e++)p.cmrecs[e].user==p.user.id&&p.cmrecs_user.push(p.cmrecs[e])}}function P(e){a.go("answerDetail",{index:e.slug})}function R(){if(p.isLoggedIn){if(!(p.canswers4rank.length>1))return void e.getDialog("answersFew");a.go("match")}else e.getDialog("notLoggedIn")}function A(){return p.isLoggedIn?te?void e.getDialog("answersFull"):void("Event"==X.type?(p.eventmode="add",a.go("addEvent")):a.go("addAnswer")):void e.loginFacebook()}function M(){p.cCategory={};for(var e=0;e<p.content.length;e++)if(p.content[e].id==t.index||p.content[e].slug==t.index){p.cCategory=p.content[e];break}X.ranking=p.cCategory.title,p.rankIsNearMe&&(X.ranking=X.ranking.replace("in San Diego","close to me")),9521==p.cCategory.id&&(ne=!0,X.fnm=!0,X.showR=!1);var a=0;switch(p.cCategory.type){case"Place":a=0;break;case"Person":a=1;break;case"Event":a=2;break;case"Organization":a=3;break;case"Short-Phrase":a=4;break;case"Activity":a=5;break;case"Establishment":a=6;break;case"Thing":a=7;break;case"PersonCust":a=8}var o=p.typeSchema[a].fields;if(p.fields=o,X.fields=p.fields,X.type=p.cCategory.type,"Event"==X.type?X.isE=!0:X.isE=!1,p.NhImplied=!1,p.NhValue="","Establishment"==p.cCategory.type||"Event"==p.cCategory.type)for(var i=p.neighborhoods.concat(p.districts),e=0;e<i.length;e++)if(p.cCategory.title.indexOf(i[e])>-1){p.NhImplied=!0,p.NhValue=i[e];break}if(X.sm)for(var e=0;e<X.fields.length;e++)"cityarea"==X.fields[e].name&&(X.fields[e].isrequired=!1),"upV"==X.fields[e].name&&(X.fields[e].isrequired=!1),"email"==X.fields[e].name&&(X.fields[e].isrequired=!1);p.answers=Q,p.canswers=[];var r=[];p.ccatans=[],p.B=[];var l={},c={};if(ne&&void 0==p.fanswers){for(var e=0;e<J.length;e++)for(var d=J[e],g=0,u=0,m=!1,v={},h=0,f=p.foodranks.cats.split(":").map(Number),b=0;b<f.length;b++)if(d.category==f[b]){if(g=d.answer,u=p.answers.map(function(e){return e.id}).indexOf(g),u<0&&(console.log("idx - ",g,"catansrec - ",d.id,d.answer,d.category),n.deleteRec(d.answer,d.category)),m=!1,r.length>0&&u>0)for(var y=0;y<r.length;y++)if(r[y].id==p.answers[u].id){m=!0,h=y;break}m||(v=p.answers[u],v.upV=d.upV,r.push(v)),m&&(r[h].upV=r[h].upV+d.upV)}p.canswers=r,p.fanswers=r}if(!ne)for(var e=0;e<J.length;e++)if(p.cCategory.isatomic){if(J[e].category==p.cCategory.id)for(var w=0;w<Q.length;w++)if(J[e].answer==Q[w].id){if(c={},c=Q[w],c.catans=J[e].id,c.catansrank=J[e].rank,c.upV=J[e].upV,"Event"==X.type){if(l=JSON.parse(Q[w].eventstr),Y(Q[w],l),s.eventIsCurrent(c,Q[w])){p.canswers.push(c),p.ccatans.push(J[e]),p.B.push(J[e].id);break}break}p.canswers.push(c),p.ccatans.push(J[e]),p.B.push(J[e].id);break}}else for(var k=p.cCategory.catstr.split(":").map(Number),y=0;y<k.length;y++)if(J[e].category==k[y])for(var w=0;w<Q.length;w++)if(J[e].answer==Q[w].id&&1!=J[e].isdup){if(c={},c=Q[w],c.catans=J[e].id,c.catansrank=J[e].rank,c.upV=J[e].upV,"Event"==X.type){if(l=JSON.parse(Q[w].eventstr),Y(Q[w],l),s.eventIsCurrent(c,Q[w])){p.canswers.push(c),p.ccatans.push(J[e]),p.B.push(J[e].id);break}break}p.canswers.push(c),p.ccatans.push(J[e]),p.B.push(J[e].id);break}ne&&p.fanswers&&(p.canswers=p.fanswers),X.answers=p.canswers;for(var x=.017453292519943295,D=Math.cos,C=0,S=p.currentUserLatitude,O=p.currentUserLongitude,E=0,P=0,R=0,e=0;e<X.answers.length;e++)E=X.answers[e].lat,P=X.answers[e].lng,C=.5-D((E-S)*x)/2+D(S*x)*D(E*x)*(1-D((P-O)*x))/2,R=12742*Math.asin(Math.sqrt(C))/1.609,X.answers[e].dist=R<1?R.toPrecision(2):R.toPrecision(3);X.haveLocation=!0,X.answers.length>0&&(isNaN(X.answers[0].dist)?X.haveLocation=!1:X.haveLocation=!0);for(var A=new Date,M=A.getDay(),I=!1,b=0;b<X.answers.length;b++){I=!1;for(var e=0;e<p.specials.length;e++)if(X.answers[b].id==p.specials[e].answer&&"weekly"==p.specials[e].freq&&(0==M&&p.specials[e].sun&&(I=!0),1==M&&p.specials[e].mon&&(I=!0),2==M&&p.specials[e].tue&&(I=!0),3==M&&p.specials[e].wed&&(I=!0),4==M&&p.specials[e].thu&&(I=!0),5==M&&p.specials[e].fri&&(I=!0),6==M&&p.specials[e].sat&&(I=!0),I)){X.answers[b].sp_bc=p.specials[e].bc,X.answers[b].sp_fc=p.specials[e].fc,X.answers[b].sp_title=p.specials[e].stitle;break}}p.cmrecs=[];for(var e=0;e<ee.length;e++)ee[e].category==p.cCategory.id&&p.cmrecs.push(ee[e]);if(p.cuseractivity=[],1==p.cCategory.isatomic)for(var e=0;e<Z.length;e++)Z[e].category==p.cCategory.id&&p.cuseractivity.push(Z[e]);else for(var f=p.cCategory.catstr.split(":").map(Number),e=0;e<Z.length;e++)for(var b=0;b<f.length;b++)if(Z[e].category==f[b]){p.cuseractivity.push(Z[e]);break}X.numContributors=p.cuseractivity.length,X.isLoading=!1}function I(){te=!1}function $(){p.isLoggedIn?p.cmrecs_user.length>0?(X.selOverall="",X.selPersonal="active",X.numContributors=1,r.computeRanking(p.canswers,p.cmrecs_user)):e.getDialog("noPersonalRank"):e.getDialog("notLoggedIn")}function _(){X.selOverall="active",X.selPersonal="",X.numContributors=p.cuseractivity.length,r.computeRanking(p.canswers,p.cmrecs)}function T(){function e(e,t){return e.Rank-t.Rank}X.answers=X.answers.sort(e),F(),p.canswers=X.answers,X.selRank="active",X.selDistance="",X.selUpV="",X.selDate="",X.showR=!0}function L(){function t(e,t){return e.dist-t.dist}X.haveLocation?(X.answers=X.answers.sort(t),F(),p.canswers=X.answers,X.selRank="",X.selDistance="active",X.selUpV="",X.selDate="",ne&&(X.answers=X.answers.slice(0,99))):(p.loadRankWhenCoordsRdy=!0,p.rankIsNearMe=!0,e.askPermissionToLocate())}function B(){function e(e,t){return t.upV-e.upV}X.answers=X.answers.sort(e),F(),p.canswers=X.answers,X.selRank="",X.selDistance="",X.selUpV="active",X.selDate="",ne||X.isE||(X.showR=!X.sm)}function U(){function e(e,t){return s.date2number(e.date)-s.date2number(t.date)}X.answers=X.answers.sort(e),F(),p.canswers=X.answers,X.selRank="",X.selDistance="",X.selUpV="",X.selDate="active"}function N(){b.loadComments("category",oe).then(function(){x.all(oe.comments.map(function(e){return D.getFBUserById(e.user)})).then(function(e){for(var t=0;t<oe.comments.length;t++)oe.comments[t].picture=e[t]?e[t].picture.data.url:null})})}function V(){b.postComment("category",oe)}function F(){X.image1="/assets/images/noimage.jpg",X.image2="/assets/images/noimage.jpg",X.image3="/assets/images/noimage.jpg",X.answers[0]&&(X.image1=X.answers[0].imageurl),X.answers[1]&&(X.image2=X.answers[1].imageurl),X.answers[2]&&(X.image3=X.answers[2].imageurl)}function G(){p.cCategory.title.indexOf("@")>-1?a.go("answerDetail",{index:p.cCategory.owner}):a.go("cwrapper")}function q(){p.addInfoMsgAck=!0,X.hideInfoBox=!0,X.addInfoMsgAck=!0}function j(){e.getLocation(z)}function z(){p.$emit("getLocation")}function Y(e,t){e.bc=t.bc,e.fc=t.fc,e.freq=t.freq,e.edate=t.edate,e.sdate=t.sdate,e.etime=t.etime,e.etime2=t.etime2,e.stime=t.stime,e.stime2=t.stime2,e.mon=t.mon,e.tue=t.tue,e.wed=t.wed,e.thu=t.thu,e.fri=t.fri,e.sat=t.sat,e.sun=t.sun}function W(t){if(p.isLoggedIn)return p.DEBUG_MODE&&console.log("Comment Flagged"),y.flagAnswer("comment-rank",p.cCategory.id,t),void e.getDialog("commentFlagged");e.loginFacebook()}function H(){X.linkurl="https://rank-x.com/rankSummary/"+p.cCategory.slug,X.tweet=p.cCategory.title+", endorse your favorite ones at: ";var t="https://rank-x.com/"+p.cCategory.image1url;"Short-Phrase"==p.cCategory.type&&(t="https://rank-x.com/assets/images/rankxlogosd2_sm.png"),e.shareOptions(K,X.isMobile,X.linkurl,"Rank-X, "+X.ranking+", "+p.cCategory.question+"\n"+t,m)}function K(e){var t=p.cCategory.image1url;switch("Short-Phrase"==p.cCategory.type&&(t="https://rank-x.com/assets/images/rankxlogosd2_sm.png"),e){case"twitter":p.DEBUG_MODE&&console.log(e),w.share({provider:"twitter",attrs:{socialshareUrl:X.linkurl,socialshareText:X.tweet,socialshareHashtags:"rankxsandiego"}});break;case"facebook":p.DEBUG_MODE&&console.log(e),FB.ui({method:"feed",name:p.cCategory.title,link:X.linkurl,picture:t,caption:"Rank-X San Diego",description:p.cCategory.question,message:""});break;case"email":p.DEBUG_MODE&&console.log(e),w.share({provider:"email",attrs:{socialshareSubject:"Rank-X, "+X.ranking,socialshareBody:X.linkurl}});break;case"gplus":p.DEBUG_MODE&&console.log(e),w.share({provider:"google",attrs:{socialshareUrl:X.linkurl,socialshareText:X.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"pinterest":p.DEBUG_MODE&&console.log(e),w.share({provider:"pinterest",attrs:{socialshareUrl:X.linkurl,socialshareText:"Rank-X, "+X.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"tumblr":p.DEBUG_MODE&&console.log(e),w.share({provider:"tumblr",attrs:{socialshareUrl:X.linkurl,socialshareText:"Rank-X, "+X.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"reddit":p.DEBUG_MODE&&console.log(e),w.share({provider:"reddit",attrs:{socialshareUrl:X.linkurl,socialshareText:"Rank-X, "+X.ranking,socialshareSubreddit:p.cCategory.question}})}}var X=this;X.title="rankSummary",X.addAnswerDisabled="",X.answerDetail=P,X.addAnswer=A,X.goRank=R,X.closeRank=G,X.rankOverall=_,X.rankPersonal=$,X.closeAddInfoMsg=q,X.whyNoDistance=j,X.sortByRank=T,X.sortByDistance=L,X.sortByUpV=B,X.sortByDate=U,X.loadComments=N,X.postComment=V,X.cmFlag=W,X.share=H,X.selOverall="active",X.selPersonal="",X.selRank="active",X.selDistance="",X.commLoaded=!1,X.user=p.user;p.cvotes=[],p.ceditvotes=[],p.cmrecs_user=[];var Q=[],J=[],Z=[],ee=[],te=!1,ae=!1,ne=!1,se=!1;X.fnm=!1;var oe={};oe.commLoaded=!1,oe.initials="",oe.bc="",oe.fc="",oe.comments=[],oe.newComment="",X.cm=oe,X.isLoggedIn=void 0!=p.isLoggedIn&&p.isLoggedIn,p.userHasRank=!1,p.userActRecId=0;X.hideInfoBox=!1,p.addInfoMsgAck?X.addInfoMsgAck=p.addInfoMsgAck:X.addInfoMsgAck=!1;var ie=p.$on("updateVoteTable",function(){ae||O(),ae=!0}),re=p.$on("rankDataLoaded",function(){X.dataReady=!0,C()});m.$on("$destroy",ie),m.$on("$destroy",re),X.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(X.isMobile=!0),g.innerWidth<512?(X.sm=!0,X.nsm=!1):(X.sm=!1,X.nsm=!0),null!=document.getElementById("SearchInput")&&void 0!=document.getElementById("SearchInput")&&document.getElementById("SearchInput").blur(),window.prerenderReady=!1,p.rankSummaryDataLoaded?(X.dataReady=!0,C()):X.dataReady=!1}angular.module("app").controller("rankSummary",e),e.$inject=["dialog","$stateParams","$state","catans","datetime","color","answer","rank","$filter","table","vrowvotes","$window","vrows","$scope","$rootScope","$modal","editvote","votes","commentops","flag","Socialshare","$location","$q","fbusers"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l){function c(e){if(!s.isLoggedIn)return void t.loginFacebook();var a={};a.user=s.user.id,a.hs=y.answer1.id,a.ls=y.answer2.id,a.category=s.cCategory.id,a.timestmp=Date.now(),1==e&&(a.sel=y.answer1.id),2==e&&(a.sel=y.answer2.id),P.push(a),s.cmrecs_user.push(a),O++,O>=C&&(O=0),R=!0,u()}function d(){O++,O>=C&&(O=0),u()}function g(){x=s.canswers4rank,D=x.length,C=D*(D-1)/2}function u(){if(y.GP=s.cmrecs_user.length,s.DEBUG_MODE&&console.log("vm.GP - ",y.GP),y.Tot=C,s.cmrecs_user.length>=C)return R?t.getDialog("goodJobRankComplete"):t.getDialog("rankComplete"),void m();if(E)for(var e=w[S[O]],a=k[S[O]],n=!1,o=0;o<s.cmrecs_user.length;o++)if(s.cmrecs_user[o].hs==x[e].id&&s.cmrecs_user[o].ls==x[a].id){n=!0;break}n&&d(),y.answer1=x[w[S[O]]],y.answer2=x[k[S[O]]],f()}function m(){e.go("rankSummary",{index:y.table.id})}function p(t){1===t?e.go("answerDetail",{index:y.answer1.id}):e.go("answerDetail",{index:y.answer2.id})}function v(){w=[],k=[];for(var e=0;e<=D-1;e++)for(var t=e+1;t<=D-1;t++)w.push(e),k.push(t)}function h(){for(var e=0;e<C;e++)S[e]=e;S=function(e){var t,a,n=e.length;if(n)for(;--n;)a=Math.floor(Math.random()*(n+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(S)}function f(){y.fields=s.fields}function b(){e.go("rankSummary",{index:s.cCategory.id})}var y=this;y.title="match",y.header="table"+s.cCategory.id+".header",y.body="table"+s.cCategory.id+".body",y.ranking=s.title;var w=[],k=[],x=[],D=0,C=0,S=[],O=0,E=s.cmrecs_user.length>0,P=[],R=!1;y.table=s.cCategory,y.type=s.cCategory.type,y.answer1,y.answer2,y.selectAnswer=c,y.rankSummary=m,y.skipMatch=d,y.answerDetail=p,y.closeRank=b,l.innerWidth<512?(y.sm=!0,y.nsm=!1):(y.sm=!1,y.nsm=!0),function(){s.$on("$stateChangeSuccess",function(e,t,a,n,o){s.previousState=n.name}),s.$on("$stateChangeStart",function(e,t,a,n,s){"match"==n.name&&P.length>0&&(o.postRec(P),P=[])}),g(),v(),h(),u()}()}angular.module("app").controller("match",e),e.$inject=["$state","dialog","$location","answer","$rootScope","matchrec","$modal","useractivity","$window"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g){function u(){E.rankTitle=t.cCategory.title,E.tags=t.cCategory.tags,E.keywords=t.cCategory.keywords,E.type=t.cCategory.type,E.question=t.cCategory.question,E.answertags=t.cCategory.answertags,E.isatomic=t.cCategory.isatomic,E.catstr=t.cCategory.catstr,E.ismp=t.cCategory.ismp,t.cCategory.bc&&(E.bc=t.cCategory.bc),t.cCategory.fc&&(E.fc=t.cCategory.fc),t.cCategory.shade&&(E.shade=t.cCategory.shade),t.cCategory.bc&&(E.bc2=d.shadeColor(E.bc,E.shade/10)),t.cCategory.fimage&&(E.image=t.cCategory.fimage)}function m(){a.go("cwrapper")}function p(){var e=JSON.parse(JSON.stringify(t.cCategory)),a=[],n=[];e.title!=E.rankTitle&&(a.push("title"),n.push(E.rankTitle)),e.tags!=E.tags&&(a.push("tags"),n.push(E.tags)),e.keywords!=E.keywords&&(a.push("keywords"),n.push(E.keywords)),e.type!=E.type&&(a.push("type"),n.push(E.type)),e.question!=E.question&&(a.push("question"),n.push(E.question)),e.answertags!=E.answertags&&(a.push("answertags"),n.push(E.answertags)),e.isatomic!=E.isatomic&&(a.push("isatomic"),n.push(E.isatomic)),e.catstr!=E.catstr&&(a.push("catstr"),n.push(E.catstr)),e.ismp!=E.ismp&&(a.push("ismp"),n.push(E.ismp)),e.bc!=E.bc&&(a.push("bc"),n.push(E.bc)),e.fc!=E.fc&&(a.push("fc"),n.push(E.fc)),e.shade!=E.shade&&(a.push("shade"),n.push(E.shade)),e.fimage!=E.images[E.i].webformatURL&&(a.push("fimage"),n.push("https://rankx.blob.core.windows.net/sandiego/featuredImages/"+t.cCategory.slug+".jpg"),e.fimage&&e.fimage.indexOf("https://rankx.blob")>-1&&i.deleteBlob(e.fimage),C()),r.update(e.id,a,n),m()}function v(){l.deleteRank(t.cCategory,h)}function h(){r.deleteTable(t.cCategory.id),c.deletebyCategory(t.cCategory.id),a.go("cwrapper")}function f(){var e=E.imageQuery.replace(" ","+");E.i=0,E.images=[],g.search(e).then(function(e){t.DEBUG_MODE&&console.log("Pixabay results - ",e),E.numResults=e.length;for(var a=0;a<E.numResults;a++)E.images.push(e[a]);E.image=E.images[E.i].previewURL})}function b(){E.i=E.i+1,E.i>E.images.length-1&&(E.i=E.images.length-1),E.image=E.images[E.i].previewURL}function y(){E.i=E.i-1,E.i<0&&(E.i=0),E.image=E.images[E.i].previewURL}function w(e){E.c1sel=!1,E.c2sel=!1,E.c3sel=!1,E.c4sel=!1,E.c5sel=!1,E.c6sel=!1,1==e&&(E.c1sel=!0),2==e&&(E.c2sel=!0),3==e&&(E.c3sel=!0),4==e&&(E.c4sel=!0),5==e&&(E.c5sel=!0),6==e&&(E.c6sel=!0),k(e)}function k(e){1==e&&(E.bc="brown",E.fc="#f8f8ff"),2==e&&(E.bc="#4682b4",E.fc="#f8f8ff"),3==e&&(E.bc="#008080",E.fc="#f8f8ff"),4==e&&(E.bc="gray",E.fc="#f8f8ff"),5==e&&(E.bc="#a3297a",E.fc="#f8f8ff"),6==e&&(E.bc="#c68c53",E.fc="#f8f8ff"),E.bc2=d.shadeColor(E.bc,E.shade)}function x(){E.shade=E.shade+1,E.shade>10&&(E.shade=10),E.bc2=d.shadeColor(E.bc,E.shade/10)}function D(){E.shade=E.shade-1,E.shade<-10&&(E.shade=-10),E.bc2=d.shadeColor(E.bc,E.shade/10)}function C(){var e=t.cCategory.slug,a=E.images[E.i].webformatURL,n=t.cCategory.id;t.DEBUG_MODE&&console.log("Process Image - ",n,a,e),S(a,e,n)}function S(e,a,n){o({method:"POST",url:"https://server.rank-x.com/ImageServer/SaveImage",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{imageurl:e,filename:a,rank:n}}).then(function(e){t.DEBUG_MODE&&console.log("Processing Image Success",e)},function(e){t.DEBUG_MODE&&console.log("Error Processing Image - ",e)})}function O(){a.go("cwrapper")}var E=this;E.title="editRanking",E.closeRank=m,E.goEdit=p,E.goDelete=v,E.getImages=f,E.plusShade=x,E.minusShade=D,E.shade=0,E.nextImg=b,E.prevImg=y,E.csel=w,E.goBack=O,E.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],s.innerWidth<512?(E.sm=!0,E.nsm=!1):(E.sm=!1,E.nsm=!0),function(){t.cCategory={};for(var e=0;e<t.content.length;e++)if(t.content[e].id==n.index||t.content[e].slug==n.index){t.cCategory=t.content[e];break}console.log("$rootScope.cCategory - ",t.cCategory),E.ranking=t.cCategory.title,t.rankIsActive=!0,t.objNumAct=t.objNum,u(),t.DEBUG_MODE&&console.log("editRanking page Loaded!")}()}angular.module("app").controller("editRanking",e),e.$inject=["$location","$rootScope","$state","$stateParams","$window","$http","imagelist","table","dialog","catans","color","pixabay"]}(),function(){"use strict";function e(e,t,a){function n(n){if(g()&&!n)return t.when(m);var s=v+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return m=e[0].data.resource,a.DEBUG_MODE&&console.log("No. promoters: ",m.length),m},u)}function s(t){function a(e){return p=e.data.resource}var n=v+"/"+t;return e.get(n).then(a,u)}function o(t){function a(e){return p=e.data.resource}var n=v+"/?filter=user="+t;return e.get(n).then(a,u)}function i(t){function a(e){return p=e.data.resource}var n=v+"/?filter=code="+t;return e.get(n).then(a,u)}function r(t){function a(e){var a=t;return a.id=e.data.resource[0].id,m.push(a),e.data}var n=v,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,u)}function l(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating promoter succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"firstname":r.firstname=s[l];break;case"lastname":r.lastname=s[l];break;case"email":r.email=s[l];break;case"address":r.address=s[l];break;case"phone":r.phone=s[l];break;case"code":r.code=s[l];break;case"stripeid":r.stripeid=s[l]}i.resource.push(r);for(var c=v,d=p.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"firstname":p[d].firstname=s[l];break;case"lastname":p[d].lastname=s[l];break;case"email":p[d].email=s[l];break;case"address":p[d].address=s[l];break;case"phone":p[d].phone=s[l];break;case"code":p[d].code=s[l];break;case"stripeid":p[d].stripeid=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,u)}function c(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting promote was succesful"),e.data}var s={};s.resource=[];var o={};o.id=promote_id,s.resource.push(o);var i=v+"/"+t,r=m.map(function(e){return e.id}).indexOf(t);return r>-1&&m.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,u)}function d(t){function a(e){return p=e.data.resource}var n=v+"/?filter=code="+t;return e.get(n).then(a,u)}function g(){return m.length>0}function u(e){throw e}var m=[],p={},v="/api/v2/mysql/_table/promoters";return{getall:n,get:s,getbyUser:o,getbyCode:i,add:r,update:l,deletepromoter:c,getbycode:d}}angular.module("app").factory("promoter",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s){function o(){c.promoter.code=c.code,r(),d&&n.add(c.promoter).then(function(){s.notificationWithCallback("Success","You have successfully registered as a Promoter.",i)})}function i(){a.go("promoterconsole")}function r(){d=!0,c.promoter.firstname.length<1?(s.getDialog("firstnameisinvalid"),d=!1):c.promoter.lastname.length<1?(s.getDialog("lastnameisinvalid"),d=!1):c.promoter.email.length<1||c.promoter.email.indexOf("@")<0?(s.getDialog("emailisinvalid"),d=!1):c.promoter.address.length<5?(s.getDialog("addressisinvalid"),d=!1):c.promoter.phone.length<9?(s.getDialog("phoneisinvalid"),d=!1):c.promoter.code.length<1&&(s.getDialog("missingcode"),d=!1)}function l(){for(var e="",t="",a="abcdefghijklmnopqrstuvwxyz",n="0123456789",s=0;s<5;s++)e+=a.charAt(Math.floor(Math.random()*a.length));for(var s=0;s<3;s++)t+=n.charAt(Math.floor(Math.random()*n.length));c.code=e+t}var c=this;c.title="promote",c.getcode=l,c.submit=o;var d=!1;!function(){c.promoter={},c.promoter.firstname="",c.promoter.lastname="",c.promoter.phone="",c.promoter.address="",c.promoter.code="",c.promoter.email="",t.user?(c.promoter.firstname=t.user.first_name,c.promoter.lastname=t.user.last_name,c.promoter.user=t.user.id):s.getDialog("nologinsignup"),console.log("promote page Loaded!")}()}angular.module("app").controller("promotersignup",e),e.$inject=["$location","$rootScope","$state","promoter","dialog"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c){function d(){window.open("https://connect.stripe.com/oauth/authorize?response_type=code&client_id="+l+"&scope=read_write&state="+w.promoter.id,"Stripe Connect","_self")}function g(){t.userpromoter&&1==t.userpromoter.length&&t.userpromoter[0].user==t.user.id?(C=!0,w.promoter=t.userpromoter[0],w.userIsPromoter=!0):(w.userIsPromoter=!1,w.dataReady=!0),w.dataReady||u(),console.log("Promoter console page Loaded!"),console.log("vm.dataReady - ",w.dataReady)}function u(){var e=0,a=0,n={};!w.dataReady&&C&&s.getaccntsbycode(t.userpromoter[0].code).then(function(s){console.log("resuls -",s);for(var o=0;o<s.length;o++){e=s[o].answer,n={},a=t.answers.map(function(e){return e.id}).indexOf(e),n=angular.copy(s[o]),n.name=t.answers[a].name,n.answerObj=t.answers[a],"Basic"==n.status&&(n.style="background-color:#bfbfbf"),n.istrial?(n.status="On Trial "+Math.ceil(moment.duration(moment(n.discountEndDate)-moment()).asDays())+" Days left",n.style="background-color:#b3b300"):(n.status="Active",n.style="background-color:#009900");for(var i=0;i<t.codeprices.length;i++)if(t.codeprices[i].code==n.bizcat){n.price=t.codeprices[i].price;break}n.totalCommission=0,n.ispremium&&(n.totalCommission+=n.price*w.STRIPE_COMMISSION_PERCENTAGE),n.hasranks&&(n.totalCommission+=35*n.ranksqty*w.STRIPE_COMMISSION_PERCENTAGE),w.myaccnts.push(n)}w.myaccnts.length>0?w.noAns=!1:w.noAns=!0,w.dataReady=!0,g()})}function m(e){a.go("answerDetail",{index:e.slug})}function p(){a.go("promote")}function v(e){w.manageview=!0,w.business=e,w.overview=!1}function h(){if(1==w.manageview)return w.overview=!0,void(w.manageview=!1);"rankSummary"==t.previousState?a.go("rankSummary",{index:t.cCategory.id}):"answerDetail"==t.previousState?a.go("answerDetail",{index:t.canswer.id}):"addAnswer"==t.previousState?a.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?a.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?a.go("about"):a.go("cwrapper")}function f(){k=["firstname","lastname","email","address","phone"],x=["First Name","Last Name","Email","Address","Phone"],D=[w.promoter.firstname,w.promoter.lastname,w.promoter.email,w.promoter.address,w.promoter.phone],o.editInfo(k,x,D,b)}function b(e){i.update(w.promoter.id,k,e).then(function(){u()})}function y(){a.go("promotersignup")}var w=this;if(w.notifications=[],-1!==n.location.href.indexOf("connectStripe")){"success"==n.location.href.slice(n.location.href.indexOf("connectStripe")).split("=")[1].split("&")[0]?w.notifications.push({message:"You are successfully connected to your Stripe Account",type:"success"}):n.alert(n.location.href.slice(n.location.href.indexOf("message")).split("=")[1].split("&")[0])}
var k=[],x=[],D=[];w.title="promoterconsole",w.overview=!0,w.manageview=!0,w.STRIPE_COMMISSION_PERCENTAGE=t.setting?t.setting.STRIPE_COMMISSION_PERCENTAGE:.2,w.gotoanswer=m,w.gotomanage=v,w.gotoPromotePage=p,w.goBack=h,w.goEdit=f,w.goSignup=y,w.connectStripe=d,w.myaccnts=[],w.noAns=!1,w.manageview=!1,w.dataReady=!1;var C=!1;!function(){i.getbyUser(t.user.id).then(function(e){t.userpromoter=e,g()})}()}angular.module("app").controller("promoterconsole",e),e.$inject=["$location","$rootScope","$state","$window","useraccnt","dialog","promoter","$location","STRIPE_CLIENT_ID","setting"]}(),function(){"use strict";function e(e,t,a,n){function s(e){1==e&&o.showOne?o.showOne=!1:2==e&&o.showTwo?o.showTwo=!1:3==e&&o.showThree?o.showThree=!1:4==e&&o.showFour?o.showFour=!1:5==e&&o.showFive?o.showFive=!1:6==e&&o.showSix?o.showSix=!1:(o.showOne=!1,o.showTwo=!1,o.showThree=!1,o.showFour=!1,o.showFive=!1,o.showSix=!1,1!=e||o.showOne||(o.showOne=!0),2!=e||o.showTwo||(o.showTwo=!0),3!=e||o.showThree||(o.showThree=!0),4!=e||o.showFour||(o.showFour=!0),5!=e||o.showFive||(o.showFive=!0),6!=e||o.showSix||(o.showSix=!0))}var o=this;o.title="promote",o.show=s,o.showOne=!1,o.showTwo=!1,o.showThree=!1,o.showFour=!1,o.showFive=!1,o.showSix=!1,function(){console.log("promote page Loaded!")}()}angular.module("app").controller("promote",e),e.$inject=["$location","$rootScope","$state","promoter"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g){function u(){if(e.isLoggedIn){e.DEBUG_MODE&&console.log("user is logged in, loading data");var s=t.loadVotesByUser(),d=a.loadEditVotesTable(),g=n.loadVrowVotes(),u=o.getActivitybyUser(),m=r.getbyUser(e.user.id),p=l.get(),v=c.get();return i.all([s,d,g,u,m,p,v]).then(function(t){e.cvotes=t[0],e.editvotes=t[1],e.cvrowvotes=t[2],e.thisuseractivity=t[3],e.userpromoter=t[4],e.catcodes=t[5],e.codeprices=t[6],e.DEBUG_MODE&&console.log("user promoter - ",e.userpromoter),e.userDataLoaded=!0,e.$emit("userDataLoaded")})}e.DEBUG_MODE&&console.log("user is not logged in, no need to load data"),e.cvotes=[],e.editvotes=[],e.cvrowvotes=[],e.thisuseractivity=[],e.userpromoter=[],e.catcodes=[],e.codeprices=[],e.userDataLoaded=!0,e.$emit("userDataLoaded")}function m(){e.isLoggedIn&&s.getuseraccnt().then(function(t){function a(e){i.customer=e.data}if(e.useraccnts=t,e.showWarning=!1,e.useraccnts.length>0){for(var n=!0,s="",o=0;o<e.useraccnts.length;o++)if(""!=e.useraccnts[o].email&&(n=!1),void 0!=e.useraccnts[o].stripeid&&""!=e.useraccnts[o].stripeid&&0!=e.useraccnts[o].stripeid){s=g+"dreamfactory-stripe-user/"+e.useraccnts[o].stripeid+"/"+e.useraccnts[o].id;var i=e.useraccnts[o],r={method:"GET",url:s,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}};d(r).then(a,function(e){console.log("Error updating Stripe Invoices - ",e)}),console.log("Retrieving latest invoice info from Stripe")}e.$emit("userAccountsLoaded"),n?(e.showWarning=!0,e.$emit("showWarning")):e.showWarning=!1}})}return{loadUserData:u,loadUserAccount:m}}angular.module("app").service("userdata",e),e.$inject=["$rootScope","votes","editvote","vrowvotes","useraccnt","useractivity","$q","promoter","categorycode","codeprice","$http","SERVER_URL"]}(),function(){"use strict";function e(e,t,a,n,s){function o(t,a){var n=s+"stripeServer/payPromoter",o={method:"POST",url:n,data:{stripeId:t.stripeid,promoterId:t.id,amount:t.balance*a},headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}};return e(o).then(function(e){return e})}function i(t,a){return e({method:"GET",url:s+"stripeServer/"+t+"/"+a+"/deleteCustomer",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return e})}function r(t){return e({method:"GET",url:s+"stripeServer/"+t+"/invoices",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return e.data})}function l(){function t(e){return h=e.data.resource}var a=b;return e.get(a).then(t,v)}function c(){function t(e){return h=e.data.resource}var n=b+"?filter=(user="+a.user.id+")";return e.get(n).then(t,v)}function d(t){function n(e){return e.data.resource}var s=b+"?filter=(user="+a.user.id+") AND (answer="+t+")";return e.get(s).then(n,v)}function g(t){function a(e){return f=e.data.resource}var n=b+"?filter=(promocode="+t+")";return e.get(n).then(a,v)}function u(t){function n(e){var t=s;return t.id=e.data.resource[0].id,h.push(t),e.data.resource[0].id}var s={};s.user=a.user.id,s.answer=t.id,s.bizcat=p(t.id),s.status="Basic",s.stripeid="0",s.email="",s.username=a.user.name;var o={};o.resource=[],o.resource.push(s);var i=b;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(n,v)}function m(t,n,s){function o(e){return a.$emit("clear-notification-warning"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"bizcat":r.bizcat=s[l];break;case"email":r.email=s[l];break;case"status":r.status=s[l];break;case"stripeid":r.stripeid=s[l];break;case"ispremium":r.ispremium=s[l];break;case"hasranks":r.hasranks=s[l];break;case"ranksqty":r.ranksqty=s[l];break;case"name":r.name=s[l]}i.resource.push(r);for(var c=b,d=h.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"bizcat":h[d].bizcat=s[l];break;case"email":h[d].email=s[l];break;case"status":h[d].status=s[l];break;case"stripeid":h[d].stripeid=s[l];break;case"ispremium":h[d].ispremium=s[l];break;case"hasranks":h[d].hasranks=s[l];break;case"ranksqty":h[d].ranksqty=s[l];break;case"name":h[d].name=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,v)}function p(e){for(var t=0,n={},s="",o=0,i=0,r=0;r<a.catansrecs.length;r++)if(a.catansrecs[r].answer==e){t=a.catansrecs[r].category;var l=a.content.map(function(e){return e.id}).indexOf(t);n=a.content[l];for(var c=0;c<a.catcodes.length;c++)if(n.title.indexOf(a.catcodes[c].category)>-1)if(""==s)s=a.catcodes[c].code;else{for(var d=0;d<a.codeprices.length;d++)a.codeprices[d].code==s&&(o=a.codeprices[d].scale),a.codeprices[d].code==a.catcodes[c].code&&(i=a.codeprices[d].scale);i>o&&(s=a.catcodes[c].code)}}return s}function v(e){throw e}var h=[],f=[],b="/api/v2/mysql/_table/useraccnts";return{getuseraccnt:c,getaccntsbycode:g,getuseraccntans:d,getallaccnts:l,adduseraccnt:u,updateuseraccnt:m,getuseraccntInvoicesAndCustomer:r,deleteAccount:i,payPromoter:o}}angular.module("app").factory("useraccnt",e),e.$inject=["$http","$q","$rootScope","login","SERVER_URL"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c){function d(){return b.loginWithFacebook().then(function(e){return l.login("public_profile,email,user_friends").then(function(e){if("connected"===e.status)return l.api("/me?fields=id,name,picture,first_name,last_name,gender,age_range,locale")}).then(function(e){return console.log("My info: ",e),n.user=e,l.api("me/friends?fields=first_name,gender,locale,last_name,email,picture")}).then(function(e){console.log("Got friends: ",e),n.user.friends=e,n.isLoggedIn=!0,c.addFBUser(n.user);try{window.localStorage.user=JSON.stringify(n.user)}catch(e){}n.DEBUG_MODE&&console.log("oauthWithFacebook succesful"),n.$emit("redirectAfterLogin")}).catch(function(e){console.log(e)})})}function g(t){return console.log("login/services/login.svc.js:initiate"),e.post("/api/v2/user/session",t).then(function(t){e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,a.session_token=t.data.session_token,n.user=t.data;try{window.localStorage.user=JSON.stringify(t.data)}catch(e){}})}function u(){n.DEBUG_MODE&&console.log("@loginWithFacebook");var e="",i=0,r=0;e=void 0==n.stateName?o.current.name:n.stateName,void 0==n.stateName?("rankSummary"==e&&(i=n.cCategory.id),"answerDetail"==e&&(i=n.canswer.id)):i=n.stateNum,r=void 0!=n.cCategory?n.cCategory.id:void 0,a.put("statename",e),a.put("statenum",i),a.put("ccategory",r);var l=t.defer(),c=s+"/api/v2/user/session?service=facebook";return l.resolve({url:c}),l.promise}function m(t){function s(t){console.log("oauth results",t),e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,a.session_token=t.data.session_token,n.user=t.data,n.isLoggedIn=!0;try{window.localStorage.user=JSON.stringify(t.data)}catch(e){}n.DEBUG_MODE&&console.log("oauthWithFacebook succesful"),n.$emit("redirectAfterLogin")}return n.DEBUG_MODE&&console.log("@oauthWithFacebook - ",t),e.post("/api/v2/user/session?oauth_callback=true&service=facebook&"+t).then(s,v)}function p(){return e.delete("/api/v2/user/session").then(function(t){delete e.defaults.headers.common["X-DreamFactory-Session-Token"],a.remove("session_token"),delete n.user,n.isLoggedIn=!1;try{window.localStorage.removeItem("user")}catch(e){}})}function v(e){throw console.log("error",e),e}function h(t){return console.log("options",t),e.post("/api/v2/user/register?login=true",t).then(function(e){console.log("register result",e)},function(e){console.log("error",e)})}function f(){var e=new Object;e.age_range={min:21},e.first_name="Test",e.friends={data:[{first_name:"John",gender:"male",id:"362411340826490",last_name:"Carter",locale:"en_US",picture:{data:{is_silhouette:!1,url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/18034179_362408994160058_2814191765613662934_n.jpg?oh=03f00905624bc37bc3f57b76148a44aa&oe=59BC08B8"}}},{first_name:"John",gender:"male",id:"398314100568945",last_name:"Will",locale:"en_US",picture:{data:{is_silhouette:!1,url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/14915696_288291968237826_1651783963192855784_n.jpg?oh=18bee38eafb63165ac9ecf37d649d8ee&oe=597C137F"}}}],summary:{}},e.gender="male",e.id=0xaaf2b1002387,e.last_name="User",e.locale="us_EN",e.name="Test User",e.picture={data:{url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/18057110_194133167766495_4123816583005617544_n.jpg?oh=7dc367a88a4d28f4f84137f9007f847e&oe=59836C25"}},n.isAdmin=!0,e.is_sys_admin=!0,a.session_token=e.session_token,n.user=e;try{return window.localStorage.user=JSON.stringify(e),{email:e.email,first_name:e.first_name,host:e.host,id:e.id,is_sys_admin:e.is_sys_admin,last_login_date:e.last_login_date,last_name:e.last_name,name:e.name,role:e.role,role_id:e.role_id,session_id:e.session_id,session_token:e.session_token}}catch(e){}}var b={initiate:g,loginWithFacebook:u,oauthWithFacebook:m,register:h,logout:p,setFakeLocalUser:f,facebookSDKLogin:d};return b}angular.module("app").factory("login",e),e.$inject=["$http","$q","$cookies","$rootScope","INSTANCE_URL","$state","$location","$window","$facebook","fbusers"]}(),function(){"use strict";angular.module("login",["ngResource","ngCookies","ui.router"]).run(["$rootScope",function(e){try{e.user=JSON.parse(window.localStorage.user),e.user&&(e.isLoggedIn=!0),e.user.is_sys_admin&&(e.isAdmin=!0)}catch(e){}}]).config(function(){})}(),function(){"use strict";function e(e,t,a,n){function s(e){return e.url.indexOf("/api/v2")>-1&&(e.url=n+e.url),e.url.indexOf("api.instagram.com")>-1&&(e.headers.useXDomain=!0,e.headers.common="Content-Type: application/json",delete e.headers.common["X-Requested-With"],delete e.headers["X-DreamFactory-Session-Token"],delete e.headers["X-Dreamfactory-API-Key"]),"post"===e.method.toLowerCase()&&e.url.indexOf("/api/v2/user/session")>-1&&delete e.headers["X-DreamFactory-Session-Token"],e}function o(a){return console.log("result",a),302==a.status?(console.log("result",a),e.path("/login"),t.reject(a)):((401===a.status||403===a.status&&a.data.error.message.indexOf("token")>-1)&&e.path("/login"),t.reject(a))}return{request:s,responseError:o}}angular.module("login").factory("httpInterceptor",e),e.$inject=["$location","$q","$injector","INSTANCE_URL"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("register",n),a.register({email:o.username,password:o.password,first_name:o.firstName||"Address",last_name:o.lastName||"Book"}).then(function(){e.path("/bizlogin")},function(e){o.message=e.Message,console.log("Error: ",e)})}function s(){e.path("/bizlogin")}var o=this;o.title="register",o.username="",o.password="",o.confirm="",o.firstName="",o.lastName="",o.message="",o.register=n,o.signIn=s,function(){t.isLoggedIn=!1}()}angular.module("login").controller("register",e),e.$inject=["$location","$rootScope","login"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d){function g(){n.facebookSDKLogin()}function u(){console.log("submit"),n.initiate({email:b.username,password:b.password}).then(function(){a.isLoggedIn=!0,console.log("isLoggedIn",a.isLoggedIn),e.path("/")})}function m(){var e=i.get("statename"),t=i.get("statenum");"rankSummary"==e||"answerDetail"==e?o.go(e,{index:t}):o.go("cwrapper")}function p(){n.loginWithFacebook().then(function(e){console.log("result @loginWithFacebook - ",e),t.location=e.url})}function v(){e.path("/register")}function h(){o.go("cwrapper")}function f(){s.getDialog("whyFacebook")}var b=this;b.title="login",b.username="",b.password="",b.code="",b.isProgressing=!1,b.submit=u,b.register=v,b.redirectForFacebook=p,b.whyFacebookDialog=f,b.facebookLogin=g,b.goBack=h,a.$on("redirectAfterLogin",function(){m()}),"localhost"==window.location.hostname&&(console.log("server is: "+window.location.hostname),console.log("let's fake your user as an FB login"),n.setFakeLocalUser()),a.isLoggedIn&&o.go("cwrapper")}angular.module("login").controller("login",e),e.$inject=["$location","$window","$rootScope","login","dialog","$state","$cookies","$http","$facebook","fbusers","InstagramService"]}(),function(){"use strict";function e(e,t,a,n,s,o,i){function r(){console.log("bizlogin - submit"),n.initiate({email:l.username,password:l.password}).then(function(){a.isLoggedIn=!0,console.log("isLoggedIn",a.isLoggedIn),i.go("cwrapper",{},{location:"replace"})})}var l=this;l.title="bizlogin",l.username="",l.password="",l.code="",l.isProgressing=!1,l.submit=r,function(){var e=location.search,t=e.lastIndexOf("?");t>=0&&(e=e.substr(t+1)),e&&(l.isProgressing=!0,n.oauthWithFacebook(e).then(function(e){a.isLoggedIn=!0,console.log("isLoggedIn",a.isLoggedIn),i.go("cwrapper",{},{location:"replace"})},function(){l.isProgressing=!1})),console.log("vm.code bizlogin --",l.code),a.isLoggedIn=!1}()}angular.module("login").controller("bizlogin",e),e.$inject=["$location","$window","$rootScope","login","dialog","userDetail","$state"]}(),angular.module("app").directive("userDetailModal",["$rootScope","userDetail","dialog",function(e,t,a){"use strict";return{restrict:"E",templateUrl:"app/login/partials/add-user-detail.html",link:function(n,s,o,i){n.maxDate=moment().format("YYYY-MM-DD"),e.openUserDetailModal=function(){e.user&&(e.user.gender="Male",e.user.birth_date=""),openModal("#addUserDetailModal")},e.addUserDetail=function(){t.addUserDetail().then(function(a){t.getUserDetail().then(function(t){if(0==Object.keys(t).length)e.openUserDetailModal();else{e.user.age=calculateAge(new Date(t[0].birth_date)),e.user.gender=t[0].gender,e.user.birth_date=t[0].birth_date;try{window.localStorage.user=JSON.stringify(e.user)}catch(e){}}}),closeModal("#addUserDetailModal")})},e.whyThisInfoDialog=function(){a.getDialog("whyUserData")},e.user&&(e.user.birth_date&&e.user.gender||e.openUserDetailModal())}}}]),function(){"use strict";function e(e,t,a){function n(e,t){"#"!=e.charAt(0)&&("red"==e?e="#ff0000":"black"==e?e="#000000":"grey"==e||"gray"==e?e="#808080":"lightgrey"==e||"lightgray"==e?e="#d3d3d3":"darkgrey"==e||"darkgray"==e?e="#a9a9a9":"green"==e?e="#008000":"brown"==e?e="#a52a2a":"blue"==e?e="#0000ff":"white"==e?e="#ffffff":console.log("Dont know what color is ",e));var a=parseInt(e.slice(1),16),n=t<0?0:255,s=t<0?-1*t:t,o=a>>16,i=a>>8&255,r=255&a;return"#"+(16777216+65536*(Math.round((n-o)*s)+o)+256*(Math.round((n-i)*s)+i)+(Math.round((n-r)*s)+r)).toString(16).slice(1)}function s(e){var t,a,n,s,i,r,l,c,d;return c=e.match(/hsla?\((.+?)\)/)[1].split(",").map(function(e){return e.trim(),parseFloat(e)}),n=c[0],d=c[1],s=c[2],c[3],n/=360,d/=100,s/=100,0===d?l=a=t=s:(r=s<.5?s*(1+d):s+d-s*d,i=2*s-r,l=o(i,r,n+1/3),a=o(i,r,n),t=o(i,r,n-1/3)),"#"+Math.round(255*l).toString(16)+Math.round(255*a).toString(16)+Math.round(255*t).toString(16)}function o(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}function i(e){var t="",a="";return e.tags.indexOf("food")>-1?(t="brown",a="#f8f8ff"):e.tags.indexOf("lifestyle")>-1?(t="#008080",a="#f8f8ff"):e.tags.indexOf("social")>-1?(t="#4682b4",a="#f8f8ff"):e.tags.indexOf("city")>-1?(t="gray",a="#f8f8ff"):e.tags.indexOf("neighborhood")>-1?(t="gray",a="#f8f8ff"):e.tags.indexOf("politics")>-1?(t="#595959",a="#f8f8ff"):e.tags.indexOf("sports")>-1?(t="#4682b4",a="#f8f8ff"):e.tags.indexOf("beauty")>-1?(t="#a3297a",a="#f8f8ff"):e.tags.indexOf("health")>-1?(t="green",a="#f8f8ff"):e.tags.indexOf("services")>-1?(t="#c68c53",a="#f8f8ff"):e.tags.indexOf("technology")>-1?(t="gray",a="#f8f8ff"):e.tags.indexOf("dating")>-1?(t="#b22222",a="#f8f8ff"):e.tags.indexOf("personalities")>-1?(t="#c68c53",a="#f8f8ff"):(t="gray",a="#f8f8ff"),[t,a]}return{shadeColor:n,hsl2rgb:s,hue2rgb:o,defaultRankColor:i}}angular.module("app").factory("color",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return i=e.data.resource}if(s()&&!a)return t.when(i);var l=r;return e.get(l).then(n,o)}function s(){return i.length>0}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/cities";return{getCities:n}}angular.module("app").factory("city",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("citySelectionModal",["$rootScope",function(e){"use strict";return{restrict:"E",templateUrl:"app/layout/Partials/city-selection.html",link:function(t,a,n,s){e.selectedCity=JSON.parse(window.localStorage.selectedCity)}}}]),function(){"use strict";function e(e,t){function a(){"rankSummary"==t.previousState?e.go("rankSummary",{index:t.cCategory.id}):"answerDetail"==t.previousState?e.go("answerDetail",{index:t.canswer.id}):"addAnswer"==t.previousState?e.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?e.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?e.go("about"):e.go("cwrapper")}var n=this;n.title="privacypolicy",n.goBack=a,function(){console.log("privacypolicy page Loaded!")}()}angular.module("app").controller("privacypolicy",e),e.$inject=["$state","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g){function u(){s.go("mybusiness"),$(".navbar-collapse").collapse("hide")}function m(){s.go("favs")}function p(){s.go("promoterconsole"),$(".navbar-collapse").collapse("hide")}function v(){s.go("about")}function h(){s.go("fileuploadtest")}function f(){s.go("admin")}function b(){a.fbmode=!0,s.go("cwrapper",{},{reload:!0})}function y(){c.tour(),$(".navbar-collapse").collapse("hide")}function w(){a.fbmode=!1,a.searchActive=!1,a.hidelogo=!1,a.inputVal="","cwrapper"!=s.current.name?s.go("cwrapper",{main:!0}):a.$emit("mainView")}function k(){s.go("customer")}function x(){a.stateName=s.current.name,"rankSummary"==a.stateName?a.stateNum=a.cCategory.id:"answerDetail"==a.stateName?a.stateNum=a.canswer.id:a.stateNum=void 0,s.go("login")}function D(){n.logout().then(function(){_.user="",_.isLoggedIn=!1,_.hasBusiness=!1,_.isPromoter=!1,localStorage.clear(),s.go("cwrapper",{},{location:"replace"})})}function C(){openModal("#selectCityModal")}function S(e){a.DEBUG_MODE&&console.log("position.coords.latitude - ",e.coords.latitude),a.DEBUG_MODE&&console.log("position.coords.longitude - ",e.coords.longitude),a.currentUserLatitude=e.coords.latitude,a.currentUserLongitude=e.coords.longitude,i.put("currentUserLatitude",a.currentUserLatitude),i.put("currentUserLongitude",a.currentUserLongitude),a.coordsRdy=!0,A(),a.loadFbnWhenCoordsRdy&&s.go("rankSummary",{index:9521}),a.isLoggedIn&&(a.user.latitude=a.currentUserLatitude,a.user.longitude=a.currentUserLongitude,a.DEBUG_MODE&&console.log("Geo Location is set for logged in user.")),a.DEBUG_MODE&&console.log("Geo Location is set for user."),"rankSummary"==s.current.name&&s.reload()}function O(){a.DEBUG_MODE&&console.log("@autoDetectCity"),geolocator.locate(T,function(e,t){e?(a.DEBUG_MODE&&console.log("Error getting geolocation - ERROR("+e.code+"): "+e.message),c.getDialog("errorGettingGeolocation")):(a.DEBUG_MODE&&console.log(t),S(t))})}function E(){geolocator.config({language:"en",google:{version:"3",key:l}}),T={enableHighAccuracy:!0,timeout:1e4,maximumWait:1e4,maximumAge:0,desiredAccuracy:30,fallbackToIP:!0}}function P(){_.warning=!0}function R(){_.warning=!1}function A(){_.coordsRdy=!0}function M(){var e=a.answers.map(function(e){return e.id}).indexOf(a.useraccnts[0].answer);c.askEmail(a.answers[e].name)}function I(){c.askPermissionToLocate()}var _=this;_.title="navbar",_.user=a.user,_.isLoggedIn=!!a.isLoggedIn&&a.isLoggedIn,_.logout=D,_.goToLogin=x,_.gotoAbout=v,_.gotomybusiness=u,_.gotofavs=m,_.gotoFeedback=b,_.gotoTour=y,_.gotoHome=w,_.gotoAdmin=f,_.goPromoterConsole=p,_.gotoFileUpload=h,_.gotoCustomer=k,_.openCitySelection=C,_.goWarning=M,_.goCoords=I,void 0==a.coordsRdy&&(a.coordsRdy=!1),a.loadFbnWhenCoordsRdy=!1;var T={};_.warning=!1,a.$on("getLocation",function(e){O()}),a.$on("coordsRdy",function(e){A()}),a.$on("showWarning",function(e){a.DEBUG_MODE&&console.log("rx showWarning"),P()}),a.$on("hideWarning",function(e){a.DEBUG_MODE&&console.log("rx clearWarning"),R()}),a.$on("useAddress",function(e,t){var n={};n.location=t.address,n.lat=0,n.lng=0,a.coordForUSer=!0,d.getLocationGPS(n)}),a.$on("userDataLoaded",function(e){a.isLoggedIn?(_.isPromoter=!0,a.isPromoter=!0,a.DEBUG_MODE&&console.log("User is promoter")):(a.isPromoter=!1,_.isPromoter=!1)}),a.$on("userAccountsLoaded",function(e){a.isLoggedIn&&a.useraccnts.length>0?(_.hasBusiness=!0,a.hasBusiness=!0,a.DEBUG_MODE&&console.log("User has business")):(a.hasBusiness=!1,_.hasBusiness=!1)}),function(){void 0==a.hasBusiness?_.hasBusiness=!1:_.hasBusiness=a.hasBusiness,void 0==a.isPromoter?_.isPromoter=!1:_.isPromoter=a.isPromoter,a.showWarning&&P(),E(),_.coordsRdy=a.coordsRdy,a.DEBUG_MODE&&console.log("Navbar Loaded!")}(),a.getCurrentPositionOfUser=function(){geolocator.locate(T,function(e,t){e?(a.DEBUG_MODE&&console.log("Error getting geolocation - ERROR("+e.code+"): "+e.message),c.getDialog("errorGettingGeolocation")):(a.DEBUG_MODE&&console.log(t),S(t))})}}angular.module("app").controller("navbar",e),e.$inject=["$location","$translate","$rootScope","login","$state","city","$cookies","$http","GOOGLE_API_KEY","dialog","getgps","useraccnt"]}(),function(){"use strict";function e(e,t,a,n,s,o,i){function r(e,t){i.showAllFriendsListDlg(e,t)}function l(){for(var e=0;e<t.headlines.length;e++)if("food"==t.headlines[e].type){f.bgc1=t.headlines[e].bc,f.fc1=t.headlines[e].fc,f.headline1=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("lifestyle"==t.headlines[e].type){f.bgc2=t.headlines[e].bc,f.fc2=t.headlines[e].fc,f.headline2=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("services"==t.headlines[e].type){f.bgc3=t.headlines[e].bc,f.fc3=t.headlines[e].fc,f.headline3=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("health"==t.headlines[e].type){f.bgc4=t.headlines[e].bc,f.fc4=t.headlines[e].fc,f.headline4=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("beauty"==t.headlines[e].type){f.bgc5=t.headlines[e].bc,f.fc5=t.headlines[e].fc,f.headline5=t.headlines[e].title;break}}function c(){var e={},a={};f.foodans=[],f.lifestyleans=[],f.servicesans=[],f.healthans=[],f.beautyans=[];for(var n=0;n<t.friends_votes.length;n++)if(1==t.friends_votes[n].vote){var s=t.answers.map(function(e){return e.id}).indexOf(t.friends_votes[n].answer);if(e=t.answers[s],"Establishment"==e.type)for(var o=0;o<t.catansrecs.length;o++)if(t.catansrecs[o].answer==e.id){var i=t.content.map(function(e){return e.id}).indexOf(t.catansrecs[o].category);a=t.content[i],(a.title.indexOf("food")>-1||a.tags.indexOf("food")>-1)&&u(f.foodans,e,n),(a.title.indexOf("lifestyle")>-1||a.tags.indexOf("lifestyle")>-1)&&u(f.lifestyleans,e,n),(a.title.indexOf("services")>-1||a.tags.indexOf("services")>-1)&&u(f.servicesans,e,n),(a.title.indexOf("health")>-1||a.tags.indexOf("health")>-1)&&u(f.healthans,e,n),(a.title.indexOf("beauty")>-1||a.tags.indexOf("beauty")>-1)&&u(f.beautyans,e,n)}}f.foodans.length>5&&(f.cb1gt5=!0),f.lifestyleans.length>5&&(f.cb2gt5=!0),f.servicesans.length>5&&(f.cb3gt5=!0),f.healthans.length>5&&(f.cb4gt5=!0),f.beautyans.length>5&&(f.cb5gt5=!0),f.foodans.length>0?f.answerExist1=!0:f.answerExist1=!1,f.lifestyleans.length>0?f.answerExist2=!0:f.answerExist2=!1,f.servicesans.length>0?f.answerExist3=!0:f.answerExist3=!1,f.healthans.length>0?f.answerExist4=!0:f.answerExist4=!1,f.beautyans.length>0?f.answerExist5=!0:f.answerExist5=!1,0==f.foodans.length&&0==f.servicesans.length&&0==f.lifestyleans.length&&0==f.healthans.length&&0==f.beautyans.length&&(f.noAns=!0)}function d(e){for(var a=0;a<t.specials.length;a++)if(e.id==t.specials[a].answer&&"weekly"==t.specials[a].freq&&(0==y&&t.specials[a].sun&&(w=!0),1==y&&t.specials[a].mon&&(w=!0),2==y&&t.specials[a].tue&&(w=!0),3==y&&t.specials[a].wed&&(w=!0),4==y&&t.specials[a].thu&&(w=!0),5==y&&t.specials[a].fri&&(w=!0),6==y&&t.specials[a].sat&&(w=!0),w)){e.sp_bc=t.specials[a].bc,e.sp_fc=t.specials[a].fc,e.sp_title=t.specials[a].stitle;break}}function g(e,a){for(var n=0;n<t.user.friends.data.length;n++)if(a.user==t.user.friends.data[n].id)return t.user.friends.data[n]}function u(e,a,n){var s=e.map(function(e){return e.id});if(-1==s.indexOf(a.id)){var o=angular.copy(a);d(o),o.trackID=o.id+""+t.friends_votes[n].id,o.userObjs=[];var i=g(o,t.friends_votes[n]);o.userObjs.push(i),e.push(o)}else{var o=e[s.indexOf(a.id)],i=g(o,t.friends_votes[n]);m(o,i)}}function m(e,t){-1==e.userObjs.map(function(e){return e.id}).indexOf(t.id)&&e.userObjs.push(t)}function p(e,n){switch(t.myfavs={},e){case 1:t.canswers=f.foodans,t.myfavs.title="My Food";break;case 2:t.canswers=f.lifestyleans,t.myfavs.title="My Lifestyle";break;case 3:t.canswers=f.servicesans,t.myfavs.title="My Services";break;case 4:t.canswers=f.healthans,t.myfavs.title="My Health";break;case 5:t.canswers=f.beautyans,t.myfavs.title="My Beauty"}a.go("answerDetail",{index:n.slug})}function v(e){1==e&&(5==f.maxRes1?(f.btext1="See less",f.maxRes1=100):(f.btext1="See more",f.maxRes1=5)),2==e&&(5==f.maxRes2?(f.btext2="See less",f.maxRes2=100):(f.btext2="See more",f.maxRes2=5)),3==e&&(5==f.maxRes3?(f.btext3="See less",f.maxRes3=100):(f.btext3="See more",f.maxRes3=5)),4==e&&(5==f.maxRes4?(f.btext4="See less",f.maxRes4=100):(f.btext4="See more",f.maxRes4=5)),5==e&&(5==f.maxRes5?(f.btext5="See less",f.maxRes5=100):(f.btext5="See more",f.maxRes5=5))}function h(){"rankSummary"==t.previousState?a.go("rankSummary",{index:t.cCategory.slug}):a.go("cwrapper")}var f=this;f.title="myfriends",f.goBack=h,f.answerDetail=p,f.seeMore=v,f.showAllFriendsList=r,o.$parent.$parent.$parent.seo={pageTitle:"My Friends' Favourite",metaDescription:"RankX lets you see your friends' favorite food, lifestyle, health, beauty and services."};var b=new Date,y=b.getDay(),w=!1;f.noAns=!1,f.friendsDataLoading=!0,f.maxRes1=5,f.btext1="See more",f.maxRes2=5,f.btext2="See more",f.maxRes3=5,f.btext3="See more",f.maxRes4=5,f.btext4="See more",f.maxRes5=5,f.btext5="See more",f.cb1gt5=!1,f.cb2gt5=!1,f.cb3gt5=!1,f.cb4gt5=!1,f.cb5gt5=!1,function(){l(),t.friendsVotes?c():s.loadVotesByMyFriends().then(function(e){t.friends_votes=e,c()})}()}angular.module("app").controller("myfriends",e),e.$inject=["$location","$rootScope","$state","$window","votes","$scope","dialog"]}(),function(){"use strict";function e(e,t,a,n){function s(){for(var e=0;e<t.headlines.length;e++)if("food"==t.headlines[e].type){d.bgc1=t.headlines[e].bc,d.fc1=t.headlines[e].fc,d.headline1="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("lifestyle"==t.headlines[e].type){d.bgc2=t.headlines[e].bc,d.fc2=t.headlines[e].fc,d.headline2="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("services"==t.headlines[e].type){d.bgc3=t.headlines[e].bc,d.fc3=t.headlines[e].fc,d.headline3="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("health"==t.headlines[e].type){d.bgc4=t.headlines[e].bc,d.fc4=t.headlines[e].fc,d.headline4="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("beauty"==t.headlines[e].type){d.bgc5=t.headlines[e].bc,d.fc5=t.headlines[e].fc,d.headline5="My "+t.headlines[e].title;break}}function o(){var e={},a={};d.myfoodans=[],d.mylifestyleans=[],d.myservicesans=[],d.myhealthans=[],d.mybeautyans=[];for(var n=[],s=0;s<t.cvotes.length;s++)if(1==t.cvotes[s].vote){var o=t.answers.map(function(e){return e.id}).indexOf(t.cvotes[s].answer);if(e=t.answers[o],"Establishment"==e.type)for(var r=0;r<t.catansrecs.length;r++)if(t.catansrecs[r].answer==e.id){var l=t.content.map(function(e){return e.id}).indexOf(t.catansrecs[r].category);a=t.content[l],(a.title.indexOf("food")>-1||a.tags.indexOf("food")>-1)&&(n=d.myfoodans.map(function(e){return e.id}),n.indexOf(e.id)<0&&(i(e),d.myfoodans.push(e))),(a.title.indexOf("lifestyle")>-1||a.tags.indexOf("lifestyle")>-1)&&(n=d.mylifestyleans.map(function(e){return e.id}),n.indexOf(e.id)<0&&(i(e),d.mylifestyleans.push(e))),(a.title.indexOf("services")>-1||a.tags.indexOf("services")>-1)&&(n=d.myservicesans.map(function(e){return e.id}),n.indexOf(e.id)<0&&(i(e),d.myservicesans.push(e))),(a.title.indexOf("health")>-1||a.tags.indexOf("health")>-1)&&(n=d.myhealthans.map(function(e){return e.id}),n.indexOf(e.id)<0&&(i(e),d.myhealthans.push(e))),(a.title.indexOf("beauty")>-1||a.tags.indexOf("beauty")>-1)&&(n=d.mybeautyans.map(function(e){return e.id}),n.indexOf(e.id)<0&&(i(e),d.mybeautyans.push(e)))}}d.myfoodans.length>5&&(d.cb1gt5=!0),d.mylifestyleans.length>5&&(d.cb2gt5=!0),d.myservicesans.length>5&&(d.cb3gt5=!0),d.myhealthans.length>5&&(d.cb4gt5=!0),d.mybeautyans.length>5&&(d.cb5gt5=!0),d.myfoodans.length>0?d.answerExist1=!0:d.answerExist1=!1,d.mylifestyleans.length>0?d.answerExist2=!0:d.answerExist2=!1,d.myservicesans.length>0?d.answerExist3=!0:d.answerExist3=!1,d.myhealthans.length>0?d.answerExist4=!0:d.answerExist4=!1,d.mybeautyans.length>0?d.answerExist5=!0:d.answerExist5=!1,0==d.myfoodans.length&&0==d.myservicesans.length&&0==d.mylifestyleans.length&&0==d.myhealthans.length&&0==d.mybeautyans.length&&(d.noAns=!0)}function i(e){for(var a=0;a<t.specials.length;a++)if(e.id==t.specials[a].answer&&"weekly"==t.specials[a].freq&&(0==u&&t.specials[a].sun&&(m=!0),1==u&&t.specials[a].mon&&(m=!0),2==u&&t.specials[a].tue&&(m=!0),3==u&&t.specials[a].wed&&(m=!0),4==u&&t.specials[a].thu&&(m=!0),5==u&&t.specials[a].fri&&(m=!0),6==u&&t.specials[a].sat&&(m=!0),m)){e.sp_bc=t.specials[a].bc,e.sp_fc=t.specials[a].fc,e.sp_title=t.specials[a].stitle;break}}function r(e,n){switch(t.myfavs={},e){case 1:t.canswers=d.myfoodans,t.myfavs.title="My Food";break;case 2:t.canswers=d.mylifestyleans,t.myfavs.title="My Lifestyle";break;case 3:t.canswers=d.myservicesans,t.myfavs.title="My Services";break;case 4:t.canswers=d.myhealthans,t.myfavs.title="My Health";break;case 5:t.canswers=d.mybeautyans,t.myfavs.title="My Beauty"}a.go("answerDetail",{index:n.id})}function l(e){1==e&&(5==d.maxRes1?(d.btext1="See less",d.maxRes1=100):(d.btext1="See more",d.maxRes1=5)),2==e&&(5==d.maxRes2?(d.btext2="See less",d.maxRes2=100):(d.btext2="See more",d.maxRes2=5)),3==e&&(5==d.maxRes3?(d.btext3="See less",d.maxRes3=100):(d.btext3="See more",d.maxRes3=5)),4==e&&(5==d.maxRes4?(d.btext4="See less",d.maxRes4=100):(d.btext4="See more",d.maxRes4=5)),5==e&&(5==d.maxRes5?(d.btext5="See less",d.maxRes5=100):(d.btext5="See more",d.maxRes5=5))}function c(){"rankSummary"==t.previousState?a.go("rankSummary",{index:t.cCategory.slug}):a.go("cwrapper")}var d=this;d.title="myfavs",d.goBack=c,d.answerDetail=r,d.seeMore=l;var g=new Date,u=g.getDay(),m=!1;d.noAns=!1,d.maxRes1=5,d.btext1="See more",d.maxRes2=5,d.btext2="See more",d.maxRes3=5,d.btext3="See more",d.maxRes4=5,d.btext4="See more",d.maxRes5=5,d.btext5="See more",d.cb1gt5=!1,d.cb2gt5=!1,d.cb3gt5=!1,
d.cb4gt5=!1,d.cb5gt5=!1,function(){t.inFavMode=!0,s(),o(),console.log("myfavs page Loaded!")}()}angular.module("app").controller("myfavs",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c){function d(){a.go("mybusiness",{},{reload:!0})}function g(){L.mybizs=[];for(var e=!1,a={},n=0;n<t.answers.length;n++)if(t.answers[n].owner==t.user.id){e=!1,a={},a=t.answers[n];for(var o=0;o<t.useraccnts.length;o++)if(t.useraccnts[o].answer==t.answers[n].id){e=!0,a.status=t.useraccnts[o].status,a.bizcat=t.useraccnts[o].bizcat,a.email=t.useraccnts[o].email,a.accountid=t.useraccnts[o].id,a.stripeid=t.useraccnts[o].stripeid,a.lastPaymentMade=t.useraccnts[o].lastPaymentMade,a.nextPaymentDue=t.useraccnts[o].nextPaymentDue,a.monthlyCost=t.useraccnts[o].monthlyCost,a.isPremium=t.useraccnts[o].ispremium,a.hasRanks=t.useraccnts[o].hasranks,a.ranksQty=t.useraccnts[o].ranksqty,a.stripesub=t.useraccnts[o].stripesub,a.stripesipremium=t.useraccnts[o].stripesipremium,a.stripesiranks=t.useraccnts[o].stripesiranks,a.user=t.useraccnts[o].user,a.firstname=t.user.first_name,a.lastname=t.user.last_name,a.promocode=t.useraccnts[o].promocode,a.isPremium?(a.status="Premium",a.style="background-color:#009900"):(a.status="Basic",a.style="background-color:#bfbfbf"),a.hasRanks?(a.status2=a.ranksQty+" Custom Ranks",a.style2="background-color:#009900"):(a.status2="No Custom Ranks",a.style2="background-color:#bfbfbf");for(var i=0;i<t.codeprices.length;i++)if(t.codeprices[i].code==a.bizcat){a.price=t.codeprices[i].price;break}break}e||s.adduseraccnt(t.answers[n]),a.loadingInvoices=!0,a.invoices=[],f(a),h(a),L.mybizs.push(a)}0==L.mybizs.length&&(L.noAns=!0)}function u(){L.showInvoices=!L.showInvoices}function m(){L.showInvoices=!1}function p(){L.showPaymentInfo=!L.showPaymentInfo}function v(e){return format(e.getMonth()+1)+"/"+format(e.getDate())+"/"+format(e.getFullYear())}function h(e){e.promocode?l.getbyCode(e.promocode).then(function(t){t.length>=1&&(e.promoterObj=t[0])}):e.promoterObj=void 0}function f(e){-1===[void 0,"","0"].indexOf(e.stripeid)&&s.getuseraccntInvoicesAndCustomer(e.stripeid).then(function(t){var a=angular.copy(t.invoices);e.invoices=a.data.map(function(e){return e.period_end=new Date(1e3*e.period_end),e.date=moment(1e3*e.date).format("YYYY-MM-DD"),e.period_start=new Date(1e3*e.period_start),e.discount?Date.now()>1e3*e.discount.end?e.discountMsg="Trial Ended":e.discountMsg="Trial "+Math.ceil(moment.duration(1e3*e.discount.end-Date.now()).asDays())+" Days left":e.discountMsg="No Discount",e}),e.customer=t.customer,e.loadingInvoices=!1}).catch(function(t){e.invoices=[],console.log("Error getting Stripe Invoices - ",t)})}function b(e){a.go("answerDetail",{index:e.slug})}function y(e){L.showInvoices=!1,L.showPaymentInfo=!1,L.codeMsg="Enter a code and validate it using the 'Check code' button",L.promocode="",L.business=e,L.getRanks=!1,L.getPremium=!1,L.ranksQty=1,L.overview=!1,L.manageview=!0,e.isPremium&&e.hasRanks?L.sell=!1:L.sell=!0,console.log("vm.business",e)}function w(){return 1==L.manageview?(L.overview=!0,L.manageview=!1,void(L.checkout=!1)):1==L.checkout?(L.manageview=!0,L.checkout=!1,void(L.overview=!1)):void("rankSummary"==t.previousState?a.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?a.go("answerDetail",{index:t.canswer.slug}):"addAnswer"==t.previousState?a.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?a.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?a.go("about"):a.go("cwrapper"))}function k(e){o.unbindAccount(L.business,x)}function x(){i.updateAnswer(L.business.id,["owner"],[0]),s.deleteAccount(L.business.stripeid).then(function(e){L.mybizs=[],g(),L.overview=!0,L.manageview=!1}).catch(function(e){console.log(e)})}function D(){L.ranksQty=L.ranksQty+1}function C(){L.ranksQty=L.ranksQty-1,L.ranksQty<1&&(L.ranksQty=1)}function S(){8==L.promocode.length?(L.codeMsg="Validating code ...",l.getbyCode(L.promocode).then(function(e){console.log("code exists - ",e.length,e),e.length>0?(L.codeOk=!0,L.codeMsg="This code gets you 60 days free on all your subscriptions!"):(L.codeOk=!1,L.codeMsg="Sorry, this is not a valid code.")})):(L.codeOk=!1,L.codeMsg="Sorry, this is not a valid code.")}function O(){L.acceptTOS=!1,0==L.contactInfoOk?o.getDialog("contactInfoIncomplete"):0==L.getRanks&&0==L.getPremium?o.getDialog("nothingSelectedForPurchase"):(L.total=L.getRanks*L.ranksQty*35+L.getPremium*L.business.price,L.manageview=!1,L.checkout=!0,$("purchase"))}function E(){L.business.hasRanks?(A=!1,E=!0,B=!1,U=0,o.confirmCancel(L.business,"Premium",P)):(A=!0,E=!1,B=!1,U=0,o.confirmCancel(L.business,"Premium",P))}function P(){var e=c+"StripeServer/cancel",t={method:"POST",url:e,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{cancelAll:A,cancelPremium:E,cancelRanks:B,cancelNumRanks:U,stripeId:L.business.stripeid,useraccntId:L.business.accountid,stripesub:L.business.stripesub,stripesipremium:L.business.stripesipremium,stripesiranks:L.business.stripesiranks}};r(t).then(function(e){console.log("Cancelling Premium Membership Success",e)},function(e){console.log("Error Cancelling Premium Membership - ",e)}),$("cancel")}function R(){L.business.isPremium?(A=!1,E=!1,B=!0,U=0,o.confirmCancel(L.business,"Ranks",P)):(A=!0,E=!1,B=!1,U=0,o.confirmCancel(L.business,"Ranks",P))}function A(){A=!0,E=!1,B=!1,U=0,o.confirmCancel(L.business,"All",P)}function M(){o.editNumRanks(L.business,I)}function I(e,t){if("cancel"==e&&t==L.business.ranksQty)R();else{var a=0;"purchase"==e&&(a=L.business.ranksQty+t),"cancel"==e&&(a=L.business.ranksQty-t);var n=c+"StripeServer/edit",s={method:"POST",url:n,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{action:e,numRanks:a,stripeId:L.business.stripeid,useraccntId:L.business.accountid,stripesub:L.business.stripesub,stripesiranks:L.business.stripesiranks}};r(s).then(function(e){console.log("Updating Quantity of Custom Ranks Success",e)},function(e){console.log("Error Updating Quantity of Custom Ranks - ",e)}),$("edit",a)}console.log("Execute Edit Num Ranks")}function $(e,a){setTimeout(function(){function n(e){return console.log(JSON.stringify(e)),e}function o(n){var s=!0;console.log("i'm in, will check every 3 seconds for signup success"),console.log("full result:"),console.log(n);var o=!1;try{if("purchase"==e&&(L.getPremium&&n[0].ispremium&&!L.getRanks||!L.getPremium&&L.getRanks&&n[0].hasranks&&L.ranksQty==n[0].ranksqty||L.getPremium&&n[0].ispremium&&L.getRanks&&n[0].hasranks&&L.ranksQty==n[0].ranksqty)&&(o=!0),"cancel"==e&&(E&&!n[0].ispremium&&""==n[0].stripesipremium||B&&!n[0].hasranks&&""==n[0].stripesiranks||A&&""==n[0].stripesub)&&(o=!0),"edit"==e&&n[0].ranksqty==a&&(o=!0),o){var i=t.useraccnts.map(function(e){return e.id}).indexOf(n[0].id);return t.useraccnts[i]=n[0],g(),console.log(L.mybiz),L.overview=!0,L.manageview=!1,L.checkout=!1,!0}console.log("havent accomplished mission yet")}catch(e){return console.log("error while looking up subscription info from DF: "+JSON.stringify(e)),s=!1,e}1==s&&(L.checkout||L.manage)&&$(e)}console.log("loopCheck -- ",e),s.getuseraccntans(L.business.id).then(o,n)},3e3)}function _(){N=["name","email"],V=["Name","Email"],F=[L.business.firstname+" "+L.business.lastname,L.business.email],o.editInfo(N,V,F,T)}function T(e){s.updateuseraccnt(L.business.accountid,N,e).then(function(){g()})}if(-1!==n.location.href.indexOf("cardUpdate")){"success"==n.location.href.slice(n.location.href.indexOf("cardUpdate")).split("=")[1].split("&")[0]?n.alert("Successfully changed card details."):n.alert(n.location.href.slice(n.location.href.indexOf("messgage")).split("=")[1].split("&")[0])}var L=this;L.title="mybusiness",L.overview=!0,L.manageview=!1,L.codeOk=!1,L.getRanks=!1,L.getPremium=!1,L.dataReady=!1,L.showInvoices=!1,L.showPaymentInfo=!1,L.SERVER_URL=c,L.gotoanswer=b,L.gotomanage=y,L.goCheckout=O,L.unbind=k,L.goBack=w,L.ranksQty=1,L.plusQty=D,L.minusQty=C,L.checkcode=S,L.cancelPremium=E,L.cancelAllRanks=R,L.editRanks=M,L.cancelAll=A,L.editContact=_,L.showInvoicsClicked=u,L.showPaymentInfoEditClicked=p,L.changeCardNumber=d,L.GetFormattedDate=v,L.hideInvoices=m,L.mybizs=[],function(){s.getuseraccnt().then(function(e){t.useraccnts=e,L.dataReady=!0,g()}),console.log("mybusiness page Loaded!")}(),L.noAns=!1;var A=!1,E=!1,B=!1,U=0,N=[],V=[],F=[]}angular.module("app").controller("mybusiness",e),e.$inject=["$location","$rootScope","$state","$window","useraccnt","dialog","answer","$http","promoter","SERVER_URL"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m,p,v,h,f,b,y,w,k,x,D,C,S,O,E,P){function R(){t.neighborhoods=["Downtown","La Jolla","Pacific Beach","Hillcrest","University Heights","Old Town","Del Mar","Ocean Beach","North Park","Mission Hills","Barrio Logan","City Heights","Clairemont","La Mesa","Point Loma","South Park","Scripps Ranch","Mission Beach","Mission Valley","Kensington","Cardiff by the Sea","Coronado","Leucadia","Oceanside","National City","Rancho Santa Fe","Solana Beach","Poway","El Cajon","Escondido","Carlsbad","San Ysidro","Otay Mesa","Linda Vista","Chula Vista","Encinitas","Golden Hills","Spring Valley","Rancho San Diego","Mira Mesa","Torrey Pines","Carmel Valley","Miramar","Kearny Mesa","Rancho Penasquitos","Sorrento Valley","Tierra Santa","Logan Heights","Serra Mesa","Normal Heights","Talmadge","Bird Rock","South San Diego","North City","San Carlos","Del Cerro","Grantville"],t.districts=["Columbia","Core","Cortez Hill","East Village","Gaslamp Quarter","Horton Plaza","Little Italy","Marina","Bankers Hill"],F.nhs=[],F.nhs=F.nhs.concat(t.neighborhoods,t.districts),F.allTopics=["LifeStyle","Social","Sports","Food","Beauty & Fashion","Family","Technology","Dating","City","Services","Health","Celebrities"],F.filterOptions=P.loadFilterOptions(),t.allnh=t.neighborhoods.concat(t.districts),s.get("../../../assets/fields.json").then(function(e){t.typeSchema=e.data}),s.get("../../../assets/dialogs.json").then(function(e){t.dialogs=e.data}),s.get("../../../assets/foodranks.json").then(function(e){t.foodranks=e.data}),P.loadInitalHomeData()||u.getMostPopularData(),O.gethomedata(),O.getallranks(),O.getallcblocks(),O.getrankdata(),O.getanswerdata(),O.getpagevisitdata(),E.getSetting()}function A(){void 0==t.pageDataLoaded&&(t.pageDataLoaded=!1),void 0==t.userDataLoaded&&(t.userDataLoaded=!1),window.location.href.indexOf("rankSummary")>-1?t.dataIsLoaded=t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("answerDetail")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("favs")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("mybusiness")>-1?t.dataIsLoaded=t.answerDetailLoaded:window.location.href.indexOf("promoteconsole")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("home")>-1?t.dataIsLoaded=t.initalHomeDataLoaded:t.dataIsLoaded=t.pageDataLoaded&&t.userDataLoaded,F.isLoading=!t.dataIsLoaded,t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.dataIsLoaded -",t.dataIsLoaded),t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.pageDataLoaded -",t.pageDataLoaded),t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.userDataLoaded -",t.userDataLoaded)}function M(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1}function I(){S.go("privacypolicy")}function $(){S.go("rodconsole")}function _(){t.inputVal=F.val,t.inputVal.length>0?t.searchActive=!0:t.searchActive=!1,F.searchActive=t.searchActive,a.scroll(0,0)}function T(){F.searchActive=!1}function L(){t.fbmode=!1,t.searchActive=!1,F.searchActive=!1,t.hidelogo=!1,t.inputVal="",F.val="","cwrapper"!=S.current.name?S.go("cwrapper",{main:!0}):t.$emit("mainView")}function B(){S.go("addCustomRank")}function U(){t.editMode=!0,F.selEditRank="active",F.selViewRank="",console.log("$rootScope.editMode -- ",t.editMode)}function N(){t.editMode=!1,F.selEditRank="",F.selViewRank="active"}function V(){t.$emit("applyRule")}var F=this;F.title="layout",F.header="",r.$parent.seo={pageTitle:"Home |",metaDescription:"Home | Rank-X creates collective rankings on everything in your city."},F.veilMsg="Just a moment, loading the best information about San Diego",F.hidelogo=!1,F.getResults=_,F.hideSearch=T,F.gotoHome=L,F.goAddRank=B,F.editRank=U,F.viewRank=N,F.applyRule=V,F.goPrivacyPolicy=I,F.goRankofDayConsole=$,F.showFilters=!1,F.toggleFilterBox=function(){F.showFilters=!F.showFilters},F.selectNh=function(e,t){F.filterOptions.isCity=!1,F.filterOptions.isNh=!0},F.selectTopic=function(e){if("All"==e)0==F.filterOptions.isAllTopics?(F.filterOptions.isAllTopics=!0,F.filterOptions.ctopics=F.allTopics):(F.filterOptions.isAllTopics=!1,F.filterOptions.ctopics=[]);else if(-1!==F.filterOptions.ctopics.indexOf(e))F.filterOptions.isAllTopics=!1,F.filterOptions.ctopics.splice(F.filterOptions.ctopics.indexOf(e),1);else{F.filterOptions.ctopics.push(e);var t=F.allTopics.filter(function(e){return-1==F.filterOptions.ctopics.indexOf(e)});0==t.length&&(F.filterOptions.isAllTopics=!0)}},F.switchLocationScope=function(e){"city"==e?(F.filterOptions.isCity=!0,F.filterOptions.isNh=!1):(F.filterOptions.isCity=!1,F.filterOptions.isNh=!0)},F.applyFilters=function(){if(0==F.filterOptions.ctopics.length)return void alert("Please select at least 1 topic.");P.saveFilterOptions(F.filterOptions),t.$emit("filterOptionChanged"),F.showFilters=!F.showFilters},t.$on("refreshRanks",function(){"cwrapper"==S.current.name&&(F.hidelogo=t.hidelogo)}),t.$on("showLogo",function(){"rankSummary"==S.current.name||S.current.name}),t.$on("userDataLoaded",function(){A()}),t.$on("homeDataLoaded",function(){A()}),t.$on("rankDataLoaded",function(){A()}),t.$on("answerDataLoaded",function(){A()}),t.$on("initalHomeDataLoaded",function(){t.initalHomeDataLoaded=!0,A()}),a.innerWidth<512?(F.logoimage="/assets/images/rankxlogosd2_sm.png",t.sm=!0,F.sm=!0):(F.logoimage="/assets/images/rankxlogosd2_sm.png",t.sm=!1,F.sm=!1),t.$on("$stateChangeSuccess",function(e,a,n,s,o){t.previousState=s.name});var G=i.get("tourviewed");void 0==G&&(G=!1),function(){t.isAdmin=!1,F.isAdmin=!1,t.DEBUG_MODE=l,t.EMPTY_IMAGE=c,t.facebookAppId="",t.facebookUrl="https://www.facebook.com/Rank-X-San-Diego-582174448644554",void 0==t.dataIsLoaded&&(F.isLoading=!0,R()),t.isLoggedIn&&(h.loadUserData(),h.loadUserAccount()),t.isFacebookApp=M(),t.DEBUG_MODE&&console.log("Layout Loaded!")}()}angular.module("app").controller("layout",e),e.$inject=["$location","$rootScope","$window","$q","$http","pvisits","$cookies","$scope","DEBUG_MODE","EMPTY_IMAGE","rankofday","answer","table","special","datetime","uaf","userdata","dialog","matchrec","edit","useractivity","vrows","headline","cblock","catans","$state","dataloader","setting","filter"]}(),function(){"use strict";function e(e,t,a,n){}angular.module("app").controller("feeds",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t,a){function n(){a.go("cwrapper")}var s=this;s.title="feedback",s.goBack=n,function(){console.log("feedback page Loaded!")}()}angular.module("app").controller("feedback",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n){}angular.module("app").controller("favs",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m,p,v,h,f){function b(t){_.currentIndex=0,_.startIndex=0,_.loadingCountOneScroll=6,_.scrollingData=[],_.scrollDataLoading=!1,_.content=[],_.endReached=!1,_.scrollingData=[];var a=[],n=[],s="";if(s=e.filterOptions.isCity?" in San Diego":" in "+e.filterOptions.cnh,e.filterOptions.isAllTopics&&e.filterOptions.isCity)n=angular.copy(e.content.filter(function(e){return 1==e.ismp}));else if(e.filterOptions.isAllTopics&&!e.filterOptions.isCity){var o=f.searchRanks(e.filterOptions.cnh);a=a.concat(o)}else for(var i=0;i<e.filterOptions.ctopics.length;i++){var o=f.searchRanks(e.filterOptions.ctopics[i].toLowerCase()+s);a=a.concat(o)}if(k(a),a.forEach(function(e){-1==n.indexOf(e)&&n.push(e)}),n.sort(function(e,t){var a=e.views?e.views:0,n=t.views?t.views:0;return e.id==t.id?0:a<n?1:-1}),t)n.length>=8?(_.initalHomeData=n.splice(0,8),h.saveInitalHomeData(_.initalHomeData)):(_.initalHomeData=n,h.saveInitalHomeData(_.initalHomeData),n=[]),_.uniqueResult=n;else{var r=_.initalHomeData.map(function(e){return e.id});_.uniqueResult=n.filter(function(e){return-1==r.indexOf(e.id)})}for(var i=0;i<_.uniqueResult.length;i++)_.scrollingData.push(i);k(_.scrollingData)}function y(){_.scrollDataLoading=!0,v(function(){_.currentIndex+_.loadingCountOneScroll>_.scrollingData.length-1&&(_.current=_.scrollingData.length,_.endReached=!0),_.currentIndex+=_.loadingCountOneScroll,_.currentIndex-_.startIndex>_.scrollingItemsOnePage&&(_.startIndex=_.currentIndex-_.scrollingItemsOnePage),_.scrollDataLoading=!1},500)}function w(){_.startIndex>=3&&(_.startIndex-=3,_.currentIndex-=3)}function k(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[a],e[a]=t;return e}function x(){1==t.params.main&&R(),e.inFavMode=!1,e.DEBUG_MODE&&console.log("activate cwrapper!"),_.isNh=e.isNh,_.isNh?_.querybc="#428bca":_.querybc="white",_.isNhRdy=e.isNhRdy,_.cnh=e.cnh,_.isNh&&(_.searchScope=_.isNhRdy?e.cnh:"Neighborhood"),_.isCity=e.isCity,_.isCity&&(_.searchScope="all San Diego"),_.nhs=e.neighborhoods.concat(e.districts),_.searchActive=!!e.searchActive&&e.searchActive,e.cCategory=void 0,_.val=e.inputVal,window.prerenderReady=!0}function D(){e.cityranks=["city","lifestyle","food","politics","services","social","beauty","sports","personalities","technology","dating","health"],e.nhranks=["neighborhood","lifestyle","food","services","social","beauty","health"],_.nhs=e.neighborhoods.concat(e.districts)}function C(t){1==t&&(_.isNh=!1,_.isCity=!0,e.isNh=!1,e.isCity=!0,e.$emit("loadNh"),_.searchScope="all San Diego",_.ranks=e.cityranks,_.querybc="white"),2==t&&(_.isNh=!0,_.isCity=!1,e.isNh=!0,e.isCity=!1,_.val="",e.inputVal="",e.searchActive=!1,e.isNhRdy&&e.$emit("loadNh"),_.searchScope="Neighborhood",_.ranks=e.nhranks,_.querybc="#428bca"),_.searchActive=e.searchActive}function S(t){e.cnh=t,_.cnh=t,_.isNhRdy=!0,e.isNhRdy=_.isNhRdy,_.inputVal="",_.searchActive=!1,e.$emit("loadNh"),_.searchScope=t,_.val="",e.inputVal="",$("#nhdropdown").dropdown("toggle")}function O(){e.coordsRdy?t.go("rankSummary",{index:9521}):(e.loadFbnWhenCoordsRdy=!0,r.askPermissionToLocate())}function E(){for(var a=!1,n=0,s=e.content.length-1;!a;)n=Math.floor(Math.random()*(s-0+1))+0,e.content[n].tags.indexOf("isMP")>-1&&(a=!0);t.go("rankSummary",{index:e.content[n].id})}function P(){t.go("rankSummary",{index:6949})}function R(){e.inputVal="",_.val="",C(1),e.fbmode=!1,_.fbm=e.fbmode}function A(e){t.go("answerDetail",{index:e.answer})}function M(e){t.go("rankSummary",{index:e.category})}function I(){console.log("@prepareNewCatansOptions - $rootScope.content.length ",e.content.length),e.ctsOptions=[];for(var t="",a=0;a<e.content.length;a++)e.content[a].title.indexOf("in Hillcrest")>-1&&(t=e.content[a].title.replace("Hillcrest","@neighborhood"),e.ctsOptions.push(t)),e.content[a].tags.indexOf("isMP")>-1&&e.ctsOptions.push(e.content[a].title)}var _=this;s.$parent.$parent.$parent.seo={pageTitle:"Home ",metaDescription:"Home | Rank-X creates collective rankings on everything in your city."};var T={};T.get=function(e,t,a){v(function(){for(var n=[],s=e;s<=e+t-1;s++)n.push("item #"+s);a(n)},100)},_.datasource=T,_.title="cwrapper",_.switchScope=C,void 0==e.hidelogo?_.hidelogo=!1:_.hidelogo=e.hidelogo,_.foodNearMe=O,_.events=P,_.selfimprove=E,_.selnh=S,_.goHome=R,_.gotoAnswer=A,_.gotoRank=M,e.editMode=!1,_.content=[],_.emptyspace="",_.fbm=!!e.fbmode;var L=e.$on("mainView",function(e){"cwrapper"==t.current.name&&R()});_.loadMore=y,_.showLess=w,_.pageDataLoaded=e.pageDataLoaded,_.initalHomeData=e.initalHomeData,_.currentIndex=0,_.startIndex=0,e.sm?(_.scrollingItemsOnePage=6,_.loadingCountOneScroll=3):(_.loadingCountOneScroll=6,_.scrollingItemsOnePage=12),_.scrollingItemsOnePage=1e3,_.scrollingData=[],_.scrollDataLoading=!1,_.content=[],_.endReached=!1,_.scrollingData=[],_.uniqueResult=[],e.pageDataLoaded&&(_.content=e.content,b(!1)),e.$on("filterOptionChanged",function(){_.pageDataLoaded&&b(!0)}),e.$on("homeDataLoaded",function(){_.pageDataLoaded=!0,_.content=e.content,b()}),angular.element(c).bind("scroll",function(){var e=Math.max(angular.element("body")[0].scrollHeight,angular.element("body")[0].offsetHeight,angular.element("html")[0].clientHeight,angular.element("html")[0].scrollHeight,angular.element("html")[0].offsetHeight);$("#inifinite-container").offset().top+600>this.pageYOffset&&this.pageYOffset>$("#inifinite-container").offset().top&&console.log(e,this.pageYOffset),s.$apply()}),s.$on("$destroy",L),window.prerenderReady=!1,e.cwrapperLoaded?x():function(){e.DEBUG_MODE&&console.log("init cwrapper!"),_.isAdmin=e.isAdmin,e.inputVal="",C(1),_.cnh="Select Neighborhood",e.cnh=_.cnh,_.isNhRdy=!1,e.isNhRdy=!1;var t="#595959",a=u.shadeColor(t,.5);_.headerStyle="color:#f8f8ff;width:50%;border-style:none;background:#595959;background: -webkit-linear-gradient(left,#595959,"+a+");background: -o-linear-gradient(right,"+t+","+a+");background: -moz-linear-gradient(right,"+t+", "+a+");background: linear-gradient(to right,"+t+", "+a+");",D(),e.cwrapperLoaded=!0,e.cCategory=void 0,_.searchActive=!!e.searchActive&&e.searchActive,e.isAdmin&&I(),x()}()}angular.module("app").controller("cwrapper",e),e.$inject=["$rootScope","$state","$http","$stateParams","$scope","query","table","dialog","uaf","$window","userdata","$location","color","fbusers","$q","$timeout","filter","search"]}(),function(){"use strict";function e(e,t,a,n,s){function o(){a.go("cwrapper")}var i=this;i.title="about",i.goBack=o,n.innerWidth<512?(i.logoimage="/assets/images/rankxlogo_noheadline.png",i.sm=!0):(i.logoimage="/assets/images/rankxlogo_noheadline.png",i.sm=!1),s.$parent.seo={pageTitle:"About",metaDescription:"Rank-X creates collective rankings on everything in your city."},function(){console.log("About page Loaded!")}()}angular.module("app").controller("about",e),e.$inject=["$location","$rootScope","$state","$window","$scope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return p=e.data.resource}if(c()&&!a)return t.when(p);var s=h;return e.get(s).then(n,u)}function s(a,n){function s(e){return m=e.data}if(g(a)&&!n)return t.when(m);var o=h+"/"+a;return e.get(o).then(s,u)}function o(a,n){function s(e){return v=e.data.resource}if(d()&&!n)return t.when(v);var o=h+"/?filter=answer="+a;return e.get(o).then(s,u)}function i(t){function a(e){var a=t;return a.id=e.data.resource[0].id,p.length>0&&p.push(a),v.length>0&&v.push(a),console.log("result",e),e.data}var n=h,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,u)}function r(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating special succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"answer":r.answer=s[l];break;case"bc":r.bc=s[l];break;case"details":r.details=s[l];break;case"edate":r.edate=s[l];break;case"etime":r.etime=s[l];break;case"etime2":r.etime2=s[l];break;case"fc":r.fc=s[l];break;case"freq":r.freq=s[l];break;case"mon":r.mon=s[l];break;case"tue":r.tue=s[l];break;case"wed":r.wed=s[l];break;case"thu":r.thu=s[l];break;case"fri":r.fri=s[l];break;case"sat":r.sat=s[l];break;case"sun":r.sun=s[l];break;case"name":r.name=s[l];break;case"image":r.image=s[l];break;case"sdate":r.sdate=s[l];break;case"stime":r.stime=s[l];break;case"stime2":r.stime2=s[l];break;case"stitle":r.stitle=s[l]}i.resource.push(r);for(var c=h,d=p.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"answer":p[d].answer=s[l];break;case"bc":p[d].bc=s[l];break;case"details":p[d].details=s[l];break;case"edate":p[d].edate=s[l];break;case"etime":p[d].etime=s[l];break;case"etime2":p[d].etime2=s[l];break;case"fc":p[d].fc=s[l];break;case"freq":p[d].freq=s[l];break;case"mon":p[d].mon=s[l];break;case"tue":p[d].tue=s[l];break;case"wed":p[d].wed=s[l];break;case"thu":p[d].thu=s[l];break;case"fri":p[d].fri=s[l];break;case"sat":p[d].sat=s[l];break;case"sun":p[d].sun=s[l];break;case"name":p[d].name=s[l];break;case"image":p[d].image=s[l];break;case"sdate":p[d].sdate=s[l];break;case"stime":p[d].stime=s[l];break;case"stime2":p[d].stime2=s[l];break;case"stitle":p[d].stitle=s[l]}for(var g=v.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"answer":v[g].answer=s[l];break;case"bc":v[g].bc=s[l];break;case"details":v[g].details=s[l];break;case"edate":v[g].edate=s[l];break;case"etime":v[g].etime=s[l];break;case"etime2":v[g].etime2=s[l];break;case"fc":v[g].fc=s[l];break;case"freq":v[g].freq=s[l];break;case"mon":v[g].mon=s[l];break;case"tue":v[g].tue=s[l];break;case"wed":v[g].wed=s[l];break;case"thu":v[g].thu=s[l];break;case"fri":v[g].fri=s[l];break;case"sat":v[g].sat=s[l];break;case"sun":v[g].sun=s[l];break;case"name":v[g].name=s[l];break;case"image":v[g].image=s[l];break;case"sdate":v[g].sdate=s[l];break;case"stime":v[g].stime=s[l];break;case"stime2":v[g].stime2=s[l];break;case"stitle":v[g].stitle=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,u)}function l(t){function a(e){return console.log("Deleting special was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var o=h+"/"+t;if(p.length>0){var i=p.map(function(e){return e.id}).indexOf(t);i>-1&&p.splice(i,1)}if(v.length>0){var i=v.map(function(e){return e.id}).indexOf(t);i>-1&&v.splice(i,1)}return e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,u)}function c(){return p.length>0}function d(){return v.length>0}function g(e){return m&&m.id==e}function u(e){throw e}var m,p=[],v=[],h="/api/v2/mysql/_table/specials";return{getSpecials:n,getSpecial:s,addSpecial:i,updateSpecial:r,deleteSpecial:l,getSpecialsbyAnswer:o}}angular.module("app").factory("special",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e){function t(e){if("onetime"==e.freq){a(e,"stime"),a(e,"etime");var t=new Date(e.sdate),n=t.toString();e.sdate=n.substring(0,15),t=new Date(e.edate),n=t.toString(),e.edate=n.substring(0,15)}"weekly"==e.freq&&(a(e,"stime2"),a(e,"etime2"))}function a(e,t){var a="";switch(t){case"stime":a=e.stime;break;case"etime":a=e.etime;break;case"stime2":a=e.stime2;break;case"etime2":a=e.etime2}if(null!=a&&void 0!=a&&(a.indexOf("00:00")>-1||a.indexOf("30:00")>-1)){a=a.replace("00:00","00"),a=a.replace("30:00","30");var n=parseInt(a.substring(0,2))<12;if(a+=n?" AM":" PM",!n){var s=parseInt(a.substring(0,2))-12,o="";o=s<10?"0"+s.toString():s.toString(),a=a.replace(a.substring(0,2),o)}}switch(t){case"stime":e.stime=a;break;case"etime":e.etime=a;break;case"stime2":e.stime2=a;break;case"etime2":e.etime2=a}}function n(e){var t=new Date(e),a=t.getFullYear().toString()+(t.getMonth()+1<10?"0"+(t.getMonth()+1).toString():(t.getMonth()+1).toString())+(t.getDate()<10?"0"+t.getDate().toString():t.getDate().toString());return Number(a)}function s(t){return n(t)-e.dateTodayNum>=0}function o(t,a){var s=0,o=!1,i=0,r=!1;if(void 0!=a.edate&&""!=a.edate&&(s=n(a.edate.slice(4)),o=!0),i=n(a.sdate.slice(4)),o)if(s>=e.dateTodayNum)if(r=!0,i>=e.dateTodayNum)t.date=a.sdate.slice(4);else{var l=new Date(e.dateToday),c=l.toString();t.date=c.substring(0,15).slice(4)}else r=!1,t.date=a.edate.slice(4);else i>=e.dateTodayNum?(r=!0,t.date=a.sdate.slice(4)):(r=!1,t.date=a.sdate.slice(4));return r}return{formatdatetime:t,formatTime:a,date2number:n,dateIsCurrent:s,eventIsCurrent:o}}angular.module("app").service("datetime",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s){function o(){g.specialsList=[];for(var e={},a=0;a<7;a++)e={},a<t.specials.length?(e=t.specials[a],e.used=!0):(e.stitle="Empty",e.used=!1),g.specialsList.push(e)}function i(){t.specialmode="add",a.go("editspecial")}function r(e){t.cspecial=e,t.specialmode="edit",a.go("editspecial")}function l(e){r=e,n.deleteRank(e,c,!0)}function c(){s.deleteSpecial(r.id).then(function(){o()})}function d(){a.go("answerDetail",{index:t.canswer.id})}var g=this;g.title="specials",g.addSpecial=i,g.selSpecial=r,g.deleteSpecial=l,g.goBack=d,g.specialsList=[],g.dataReady=!1;var r={};!function(){s.getSpecialsbyAnswer(t.canswer.id).then(function(e){t.specials=e,g.dataReady=!0,o()}),console.log("Specials Page loaded!")}()}angular.module("app").controller("specials",e),e.$inject=["$location","$rootScope","$state","dialog","special"]}(),function(){"use strict";function e(e,t,a){this.title="photogallery",function(){console.log("photogallery page Loaded!")}()}angular.module("app").controller("photogallery",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a){this.title="mainphoto",function(){console.log("mainphoto page Loaded!")}()}angular.module("app").controller("mainphoto",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){function e(e,t){return e.gnum-t.gnum}if(y.vrows=[],t.cansvrows.length>0){y.vrows=t.cansvrows.sort(e),y.vrows[0].shdr=!0;for(var a=1;a<y.vrows.length;a++)y.vrows[a].gnum==y.vrows[a-1].gnum?y.vrows[a].shdr=!1:y.vrows[a].shdr=!0;y.vrows[y.vrows.length-1].saddr=!0;for(var a=0;a<y.vrows.length-1;a++)y.vrows[a].gnum!=y.vrows[a+1].gnum?y.vrows[a].saddr=!0:y.vrows[a].saddr=!1}}function r(){a.go("answerDetail",{index:t.canswer.id})}function l(e){t.cansvrows=[];for(var a=0;a<t.cvrows.length;a++)t.cvrows[a].answer==e&&t.cansvrows.push(t.cvrows[a]);i()}function c(e){n.addVRow(e,d)}function d(e,a){var n=!1;"-"==e.title&&(n=!0);var o=JSON.parse(JSON.stringify(e));if(o.id=void 0,o.$$hashKey=void 0,o.upV=0,o.downV=0,o.title=a,n){s.updateRec(e.id,["title"],[a]).then(function(){l(t.canswer.id)})}else{s.postRec(o).then(function(){l(t.canswer.id)})}}function g(e){n.deleteVRow(e,u)}function u(e){var a=s.deleteVrow(e.id);o.deleteVrowVotesbyVrow(e.id),a.then(function(){l(t.canswer.id)})}function m(){var e=y.vrows[y.vrows.length-1];n.addVRowGroup(e,p)}function p(e,a){if(y.vrows.length>0){var n=JSON.parse(JSON.stringify(e));n.id=void 0,n.$$hashKey=void 0,n.upV=0,n.downV=0,n.title="-",n.gnum=y.vrows[y.vrows.length-1].gnum+1,n.gtitle=a}else n={},n.answer=t.canswer.id,n.gnum=0,n.gtitle=a,n.title="-",n.upV=0,n.downV=0;s.postRec(n).then(function(){l(t.canswer.id)})}function v(e){n.editVRowGroup(e,h,f)}function h(e,a){var n=!1;if(e.gtitle!=a&&(n=!0),n){for(var o=0;o<t.cansvrows.length;o++)t.cansvrows[o].gnum==e.gnum&&(t.cansvrows[o].gtitle=a,s.updateRec(t.cansvrows[o].id,["gtitle"],[a]));l(t.canswer.id)}}function f(e){n.deleteVRowGroup(e,b)}function b(e){s.deleteVrowByGroup(e.gnum,e.answer).then(function(){console.log("$rootScope.cvrows - ",t.cvrows),l(t.canswer.id)})}var y=this;y.title="editvrows";y.header="Edit Vote Rows for "+t.canswer.name,y.editvrowsList=[],y.vrows=[],y.addVRowDiag=c,y.addVRowGroupDiag=m,y.deleteVRowDiag=g,y.editVRowGroupDiag=v,y.closeRank=r,function(){y.vrows=t.cansvrows,i(),console.log("editvrows Page loaded!")}()}angular.module("app").controller("editvrows",e),e.$inject=["$location","$rootScope","$state","dialog","vrows","vrowvotes"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){p.char=25-p.sp.stitle.length}function r(e){1==e&&(p.weekly=!1,p.onetime=!0,p.sp.freq="onetime"),2==e&&(p.weekly=!0,p.onetime=!1,p.sp.freq="weekly")}function l(){h=p.sp,h.name=t.canswer.name,h.answer=t.canswer.id,h.image=p.imageURL,h.freq=p.onetime?"onetime":"weekly",n.createSpecialPreview(h,c)}function c(){if("onetime"==p.sp.freq&&(h.stime2=null,h.etime2=null),"weekly"==p.sp.freq&&(h.stime=null,h.sdate=null,h.etime=null,h.edate=null),
0==p.isEdit)s.addSpecial(h).then(function(){a.go("specials")});else{var e=[],t=[];console.log("spx, vm.sp",v,p.sp),v.bc!=p.sp.bc&&(e.push("bc"),t.push(p.sp.bc)),v.fc!=p.sp.fc&&(e.push("fc"),t.push(p.sp.fc)),v.edate!=p.sp.edate&&(e.push("edate"),t.push(p.sp.edate)),v.etime!=p.sp.etime&&(e.push("etime"),t.push(p.sp.etime)),v.etime2!=p.sp.etime2&&(e.push("etime2"),t.push(p.sp.etime2)),v.sdate!=p.sp.sdate&&(e.push("sdate"),t.push(p.sp.sdate)),v.stime!=p.sp.stime&&(e.push("stime"),t.push(p.sp.stime)),v.stime2!=p.sp.stime2&&(e.push("stime2"),t.push(p.sp.stime2)),v.stitle!=p.sp.stitle&&(e.push("stitle"),t.push(p.sp.stitle)),v.image!=p.imageURL&&(e.push("image"),t.push(p.imageURL)),v.name!=p.sp.name&&(e.push("name"),t.push(p.sp.name)),v.details!=p.sp.details&&(e.push("details"),t.push(p.sp.details)),v.freq!=p.sp.freq&&(e.push("freq"),t.push(p.sp.freq)),v.mon!=p.sp.mon&&(e.push("mon"),t.push(p.sp.mon)),v.tue!=p.sp.tue&&(e.push("tue"),t.push(p.sp.tue)),v.wed!=p.sp.wed&&(e.push("wed"),t.push(p.sp.wed)),v.thu!=p.sp.thu&&(e.push("thu"),t.push(p.sp.thu)),v.fri!=p.sp.fri&&(e.push("fri"),t.push(p.sp.fri)),v.sat!=p.sp.sat&&(e.push("sat"),t.push(p.sp.sat)),v.sun!=p.sp.sun&&(e.push("sun"),t.push(p.sp.sun)),console.log("fields, vals",e,t),s.updateSpecial(h.id,e,t).then(function(){a.go("specials")})}}function d(){s.deleteSpecial(p.sp.id),a.go("specials")}function g(){a.go("specials")}function u(){p.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"]}function m(){a.go("answerDetail",{index:t.canswer.id})}var p=this;p.title="editspecial",p.sp={};var v={},h={};p.displayCharLength=i,p.frequencySel=r,p.showPreview=l,p.deleteSpecial=d,p.goBack=g,p.closeRank=m,p.header=t.canswer.name,p.isEdit=!1,p.userIsOwner=t.userIsOwner;var f=t.$on("fileUploaded",function(e,t){console.log("Received fileUploaded",t),console.log("$state.current.name - ",a.current.name),"editspecial"==a.current.name&&(console.log("loaded date to vm.imageURL"),p.imageURL=t)});$scope.$on("$destroy",f),function(){"edit"==t.specialmode&&(p.sp=JSON.parse(JSON.stringify(t.cspecial)),v=JSON.parse(JSON.stringify(t.cspecial)),o.formatdatetime(p.sp),p.isEdit=!0,"onetime"==p.sp.freq&&r(1),"weekly"==p.sp.freq&&r(2),p.sp.bc=p.sp.bc,p.sp.fc=p.sp.fc,void 0!=p.sp.image?p.imageURL=p.sp.image:p.imageURL=t.EMPTY_IMAGE),"add"==t.specialmode&&(p.char=25,p.sp.fc="hsl(0, 100%, 0%)",p.sp.bc="hsl(0, 0%, 100%)",r(1),p.imageURL=t.EMPTY_IMAGE),u(),console.log("editspecial page Loaded!")}()}angular.module("app").controller("editspecial",e),e.$inject=["$location","$rootScope","$state","dialog","special","datetime"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){u.answers=t.custans}function r(e){t.cust.canswer=e.id,console.log("current answer ",e.id,e.name)}function l(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("mainphoto")}function c(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("specials")}function d(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("photogallery")}function g(){a.go("content")}var u=this;u.title="customer",u.selMainPhoto="active",u.selSpecials="",u.selPhotoGallery="",u.goBack=g,u.loadMainPhoto=l,u.loadSpecials=c,u.loadPhotoGallery=d,u.selAnswer=r,t.cust={},t.cust.id=1,function(){n.getAnswerbyCustomer(t.cust.id).then(function(e){t.custans=e.resource,console.log("Customer-Answer records: ",t.custans),i()}),console.log("customer page Loaded!")}()}angular.module("app").controller("customer",e),e.$inject=["$location","$rootScope","$state","answer","dialog","special"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){return e.get(f+"?order=views DESC&offset=0&limit=8").then(function(e){a.initalHomeData=e.data.resource,o.saveInitalHomeData(a.initalHomeData),a.$emit("initalHomeDataLoaded")}),!0}function r(n){if(p()&&!n)return t.when(h);var s=f+"?offset=0",o=f+"?offset=1000",i=f+"?offset=2000",r=f+"?offset=3000",l=f+"?offset=4000",c=f+"?offset=5000",d=f+"?offset=6000",g=f+"?offset=7000",u=e.get(s),m=e.get(o),b=e.get(i),y=e.get(r),w=e.get(l),k=e.get(c),x=e.get(d),D=e.get(g);return t.all([u,m,b,y,w,k,x,D]).then(function(e){return h=e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource),a.DEBUG_MODE&&console.log("tables length: ",h.length),h},v)}function l(){var n=f+"/?filter=ismp=true",s=e.get(n);return t.all([s]).then(function(e){return h=e[0].data.resource,a.DEBUG_MODE&&console.log("tables_main length: ",h.length),h},v)}function c(){var n=f+"/?filter=ismp=false&offset=0",s=f+"/?filter=ismp=false&offset=1000",o=f+"/?filter=ismp=false&offset=2000",i=f+"/?filter=ismp=false&offset=3000",r=f+"/?filter=ismp=false&offset=4000",l=f+"/?filter=ismp=false&offset=5000",c=f+"/?filter=ismp=false&offset=6000",d=f+"/?filter=ismp=false&offset=7000",g=e.get(n),u=e.get(s),m=e.get(o),p=e.get(i),b=e.get(r),y=e.get(l),w=e.get(c),k=e.get(d);return t.all([g,u,m,p,b,y,w,k]).then(function(e){return h=h.concat(e[0].data.resource,e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource),a.DEBUG_MODE&&console.log("tables length: ",h.length),h},v)}function d(t){function n(e){var n=t;n.id=e.data.resource[0].id,h.push(n);var s=n.tags+" "+n.title;a.searchStr.push(s);var o=n.title.toLowerCase();o=o.replace(/ /g,"-"),o=o+"-"+e.data.resource[0].id;var i="https://rankx.blob.core.windows.net/sandiego/featuredImages/"+o+".jpg";return m(e.data.resource[0].id,["slug","fimage"],[o,i]),a.DEBUG_MODE&&console.log("result",e),e.data}t.isatomic=!0;var s=f,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(n,v)}function g(t,s,o){function i(e){var i=t;i.id=e.data.resource[0].id,h.push(i);var r=i.tags+" "+i.title;a.searchStr.push(r);var l=i.title.toLowerCase();l=l.replace(/ /g,"-"),l=l+"-"+e.data.resource[0].id;var c="https://rankx.blob.core.windows.net/sandiego/featuredImages/"+l+".jpg";m(e.data.resource[0].id,["slug","fimage"],[l,c]);var d={};d.id=e.data.resource[0].id,d.bc=s[0],d.fc=s[1];var g="",u=[];return void 0!=a.canswer.ranks&&null!=a.canswer.ranks&&""!=a.canswer.ranks?(console.log("there is already a rank"),g=a.canswer.ranks,console.log("this is the existing string - ",g),u=JSON.parse(g),console.log("ranks",u),u.push(d),g=JSON.stringify(u),console.log("this is the new string - ",g),n.updateAnswer(o,["ranks"],[g])):(g="["+JSON.stringify(d)+"]",console.log("this is the new string - ",g),n.updateAnswer(o,["ranks"],[g])),a.DEBUG_MODE&&console.log("result",e),e.data}t.isatomic=!0;var r=f,l=[];return l.push(t),e.post(r,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(i,v)}function u(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting table was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=f+"/"+t,r=h.map(function(e){return e.id}).indexOf(t);return r>-1&&h.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,v)}function m(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating ranking record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"views":r.views=s[l];break;case"answers":r.answers=s[l];break;case"title":r.title=s[l];break;case"tags":r.tags=s[l];break;case"keywords":r.keywords=s[l];break;case"type":r.type=s[l];break;case"question":r.question=s[l];break;case"image1url":r.image1url=s[l];break;case"image2url":r.image2url=s[l];break;case"image3url":r.image3url=s[l];break;case"answertags":r.answertags=s[l];break;case"isatomic":r.isatomic=s[l];break;case"catstr":r.catstr=s[l];break;case"numcom":r.numcom=s[l];break;case"ismp":r.ismp=s[l];break;case"fimage":r.fimage=s[l];break;case"bc":r.bc=s[l];break;case"fc":r.fc=s[l];break;case"shade":r.shade=s[l];break;case"slug":r.slug=s[l]}i.resource.push(r);for(var c=f,d=0,l=0;l<a.content.length;l++)if(a.content[l].id==t){d=l;break}for(var l=0;l<n.length;l++)switch(n[l]){case"answers":a.content[d].answers=s[l];break;case"views":a.content[d].views=s[l];break;case"title":a.content[d].title=s[l];break;case"tags":a.content[d].tags=s[l];break;case"keywords":a.content[d].keywords=s[l];break;case"type":a.content[d].type=s[l];break;case"question":a.content[d].question=s[l];break;case"image1url":a.content[d].image1url=s[l];break;case"image2url":a.content[d].image2url=s[l];break;case"image3url":a.content[d].image3url=s[l];break;case"answertags":a.content[d].answertags=s[l];break;case"isatomic":a.content[d].isatomic=s[l];break;case"catstr":a.content[d].catstr=s[l];break;case"numcom":a.content[d].numcom=s[l];break;case"ismp":a.content[d].ismp=s[l];break;case"fimage":a.content[d].fimage=s[l];break;case"bc":a.content[d].bc=s[l];break;case"fc":a.content[d].fc=s[l];break;case"shade":a.content[d].shade=s[l];break;case"slug":a.content[d].slug=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,v)}function p(){return h.length>0}function v(e){throw e}var h=[],f="/api/v2/mysql/_table/ranking";return{getTables:r,getTablesMain:l,getTablesNonMain:c,update:m,addTable:d,addTableforAnswer:g,deleteTable:u,getMostPopularData:i}}angular.module("app").factory("table",e),e.$inject=["$http","$q","$rootScope","answer","$state","filter"]}(),function(){"use strict";function e(e){function t(t){var a="",n="",s=!1,o={},i="",r="",l={},c=["pb","ob","dt","mb"],d=["Pacific Beach","Ocean Beach","Downtown","Mission Beach"],g=!1,u=!1,m=!1,p=!1,v=[],h=t;if(h)if(h.indexOf("best")>-1&&(h=h.replace("best","")),h.indexOf("Best")>-1&&(h=h.replace("Best","")),h.indexOf("top")>-1&&(h=h.replace("top","")),h.indexOf("Top")>-1&&(h=h.replace("Top","")),h.indexOf("great")>-1&&(h=h.replace("great","")),h.indexOf("Great")>-1&&(h=h.replace("Great","")),h.indexOf("awesome")>-1&&(h=h.replace("awesome","")),h.indexOf("Awesome")>-1&&(h=h.replace("Awesome","")),h.indexOf("amazing")>-1&&(h=h.replace("amazing","")),h.indexOf("Amazing")>-1&&(h=h.replace("Amazing","")),h.indexOf("most")>-1&&(h=h.replace("most","")),h.indexOf("Most")>-1&&(h=h.replace("Most","")),h.indexOf("the ")>-1&&(h=h.replace("the ","")),h.indexOf("The ")>-1&&(h=h.replace("The ","")),h.indexOf("shops")>-1&&(h=h.replace("shops","")),h.indexOf("Shops")>-1&&(h=h.replace("Shops","")),h.indexOf("places")>-1&&(h=h.replace("places","")),h.indexOf("Places")>-1&&(h=h.replace("Places","")),h.indexOf("delicious")>-1&&(h=h.replace("delicious","")),h.indexOf("Delicious")>-1&&(h=h.replace("Delicious","")),h.length>=3){var f=h;f.indexOf("near me")>-1||f.indexOf("near")>-1||f.indexOf("close")>-1||f.indexOf("close to")>-1||f.indexOf("close to me")>-1?(s=!0,f=f.replace("near me","in San Diego"),f=f.replace("near","in San Diego"),f=f.replace("close to me","in San Diego"),f=f.replace("close to","in San Diego"),f=f.replace("close","in San Diego")):s=!1,"Food"==f&&(f=f.replace("Food","Food Near Me")),"food"==f&&(f=f.replace("food","Food Near Me")),"pho"!=f&&"Pho"!=f||(f="vietnamese"),e.isNh&&(f=f+" "+e.cnh);for(var b=[],y=[],w=[],k=[],x=[],D=!0,C=!0,S=!1,O=f.split(" "),E=0;E<e.content.length;E++)if(e.content[E].ismp){n=e.searchStr[E],a=e.content[E].title,o=e.content[E],D=!0,C=!0;for(var P=0;P<O.length;P++){if(i=O[P].charAt(0).toUpperCase()+O[P].slice(1),r=O[P].charAt(0).toLowerCase()+O[P].slice(1),D=D&&(n.indexOf(O[P])>-1||n.indexOf(O[P].toUpperCase())>-1||n.indexOf(i)>-1||n.indexOf(r)>-1),C=C&&(a.indexOf(O[P])>-1||a.indexOf(O[P].toUpperCase())>-1||a.indexOf(i)>-1||a.indexOf(r)>-1),O[P].length>=3)for(var R=0;R<e.allnh.length;R++)(e.allnh[R].indexOf(O[P])>-1||e.allnh[R].indexOf(O[P].toUpperCase())>-1||e.allnh[R].indexOf(i)>-1||e.allnh[R].indexOf(r)>-1)&&(e.allnh[R],S=!0);if(2==O[P].length)for(var R=0;R<c.length;R++)(c[R].indexOf(O[P])>-1||c[R].indexOf(O[P].toUpperCase())>-1||c[R].indexOf(i)>-1||c[R].indexOf(r)>-1)&&(d[R],S=!0)}C&&o.tags.indexOf("isMP")>-1?(w.push(e.content[E]),u=!0):D&&(s?o.title.indexOf("in San Diego")>-1&&y.push(e.content[E]):y.push(e.content[E]))}if(S)for(var A=!1,E=0;E<e.content.length;E++){n=e.searchStr[E],A=!0;for(var P=0;P<O.length;P++)i=O[P].charAt(0).toUpperCase()+O[P].slice(1),r=O[P].charAt(0).toLowerCase()+O[P].slice(1),A=A&&(n.indexOf(O[P])>-1||n.indexOf(O[P].toUpperCase())>-1||n.indexOf(i)>-1||n.indexOf(r)>-1);A&&(x.push(e.content[E]),p=!0)}for(var P=0;P<w.length;P++)a=w[P].title,a.indexOf("in San Diego")>-1&&0==w[P].isatomic&&(l={},l=JSON.parse(JSON.stringify(w[P])),l.title=l.title.replace("in San Diego","close to me"),k.push(l),m=!0);for(var P=0;P<v.length;P++)a=v[P].title,a.indexOf("in San Diego")>-1&&0==v[P].isatomic&&(l={},l=JSON.parse(JSON.stringify(v[P])),l.title=l.title.replace("in San Diego","close to me"),b.push(l),g=!0);p&&(v=v.concat(x)),m&&(v=v.concat(k)),u&&(v=v.concat(w)),g&&(v=v.concat(b)),v=v.concat(y)}else v=[];return v}function a(t){var a="",n="",s=[],o=t,i=!1,r="";if(o&&o.length>=3)for(var l=o,c=l.split(" "),d=0;d<e.answers.length;d++){r=e.answers[d].name,i=!0;for(var g=0;g<c.length;g++)a=c[g].charAt(0).toUpperCase()+c[g].slice(1),n=c[g].charAt(0).toLowerCase()+c[g].slice(1),i=i&&(r.indexOf(c[g])>-1||r.indexOf(c[g].toUpperCase())>-1||r.indexOf(a)>-1||r.indexOf(n)>-1);i&&(e.isNh?e.answers[d].cityarea==e.cnh&&s.push(e.answers[d]):s.push(e.answers[d]))}return s}return{searchRanks:t,searchAnswers:a}}angular.module("app").service("search",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(t){function a(e){return e}function n(e){return r=e.data.resource}var s=new Date,o=s.getTimezoneOffset();s.setMinutes(s.getMinutes()-o);var l=a(s.getMonth()+1)+"/"+a(s.getDate())+"/"+s.getFullYear(),d=c+"/?filter=date="+l;return e.get(d).then(n,i)}function s(){function t(e){return l=e.data.resource}var a=c;return e.get(a).then(t,i)}function o(t,a,n){function s(e){return console.log("updating rank of day succesful"),e.data}var o={};o.resource=[];var r={};r.id=t;for(var d=0;d<a.length;d++)switch(a[d]){case"introtext":r.introtext=n[d]}o.resource.push(r);for(var g=c,u=l.map(function(e){return e.id}).indexOf(t),d=0;d<a.length;d++)switch(a[d]){case"name":l[u].introtext=n[d]}return e.patch(g,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,i)}function i(e){throw e}var r=[],l=[],c="/api/v2/mysql/_table/rankofday";return{getrankofday:n,getall:s,update:o}}angular.module("app").factory("rankofday",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return c=e.data.resource}if(r()&&!a)return t.when(c);var s=d;return e.get(s).then(n,l)}function s(t){function n(e){var t=e.data.resource[0].id;return c[c.length-1].id=t,a.DEBUG_MODE&&console.log("creating pvisits record was succesful"),e.data}var s={};s.date=t,s.nvisits=1;var o={};o.resource=[],o.resource.push(s),c.push(s);var i=d;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(n,l)}function o(t,n){function s(e){return a.DEBUG_MODE&&console.log("Updating pvisits record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.nvisits=n,o.resource.push(i);var r=d;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,l)}function i(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting user activity record was succesful"),e.data}for(var s=0;s<c.length;s++)c[s].id==t&&c.splice(s,1);var o=d+"/"+t;return e.delete(o).then(n,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/pvisits";return{getpvisits:n,postRec:s,patchRec:o,deleteRec:i}}angular.module("app").factory("pvisits",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){if(i()&&!a)return t.when(l);var n=c+"?offset=0",s=e.get(n);return t.all([s]).then(function(e){return l=e[0].data.resource},r)}function s(t){function a(e){var a=t;return a.id=e.data.resource[0].id,l.push(a),console.log("result",e),e.data}var n=c,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,r)}function o(t,n,s){function o(e){return console.log("updating headlines succesful"),e.data}var i={};i.resource=[];var d={};d.id=t;for(var g=0;g<n.length;g++)switch(n[g]){case"city":d.city=s[g];break;case"nh":d.nh=s[g];break;case"title":d.title=s[g];break;case"filter":d.filter=s[g];break;case"bc":d.bc=s[g];break;case"fc":d.fc=s[g]}i.resource.push(d);for(var u=c,m=l.map(function(e){return e.id}).indexOf(t),g=0;g<n.length;g++)switch(n[g]){case"city":a.content[m].city=s[g];break;case"nh":a.content[m].nh=s[g];break;case"title":a.content[m].title=s[g];break;case"filter":a.content[m].filter=s[g];break;case"bc":a.content[m].bc=s[g];break;case"fc":a.content[m].fc=s[g]}return e.patch(u,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,r)}function i(){return l.length>0}function r(e){throw e}var l=[],c="/api/v2/mysql/_table/headlines";return{getheadlines:n,addheadline:s,update:o}}angular.module("app").factory("headline",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m,p,v,h,f){function b(){i.getInitalHomeData().then(function(e){})}function y(){var e=i.getTablesMain(),n=v.getheadlines(),o=h.getcblocksmain(),r=s.getrankofday(),l=c.getactions();return d.loadUserData(),d.loadUserAccount(),t.all([e,n,o,r,l]).then(function(e){a.content=e[0],a.headlines=e[1],a.cblocks=e[2],a.rankofday=e[3],a.uafs=e[4],a.pageDataLoaded=!0,E(),a.DEBUG_MODE&&console.log("cwrapper data ready!"),a.$emit("homeDataLoaded")})}function w(){var e=i.getTablesNonMain();return t.all([e]).then(function(e){a.content=e[0],a.allRanksLoaded=!0,E(),a.DEBUG_MODE&&console.log("all ranks data ready!")})}function k(){var e=h.getcblocksall();return t.all([e]).then(function(e){a.cblocks=e[0],a.allCblocksLoaded=!0,a.DEBUG_MODE&&console.log("all cblocks ready!")})}function x(){var e=o.getAnswers(),n=r.getSpecials(),s=g.GetMatchTable(),i=m.getAllUserActivity(),l=f.getAllcatans();return t.all([e,n,s,i,l]).then(function(e){a.answers=e[0],a.specials=e[1],a.mrecs=e[2],a.alluseractivity=e[3],a.catansrecs=e[4],a.rankSummaryDataLoaded=!0,O(),a.DEBUG_MODE&&console.log("rankSummary data ready!"),a.$emit("rankDataLoaded")})}function D(){var e=u.getEdits(),n=p.getAllvrows();return t.all([e,n]).then(function(e){a.edits=e[0],a.cvrows=e[1],a.answerDetailLoaded=!0,a.DEBUG_MODE&&console.log("answerdetail data ready!"),a.$emit("answerDataLoaded")})}function C(){var e=n.getpvisits();return t.all([e]).then(function(e){a.pvisits=e[0],S(),a.DEBUG_MODE&&console.log("page visits data ready!")})}function S(){function e(e){return e}var t=new Date,s=t.getTimezoneOffset();t.setMinutes(t.getMinutes()-s);for(var o=e(t.getMonth()+1)+"/"+e(t.getDate())+"/"+t.getFullYear(),i=!0,r={},c=0;c<a.pvisits.length;c++)if(a.pvisits[c].date==o){i=!1,r=a.pvisits[c];break}i?n.postRec(o):n.patchRec(r.id,r.nvisits+1),a.dateToday=o,a.dateTodayNum=l.date2number(o)}function O(){a.estAnswers=[],a.estNames=[],a.pplAnswers=[],a.pplNames=[],a.plaAnswers=[],a.plaNames=[];for(var e=0;e<a.answers.length;e++)"Establishment"==a.answers[e].type&&(a.estNames.push(a.answers[e].name),a.estAnswers.push(a.answers[e])),"Person"==a.answers[e].type&&(a.pplNames.push(a.answers[e].name),a.pplAnswers.push(a.answers[e])),"Place"==a.answers[e].type&&(a.plaNames.push(a.answers[e].name),a.plaAnswers.push(a.answers[e]))}function E(){a.searchStr=[];for(var e=0;e<a.content.length;e++)a.searchStr[e]=a.content[e].tags+" "+a.content[e].title}return{gethomedata:y,getallranks:w,getallcblocks:k,getrankdata:x,getanswerdata:D,getpagevisitdata:C,getInitalHomeData:b}}angular.module("app").factory("dataloader",e),e.$inject=["$http","$q","$rootScope","pvisits","rankofday","answer","table","special","datetime","uaf","userdata","matchrec","edit","useractivity","vrows","headline","cblock","catans"]}(),function(){"use strict";function e(e,t,a){function n(n){if(c()&&!n)return t.when(g);var s=u+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return g=e[0].data.resource,a.DEBUG_MODE&&console.log("No. C-Blocks: ",g.length),g},d)}function s(){var n=u+"/?filter=ismp=true",s=e.get(n);return t.all([s]).then(function(e){return g=e[0].data.resource,a.DEBUG_MODE&&console.log("No. C-Blocks: ",g.length),g},d)}function o(){var n=u+"/?filter=ismp=false",s=e.get(n);return t.all([s]).then(function(e){return g=g.concat(e[0].data.resource),a.DEBUG_MODE&&console.log("No. C-Blocks: ",g.length),g},d)}function i(t){function a(e){var a=t;return a.id=e.data.resource[0].id,g.push(a),console.log("adding cblock succesful",e),e.data}var n=u,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,d)}function r(t,a,n){function s(e){return console.log("updating cblocks succesful"),e.data}var o={};o.resource=[];var i={};i.id=t;for(var r=0;r<a.length;r++)switch(a[r]){case"catstr":i.catstr=n[r];break;case"ismp":i.ismp=n[r]}o.resource.push(i);for(var l=u,c=g.map(function(e){return e.id}).indexOf(t),r=0;r<a.length;r++)switch(a[r]){case"catstr":g[c].catstr=n[r];break;case"ismp":g[c].ismp=n[r]}return e.patch(l,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function l(t){function a(e){return console.log("Deleting cblock was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var o=u+"/"+t,i=g.map(function(e){return e.id}).indexOf(t);return i>-1&&g.splice(i,1),e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,d)}function c(){return g.length>0}function d(e){throw e}var g=[],u="/api/v2/mysql/_table/cblocks";return{getcblocks:n,getcblocksmain:s,getcblocksall:o,addcblock:i,update:r,deleteRec:l}}angular.module("app").factory("cblock",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("userfeedBlock",["$rootScope","$state","fbusers","$q","uaf","color",function(e,t,a,n,s,o){"use strict";return{templateUrl:"app/content/partials/userfeed-block.html",transclude:!0,scope:{showAll:"@"},controller:["$scope","$window",function(t,a){var n=t;n.title="mycontent",n.sm=e.sm,a.innerWidth<768&&(n.thumbheight="80px"),a.innerWidth>=768&&a.innerWidth<992&&(n.thumbheight="100px"),a.innerWidth>=992&&a.innerWidth<1200&&(n.thumbheight="80px"),a.innerWidth>1200&&(n.thumbheight="100px")}],link:function(i){function r(){console.log("$rootScope.uafs.length - ",e.uafs.length),i.feeds=[],n.all(e.uafs.map(function(e){return a.getFBUserById(e.userid)})).then(function(t){for(var a=0;a<e.uafs.length;a++){var n=angular.copy(e.uafs[a]);n.picture=t[a]?t[a].picture.data.url:null,i.feeds[a]=n}}),"true"==i.showAll?i.fres=30:i.fres=6,i.ftext="see more"}void 0==i.isDestroyed&&r();var l="#595959",c=o.shadeColor(l,.5);i.headerStyle="color:#f8f8ff;width:100%;border-style:none;background:#595959;background: -webkit-linear-gradient(left,#595959,"+c+");background: -o-linear-gradient(right,"+l+","+c+");background: -moz-linear-gradient(right,"+l+", "+c+");background: linear-gradient(to right,"+l+", "+c+");",i.seeMoreFeed=function(){t.go("feeds")},i.refreshFeed=function(){console.log("refreshFeed"),s.getactions().then(function(t){e.uafs=t,r()})},i.gotoAnswer=function(e){t.go("answerDetail",{index:e.answer})},i.gotoRank=function(e){t.go("rankSummary",{index:e.category})},i.$on("$destroy",function(){i.isDestroyed=!0})}}}]),angular.module("app").directive("trendBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,a,n,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/trend-block.html",transclude:!0,scope:{},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,a,n,s,o,i,r,l,c,d,g,u){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(a){a.isDestroyed,a.seeTab=function(e){1==e&&(a.popular=!0,a.newest=!1),2==e&&(a.newest=!0,a.popular=!1)},a.seeTab(1),function(){var t=angular.copy(e.content.filter(function(e){return 1==e.ismp}));t.sort(function(e,t){var a=e.views?e.views:0,n=t.views?t.views:0;return e.id==t.id?0:a<n?1:-1}),a.popularOrder=t.slice(0,8),t.sort(function(e,t){var a=e.timestmp?e.timestmp:0,n=t.timestmp?t.timestmp:0;return e.id==t.id?0:a<n?1:-1}),a.newestOrder=t.slice(0,8)}(),a.rankSel=function(a,n){e.rankIsNearMe=!!n,e.editMode?t.go("editRanking",{index:a.slug}):t.go("rankSummary",{index:a.slug})},a.$on("$destroy",function(){a.isDestroyed=!0})}}}]),angular.module("app").directive("searchBlock",["$rootScope","$state","search","$timeout",function(e,t,a,n){"use strict";return{templateUrl:"app/content/partials/search-block.html",transclude:!0,scope:{query:"@",ans:"=",ranks:"=",length:"="},controller:["$scope",function(e){}],link:function(s){s.rankSel=function(a,n){e.rankIsNearMe=!!n,e.editMode?t.go("editRanking",{index:a.slug}):t.go("rankSummary",{index:a.slug})},s.ansSel=function(a){e.cCategory=void 0,t.go("answerDetail",{index:a.slug})},s.resRanks=[],s.resAnswers=[],s.maxRes=4e3;var o;s.$watch("query",function(){n.cancel(o),o=n(function(){s.getResults()},300)}),s.getResults=function(){s.resRanks=[],s.ranks&&(s.resRanks=a.searchRanks(s.query)),s.resAnswers=[],s.ans&&(s.resAnswers=a.searchAnswers(s.query));for(var e=0;e<s.resAnswers.length;e++)"Establishment"==s.resAnswers[e].type&&(s.resAnswers[e].icon="fa fa-building-o"),"Person"!=s.resAnswers[e].type&&"PersonCust"!=s.resAnswers[e].type||(s.resAnswers[e].icon="fa fa-male"),"Short-Phrase"==s.resAnswers[e].type&&(s.resAnswers[e].icon="fa fa-comment-o"),"Event"==s.resAnswers[e].type&&(s.resAnswers[e].icon="fa fa-calendar-o"),"Organization"==s.resAnswers[e].type&&(s.resAnswers[e].icon="fa fa-trademark");s.length=s.resRanks.length+s.resAnswers.length}}}}]),angular.module("app").directive("rankItem",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,a,n,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/rank-block.html",transclude:!0,scope:{rankObject:"="},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,a,n,s,o,i,r,l,c,d,g,u){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(a){function n(e){e.titlex=e.title.replace(" in San Diego",""),0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}function s(e){if("Short-Phrase"==e.type){if(e.isShortPhrase=!0,void 0!=e.image1url){var t=e.image1url.split("##");e.title1=t[0],e.addinfo1=t[1]}if(void 0!=e.image2url){var a=e.image2url.split("##");e.title2=a[0],e.addinfo2=a[1]}if(void 0!=e.image3url){var n=e.image3url.split("##");e.title3=n[0],e.addinfo3=n[1]}}}void 0==a.isDestroyed&&function(){a.results=[];var e=r.innerWidth-20;a.w2=Math.round(e/2),a.w4=Math.round(e/4)-5,a.w8=Math.round(e/8),a.resultsTop=[];var t={};t={},t=JSON.parse(JSON.stringify(a.rankObject)),n(t),s(t),a.resultsTop.push(t);var o=a.resultsTop[0];if(a.title=o.title,a.stats={},a.stats.views=o.views,a.stats.answers=o.answers,a.stats.numcom=o.numcom,void 0!=a.stats.numcom&&null!=a.stats.numcom||(a.stats.numcom=0),a.isBasic=!0,void 0!=o.fimage&&""!=o.fimage)a.image4=o.image3url,a.image3=o.image2url,a.image2=o.image1url,a.image1=o.fimage,a.bc=o.bc,a.fc=o.fc,a.shade=o.shade;else{var i=c.defaultRankColor(o);a.bc=i[0],a.fc=i[1],a.shade=-4,a.image3=o.image3url,a.image2=o.image2url,a.image1=o.image1url}}(),a.rankSel=function(a,n){e.rankIsNearMe=!!n,e.editMode?t.go("editRanking",{index:a.slug}):t.go("rankSummary",{index:a.slug})},a.$on("$destroy",function(){a.isDestroyed=!0})}}}]),angular.module("app").directive("rankBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,a,n,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/rank-block.html",transclude:!0,scope:{theme:"@",type:"@"},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,a,n,s,o,i,r,l,c,d,g,u){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(a){function n(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[a],e[a]=t;return e}function s(e){e.titlex=e.title.replace(" in San Diego",""),0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}function o(e){if("Short-Phrase"==e.type){if(e.isShortPhrase=!0,void 0!=e.image1url){var t=e.image1url.split("##");e.title1=t[0],e.addinfo1=t[1]}if(void 0!=e.image2url){var a=e.image2url.split("##");e.title2=a[0],e.addinfo2=a[1]}if(void 0!=e.image3url){var n=e.image3url.split("##");e.title3=n[0],e.addinfo3=n[1]}}}void 0==a.isDestroyed&&function(){var t="",i=[],l=0;a.results=[];var d=r.innerWidth-20;a.w2=Math.round(d/2),a.w4=Math.round(d/4)-5,a.w8=Math.round(d/8);for(var g=0;g<e.cblocks.length;g++)if("city"==e.cblocks[g].scope&&e.isCity&&e.cblocks[g].type==a.theme){t=e.cblocks[g].catstr,i=t.split(":"),n(i);for(var u=0;u<i.length;u++)l=e.content.map(function(e){return e.id}).indexOf(Number(i[u])),a.results.push(e.content[l]);break}a.resultsTop=[];var m={},p=a.results.length;if(p>0)for(var v=0;v<p;v++)m={},m=JSON.parse(JSON.stringify(a.results[v])),a.results[v].image1url!=e.EMPTY_IMAGE&&void 0!=a.results[v].image1url&&""!=a.results[v].image1url&&(s(m),o(m),"Short-Phrase"==m.type&&void 0==m.fimage||a.resultsTop.push(m));var h=a.resultsTop[0];if(a.title=h.title,a.stats={},a.stats.views=h.views,a.stats.answers=h.answers,a.stats.numcom=h.numcom,void 0!=a.stats.numcom&&null!=a.stats.numcom||(a.stats.numcom=0),"basic"==a.type&&(a.isBasic=!0),"grid4"==a.type&&(a.isGrid4=!0),void 0!=h.fimage&&""!=h.fimage)a.image4=h.image3url,a.image3=h.image2url,a.image2=h.image1url,a.image1=h.fimage,a.bc=h.bc,a.fc=h.fc,a.shade=h.shade;else{var f=c.defaultRankColor(h);a.bc=f[0],a.fc=f[1],a.shade=-4,a.image3=h.image3url,a.image2=h.image2url,a.image1=h.image1url}}(),a.rankSel=function(a,n){e.rankIsNearMe=!!n,e.editMode?t.go("editRanking",{index:a.slug}):t.go("rankSummary",{index:a.slug})},a.$on("$destroy",function(){a.isDestroyed=!0})}}}]),angular.module("app").directive("contentBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,a,n,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/content-block.html",transclude:!0,scope:{modType:"@type",isDynamic:"=dynamic",isRoW:"=rankofweek",updateView:"&updateView"},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,a,n,s,o,i,r,l,c,d,g,u){var m=t;m.title="mycontent",m.sm=e.sm,m.maxRes=4,m.btext="see more";c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(a){function n(){a.image1="/assets/images/noimage.jpg",a.image2="/assets/images/noimage.jpg",a.image3="/assets/images/noimage.jpg",a.isShortPhrase=!1
;for(var t=0;t<e.headlines.length;t++)if(e.headlines[t].type==a.modType){a.bgc=e.headlines[t].bc,a.bgc2=c.shadeColor(a.bgc,.5),a.fc=e.headlines[t].fc,a.headline=e.headlines[t].title;break}e.DEBUG_MODE&&console.log("rankofday - ",e.rankofday[0]);var n="",s="";e.isCity&&(n=e.rankofday[0].main),e.isNh&&(n=e.rankofday[0].nh+" "+e.cnh),a.results=[];var o=n.split(" ");e.DEBUG_MODE&&console.log("valTags _ ",o);for(var i=0;i<e.content.length;i++){var r=!0;s=e.content[i].title;for(var l=0;l<o.length;l++){var d=o[l].charAt(0).toUpperCase()+o[l].slice(1),g=o[l].charAt(0).toLowerCase()+o[l].slice(1);r=r&&(s.indexOf(o[l])>-1||s.indexOf(o[l].toUpperCase())>-1||s.indexOf(d)>-1||s.indexOf(g)>-1)}if(r){a.results.push(e.content[i]);break}}var u=JSON.parse(JSON.stringify(a.results[0]));if(a.results.length>0&&void 0!=a.results[0])if(void 0!=a.results[0].fimage&&""!=a.results[0].fimage&&u.image1url.indexOf("featuredImages")<0)a.image3=u.image2url,a.image2=u.image1url,a.image1=u.fimage,a.rdbc=a.results[0].bc,a.rdfc=a.results[0].fc,a.shade=a.results[0].shade;else{var m=c.defaultRankColor(a.results[0]);a.rdbc=m[0],a.rdfc=m[1],a.shade=4,void 0!=a.results[0].image1url&&(a.image1=u.image1url),void 0!=a.results[0].image2url&&(a.image2=u.image2url),void 0!=a.results[0].image3url&&(a.image3=u.image3url)}if("Short-Phrase"==a.results[0].type){a.isShortPhrase=!0;var p=a.image1.split("##");a.title1=p[0],a.addinfo1=p[1];var v=a.image2.split("##");a.title2=v[0],a.addinfo2=v[1];var h=a.image3.split("##");a.title3=h[0],a.addinfo3=h[1]}a.rankOfDay=a.results[0].title}function s(){var t="",n=[],s=0;a.results=[];for(var l=!1,d=0;d<e.headlines.length;d++)if(e.headlines[d].type==a.modType){a.bgc=e.headlines[d].bc,a.bgc2=c.shadeColor(a.bgc,.3),a.fc=e.headlines[d].fc,a.headline=e.headlines[d].title,e.isNh&&"rxfeedback"!=e.headlines[d].type&&"rxsuggestion"!=e.headlines[d].type&&(a.headline=a.headline+" - "+e.cnh);break}for(var d=0;d<e.cblocks.length;d++){if("city"==e.cblocks[d].scope&&e.isCity&&e.cblocks[d].type==a.modType){t=e.cblocks[d].catstr,n=t.split(":"),o(n);for(var g=0;g<n.length;g++)s=e.content.map(function(e){return e.id}).indexOf(Number(n[g])),a.results.push(e.content[s]);l=!0;break}if("nh"==e.cblocks[d].scope&&e.isNh&&e.cblocks[d].type==a.modType&&e.cblocks[d].scopename==e.cnh){t=e.cblocks[d].catstr,n=t.split(":"),o(n);for(var g=0;g<n.length;g++)s=e.content.map(function(e){return e.id}).indexOf(Number(n[g])),a.results.push(e.content[s]);l=!0;break}if("rx"==e.cblocks[d].scope&&e.cblocks[d].type==a.modType&&"RankX"==e.cblocks[d].scopename){t=e.cblocks[d].catstr,n=t.split(":");for(var g=0;g<n.length;g++)s=e.content.map(function(e){return e.id}).indexOf(Number(n[g])),a.results.push(e.content[s]);l=!0;break}}a.results.length<=6?a.resLT6=!0:a.resLT6=!1;var u=void 0!=a.results[0];a.updateView(l&&u),a.hideme=!l||!u,a.resultsTop=[];var m={},p=a.results.length;if(p>0)for(var v=0;v<p;v++){if(m={},m=JSON.parse(JSON.stringify(a.results[v])),void 0!=a.results[v].fimage&&""!=a.results[v].fimage&&(a.results[v].image1url=a.results[v].fimage),a.results[v].image1url!=e.EMPTY_IMAGE&&void 0!=a.results[v].image1url&&""!=a.results[v].image1url)i(m),r(m),a.resultsTop.push(m);else{for(var h=v;h<p-1;h++)a.results[h]=a.results[h+1];a.results[p-1]=m}if(a.resultsTop.length>2||a.resultsTop.length==p){a.results=a.results.slice(a.resultsTop.length+1);break}}}function o(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[a],e[a]=t;return e}function i(e){e.titlex=e.title.replace(" in San Diego",""),0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}function r(e){if("Short-Phrase"==e.type){if(e.isShortPhrase=!0,void 0!=e.image1url){var t=e.image1url.split("##");e.title1=t[0],e.addinfo1=t[1]}if(void 0!=e.image2url){var a=e.image2url.split("##");e.title2=a[0],e.addinfo2=a[1]}if(void 0!=e.image3url){var n=e.image3url.split("##");e.title3=n[0],e.addinfo3=n[1]}}}function l(){console.log("apply Rule")}void 0==a.isDestroyed&&("rankofweek"==a.modType?n():s());var d=e.$on("loadNh",function(e){"rankofweek"==a.modType?n():s()}),g=e.$on("applyRule",function(e){l()});a.rankSel=function(a,n){e.rankIsNearMe=!!n,e.editMode?t.go("editRanking",{index:a.slug}):t.go("rankSummary",{index:a.slug})},a.seeMore=function(e,t){4==a.maxRes?(a.btext="see less",a.maxRes=100):(a.btext="see more",a.maxRes=4)},a.updateView=function(e){a.hideme=!e},a.$on("$destroy",d),a.$on("$destroy",g),a.$on("$destroy",function(){a.isDestroyed=!0})}}}]),function(){"use strict";function e(e,t,a,n){function s(n){function s(e){return d=e.data.resource}if(l()&&!n)return t.when(d);var o=g+"?filter=user="+a.user.id;return e.get(o).then(s,c)}function o(t,s){function o(e){var t=r;return t.id=e.data.resource[0].id,d.push(t),a.cvrowvotes.push(t),1==r.val&&n.post("upVotedVrow",["answer","vrow"],[r.answer,t.vrow]),-1==r.val&&n.post("downVotedVrow",["answer","vrow"],[r.answer,t.vrow]),a.DEBUG_MODE&&console.log("Creating new vrowvoting record was succesful"),e.data}var i={};i.resource=[];var r={};r.user=a.user.id,r.answer=a.canswer.id,r.vrow=t,r.val=s,r.timestmp=Date.now(),i.resource.push(r);var l=g;return e.post(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,c)}function i(t,n){function s(e){return a.DEBUG_MODE&&console.log("Updating vrow vote record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.val=n,i.timestmp=Date.now(),o.resource.push(i);var r=g,l=d.map(function(e){return e.id}).indexOf(t);return d[l].vote=n,d[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,c)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting vrow votes records was succesful"),e.data}for(var s=0;s<d.length;s++)d[s].vrow==t&&d.splice(s,1);var o=g+"?filter=vrow="+t;return e.delete(o).then(n,c)}function l(e){return d.length>0}function c(e){throw e}var d=[],g="/api/v2/mysql/_table/vrowvotes";return{loadVrowVotes:s,patchRec:i,postRec:o,deleteVrowVotesbyVrow:r}}angular.module("app").factory("vrowvotes",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a,n){function s(n){if(u()&&!n)return t.when(p);var s=v+"?offset=0",o=v+"?offset=1000",i=v+"?offset=2000",r=v+"?offset=3000",l=v+"?offset=4000",c=v+"?offset=5000",d=v+"?offset=6000",g=v+"?offset=7000",h=v+"?offset=8000",f=v+"?offset=9000",b=v+"?offset=10000",y=v+"?offset=11000",w=v+"?offset=12000",k=v+"?offset=13000",x=v+"?offset=14000",D=v+"?offset=15000",C=v+"?offset=16000",S=v+"?offset=17000",O=v+"?offset=18000",E=v+"?offset=19000",P=v+"?offset=20000",R=v+"?offset=21000",A=v+"?offset=22000",M=v+"?offset=23000",I=e.get(s),$=e.get(o),_=e.get(i),T=e.get(r),L=e.get(l),B=e.get(c),U=e.get(d),N=e.get(g),V=e.get(h),F=e.get(f),G=e.get(b),q=e.get(y),j=e.get(w),z=e.get(k),Y=e.get(x),W=e.get(D),H=e.get(C),K=e.get(S),X=e.get(O),Q=e.get(E),J=e.get(P),Z=e.get(R),ee=e.get(A),te=e.get(M);return t.all([I,$,_,T,L,B,U,N,V,F,G,q,j,z,Y,W,H,K,X,Q,J,Z,ee,te]).then(function(e){return p=e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource,e[8].data.resource,e[9].data.resource,e[10].data.resource,e[11].data.resource,e[12].data.resource,e[13].data.resource,e[14].data.resource,e[15].data.resource,e[16].data.resource,e[17].data.resource,e[18].data.resource,e[19].data.resource,e[20].data.resource,e[21].data.resource,e[22].data.resource,e[23].data.resource),a.DEBUG_MODE&&console.log("No. Vrows: ",p.length),p},m)}function o(e){var t=[],n={},s=[];if(a.cCategory.tags.indexOf("food")>-1||a.cCategory.tags.indexOf("services")>-1||a.cCategory.tags.indexOf("health")>-1||a.cCategory.tags.indexOf("beauty")>-1||a.cCategory.tags.indexOf("food")>-1||a.cCategory.title.indexOf("food")>-1||a.cCategory.title.indexOf("restaurants")>-1||a.cCategory.title.indexOf("Bars")>-1||a.cCategory.title.indexOf("bars")>-1||a.cCategory.title.indexOf("pubs")>-1||a.cCategory.title.indexOf("Yoga")>-1||a.cCategory.title.indexOf("Pilates")>-1||a.cCategory.title.indexOf("yoga")>-1||a.cCategory.title.indexOf("pilates")>-1||a.cCategory.title.indexOf("schools")>-1||a.cCategory.title.indexOf("Gyms")>-1||a.cCategory.title.indexOf("gyms")>-1||a.cCategory.title.indexOf("Nightclubs")>-1||"PersonCust"==e.type||"Establishment"==e.type){t=["Quality of Service","Friendliness of Staff","Promptness of Service","Value for the Money"],(a.cCategory.tags.indexOf("food")>-1||a.cCategory.title.indexOf("food")>-1||a.cCategory.title.indexOf("restaurants")>-1||a.cCategory.title.indexOf("offee")>-1)&&(t=["Quality of Food and Drinks","Friendliness of Staff","Promptness of Service","Value for the Money"]),(a.cCategory.title.indexOf("Bars")>-1||a.cCategory.title.indexOf("bars")>-1||a.cCategory.title.indexOf("pubs")>-1)&&(t=["Quality of Drinks","Friendliness of Staff","Promptness of Service","Value for the Money"]),(a.cCategory.title.indexOf("Gyms")>-1||a.cCategory.title.indexOf("gyms")>-1)&&(t=["Equipment & Facilities","Friendliness of Staff","Environment","Value for the Money"]),(a.cCategory.title.indexOf("Yoga")>-1||a.cCategory.title.indexOf("Pilates")>-1||a.cCategory.title.indexOf("yoga")>-1||a.cCategory.title.indexOf("pilates")>-1||a.cCategory.title.indexOf("schools")>-1||a.cCategory.title.indexOf("MMA")>-1)&&(t=["Quality of Instructors","Friendliness of Staff","Class Environment","Value for the Money"]),(a.cCategory.title.indexOf("Apartments")>-1||a.cCategory.title.indexOf("apartments")>-1)&&(t=["Location","Floor Layout","Facilities","Value for the Money"]),(a.cCategory.title.indexOf("shop")>-1||a.cCategory.title.indexOf("store")>-1)&&a.cCategory.title.indexOf("arber")<0&&a.cCategory.title.indexOf("offee")<0&&a.cCategory.title.indexOf("repair")<0&&(t=["Assortment of Products","Friendliness of Staff","Value for the Money"]),(a.cCategory.title.indexOf("Tattoo")>-1||a.cCategory.title.indexOf("tattoo")>-1)&&(t=["Quality of Service","Friendliness of Staff","Promptness of Service","Value for the Money"]),(a.cCategory.title.indexOf("Nightclubs")>-1||a.cCategory.title.indexOf("music")>-1||a.cCategory.title.indexOf("dancing")>-1)&&(t=[" Quality of Music","Environment","Friendliness of Staff","Value for the Money"]),"PersonCust"==e.type&&(t=[" Quality of Service","Friendliness","Value for the Money"]);for(var o=0;o<t.length;o++)n={},n.gnum=1,n.gtitle="General",n.title=t[o],n.upV=0,n.downV=0,n.answer=e.id,s.push(n);r(s)}}function i(t){function a(e){var t=n;return t.id=e.data.resource[0].id,p.push(t),e.data}var n=t;n.upV=0,n.downV=0,n.timestmp=Date.now();var s={};s.resource=[],s.resource.push(n);var o=v;return e.post(o,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,m)}function r(t){function a(e){for(var t=p.length-1,a=e.data.resource.length-1;a>=0;a--)p[t].id=e.data.resource[a].id,t--;return e.data}var n={};n.resource=[],n.resource.push(t),p.push.apply(p,t);var s=v;return e.post(s,t,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,m)}function l(t){function s(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVrowVotesbyVrow(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting vrows records for answer was succesful"),e.data}for(var o=0;o<p.length;o++)p[o].answer==t&&p.splice(o,1);var i=v+"?filter=answer="+t;return e.delete(i).then(s,m)}function c(t,s){function o(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVrowVotesbyVrow(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting vrows records for group was succesful"),e.data}for(var i=p.length-1;i>=0;i--)p[i].gnum==t&&p.splice(i,1);var r=v+"?filter=(gnum="+t+") AND (answer="+s+")";return e.delete(r).then(o,m)}function d(t){function s(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVrowVotesbyVrow(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting vrow was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,o.resource.push(i);var r=v+"/"+t,l=p.map(function(e){return e.id}).indexOf(t);return l>-1&&p.splice(l,1),e.delete(r,i,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,m)}function g(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating vrows record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"upV":r.upV=s[l];break;case"downV":r.downV=s[l];break;case"title":r.title=s[l];break;case"gnum":r.gnum=s[l];break;case"gtitle":r.gtitle=s[l]}i.resource.push(r);for(var c=v,d=p.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"upV":a.cvrows[d].upV=s[l];break;case"downV":a.cvrows[d].downV=s[l];break;case"title":a.cvrows[d].title=s[l];break;case"gnum":a.cvrows[d].gnum=s[l];break;case"gtitle":a.cvrows[d].gtitle=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,m)}function u(){return p.length>0}function m(e){throw e}var p=[],v="/api/v2/mysql/_table/vrows";return{getAllvrows:s,postRec:i,postRec2:r,deleteVrowByAnswer:l,deleteVrow:d,updateRec:g,deleteVrowByGroup:c,postVrows4Answer:o}}angular.module("app").factory("vrows",e),e.$inject=["$http","$q","$rootScope","vrowvotes"]}(),function(){"use strict";function e(e,t,a,n){function s(n){function s(e){return m=e.data.resource}if(g()&&!n)return t.when(m);var o=p+"/?filter=user="+a.user.id;return e.get(o).then(s,u)}function o(t){function n(e){return e.data.resource}for(var s="",o=0;o<a.user.friends.data.length;o++)s+="(user=",s+=a.user.friends.data[o].id,s+=")",o!=a.user.friends.data.length-1&&(s+=" or ");var i=p+"/?filter="+s;return e.get(i).then(n,u)}function i(t){function a(e){return m=e.data.resource}var n=p;return e.get(n).then(a,u)}function r(t,s,o,i){function r(e){var t=c;return t.id=e.data.resource[0].id,m.push(t),1==c.vote&&n.post("upVoted",["answer","category"],[s,o]),-1==c.vote&&n.post("downVoted",["answer","category"],[s,o]),a.$emit("updateVoteTable"),console.log("Creating new voting record was succesful"),e.data}var l={};l.resource=[];var c={};c.user=a.user.id,c.catans=t,c.answer=s,c.vote=i,c.timestmp=Date.now(),l.resource.push(c);var d=p;return e.post(d,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(r,u)}function l(t,n){function s(e){return a.DEBUG_MODE&&console.log("Updating vote record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.vote=n,i.timestmp=Date.now(),o.resource.push(i);var r=p,l=m.map(function(e){return e.id}).indexOf(t);return m[l].vote=n,m[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,u)}function c(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting vote records by Catans was succesful"),e.data}for(var s=0;s<m.length;s++)m[s].catans==t&&m.splice(s,1);var o=p+"/?filter=catans="+t;return e.delete(o).then(n,u)}function d(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting vote record was succesful"),e.data}for(var s=0;s<m.length;s++)m[s].id==t&&m.splice(s,1);var o=p+"/"+t;return e.delete(o).then(n,u)}function g(e){return m.length>0}function u(e){throw e}var m=[],p="/api/v2/mysql/_table/votetable";return{loadVotesByUser:s,loadAllVotes:i,patchRec:l,postRec:r,deleteVotesbyCatans:c,deleteRec:d,loadVotesByMyFriends:o}}angular.module("app").factory("votes",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return g=e.data.resource}if(l()&&!a)return t.when(g);var s=m;return e.get(s).then(n,d)}function s(n){function s(e){return u=e.data.resource}if(c()&&!n)return t.when(c);var o=m+"/?filter=user="+a.user.id;return e.get(o).then(s,d)}function o(t){function n(e){var t=s;return t.id=e.data.resource[0].id,g.push(t),a.thisuseractivity.push(t),a.DEBUG_MODE&&console.log("creating useractivity record was succesful"),e.data}var s={};s.user=a.user.id,s.category=t,s.votes=1,s.timestmp=Date.now();var o={};o.resource=[],o.resource.push(s);var i=m;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(n,d)}function i(t,n){function s(e){return a.DEBUG_MODE&&console.log("Updating useractivity record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.user=a.user.id,i.votes=n,i.timestmp=Date.now(),o.resource.push(i);var r=m,l=g.map(function(e){return e.id}).indexOf(t);return g[l].votes=n,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting user activity record was succesful"),e.data}var s=g.map(function(e){return e.id}).indexOf(t);s>-1&&g.splice(s,1);var o=m+"/"+t;return e.delete(o).then(n,d)}function l(){return g.length>0}function c(){return u.length>0}function d(e){throw e}var g=[],u=[],m="/api/v2/mysql/_table/useractivity";return{getAllUserActivity:n,getActivitybyUser:s,postRec:o,patchRec:i,deleteRec:r}}angular.module("app").factory("useractivity",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(n){var s=c+"?limit=200&order=id%20DESC",o=e.get(s);return t.all([o]).then(function(e){return l=e[0].data.resource.concat(),a.DEBUG_MODE&&console.log("No. user actions: ",l.length),l},r)}function s(t,n,s){function o(e){var t=u;return t.id=e.data.resource[0].id,l.push(t),a.DEBUG_MODE&&console.log("Posted user activity feed"),e.data}var d=c,g={};g.bc="",g.fc="";var u={},m=0;u.userid=a.user.id,u.action=t,u.initials=a.user.name.replace(/[^A-Z]/g,""),i(a.user.id,g),u.fc=g.fc,u.bc=g.bc;for(var p=0;p<n.length;p++)switch(n[p]){case"answer":u.answer=s[p],m=a.answers.map(function(e){return e.id}).indexOf(u.answer),u.text1=a.answers[m].name;break;case"category":u.category=s[p],m=a.content.map(function(e){return e.id}).indexOf(u.category),u.text2=a.content[m].title;break;case"comment":u.comment=s[p];break;case"edit":u.edit=s[p],m=a.edits.map(function(e){return e.id}).indexOf(u.edit),u.text2=a.edits[m].field;break;case"vrow":u.vrow=s[p],m=a.cvrows.map(function(e){return e.id}).indexOf(u.vrow),u.text2=a.cvrows[m].title;break;case"text1":u.text1=s[p];break;case"text2":u.text2=s[p]}var v=[];return v.push(u),e.post(d,v,{headers:{"Content-Type":"multipart/form-data"},body:v}).then(o,r)}function o(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting user activity feed was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=c+"/"+t,d=l.map(function(e){return e.id}).indexOf(t);return d>-1&&l.splice(d,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,r)}function i(e,t){switch(e%10){case 0:t.bc="#b3b3b3",t.fc="black";break;case 1:t.bc="#666666",t.fc="white";break;case 2:t.bc="#006bb3",t.fc="white";break;case 3:t.bc="#009933",t.fc="white";break;case 4:t.bc="#cc0000",t.fc="white";break;case 5:t.bc="#538cc6",t.fc="black";break;case 6:t.bc="#b36b00",t.fc="white";break;case 7:t.bc="#999966",t.fc="black";break;case 8:t.bc="#4d0099",t.fc="white";break;case 9:t.bc="#009999",t.fc="black"}}function r(e){throw e}var l=[],c="/api/v2/mysql/_table/useractivityfeed";return{getactions:n,post:s,deletebyId:o}}angular.module("app").factory("uaf",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t){function a(a){function n(e){return r=e.data.resource}if(s()&&!a)return t.when(r);var i=l;return e.get(i).then(n,o)}function n(t,a){function n(e){return i=e.data}var s=l+"/?fields=field&filter=tableid="+t;return e.get(s).then(n,o)}function s(){return r.length>0}function o(e){throw e}var i,r=[],l="/api/v2/mysql/_table/tablefield";return{getAllTableFields:a,getTableFields:n}}angular.module("app").factory("tablefield",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t,a,n){function s(t){delete e.defaults.headers.common["X-Dreamfactory-API-Key"],delete e.defaults.headers.common["X-DreamFactory-Session-Token"];var s=i+"?key="+r+"&q="+t+"&image_type=photo";return e.get(s).then(function(t){return o=[],o=t.data.hits,console.log("pixabay results success! - ",t),e.defaults.headers.common["X-Dreamfactory-API-Key"]=a,e.defaults.headers.common["X-DreamFactory-Session-Token"]=n.session_token,o},function(){console.log("Problem getting Pixabay Images")})}var o=[],i="https://pixabay.com/api/",r="5296312-7285c9a61e74685606fe28209";return{search:s}}angular.module("app").factory("pixabay",e),e.$inject=["$http","$rootScope","APP_API_KEY","$cookies"]}(),function(){"use strict";function e(e,t){function a(){t.igimages=[];var a=(t.canswer.name.replace(" ",""),"https://api.instagram.com/v1/tags/rankxdemo/media/recent?access_token=4368719989.c46745e.407288e972a64c119093166b8ba280c0&callback=JSON_CALLBACK");return console.log(a),e.jsonp(a).success(function(e){var a={};console.log(e);for(var n=0;n<e.data.length;n++)a={},a.url=e.data[n].images.standard_resolution.url,a.caption=e.data[n].caption?e.data[n].caption.text:void 0,a.from=e.data[n].user.username,t.igimages.push(a),console.log(e.data[n].images.standard_resolution.url)})}return{getImages:a}}angular.module("app").factory("instagram",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e,t){function a(){function a(e){var a=new X2JS,n=a.xml_str2json(e.data),s={},o=n.EnumerationResults.Blobs.Blob;if(o&&o.constructor===Array)for(var i=0;i<o.length;i++)s={},s.url="https://rankx.blob.core.windows.net/sandiego/"+o[i].Name,s.type="azure-uploaded",t.blobs.push(s);else o&&o.constructor===Object&&(s={},s.url="https://rankx.blob.core.windows.net/sandiego/"+o.Name,s.type="Uploaded",t.blobs.push(s));t.DEBUG_MODE&&console.log("query succeded")}function n(e){t.DEBUG_MODE&&console.log("image query failed")}var s="https://rankx.blob.core.windows.net/sandiego?restype=container&comp=list&prefix="+t.canswer.id+"/&sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D";return e.get(s).then(a,n)}function n(a){function n(e){t.$emit("refreshImages"),t.DEBUG_MODE&&console.log("Blob image deleted succesfully")}function s(e){t.DEBUG_MODE&&console.log("Blob image delete failed")}console.log("blobname, ",a);var o=a+"?sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D";return e.delete(o).then(n,s)}return{getImageList:a,deleteBlob:n}}angular.module("app").factory("imagelist",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e,t){function a(e,a,i){function r(e){return t.DEBUG_MODE&&console.log("query succeded"),o=e,s(o)}function l(e){t.DEBUG_MODE&&console.log("image query failed")}return n(e,a,i).then(r,l)}function n(a,n,s){var o="",i="",r="",l="";t.cCategory&&(l=t.cCategory.keywords);for(var c=[],d=0;d<a.length;d++)"edit"==s?c[d]=a[d].cval:"add"==s&&(c[d]=a[d].val);switch(1==a.length&&c[0]&&(i=c[0]),2==a.length&&(c[0]&&(i=c[0]),c[1]&&(r=c[1])),3==a.length&&(c[0]&&(i=c[0]),c[1]&&(r=c[1]),c[2]&&c[2]),a.length>3&&(c[0]&&(i=c[0]),c[1]&&(r=c[1]),c[2]&&c[2],c[3]&&c[3]),n){case 1:o="q="+i+" "+r+" "+l;break;case 2:case 3:o="q="+i+" "+l;break;case 4:o="q="+i+" "+r+" "+l}var g="https://www.googleapis.com/customsearch/v1?"+o+"&cx=000139851817949790257%3Aqwkdgi2q2ew&num=10&searchType=image&fileType=jpg%2C+png%2C+bmp&imgType=photo&imgSize=large&filter=1&key=AIzaSyBr143lDEROCrUWdKvqPQmhQ5BoFo13oSE";return e.get(g)}function s(e){for(var t=[],a=!1,n=!1,s=0,o=0,r=0,l=0;l<i;l++)if(a=!1,n=!1,o=e.data.items[l].image.height,r=e.data.items[l].image.width,r>o&&r/o<1.8&&(a=!0),s=e.data.items[l].link.length,("g"==e.data.items[l].link[s-1]||"p"==e.data.items[l].link[s-1])&&e.data.items[l].link.indexOf("https")>-1&&(n=!0),a&&n){var c=e.data.items[l].link;t.push(c)}return t}var o=[],i=10;return{imageSearch:n,getImageLinks:a,filterImageResults:s}}angular.module("app").factory("image",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e){function t(e,t){var a="";if("weekly"==e.freq){var n="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"");if(a=n+"<br>From: "+e.stime2+" to "+e.etime2,t&&n.length>45){for(var s=0,o="",i=0;i<a.length;i++)if("-"==a[i]&&i<45&&(s=i),"-"==a[i]&&i>45){o=a.substring(0,s)+"<br>"+a.substring(s);break}a=o}}if("onetime"==e.freq){a=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:"Starts: "+e.sdate+" at "+e.stime+"<br>Ends: "+e.edate+" at "+e.etime}var r=0,l="";if(void 0==e.details&&(e.details=""),t&&e.details.length>45)for(var i=0;i<e.details.length;i++)r>42&&" "==e.details[i]&&(l+="<br>",r=0),l+=e.details[i],r++;else l=e.details;return'<div class="text-center"><h3>'+e.stitle+"</h3><p>"+a+"</p><p>"+l+"</p></div>"}function a(e,t){var a="";if("weekly"==e.freq&&(a="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"")+"<br>From: "+e.stime2+" to "+e.etime2),"onetime"==e.freq){a=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:(void 0==e.edate?"":"Starts: ")+e.sdate+" at "+e.stime+(void 0==e.edate?"":"<br>Ends: "+e.edate+" at "+e.etime)}var n=0,s="";if(void 0==e.addinfo&&(e.addinfo=""),t&&e.addinfo.length>45)for(var o=0;o<e.addinfo.length;o++)n>42&&" "==e.addinfo[o]&&(s+="<br>",n=0),s+=e.addinfo[o],n++;return"<p><strong>"+e.name+"</strong></p><p><strong>"+(void 0!=e.location?" @ "+e.location:"")+"</strong></p>"+(void 0!=e.cityarea?"<p>in "+e.cityarea+"</p>":"")+"<p>"+a+"</p>"+(void 0!=e.addinfo?"<p>"+s+"</p>":"")+(void 0!=e.website?'<p>For more information: <a href="'+e.website+'">'+e.website+"</a></p>":"")+"</div>"}return{specialHtml:t,eventHtml:a}}angular.module("app").service("htmlops",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s){function o(n){delete t.defaults.headers.common["X-Dreamfactory-API-Key"],delete t.defaults.headers.common["X-DreamFactory-Session-Token"];var o="https://en.wikipedia.org/w/api.php?action=query&format=json&origin=*&prop=extracts&list=&meta=&continue=&titles="+n;return t.post(o,{},{headers:{"Content-Type":"multipart/form-data"}}).then(function(n){var o=JSON.stringify(n.data.query.pages),i=o.slice(o.indexOf("<p><b>"),o.indexOf("<h2>"));i=i.replace(/<p>/g,""),i=i.replace(/<\/p>/g,""),i=i.replace(/<i>/g,""),i=i.replace(/<\/i>/g,""),i=i.replace(/<small>/g,""),i=i.replace(/<\/small>/g,""),i=i.replace(/<span title\=\\"Representation in the International Phonetic Alphabet \(IPA\)\\">/g,""),i=i.replace(/<\/span>/g,""),i=i.replace(/<b>/g,""),i=i.replace(/<\/b>/g,""),i=i.replace(/.\\n\\n/g,"."),i=i.replace(/.\\n/g,"."),i=i.replace(/<(?:.|\n)*?>/gm,""),e.DEBUG_MODE&&console.log("1. wiki results res - ",i),t.defaults.headers.common["X-Dreamfactory-API-Key"]=a,t.defaults.headers.common["X-DreamFactory-Session-Token"]=s.session_token,e.$emit("wikiReady",i)})}return{getWiki:o}}angular.module("app").service("getwiki",e),e.$inject=["$rootScope","$http","APP_API_KEY","GOOGLE_API_KEY","$cookies"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(i){delete t.defaults.headers.common["X-Dreamfactory-API-Key"],delete t.defaults.headers.common["X-DreamFactory-Session-Token"];for(var r="",l=e.neighborhoods.concat(e.districts),c=!1,d=0;d<l.length;d++)if(i.location.indexOf(l[d])>-1){c=!0;break}r=!c&&i.location.indexOf("San Diego")<0?i.location+" San Diego, CA":i.location,r=r.replace("#","");var g="https://maps.googleapis.com/maps/api/geocode/json?address="+r+"&key="+n;return t.get(g,{},{headers:{"Content-Type":"multipart/form-data"}}).then(function(n){i.location=n.data.results[0].formatted_address,i.lat=n.data.results[0].geometry.location.lat,i.lng=n.data.results[0].geometry.location.lng,t.defaults.headers.common["X-Dreamfactory-API-Key"]=a,t.defaults.headers.common["X-DreamFactory-Session-Token"]=s.session_token,void 0!=i.location&&null!=i.location&&void 0!=i.lat&&null!=i.lat&&void 0!=i.lng&&null!=i.lng&&(e.coordForUSer?(e.currentUserLatitude=i.lat,e.currentUserLongitude=i.lng,e.coordForUSer=!1,e.coordsRdy=!0,e.$emit("coordsRdy"),e.loadFbnWhenCoordsRdy&&o.go("rankSummary",{index:9521}),e.loadRankWhenCoordsRdy&&o.reload()):e.$emit("answerGPSready"))})}return{getLocationGPS:i}}angular.module("app").service("getgps",e),e.$inject=["$rootScope","$http","APP_API_KEY","GOOGLE_API_KEY","$cookies","$state"]}(),function(){"use strict";function e(e,t,a){function n(t,n,s){function i(e){return console.log("creating flag answer record was succesful"),e.data}var l={};l.user=a.user.id,l.number=n,l.type=t,l.flag=s,l.timestmp=Date.now();var c={};c.resource=[],c.resource.push(l);var d=r;return e.post(d,c,{headers:{"Content-Type":"multipart/form-data"},body:c}).then(i,o)}function s(){function t(e){return i=e.data.resource}var a=r;return e.get(a).then(t,o)}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/flagtable";return{flagAnswer:n,getFlags:s}}angular.module("app").factory("flag",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){this.uploadFileToUrl=function(t,a){delete e.defaults.headers.common["X-Dreamfactory-API-Key"],delete e.defaults.headers.common["X-DreamFactory-Session-Token"],delete e.defaults.headers.common.Accept,delete e.defaults.headers.common["Accept-Language"],delete e.defaults.headers.common["Accept-Encoding"],delete e.defaults.headers.common.Referer,delete e.defaults.headers.common.origin,delete e.defaults.headers.common.Connection;var n="https://rankx.file.core.windows.net/sandiego/est/"+t.name,s=(new Date).toUTCString();console.log("date in UTC format --- ",s);var o="x-ms-date:"+s+"\nx-ms-version:2015-02-21",i="/sandiego/est/"+t.name,r="PUT\n\nmultipart/form-data\n\n"+o+i;console.log("StringToSign",r);var l=CryptoJS.enc.Base64.parse("XvsnVKjNv25OVh37Z6UviHjw0DCfo0V5XTXpxqktR9PxHBw=="),c=CryptoJS.enc.Utf8.stringify(l.words),d=CryptoJS.enc.Utf8.parse(r),g=CryptoJS.HmacSHA256(d.sigBytes,c),u=CryptoJS.enc.Base64.stringify(g);return console.log("signature---",u),e.put(n,t,{headers:{"Content-Type":"multipart/form-data","x-ms-date":s,"x-ms-version":"2015-02-21",Authorization:"SharedKey rankx:"+u}}).success(function(e){console.log("Uploading file was succesful")}).error(function(e){console.log("There was a problem uploading your file")})}}angular.module("app").service("fileupload",e),e.$inject=["$http","$cookies","APP_API_KEY"]}(),function(){"use strict";function e(e,t){function a(t){function a(e){return console.log("result",e),e.data}console.log("file",t);var n=o+"/"+t.name;return e.post(n,t,{headers:{"Content-Type":"multipart/form-data"}}).then(a,s)}function n(a){function n(e){return e.data}var i=o+"/"+encodeURIComponent(a);return e.get(i,{params:{api_key:t}}).then(n,s)}function s(e){throw console.log("Error: ",e),e}var o="/api/v2/files/images";return{uploadFile:a,getFile:n}}angular.module("app").factory("file",e),e.$inject=["$http","APP_API_KEY"]}(),function(){"use strict";function e(e,t,a,n,s){function o(n){if(g()&&!n)return t.when(v);var s=h+"?offset=0",o=h+"?offset=1000",i=e.get(s),r=e.get(o);return t.all([i,r]).then(function(e){return v=e[0].data.resource.concat(e[1].data.resource),a.DEBUG_MODE&&console.log("No. events: ",v.length),v},m)}function i(a,n){function s(e){return p=e.data}if(u(a)&&!n)return t.when(p);var o=h+"/"+a;return e.get(o).then(s,m)}function r(t){function a(e){var a=t;return a.id=e.data.resource[0].id,v.push(a),e.data}var n=h,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,m)}function l(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating event succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"name":r.name=s[l];break;case"addinfo":r.addinfo=s[l];break;case"cityarea":r.cityarea=s[l];break;case"location":r.location=s[l];break;case"image":r.imageurl=s[l];break;case"views":r.views=s[l];break;case"owner":r.owner=s[l];break;case"website":r.website=s[l]}i.resource.push(r);for(var c=h,d=v.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"name":a.events[d].name=s[l];break;case"addinfo":a.events[d].addinfo=s[l];break
;case"cityarea":a.events[d].cityarea=s[l];break;case"location":a.events[d].location=s[l];break;case"image":a.events[d].imageurl=s[l];break;case"views":a.events[d].views=s[l];break;case"lat":a.events[d].lat=s[l];break;case"lng":a.events[d].lng=s[l];break;case"owner":a.events[d].owner=s[l];break;case"phone":a.events[d].phone=s[l];break;case"website":a.events[d].website=s[l];break;case"email":a.events[d].email=s[l];break;case"strhours":a.events[d].strhours=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,m)}function c(t,n){function s(e){return a.DEBUG_MODE&&console.log(" event flagged succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.flag=n,o.resource.push(i);var r=h;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,m)}function d(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting event was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=h+"/"+t,r=v.map(function(e){return e.id}).indexOf(t);return r>-1&&v.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,m)}function g(){return v.length>0}function u(e){return p&&p.id==e}function m(e){throw e}var p,v=[],h="/api/v2/mysql/_table/events";return{getevents:o,getevent:i,addevent:r,update:l,deleteEvent:d,flagEvent:c}}angular.module("app").factory("event",e),e.$inject=["$http","$q","$rootScope","catans","vrows"]}(),function(){"use strict";function e(e,t,a,n){function s(n){function s(e){return g=e.data.resource}if(c()&&!n)return t.when(g);var o=u+"/_table/editvotetable/?filter=user="+a.user.id;return e.get(o).then(s,d)}function o(t){function s(e){for(var s={},o=0;o<e.data.resource.length;o++)s=t[o],s.id=e.data.resource[o].id,g.push(s),a.ceditvotes.push(s),1==s.vote&&n.post("upVotedEdit",["answer","edit"],[s.answer,s.edit]),-1==s.vote&&n.post("downVotedEdit",["answer","edit"],[s.answer,s.edit]);return a.DEBUG_MODE&&console.log("Creating new voting record for edit was succesful"),e.data}var o={};o.resource=[],o.resource.push(t);var i=u+"/_table/editvotetable";return e.post(i,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(s,d)}function i(t,n){function s(e){return a.DEBUG_MODE&&console.log("Updating vote record for edit was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.vote=n,i.timestmp=Date.now(),o.resource.push(i);var r=u+"/_table/editvotetable",l=g.map(function(e){return e.id}).indexOf(t);return g[l].vote=n,g[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting edit vote records for answer was succesful"),e.data}for(var s=0;s<g.length;s++)g[s].answer==t&&g.splice(s,1);var o=u+"/_table/editvotetable?filter=answer="+t;return e.delete(o).then(n,d)}function l(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting edit vote records for answer was succesful"),e.data}for(var s=0;s<g.length;s++)g[s].edit==t&&g.splice(s,1);var o=u+"/_table/editvotetable?filter=edit="+t;return e.delete(o).then(n,d)}function c(e){return g.length>0}function d(e){throw e}var g=[],u="/api/v2/mysql";return{loadEditVotesTable:s,patchEditVoteRec:i,postEditVoteRec:o,deleteEditVotes:l,deleteEditVotesbyAnswer:r}}angular.module("app").factory("editvote",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a,n){function s(a){function n(e){return g=e.data.resource}if(c()&&!a)return t.when(g);var s=u;return e.get(s).then(n,d)}function o(t){function s(e){var s=t;return s.id=e.data.resource[0].id,g.push(s),n.post("editA",["answer","edit"],[s.answer,s.id]),a.DEBUG_MODE&&console.log("Adding new Edit succesful",e),e.data}var o=u,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,d)}function i(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating edit vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=n,r.downV=s,i.resource.push(r);var l=u;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,d)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting edit was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=u+"/"+t,r=g.map(function(e){return e.id}).indexOf(t);return r>-1&&g.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,d)}function l(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting edits for answer was succesful"),e.data}for(var s=0;s<g.length;s++)g[s].answer==t&&g.splice(s,1);var o=u+"?filter=answer="+t;return e.delete(o).then(n,d)}function c(){return g.length>0}function d(e){throw e}var g=[],u="/api/v2/mysql/_table/edittable";return{getEdits:s,addEdit:o,updateEdit:i,deleteEdit:r,deleteEditbyAnswer:l}}angular.module("app").factory("edit",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c){function d(e,t){BootstrapDialog.TYPE_PRIMARY,BootstrapDialog.show({title:e,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function g(e){d(t.dialogs["dialog."+e+".title"],t.dialogs["dialog."+e+".text"])}function u(e,t,a){var n="",s="",o="",i="";n="Please Confirm",o="Cancel",i="Confirm","image"==t&&(s="You want to change the image of <strong><em>"+e.name+"</em></strong> to this one: </br><img src="+e.imageURL+' class="thumbnail" style="width:60%; max-height:150px">'),"field"==t&&"addinfo"!=e.field&&(s='You want to change the <strong class="capitalize"><em>'+e.field+"</em></strong> of <strong><em>"+e.name+"</em></strong> to <strong><em>"+e.nval+"</em></strong>."),"field"==t&&"addinfo"==e.field&&(s="You want to change the information of <strong><em>"+e.name+"</em></strong> to: <br><br>"+e.nval+"</br>."),BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&a(e)}})}function m(e,a,n){for(var s="",o="",i=(t.cCategory.id,0);i<t.fields.length;i++){switch(t.fields[i].name){case"name":o='<strong class="capitalize">Name</strong>: '+e.name+"</br>";break;case"location":o=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":o='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>";break;case"addinfo":o=e.addinfo?'<strong class="capitalize">Additional Info</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"phone":o=e.phone?'<strong class="capitalize">Phone</strong>: '+e.phone+"</br>":"<strong>Phone</strong>: </br>";break;case"website":o=e.website?'<strong class="capitalize">Website</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>";break;case"email":o=e.email?'<strong class="capitalize">Email</strong>: '+e.email+"</br>":"<strong>Email</strong>: </br>"}s+=o}p(e,"",s,a,n)}function p(e,a,n,s,o){var i="",r="",l="",c="";i="Please Confirm",l="Cancel",c="Confirm",r="You want to add the following answer to <strong>"+t.cCategory.title+"</strong>. </br></br>"+n+"</br>With the following image:<img src="+s+' class="thumbnail" style="width:60%; max-height:150px">',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:i,message:r,closable:!0,draggable:!0,btnCancelLabel:l,btnOKLabel:c,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&o(e)}})}function v(e,t,a,n){var s="",o="";"approve"==a&&"addinfo"!=e.field&&(s="Changed Approved",o="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> gets approved."),"approve"==a&&"addinfo"==e.field&&(s="Changed Approved",o="Congrats! With your vote, the information of <strong>"+e.name+"</strong> to <br><br>"+e.nval+"</br> gets approved."),"reject"==a&&(s="Changed Rejected",o="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> has been rejected."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:s,message:o,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,s){n(t,a),e.close()}}]})}function h(e){var t="",a="";"editAnswer"==e&&(a="Information Edits",t="Use edits to correct, add or update information in a profile. All edits need to be accepted by other users before they are approved. </br></br>An edit or change becomes approved when the number of people that agree exceeds the number of people that disagree by 3. </br></br>An edit or change gets rejected when the number of people that disagree exceeds those that agree by 3. </br></br> Only one edit per field at a time is allowed. Make sure you vote on the edits you agree or disagree."),"addAnswer"==e&&(a="Add a new answer",t="1. Fill out the form. The fields marked with ** are required. All other fields are not required but recommended. <br/><br/>2. Click the 'Get Images' button. <br/><br/>3. Use '>>' and '<<' buttons to browse through the images. You can 'Get More Images' button to load more images.<br/><br/>4. When the image you want shows in the image box, click the button 'Add' to add the new answer to the list.<br/><br/>NOTE: Not all images will correspond to your answer. Entering all fields will help with the image results."),"shortPhrase"==e&&(a="Add an Answer",t="Fill out the form. The fields marked with ** are required. <br/><br/> - The <strong>Title</strong> is the main idea of your answer. <br/><br/> - In the <strong>Details</strong> box, write additional details about your answer. You can also write arguments on why it should be included in this list.<br/><br/>For example: <br/><br/>In the rank <strong><em>Reasons why dogs are awesome</em></strong> you can add following answer: <br/><br/><strong>Title:</strong> They enjoy the simple things in life <br/><br/><strong>Details:</strong> Dogs dont need much to be happy, they are happy with simple things like a belly rub, a walk around the block, playing in the snow or going for a drive."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function f(e){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Image URL",message:e,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function b(e,a,n,s){for(var o="",i="",r="",l="",c=0;c<t.fields.length;c++){switch(t.fields[c].name){case"name":r='<strong class="capitalize">Name</strong>: '+e.name+"</br>",l='<strong class="capitalize">Name</strong>: '+a.name+"</br>";break;case"location":r=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>",l=a.location?'<strong class="capitalize">Location</strong>: '+a.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":r='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>",l='<strong class="capitalize">City Area</strong>: '+a.cityarea+"</br>";break;case"addinfo":r=e.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>",l=a.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+a.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"phone":r=e.phone?'<strong class="capitalize">Phoneb</strong>: '+e.phone+"</br>":"<strong>Phone</strong>: </br>",l=a.phone?'<strong class="capitalize">Phoneb</strong>: '+a.phone+"</br>":"<strong>Phone</strong>: </br>";break;case"website":r=e.website?'<strong class="capitalize">Websiteb</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>",l=a.website?'<strong class="capitalize">Websiteb</strong>: '+a.website+"</br>":"<strong>Website</strong>: </br>";break;case"email":r=e.email?'<strong class="capitalize">Emailb</strong>: '+e.email+"</br>":"<strong>Email</strong>: </br>",l=a.email?'<strong class="capitalize">Emailb</strong>: '+a.email+"</br>":"<strong>Email</strong>: </br>"}o+=r,i+=l}y(e,o,a,i,n,s)}function y(e,a,n,s,o,i){var r="",l="",c="",d="";r="Just checking",c="No, they are different",d="Yeah, same",l="Are these the same "+t.cCategory.type+'? </br></br><div class="row"><div class="col-sm-6">'+a+"</br><img src="+e.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div><div class="col-sm-6">'+s+"</br><img src="+n.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div></div>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:r,message:l,closable:!0,draggable:!0,btnCancelLabel:c,btnOKLabel:d,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t?i():o(e)}})}function w(e,a){var n="",s="",o="",i="";n="Scope of Delete",o="Just in the category: "+t.cCategory.title,i="Everywhere",s="Choose scope to delete:",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t?a():e()}})}function k(e,t,a){var n="",s="",o="",i="";n="Confirm Delete",o="Cancel",i="Delete",s="This will delete the CatAns record for <strong>"+e+"</strong> in the category of <strong>"+t+"</strong>.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&a()}})}function x(e,t){var a="",n="",s="",o="",i="";if(a="Special Preview",s="Back",o="Save Special","weekly"==e.freq&&(i="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"")+"<br>From: "+e.stime2+" to "+e.etime2),"onetime"==e.freq){i=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:"Starts: "+e.sdate+" at "+e.stime+"<br>Ends: "+e.edate+" at "+e.etime}n='This is how this special will look: </br></br>In the ranking summary:<br><table class="table table-hover cursor "><thead><tr><th>Rank</th><th>Name</th><th>Distance</th><th>Specials</th></tr></thead><tbody><tr><td>1</td><td>'+e.name+'</td><td>1.5</td><td style="background-color:'+e.bc+";color:"+e.fc+';">'+e.stitle+'<td></tr></tbody></table><br>Inside your business profile:<br><br><div style="background-color:'+e.bc+";color:"+e.fc+';"><p><strong>'+e.stitle+" @ "+e.name+"</strong></p><p>"+i+"</p><p>"+e.details+"</p></div></br>With the following image:<img src="+e.image+' class="thumbnail" style="width:70%; max-height:150px">',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function D(e,t,a){var n="",s="",o="",i="";n="Yes, Delete",o="Cancel",i="Delete",s=a?"Just confirming, do you want to delete the special <strong>"+e.stitle+"</strong>?":"Just confirming, do you want to delete the ranking <strong>"+e.title+"</strong>?",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function C(e){var t="",a="",n="",s="";t="Share Location",n="Not Now",s="Ok",a="Please allow browser share location so we can calculate distance to the best places.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:t,message:a,closable:!0,draggable:!0,btnCancelLabel:n,btnOKLabel:s,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&e()}})}function S(e){var t="",a="",n="",s="";t="Do you own this business?",n="Cancel",s="Bind",a="If you own or represent this business, please bind to your account so only you can change or edit its information.<br><br><strong>* Name of Business</strong><br><strong>* Address</strong><br><strong>* Phone Number</strong><br><strong>* Main Photo</strong><br><strong>* Hours</strong><br><br>Binding this business to your account is free.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:t,message:a,closable:!0,draggable:!0,btnCancelLabel:n,btnOKLabel:s,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&e()}})}function O(e,t,a){var n="",s="",o="",i="";n="Confirmation",o="Cancel",i="Yes, bind this business to my account",s="<br><strong>Note:</strong> Claiming to have false authority over a business is against the law.<br><br>Please confirm:<br><br>You, <strong>"+e+"</strong>, have the authority to represent <strong>"+t+"</strong>.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&a()}})}function E(e,t){var a="",n="";a="Enter Data",n="<br> Enter new vote row to be added in Group: <strong>"+e.gtitle+'</strong><br><br>Vote Row Name:<input class="form-control" type="text" placeholder="Enter Vote Row Name"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:n,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"OK",action:function(a,n){var s=a.getModalBody().find("input").val();n&&t(e,s),a.close()}}]})}function P(e,t){var a="",n="",s="",o="";a="Please Confirm",s="Cancel",o="Yes, Delete",n="<br>Please confirm, you want to delete vote row <strong>"+e.title+"</strong> from <strong>"+e.gtitle+"</strong>.<br><br><strong>Note:</strong> All vote records will be lost",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(a){a&&t(e)}})}function R(e,t){var a="",n="";a="Enter Data",n='<br>Enter name of Vote Group you want to create: <br><br>Group Name:<input class="form-control" type="text" placeholder="Enter Vote Row Group Name"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:n,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"OK",action:function(a,n){var s=a.getModalBody().find("input").val();n&&t(e,s),a.close()}}]})}function A(e,t,a){var n="",s="";n="Enter Data",s='<br>Enter new name of Vote Group: <br><br>Group Name:<input class="form-control" type="text" placeholder="'+e.gtitle+'"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:s,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"Edit",action:function(a,n){var s=a.getModalBody().find("input").val();n&&t(e,s),a.close()}},{label:"Delete",action:function(t,n){n&&a(e),t.close()}}]})}function M(e,t){var a="",n="",s="",o="";a="Please Confirm",s="Cancel",o="Yes, Delete",n="<br>Please confirm, you want to delete the vote group <strong>"+e.gtitle+"</strong> and all the items within it.<br><br><strong>Note:</strong> All vote records for all items will be lost",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(a){a&&t(e)}})}function I(e,a){for(var n="",s="",o=0;o<t.fields.length;o++){switch(t.fields[o].name){case"name":s='<strong class="capitalize">Name</strong>: '+e.name+"</br>";break;case"location":s=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":s='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>";break;case"addinfo":s=e.addinfo?'<strong class="capitalize">Additional Info</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"website":s=e.website?'<strong class="capitalize">Website</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>";break;case"date":s=e.date?'<strong class="capitalize">Date</strong>: '+e.sdate+"</br>":"<strong>Date</strong>: </br>"}n+=s}var i="",r="";if("weekly"==e.freq&&(r="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"")+"<br>From: "+e.stime2+" to "+e.etime2),"onetime"==e.freq){r=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:(void 0==e.edate?"":"Starts: ")+e.sdate+" at "+e.stime+(void 0==e.edate?"":"<br>Ends: "+e.edate+" at "+e.etime)}i='<div style="background-color:'+e.bc+";color:"+e.fc+';"><p><strong>'+e.name+(void 0!=e.location?" @ "+e.location:"")+"</strong></p>"+(void 0!=e.cityarea?"<p>in "+e.cityarea+"</p>":"")+"<p>"+r+"</p>"+(void 0!=e.addinfo?"<p>"+e.addinfo+"</p>":"")+(void 0!=e.website?'<p>For more information: <a href="'+e.website+'">'+e.website+"</a></p>":"")+"</div>",_(e,n,i,e.imageurl,a)}function _(e,a,n,s,o){var i="",r="",l="",c="";i="Please Confirm",l="Cancel",c="Confirm",r="You want to add the following event to <strong>"+t.cCategory.title+"</strong>. </br><p></p>"+n+"</br>With the following image:<img src="+s+' class="thumbnail" style="width:60%; max-height:150px">',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:i,message:r,closable:!0,draggable:!0,btnCancelLabel:l,btnOKLabel:c,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&o(e)}})}function T(){var e="",a="",n="";e="Please Confirm",a='<div class="text-left">Is it ok if we locate your position?</div><br><div class="row"><div class="container col-xs-12"><div class="text-left" style="color:blue">Option 1</div><div class="text-center" style="border:2px"><button class="btn btn-success" id="useGeo">Yes, locate me using geolocation</button></div><br><div class="text-left" style="color:blue">Option 2 <small>(recommended for accuracy)</small></div><br><p>Yes, use this address as my current location</p><div class="input-group"><input id="address" type="text" class="form-control" placeholder="Enter address"><span class="input-group-btn text-right"><button class="btn btn-success" type="button" id="gobutton">Go</button></span></div><br><br></div><div class="container col-xs-12"><div class="text-center" style="border:2px"><button class="btn btn-default" id="noapprove">No, I don\'t approve</button></div></div></div>',n='<div class="loading-pulse"></div><p>Just a moment, finding your location...</p>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:function(e){var s=$(a);return s.find("#useGeo").click({},function(){if(t.isFacebookApp)g("FacebookAppNotSupported");else{var a=e;t.$emit("getLocation"),a.enableButtons(!1),a.setClosable(!1),a.getModalBody().html(n),a.setTitle("Please wait"),setTimeout(function(){a.close()},1e4)}}),s.find("#gobutton").click({},function(){var a=s.find("input").val(),n=e;t.$emit("useAddress",{address:a}),n.close()}),s.find("#noapprove").click({},function(){e.close()}),s},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function L(e){var n="",s="";n="Missing info",s='<div class="text-left">Let\'s stay in touch. Please provide us an email address where we can keep you updated on everything related to the <strong>'+e+'</strong> account.</div><br><div class="input-group"><input id="email" type="text" class="form-control" placeholder="Enter email address"><span class="input-group-btn text-right"><button class="btn btn-primary" type="button" id="gobutton">Submit</button></span></div><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:function(e){var n=$(s);return n.find("#gobutton").click({},function(){var s=n.find("input").val(),o=e;t.showWarning=!1,a.updateuseraccnt(t.useraccnts[0].id,["email"],[s]),o.close(),t.$emit("hideWarning")}),n},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function B(e,a,n,s){var o="",i="",r=a,l=e.length,c="";c=(t.sm,"width:100%;height:auto"),o="Photos - "+n.name;var d="",g="",u="",m="",p="";s?(d='<div class="row"><div class="text-left col-xs-3 col-md-4"><button class="btn btn-default pull-left" id="prevbutton">&lt;&lt</button></div><div class="text-middle col-xs-5 col-md-4"><button class="btn btn-default" id="makeprimary">Make Main Photo</button></div><div class="text-right col-xs-4 col-md-4"><button class="btn btn-default pull-right" id="nextbutton">&gt;&gt</button></div></div>',m='<div class="text-right"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" id="trashbutton"><span class="glyphicon glyphicon-trash" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></div><br/>'):(d='<div class="row"><div class="text-left col-xs-6"><button class="btn btn-default pull-left" id="prevbutton">&lt;&lt</button></div><div class="text-right col-xs-6"><button class="btn btn-default pull-right" id="nextbutton">&gt;&gt</button></div></div>',m="<br/>"),g='<br><div class="text-center"><img id="image" class="displayed" src="',u='" style="'+c+'"></div><p>Photo from &nbsp<strong id="source">'+e[r].type+"</strong></p></br><br/>",p=void 0!=e[r].from?'<p id="credit">Photo by:&nbsp<strong>@'+e[r].from+'</strong></p></br><p id="caption">'+(e[r].caption?e[r].caption:"")+"</p>":'<p id="credit"></p><p id="caption"></p>';i=d+g+e[r].url+u+m+p,BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:o,message:function(t){var a=$(i),s=t;return a.find("#prevbutton").click({},function(){r-=1,r<0&&(r=l-1),a.find("#image").attr("src",e[r].url),a.find("#source").html(e[r].type),void 0!=e[r].from?$("#credit").html("Photo by:&nbsp<strong>@"+e[r].from+"</strong></br>"):$("#credit").html(""),void 0!=e[r].caption?$("#caption").html(e[r].caption):$("#caption").html("")}),a.find("#nextbutton").click({},function(){r+=1,r>=l&&(r=0),a.find("#image").attr("src",e[r].url),a.find("#source").html(e[r].type),void 0!=e[r].from?$("#credit").html("Photo by:&nbsp<strong>@"+e[r].from+"</strong></br>"):$("#credit").html(""),void 0!=e[r].caption?$("#caption").html(e[r].caption):$("#caption").html("")}),a.find("#trashbutton").click({},function(){U(e,r,n),s.close()}),a.find("#makeprimary").click({},function(){N(e,r,n),s.close()}),a},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function U(e,a,s){var o="",i="",r="",l="";o="Please Confirm",r="Cancel",l="Yes, Delete",i='<br>Please confirm, you want to delete this photo: <br/><img id="image" class="displayed" src="'+e[a].url+'" style="width:100%;height:auto"><br><br>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:o,message:i,closable:!0,draggable:!0,btnCancelLabel:r,btnOKLabel:l,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(o){if(o)if(console.log(e),"Instagram"==e[a].type){var i=s.ig_image_urls.indexOf(e[a].url);-1!=i&&(s.ig_image_urls=s.ig_image_urls.substr(0,i-1)+s.ig_image_urls.substr(i+e[a].url.length),X(s.id,s.ig_image_urls).then(function(e){t.$emit("refreshImages")}))}else n.deleteBlob(e[a].url)}})}function N(e,t,a){var n="",o="",i="",r="";n="Please Confirm",i="Cancel",r="Yes, make primary",o='<br>Please confirm, you want to make this the primary photo: <br/><img id="image" class="displayed" src="'+e[t].url+'" style="width:100%;height:auto"><br><br>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:o,closable:!0,draggable:!0,btnCancelLabel:i,btnOKLabel:r,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(n){if(n){var o=e[t].url;s.updateAnswer(a.id,["image"],[o])}}})}function V(){var e="",a="";e="Login required",a="You must be logged in to add answers, endorse establishments and participate in the rankings.</br></br>Do you want to log in?",BootstrapDialog.show({title:e,message:a,buttons:[{label:"Not now",action:function(e){e.close()}},{icon:"fa fa-facebook",label:"Login",cssClass:"btn-primary",action:function(e){t.stateName=l.current.name,"rankSummary"==t.stateName?t.stateNum=t.cCategory.id:"answerDetail"==t.stateName?t.stateNum=t.canswer.id:t.stateNum=void 0,o.facebookSDKLogin().then(function(){e.close(),l.go(l.current,{},{reload:!0})})}}]})}function F(e,t,a,n,s){var o="",i="";o="Share Options",i='<div class="row"><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485385043_mail.png" id="email" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485384809_2_-_Facebook.png" id="facebook" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485384868_1_-_Twitter.png" id="twitter" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485384841_13_-_Pintrest.png" id="pinterest" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485384824_6_-_Google_Plus.png" id="gplus" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485384853_5_-_Tumbler.png" id="tumblr" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><img src="/assets/images/1485425301_reddit.png" id="reddit" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><a href="#" socialshare socialshare-provider="whatsapp" socialshare-text="'+n+'" socialshare-url="'+a+'"><img src="/assets/images/1485384832_16_-_Whatsapp.png" id="whatsapp" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><a href="#" socialshare socialshare-provider="facebook-messenger" socialshare-url="'+a+'"><img src="/assets/images/1485385110_Facebook_Messenger.png" id="messenger" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center"><a href="#" socialshare socialshare-provider="sms" socialshare-text="'+n+'" socialshare-url="'+a+'"><img src="/assets/images/1485385026_sms.png" id="sms" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div></div>';var r=c(i)(s);BootstrapDialog.show({title:o,message:function(t){var a=$(r),n=t;return a.find("#twitter").click({},function(){e("twitter"),n.close()}),a.find("#facebook").click({},function(){e("facebook"),n.close()}),a.find("#email").click({},function(){e("email"),n.close()}),a.find("#pinterest").click({},function(){e("pinterest"),n.close()}),a.find("#gplus").click({},function(){e("gplus"),n.close()}),a.find("#reddit").click({},function(){e("reddit"),n.close()}),a.find("#tumblr").click({},function(){e("tumblr"),n.close()}),a.find("#whatsapp").click({},function(){n.close()}),a.find("#messenger").click({},function(){n.close()}),a.find("#sms").click({},function(){n.close()}),a},buttons:[{label:"Cancel",action:function(e){e.close()}}]})}function G(){var e="",t="",a=1,n="";n="width:100%;max-width:450px;height:auto;margin-left:auto;margin-right:auto;",e="Rank-X Intro Tour";var s="";s='<img id="image" class="displayed" src="/assets/images/rxtour1.png" style="'+n+'">',t=s,BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:t,closable:!0,draggable:!0,buttons:[{id:"btn1",
label:"No, thanks",action:function(e,t){1==a?(r.put("tourviewed",!0),e.close()):(a-=1,1==a?($("#btn1").text("No, thanks"),$("#btn2").text("Yes, take tour")):12==a?($("#btn1").text("Back"),$("#btn2").text("Close"),r.put("tourviewed",!0)):($("#btn1").text("Back"),$("#btn2").text("Next")),s='<img id="image" class="displayed" src="/assets/images/rxtour'+a+'.png" style="'+n+'">',e.setMessage(s))}},{id:"btn2",label:"Yes, take tour",action:function(e,t){12==a?(r.put("tourviewed",!0),e.close()):(12==a?e.getButton(this.id).label="Close":(a+=1,1==a?($("#btn1").text("No, thanks"),$("#btn2").text("Yes, take tour")):12==a?($("#btn1").text("Back"),$("#btn2").text("Close"),r.put("tourviewed",!0)):($("#btn1").text("Back"),$("#btn2").text("Next"))),s='<img id="image" class="displayed" src="/assets/images/rxtour'+a+'.png" style="'+n+'">',e.setMessage(s))}}]})}function q(e,t){var a="",n="",s="",o="";a="Confirm Unbind",s="Cancel",o="Yes, Unbind",n="Just confirming, do you want to unbind <strong>"+e.name+"</strong> from your account?",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function j(e,t,a){var n="",s="",o="",i="";"Premium"==t&&(i="Cancel Premium Membership",s="Do you want to cancel your Premium Membership for <strong>"+e.name+"</strong>?"),"Ranks"==t&&(i="Cancel All Custom Ranks",s="Do you want to cancel all of your Custom Ranks for <strong>"+e.name+"</strong>?"),"All"==t&&(i="Cancel All Subscriptions",s="Do you want to cancel all of your Subscriptions for <strong>"+e.name+"</strong>?"),n="Please confirm",o="Back",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"default",btnCancelAction:function(e){e.close()},callback:function(e){e&&a()}})}function z(e,t){var a="Buy or Cancel Custom Ranks",n="",s=1,o=e.ranksQty,i="purchase",r="You have selected to <strong>purchase "+s+"</strong> Custom Ranks.<br><br>If purchasing Custom Ranks you will be ask for your payment info after clicking the Purchase button.",n="<p>You are currently subscribed to <strong>"+o+'</strong> Custom Ranks.</p><br><p class="text-left">Select what you want to do.</p><br><div class="radio"><label><input type="radio" value="0" checked name="radiogrp">PURCHASE CUSTOM RANKINGS</label></div><div class="radio"><label><input type="radio" value="1" name="radiogrp">CANCEL CUSTOM RANKINGS</label></div><br><div class="row"><div class="col-xs-7"><p class="text-right">Select quantity:</p></div><div class="col-xs-5"><div class="input-group"><span class="input-group-btn"><button class="btn btn-primary" id="btn_minus"><i class="fa fa-minus"></i></button></span><input style="text-align:center" id="numRanks" class="form-control" type="text" placeholder="'+s+'"><span class="input-group-btn"><button class="btn btn-primary" id="btn_plus"><i class="fa fa-plus"></i></button></span></div></div></div><br><p class="text-left" id="mytext">'+r+"</p>";a="Please confirm",BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:function(e){var t=$(n),a="",r="<br><br>If purchasing Custom Ranks you will be ask for your payment info after clicking the Purchase button.",l="<br><br>Your Custom Ranks will be active until last day of your subscription.";return t.find("#btn_minus").click({},function(){s-=1,s<1&&(s=1),t.find("#numRanks").val(s),"purchase"==i?(a="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r,$("#btn2").text("Purchase "+s+" Custom Rankings")):(a="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l,$("#btn2").text("Cancel "+s+" Custom Rankings")),$("#mytext").html(a)}),t.find("#btn_plus").click({},function(){s+=1,s>10&&(s=10),"cancel"==i&&s>=o&&(s=o),t.find("#numRanks").val(s),"purchase"==i?(a="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r,$("#btn2").text("Purchase "+s+" Custom Rankings")):(a="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l,$("#btn2").text("Cancel "+s+" Custom Rankings")),$("#mytext").html(a)}),t.find("input[type=radio][name=radiogrp]").change(function(){s=1,0==this.value?(i="purchase",$("#btn2").text("Purchase "+s+" Custom Rankings"),a="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r):1==this.value&&(i="cancel",$("#btn2").text("Cancel "+s+" Custom Rankings"),a="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l),t.find("#numRanks").val(s),$("#mytext").html(a)}),t},closable:!0,draggable:!0,buttons:[{id:"btn1",label:"Back",action:function(e){e.close()}},{id:"btn2",label:"Purchase "+s+" Custom Rankings",action:function(e,a){t(i,s),e.close()}}]})}function Y(e,t,a,n){var s="",o="";s="Edit Information",o="<p>Please verify the information is correct.</p>";for(var i=0;i<e.length;i++)o=o+'<div class="input-group"><label class="input-group-addon">'+t[i]+':</label><input type="text" class="form-control" id="'+e[i]+'" value="'+a[i]+'"></div>';BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:s,message:function(e){return $(o)},closable:!0,draggable:!0,btnCancelLabel:"Cancel",btnOKLabel:"Save",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()},buttons:[{id:"btn1",label:"Cancel",action:function(e){e.close()}},{id:"btn2",label:"Save",action:function(t,a){for(var s=[],o="",i=0;i<e.length;i++)o=t.getModalBody().find("#"+e[i])[0].value,s.push(o);n(s),t.close()}}]})}function W(e,t,a){var e=e,t=t;BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){a(),e.close()}}]})}function H(e){var t="";"Establishment"==e&&(t="establishment"),"Person"==e&&(t="person"),"Place"==e&&(t="place"),"Organization"==e&&(t="organization"),"PersonCust"==e&&(t="person"),"Event"==e&&(t="event"),"Thing"==e&&(t="item"),"Short-Phrase"==e&&(t="answer");var a="Switch to Vote Mode to Vote! <br><br>Your endorsements make the rankings! <br><br>Give a <strong>thumb up</strong> if you <strong>endorse</strong> this "+t+" in each ranking; a <strong>thumb down</strong> if you <strong>do not endorse</strong>.";BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Endorse!",message:a,buttons:[{id:"btn-ok",label:"Got it",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function K(e,t){var a="",n="";a="Password Required",n='<br> Please enter access password:<br><br><input class="form-control" type="text" placeholder="Enter password"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:n,closable:!1,draggable:!0,buttons:[{id:"btn1",label:"Cancel",action:function(e){t(),e.close()}},{id:"btn2",label:"Go",action:function(a){"S@nDieg0"==a.getModalBody().find("input").val()?e():(t(),g("wrongPassword")),a.close()}}]})}function X(e,t){return s.updateAnswer(e,["ig_image_urls"],[t])}function Q(e,a,n){var s="",o="",i=(e.length,"");i=(t.sm,"width:100%;height:auto"),s="My Instagram Photos";var r="",l="",c="",d="";r='<div class="row"></div>',d='<div class="text-right"></div><br/>';var g="";l='<img id="image" class="displayed col-xs-3 thumbnail" src="',c='" style="'+i+'">',g='<div class="row">';for(var u=0;u<e.length;u++)if("image"==e[u].type){g+='<div class="col-xs-6 col-md-4" style="position:relative">',g+=l+e[u].images.low_resolution.url+c;var m=0;-1!=a.ig_image_urls.indexOf(e[u].images.low_resolution.url)&&(m=.7),g+='<div id="add_photo" style="background-color: grey;opacity:'+m+';position: absolute;left: 19px;right: 19px;top: 4px;bottom: 24px;border-radius: 5px;display: flex;align-items: center;">',g+='<i class="fa fa-check-circle-o" aria-hidden="true" style="color: #2d6c38;font-size: 100px;margin: auto" ></i>',g+="</div>",g+="</div>"}g+="</div>",o=r+g+d,BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"instagram-image-dialog",title:s,message:function(e){var n=$(o);return n.find("#add_photo").click({},function(){console.log(a.ig_image_urls);var e=$(this).parent().children("#image").attr("src");if(-1!=a.ig_image_urls.indexOf(e)){var n=this,s=a.ig_image_urls.indexOf(e);-1!=s&&(a.ig_image_urls=a.ig_image_urls.substr(0,s-1)+a.ig_image_urls.substr(s+e.length),X(a.id,a.ig_image_urls).then(function(e){t.$emit("refreshImages"),$(n).css("opacity",0)}))}else{var n=this;a.ig_image_urls+=";"+e,X(a.id,a.ig_image_urls).then(function(e){t.$emit("refreshImages"),$(n).css("opacity",.7)})}}),n},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function J(){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Ranking Question",message:'The <strong>Ranking Question</strong> is what you ask users when comparing two items in the rank. It is the question to determine which item deserves the higher ranking.<br><br>For example, if ranking the "Hamburgers in Pacific Beach", the <strong>Ranking Question</strong> would be "Who makes the better burgers?".<br><br>The Ranking Question is shown in the Rank Console, when users rank their endorsements.<br><br><img style="width:100%;height:auto" src="/assets/images/whatisrankquestion.png">',buttons:[{id:"btn-ok",label:"Got it",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function Z(e,t){for(var a="<div class='row'>",n=0;n<e.length;n++)a+='<div class="col-xs-3 col-md-3 text-center">',a+='<img src="'+e[n].picture.data.url+'" class="img-responsive img-circle profile-avatar" style="width: 100%;height: 100%;"/>',a+="<span>"+e[n].first_name+" "+e[n].last_name+"</span>",a+="</div>";a+="</div>",BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"fav-list-user-image-dialog",title:"My Friends that like "+t,message:function(e){var t=$(a);return t},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function ee(e,t){var a='<div class="row"> <div class="col-xs-12"> <tr ng-repeat-end> <td colspan=3> <table class="table" > <thead style="border-style:none;"> <tr>    <th style="width:45%" text-align="center">Subscription</th>    <th style="width:15%" text-align="center">Commission</th> </tr> </thead> <tbody> ';e.ispremium&&(a+='<tr style="cursor:pointer;">   <td style="width:45%">Premium Membership</td>    <td style="width:15%">'+e.price*t+"</td></tr>"),e.hasranks&&(a+='<tr style="cursor:pointer;"><td style="width:45%">'+e.ranksqty+' Custom Ranks</td><td style="width:15%">$'+35*e.ranksqty*t+"</td></tr>"),a+='                <tr>                    <td style="width:45%">Total</td>                    <td style="width:15%; background-color: darkgray;">$'+e.totalCommission+"</td>                </tr>            </tbody>        </table>    </td></tr></div></div>",BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"admin-payment-business-detail-dialog",title:e.answerObj.name+" Details",message:function(e){var t=$(a);return t},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function te(e,t){var a='<div class="row"> <div class="col-xs-12"> <div class="form-group">    <label for="commission-percent">Please Type Commission Percentage.</label>     <div class="col-xs-11"><input type="commission-percent" class="form-control" id="commission-percent" value="'+100*e+'"> </div>    <div class="col-xs-1" style="padding: 10px;padding-left: 0px;"><span>%</span></div></div>';BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"change-commission-percentage-dialog",title:"Change Commmission",message:function(e){var t=$(a);return t},buttons:[{label:"Close",action:function(e){e.close()}},{label:"OK",action:function(e,a){var n=e.getModalBody().find("input").val();a&&t(n),e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}return{editConfirm:u,getDialog:g,showDialog:d,howItWorks:h,addAnswer:m,showAddAnswer:p,editChangeEffective:v,checkSameAnswer:b,showSameAnswer:y,deleteType:w,deleteThisCatans:k,deleteRank:D,getLocation:C,url:f,createSpecialPreview:x,bizRegistration:S,bindAccount:O,addVRow:E,deleteVRow:P,addVRowGroup:R,editVRowGroup:A,deleteVRowGroup:M,showAddEvent:_,createEventPreview:I,askPermissionToLocate:T,askEmail:L,seePhotos:B,loginFacebook:V,shareOptions:F,tour:G,unbindAccount:q,confirmCancel:j,editNumRanks:z,editInfo:Y,notificationWithCallback:W,enterPassword:K,endorse:H,chooseImgFromIgDlg:Q,showAllFriendsListDlg:Z,showBusinessDetailDlg:ee,whatisrankquestion:J,changeCommissionDlg:te}}angular.module("app").factory("dialog",e),e.$inject=["$q","$rootScope","useraccnt","imagelist","answer","login","$window","$cookies","$state","$compile"]}(),function(){"use strict";function e(e,t,a,n,s){function o(t,a){if(!a.commLoaded){if(a.commLoaded=!0,e.isLoggedIn&&(a.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),a.bc=c.bc,a.fc=c.fc),"answer"==t)return s.getcomments().then(function(e){function t(e){return e<10?"0"+e:e}a.comments=e;for(var n=0;n<a.comments.length;n++){a.comments[n].initials=a.comments[n].username.replace(/[^A-Z]/g,"");var s=new Date,o=s.getTimezoneOffset(),i=a.comments[n].timestmp.split(/[- :]/),l=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]);l.setMinutes(l.getMinutes()-o);var d=l.getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear(),g=l.getHours(),u=g>12?g%12+":"+t(l.getMinutes())+" PM":g+":"+t(l.getMinutes())+" AM";a.comments[n].date=d+" "+u,r(a.comments[n].user,c),a.comments[n].bc=c.bc,a.comments[n].fc=c.fc}});if("category"==t)return n.getcomments().then(function(e){function t(e){return e<10?"0"+e:e}a.comments=e;for(var n=0;n<a.comments.length;n++){a.comments[n].initials=a.comments[n].username.replace(/[^A-Z]/g,"");var s=new Date,o=s.getTimezoneOffset(),i=a.comments[n].timestmp.split(/[- :]/),l=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]);l.setMinutes(l.getMinutes()-o);var d=l.getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear(),g=l.getHours(),u=g>12?g%12+":"+t(l.getMinutes())+" PM":g+":"+t(l.getMinutes())+" AM";a.comments[n].date=d+" "+u,r(a.comments[n].user,c),a.comments[n].bc=c.bc,a.comments[n].fc=c.fc}})}}function i(o,i){var l={};l.body=i.newComment,l.username=e.user.name,l.user=e.user.id,l.picture=e.user.picture.data.url,l.timestmp=Date.now(),i.newComment="","category"==o&&(l.category=e.cCategory.id,n.addcomment(l).then(function(){l.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),l.fc=c.fc,l.bc=c.bc,l.date="Just now",i.comments.push(l),t.update(e.cCategory.id,["numcom"],[i.comments.length])})),"answer"==o&&(l.answer=e.canswer.id,s.addcomment(l).then(function(){l.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),l.fc=c.fc,l.bc=c.bc,l.date="Just now",i.comments.push(l),a.updateAnswer(e.canswer.id,["numcom"],[i.comments.length])}))}function r(e,t){switch(e%10){case 0:t.bc="#b3b3b3",t.fc="black";break;case 1:t.bc="#666666",t.fc="white";break;case 2:t.bc="#006bb3",t.fc="white";break;case 3:t.bc="#009933",t.fc="white";break;case 4:t.bc="#cc0000",t.fc="white";break;case 5:t.bc="#538cc6",t.fc="black";break;case 6:t.bc="#b36b00",t.fc="white";break;case 7:t.bc="#999966",t.fc="black";break;case 8:t.bc="#4d0099",t.fc="white";break;case 9:t.bc="#009999",t.fc="black"}}var l={loadComments:o,postComment:i,getIconColors:r},c={};return c.bc="",c.fc="",l}angular.module("app").service("commentops",e),e.$inject=["$rootScope","table","answer","comment","comment2"]}(),function(){"use strict";function e(e,t,a,n){function s(t){function n(e){return d=e.data.resource}var s=g+"/?filter=answer="+a.canswer.id;return e.get(s).then(n,c)}function o(t){function s(e){return t.id=e.data.resource[0].id,n.post("commentA",["answer"],[t.answer]),a.DEBUG_MODE&&console.log("Adding new comment succesful",e),e.data}var o=g,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,c)}function i(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating comment vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=n,r.downV=s,i.resource.push(r);var l=g;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,c)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting comment was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=g+"/"+t,r=d.map(function(e){return e.id}).indexOf(t);return r>-1&&d.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,c)}function l(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting comments for answer was succesful"),e.data}for(var s=0;s<d.length;s++)d[s].user==t&&d.splice(s,1);var o=g+"?filter=user="+t;return e.delete(o).then(n,c)}function c(e){throw e}var d=[],g="/api/v2/mysql/_table/comments2";return{getcomments:s,addcomment:o,updatecomment:i,deletecomment:r,deletecommentsbyuser:l}}angular.module("app").factory("comment2",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a,n){function s(t){function n(e){return d=e.data.resource}var s=g+"/?filter=category="+a.cCategory.id;return e.get(s).then(n,c)}function o(t){function s(e){return t.id=e.data.resource[0].id,n.post("commentR",["category"],[t.category]),a.DEBUG_MODE&&console.log("Adding new comment succesful",e),e.data}var o=g,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,c)}function i(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating comment vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=n,r.downV=s,i.resource.push(r);var l=g;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,c)}function r(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting comment was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=g+"/"+t,r=d.map(function(e){return e.id}).indexOf(t);return r>-1&&d.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,c)}function l(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting comments for answer was succesful"),e.data}for(var s=0;s<d.length;s++)d[s].user==t&&d.splice(s,1);var o=g+"?filter=user="+t;return e.delete(o).then(n,c)}function c(e){throw e}var d=[],g="/api/v2/mysql/_table/comments";return{getcomments:s,addcomment:o,updatecomment:i,deletecomment:r,deletecommentsbyuser:l}}angular.module("app").factory("comment",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,a,n){function s(n){if(g()&&!n)return t.when(m);var s=p+"?offset=0",o=p+"?offset=1000",i=p+"?offset=2000",r=p+"?offset=3000",l=p+"?offset=4000",c=p+"?offset=5000",d=p+"?offset=6000",v=p+"?offset=7000",h=e.get(s),f=e.get(o),b=e.get(i),y=e.get(r),w=e.get(l),k=e.get(c),x=e.get(d),D=e.get(v);return t.all([h,f,b,y,w,k,x,D]).then(function(e){return m=e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource),a.DEBUG_MODE&&console.log("No. Cat-Ans: ",m.length),m},u)}function o(t){function n(e){var t=e.data.resource[0].id;return m[m.length-1].id=t,a.DEBUG_MODE&&console.log("creating catans record was succesful"),e.data}var s={};s.answer=t,s.category=a.cCategory.id,s.upV=0,s.downV=0,s.user=a.user.id,s.timestmp=Date.now();var o={};o.resource=[],o.resource.push(s),m.push(s);var i=p;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(n,u)}function i(t,n,s){function o(e){var t=e.data.resource[0].id;return m[m.length-1].id=t,a.DEBUG_MODE&&console.log("creating catans record was succesful"),e.data}var i={};i.answer=t,i.category=n,i.upV=0,i.downV=0,i.user=a.user.id,i.timestmp=Date.now(),i.isdup=s;var r={};r.resource=[],r.resource.push(i),m.push(i);var l=p;return e.post(l,r,{headers:{"Content-Type":"multipart/form-data"},body:r}).then(o,u)}function r(t){function s(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVotesbyCatans(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting catans records was succesful"),e.data}for(var o=0;o<m.length;o++)m[o].answer==t&&m.splice(o,1);var i=p+"?filter=answer="+t;return e.delete(i).then(s,u)}function l(t,s){function o(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVotesbyCatans(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting catans records by answer and category was succesful"),e.data}for(var i=0;i<m.length;i++)m[i].answer==t&&m[i].category==s&&m.splice(i,1);var r=p+"?filter=(answer="+t+") AND (category="+s+")";return e.delete(r).then(o,u)}function c(t){function s(e){for(var t=0;t<e.data.resource.length;t++)n.deleteVotesbyCatans(e.data.resource[t].id);return a.DEBUG_MODE&&console.log("Deleting catans records by category was succesful"),e.data}for(var o=0;o<m.length;o++)m[o].category==t&&m.splice(o,1);var i=p+"?filter=category="+t;return e.delete(i).then(s,u)}function d(t,n,s){function o(e){return a.DEBUG_MODE&&console.log("updating catans record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"upV":r.upV=s[l];break;case"downV":r.downV=s[l];break;case"rank":r.rank=s[l];break;case"answer":r.answer=s[l];break;case"isdup":r.isdup=s[l];break;case"category":r.category=s[l]}i.resource.push(r);for(var c=p,d=m.map(function(e){return e.id}).indexOf(t),l=0;l<n.length;l++)switch(n[l]){case"upV":a.catansrecs[d].upV=s[l];break;case"downV":a.catansrecs[d].downV=s[l];break;case"rank":a.catansrecs[d].rank=s[l];break;case"answer":a.catansrecs[d].answer=s[l];break;case"isdup":a.catansrecs[d].isdup=s[l];break;case"category":a.catansrecs[d].category=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,u)}function g(){return m.length>0}function u(e){throw e}var m=[],p="/api/v2/mysql/_table/catans";return{getAllcatans:s,postRec:o,postRec2:i,deleteRec:l,deleteAnswer:r,updateRec:d,deletebyCategory:c}}angular.module("app").factory("catans",e),e.$inject=["$http","$q","$rootScope","votes"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(n){if(p()&&!n)return t.when(b);var s=y+"?offset=0",o=y+"?offset=1000",i=y+"?offset=2000",r=y+"?offset=3000",l=y+"?offset=4000",c=y+"?offset=5000",d=y+"?offset=6000",g=e.get(s),u=e.get(o),m=e.get(i),v=e.get(r),f=e.get(l),w=e.get(c),k=e.get(d);return t.all([g,u,m,v,f,w,k]).then(function(e){return b=e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource),a.DEBUG_MODE&&console.log("No. Answers: ",b.length),b},h)}function r(a,n){function s(e){return f=e.data}if(v(a)&&!n)return t.when(f);var o=y+"/"+a;return e.get(o).then(s,h)}function l(t){function a(e){return e.data}var n=y+"/?filter=customer="+t;return e.get(n).then(a,h)}function c(t){function i(e){var i=t;return i.id=e.data.resource[0].id,b.push(i),"Establishment"==i.type&&(a.estNames.push(i.name),a.estAnswers.push(i)),"Person"==i.type&&(a.pplNames.push(i.name),a.pplAnswers.push(i)),"Place"==i.type&&(a.plaNames.push(i.name),a.plaAnswers.push(i)),n.postRec(i.id),s.postVrows4Answer(i),o.post("addedAnswer",["answer","category"],[i.id,a.cCategory.id]),a.DEBUG_MODE&&console.log("created catans for a new answer"),a.DEBUG_MODE&&console.log("result",e),e.data}var r=y,l=[];return l.push(t),e.post(r,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(i,h)}function d(t,i){function r(e){var r=t;r.id=e.data.resource[0].id,b.push(r),"Establishment"==r.type&&(a.estNames.push(r.name),a.estAnswers.push(r)),"Person"==r.type&&(a.pplNames.push(r.name),a.pplAnswers.push(r)),"Place"==r.type&&(a.plaNames.push(r.name),a.plaAnswers.push(r)),o.post("addedAnswer",["answer","category"],[r.id,i[0]]);for(var l=0;l<i.length;l++)0==l?n.postRec2(r.id,i[l],!1):n.postRec2(r.id,i[l],!0);return s.postVrows4Answer(r),a.DEBUG_MODE&&console.log("created "+i.length+"catans records for the new answer"),a.DEBUG_MODE&&console.log("result",e),e.data}var l=y,c=[];return c.push(t),e.post(l,c,{headers:{"Content-Type":"multipart/form-data"},body:c}).then(r,h)}function g(t,n,s){function i(e){return"owner"==n[0]&&o.post("binded",["answer"],[t]),a.DEBUG_MODE&&console.log("updating answer succesful"),e.data}var r={};r.resource=[];var l={};l.id=t;for(var c=0;c<n.length;c++)switch(n[c]){case"name":l.name=s[c];break;case"addinfo":l.addinfo=s[c];break;case"cityarea":l.cityarea=s[c];break;case"location":l.location=s[c];break;case"image":l.imageurl=s[c];break;case"views":l.views=s[c];break;case"lat":l.lat=s[c];break;case"lng":l.lng=s[c];break;case"owner":l.owner=s[c];break;case"phone":l.phone=s[c];break;case"website":l.website=s[c];break;case"email":l.email=s[c];break;case"strhours":l.strhours=s[c];break;case"eventstr":l.eventstr=s[c];break;case"numcom":l.numcom=s[c];break;case"ranks":l.ranks=s[c];break;case"ispremium":l.ispremium=s[c];break;case"hasranks":l.hasranks=s[c];break;case"ranksqty":l.ranksqty=s[c];break;case"ig_image_urls":l.ig_image_urls=s[c];break;case"slug":l.slug=s[c]}r.resource.push(l);for(var d=y,g=b.map(function(e){return e.id}).indexOf(t),c=0;c<n.length;c++)switch(n[c]){case"name":a.answers[g].name=s[c];break;case"addinfo":a.answers[g].addinfo=s[c];break;case"cityarea":a.answers[g].cityarea=s[c];break;case"location":a.answers[g].location=s[c];break;case"image":a.answers[g].imageurl=s[c];break;case"views":a.answers[g].views=s[c];break;case"lat":a.answers[g].lat=s[c];break;case"lng":a.answers[g].lng=s[c];break;case"owner":a.answers[g].owner=s[c];break;case"phone":a.answers[g].phone=s[c];break;case"website":a.answers[g].website=s[c];break;case"email":a.answers[g].email=s[c];break;case"strhours":a.answers[g].strhours=s[c];break;case"eventstr":a.answers[g].eventstr=s[c];break;case"numcom":a.answers[g].numcom=s[c];break;case"ranks":a.answers[g].ranks=s[c];break;case"ispremium":a.answers[g].ispremium=s[c];break;case"hasranks":a.answers[g].hasranks=s[c];break;case"ranksqty":a.answers[g].ranksqty=s[c];break;case"slug":a.answers[g].slug=s[c]}return e.patch(d,r,{headers:{"Content-Type":"multipart/form-data"},body:r}).then(i,h)}function u(t,n){function s(e){return a.DEBUG_MODE&&console.log(" answer flagged succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.flag=n,o.resource.push(i);var r=y;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,h)}function m(t){function n(e){return a.DEBUG_MODE&&console.log("Deleting answer was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=y+"/"+t,r=b.map(function(e){return e.id}).indexOf(t);return r>-1&&b.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,h)}function p(){return b.length>0}function v(e){return f&&f.id==e}function h(e){throw e}var f,b=[],y="/api/v2/mysql/_table/answers";return{getAnswers:i,getAnswer:r,addAnswer:c,addAnswer2:d,updateAnswer:g,deleteAnswer:m,flagAnswer:u,getAnswerbyCustomer:l}}angular.module("app").factory("answer",e),e.$inject=["$http","$q","$rootScope","catans","vrows","uaf"]}(),angular.module("app").directive("catBar",["color","$window","$rootScope","$state",function(e,t,a,n){"use strict";return{templateUrl:"app/answer/Partials/catbar.html",transclude:!0,scope:{text:"@",leftFn:"&leftFn",rightFn:"&rightFn",closeRank:"&closeRank"},link:function(a){a.bc="#006dcc",a.bc2=e.shadeColor(a.bc,-.3),a.fc="white",t.innerWidth<769?(a.ht=50,a.text.length>60&&(a.ht=90)):t.innerWidth<870?(a.ht=50,a.text.length>60&&(a.ht=75)):a.ht=50,a.goPrev=function(){a.leftFn()},a.goNext=function(){a.rightFn()},a.selRank=function(){a.closeRank()}}}}]),angular.module("app").directive("blobUpload",["$rootScope","$state",function(e,t){"use strict";return{templateUrl:"app/answer/Partials/blobupload.html",transclude:!0,scope:{},controller:["$scope","Upload","$timeout","$http","$rootScope",function(e,t,a,n,s){function o(t){e.errorMsg=t}o(""),e.uploadFiles=function(a,n){if(e.f=a,e.errFile=n&&n[0],null==a)if(console.log("file is null"),void 0!=e.errFile){var i="Uploading failed for "+e.errFile.name+", "+e.errFile.$error+" exceeds "+e.errFile.$errorParam;o(i)}else o("");else{var r="https://rankx.blob.core.windows.net/sandiego/"+s.canswer.id+"/"+a.name+"?sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D",l=new FileReader;l.readAsArrayBuffer(a),l.onload=function(n){t.http({url:r,method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","x-ms-blob-content-type":a.type},data:n.target.result}).then(function(t){t.status>0&&(e.errorMsg=t.status+": "+t.data);var n="https://rankx.blob.core.windows.net/sandiego/"+s.canswer.id+"/"+a.name;console.log("emitted fileUploaded!!"),s.$emit("fileUploaded",n)},null,function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}}}]}}]),angular.module("app").directive("answerHeader",["color","$window","$rootScope","$state","dialog",function(e,t,a,n,s){"use strict";return{templateUrl:"app/answer/Partials/answerheader.html",transclude:!0,scope:{ans:"@",idx:"@"},link:function(o){function i(){o.imgmode="Show Map",o.imgmodeicon="fa fa-globe",o.modeIsImage=!0,a.modeIsImage=!0}function r(){o.imgmode="Show Image",o.imgmodeicon="fa fa-picture-o",o.modeIsImage=!1,a.modeIsImage=!1}o.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(o.isMobile=!0),o.answer=JSON.parse(o.ans),"Short-Phrase"==o.answer.type?o.isShortPhrase=!0:o.isShortPhrase=!1,"Event"==o.answer.type?o.isEvent=!0:o.isEvent=!1,o.modeIsImage=!0,
o.imgmode="Show Map",o.imgmodeicon="fa fa-globe",o.hasMap=void 0!=o.answer.location&&""!=o.answer.location;for(var l=[0,401,474,769,971,996,1173,1201,1635,1960,3500],c=[.86,.86,.88,.96,.75,.96,.68,.96,.64,.6,.6],d=t.innerWidth,g=0,u=0;u<l.length-1;u++)if(d>l[u]&&d<l[u+1]){var m=(c[u+1]-c[u])/(l[u+1]-l[u]),p=c[u]-l[u]*m;g=d*m+p}if(t.innerWidth<763){if(o.sp1="width:5%;padding:0px;",o.sp2="width:25%;max-height:50px",o.sp3="width:20%",o.sm=!0,o.nsm=!1,o.width=Math.round(d*g),o.mxheight=Math.round(o.width/1.25),o.mxheight>300&&(o.mxheight=300),a.cCategory){var v=e.defaultRankColor(a.cCategory);o.bc=v[0],o.fc=v[1]}else o.bc="gray",o.fc="black";o.bc2=e.shadeColor(o.bc,.4)}else{if(o.mxheight="300",o.sp1="width:15%",o.sp2="width:22.5%;max-height:50px;",o.sp3="width:20%",o.sm=!1,o.nsm=!0,o.width=Math.round(d*g),o.width2=Math.round(d*g/2),o.width3=Math.round(d*g/3),a.cCategory){var v=e.defaultRankColor(a.cCategory);o.bc=v[0],o.fc=v[1]}else o.bc="gray",o.fc="black";o.bc2="#d8d8d8"}void 0!=o.answer.addinfo&&(o.answer.addinfo_teaser=o.answer.addinfo.slice(0,300),o.answer.addinfo_complete=o.answer.addinfo.slice(300)),o.moretext=" more ",o.completeinfo=!1,function(){if(o.hrset=!1,void 0!=o.answer.strhours&&null!=o.answer.strhours){o.hrset=!0;var e=new Date,t=e.getDay(),a=t-1;a<0&&(a=6);var n=JSON.parse(o.answer.strhours);"CLOSED"==n[a].opn?o.hourstr="Closed today":o.hourstr="Open today from: "+n[a].st+" to "+n[a].ct}}(),o.toggleimgmode=function(){o.modeIsImage?r():i()},o.editAnswer=function(){a.isLoggedIn?"Event"==o.answer.type?(a.eventmode="edit",n.go("addEvent",{index:o.answer.id})):n.go("editAnswer",{index:o.answer.id}):s.loginFacebook()},o.showcomplete=function(){return" more "==o.moretext?(o.moretext=" less ",void(o.completeinfo=!0)):" less "==o.moretext?(o.moretext=" more ",void(o.completeinfo=!1)):void 0}}}}]),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m){function p(){for(var e=0;e<n.fields.length;e++){switch(W={},W.field=n.fields[e].name,W.onlybyowner=n.fields[e].onlybyowner,n.fields[e].name){case"name":W.cval=z.answer.name;break;case"cityarea":W.cval=z.answer.cityarea;break;case"location":W.cval=z.answer.location;break;case"addinfo":W.cval=z.answer.addinfo;break;case"phone":W.cval=z.answer.phone;break;case"website":W.cval=z.answer.website;break;case"email":W.cval=z.answer.email}W.val="",W.label=n.fields[e].label,"cityarea"==W.field?W.opts="c for c in vm.neighborhoods":W.opts="c for c in vm.emptyarray",z.fields.push(W)}for(var e=0;e<z.fields.length;e++)z.fields[e].val=z.fields[e].cval}function v(e){z.edits=[],H=[],K=[];for(var t={},a=0;a<n.edits.length;a++)if(n.edits[a].answer==e){switch(t=n.edits[a],t.vote=0,t.idx=a,t.agree="",t.disagree="",n.fields[0].name){case"name":t.name=z.answer.name}z.edits.push(t),H.push(n.edits[a].upV),K.push(n.edits[a].downV)}y(z.answer.id)}function h(t){if(!n.isLoggedIn)return void e.loginFacebook();for(var a=!1,s=0;s<z.edits.length;s++)if(z.edits[s].field==t.field){a=!0;break}if(a)return void e.getDialog("editFieldExists");var o={};switch(o.field=t.field,o.nval=t.val,o.cval||(o.cval=""),o.answer=z.answer.id,o.upV=0,o.downV=0,o.imageURL="",o.display="none",n.fields[0].name){case"name":o.name=z.answer.name}o.user=n.user.id,o.username=n.user.name,o.timestmp=Date.now(),n.userIsOwner?e.editConfirm(o,"field",q):e.editConfirm(o,"field",A)}function f(){if(console.log("@editImate"),!n.isLoggedIn)return void e.loginFacebook();for(var t=!1,a=0;a<z.edits.length;a++)if("image"==z.edits[a].field){t=!0;break}if(t)return void e.getDialog("editFieldExists");c.getImageLinks(z.fields,oe,"edit").then($,_)}function b(){n.DEBUG_MODE&&console.log("@selectImage");var t={};switch(t.field="image",t.cval=z.answer.imageurl,t.nval="",n.userIsOwner?t.imageURL=n.blobimage:t.imageURL=z.imageURL,t.display="inline",t.answer=z.answer.id,t.upV=0,t.downV=0,n.fields[0].name){case"name":t.name=z.answer.name}t.user=n.user.id,t.username=n.user.name,t.timestmp=Date.now(),n.userIsOwner?e.editConfirm(t,"image",q):e.editConfirm(t,"image",M),console.log("$rootScope.userIsOwner - ",n.userIsOwner)}function y(e){for(var t={},a=0;a<n.editvotes.length;a++)n.editvotes[a].answer==e&&(t=n.editvotes[a],X.push(t));for(a=0;a<z.edits.length;a++)for(var s=0;s<X.length;s++)z.edits[a].id==X[s].edit&&(z.edits[a].vote=X[s].vote);x()}function w(t,a){if(n.isAdmin)return void e.editChangeEffective(z.edits[a],a,"approve",S);if(!n.isLoggedIn)return void e.loginFacebook();switch(t.vote){case 1:z.edits[a].vote=0,z.edits[a].upV--;break;case 0:z.edits[a].vote=1,z.edits[a].upV++;break;case-1:z.edits[a].vote=1,z.edits[a].upV++,z.edits[a].downV--}D(a),x()}function k(t,a){if(n.isAdmin)return void e.editChangeEffective(z.edits[a],a,"reject",S);if(!n.isLoggedIn)return void e.loginFacebook();switch(t.vote){case 1:z.edits[a].vote=-1,z.edits[a].upV--,z.edits[a].downV++;break;case 0:z.edits[a].vote=-1,z.edits[a].downV++;break;case-1:z.edits[a].vote=0,z.edits[a].downV--}D(a),x()}function x(){for(var e=0;e<z.edits.length;e++)switch(z.edits[e].vote){case 1:z.edits[e].agree="active",z.edits[e].disagree="";break;case 0:z.edits[e].agree="",z.edits[e].disagree="";break;case-1:z.edits[e].agree="",z.edits[e].disagree="active"}}function D(t){if(z.edits[t].upV>z.edits[t].downV){if(z.edits[t].upV-z.edits[t].downV>=J)return void e.editChangeEffective(z.edits[t],t,"approve",S)}else if(z.edits[t].downV>z.edits[t].upV&&z.edits[t].downV-z.edits[t].upV>=Z)return void e.editChangeEffective(z.edits[t],t,"reject",S)}function C(){n.DEBUG_MODE&&console.log("updateRecords @ editAnswer");for(var e=!1,t=[],a={},s=0;s<z.edits.length;s++){e=!1;for(var o=0;o<X.length;o++)if(z.edits[s].id==X[o].edit){e=!0;break}e?r.patchEditVoteRec(X[o].id,z.edits[s].vote):0!=z.edits[s].vote&&(a={},a.edit=z.edits[s].id,a.user=n.user.id,a.category=n.cCategory.id,a.answer=z.edits[s].answer,a.vote=z.edits[s].vote,a.timestmp=Date.now(),t.push(a)),z.edits[s].upV==H[s]&&z.edits[s].downV==K[s]||i.updateEdit(z.edits[s].id,z.edits[s].upV,z.edits[s].downV)}t.length>0&&(r.postEditVoteRec(t),t=[]),Q=!0}function S(e,t){"approve"==t&&(O(e),ae||I()),"reject"==t&&P(e)}function O(e){if(n.DEBUG_MODE&&console.log("Edit has been approved"),"image"==z.edits[e].field)n.DEBUG_MODE&&console.log("EA-3"),l.updateAnswer(z.edits[e].answer,[z.edits[e].field],[z.edits[e].imageURL]);else if("location"==z.edits[e].field){if(void 0!=z.edits[e].nval&&""!=z.edits[e].nval&&null!=z.edits[e].nval){ae=!0,z.answer.location=z.edits[e].nval;var t=d.getLocationGPS(z.answer);t.then(function(){})}}else if("cityarea"==z.edits[e].field){for(var a=0,o={},i="",r=[],c=[],g=0;g<n.catansrecs.length;g++)if(n.catansrecs[g].answer==z.answer.id&&(a=n.content.map(function(e){return e.id}).indexOf(n.catansrecs[g].category),o=n.content[a],o.title.indexOf(z.answer.cityarea)>-1)){i=o.title.replace(z.answer.cityarea,z.edits[e].nval);for(var u=0;u<n.content.length;u++)if(n.content[u].title==i){r.push(n.catansrecs[g].id),c.push(n.content[u].id);break}}for(var g=0;g<r.length;g++)s.updateRec(r[g],["category"],[c[g]]);n.DEBUG_MODE&&console.log("EA-4"),l.updateAnswer(z.edits[e].answer,[z.edits[e].field],[z.edits[e].nval])}else n.DEBUG_MODE&&console.log("EA-2"),l.updateAnswer(z.edits[e].answer,[z.edits[e].field],[z.edits[e].nval]);ee=!0,te=e}function E(){ne||(ne=!0,n.DEBUG_MODE&&console.log("EA-1"),l.updateAnswer(z.answer.id,["location","lat","lng"],[z.answer.location,z.answer.lat,z.answer.lng]).then(I))}function P(e){n.DEBUG_MODE&&console.log("Edit has been discarded"),i.deleteEdit(z.edits[e].id),r.deleteEditVotes(z.edits[e].id),n.edits.splice(z.edits[e].idx,1),z.edits.splice(e,1)}function R(){e.howItWorks("editAnswer")}function A(e){C(),Q=!1;var t=i.addEdit(e);n.DEBUG_MODE&&console.log("creating edit"),t.then(function(){v(z.answer.id)})}function M(e){C(),Q=!1,i.addEdit(e).then(function(){v(z.answer.id),z.imageURL=z.answer.imageurl,z.imagefunctions="none"})}function I(){ee&&(i.deleteEdit(z.edits[te].id),r.deleteEditVotes(z.edits[te].id),n.edits.splice(z.edits[te].idx,1),z.edits.splice(te,1)),a.go("answerDetail",{index:z.answer.id})}function $(e){for(var t=!1,a=0;a<e.length;a++){for(var n=0;n<se.length;n++)if(0==e[a].localeCompare(se[n])){t=!0;break}t||se.push(e[a])}z.numLinks=se.length,oe++,(z.numLinks>10||oe>4)&&(z.searchDisabled="disabled"),oe>1&&(z.imageCommand="Load More Images"),z.linkIdx=0,z.imageURL=se[z.linkIdx],z.numLinks>0&&(z.imagefunctions="inline")}function _(){n.DEBUG_MODE&&console.log("query failed, dont give up")}function T(){z.linkIdx++,z.linkIdx>=z.numLinks&&(z.linkIdx=0),z.imageURL=se[z.linkIdx]}function L(){z.linkIdx--,z.linkIdx<0&&(z.linkIdx=z.numLinks-1),z.imageURL=se[z.linkIdx]}function B(){I()}function U(){if(z.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"],z.openOptions=["OPEN","CLOSED"],void 0==z.answer.strhours||null==z.answer.strhours||0==z.answer.strhours.length){z.openhours=JSON.parse('[{"day":"MON","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"TUE","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"WED","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"THU","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"FRI","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"SAT","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"SUN","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"}]')}else z.openhours=JSON.parse(z.answer.strhours)}function N(){z.updateHoursEn=""}function V(){for(var e=[],t={},a=0;a<z.openhours.length;a++)t={},t.day=z.openhours[a].day,t.opn=z.openhours[a].opn,t.st=z.openhours[a].st,t.ct=z.openhours[a].ct,e.push(t);var s=JSON.stringify(e);n.DEBUG_MODE&&console.log("EA-4"),l.updateAnswer(z.answer.id,["strhours"],[s]),z.updateHoursEn="disabled"}function F(){for(var e="",t=0;t<z.fields.length;t++)"name"==z.fields[t].field&&(e=z.fields[t].val);e.length>0&&u.getWiki(e)}function G(e){console.log("Load Wiki!!",e);for(var t=0;t<z.fields.length;t++)"addinfo"==z.fields[t].field&&(z.fields[t].val=e)}function q(e){if(n.DEBUG_MODE&&console.log("Direct Edit Executed"),n.DEBUG_MODE&&console.log("edit - ",e),"image"==e.field)n.DEBUG_MODE&&console.log("R1"),z.imageURL=n.blobimage,l.updateAnswer(e.answer,["image"],[e.imageURL]),a.go("editAnswer",{},{reload:!0});else if("location"==e.field){if(n.DEBUG_MODE&&console.log("R2"),void 0!=e.nval&&""!=e.nval&&null!=e.nval){z.answer.location=e.nval;var t=d.getLocationGPS(z.answer);t.then(function(){})}}else n.DEBUG_MODE&&console.log("R3"),l.updateAnswer(e.answer,[e.field],[e.nval]);n.cmd1exe=!1}function j(e){e?(z.imageURL=n.EMPTY_IMAGE,b()):z.imageURL=se[z.linkIdx]}var z=this;if(z.title="editAnswer",z.answer={},z.showHowItWorksDialog=R,z.editField=h,z.editAgree=w,z.editImage=f,z.selectImage=b,z.viewPrev=L,z.viewNext=T,z.closeRank=B,z.editDisagree=k,z.answerDetail=I,z.hoursChanged=N,z.updateHours=V,z.onNoGoodImages=j,z.getWiki=F,z.ranking=n.title,z.userIsOwner=n.userIsOwner,t.index){if(/^\d+$/.test(t.index)){var Y=n.answers.map(function(e){return e.id}).indexOf(+t.index);z.answer=n.answers[Y]}else{var Y=n.answers.map(function(e){return e.slug}).indexOf(t.index);z.answer=n.answers[Y]}}z.type=z.answer.type,z.imageURL=z.answer.imageurl,z.fields=[];var W={};z.edits=[];var H=[],K=[],X=[],Q=!1,J=1,Z=1,ee=!1,te=0,ae=!1,ne=!1,se=[];z.linkIdx=0,z.numLinks=0,z.imageCommand="Change Image";var oe=3;z.imagefunctions="none",z.emptyarray=[],z.updateHoursEn="disabled",z.neighborhoods=n.neighborhoods.concat(n.districts),n.$on("$stateChangeSuccess",function(e,t,a,s,o){n.previousState=s.name}),n.$on("$stateChangeStart",function(e,t,a,n,s){"editAnswer"==n.name&&(Q||C())}),n.$on("fileUploaded",function(e,t){n.cmd1exe=!!n.cmd1exe&&n.cmd1exe,"editAnswer"!=a.current.name||n.cmd1exe||(n.cmd1exe=!0,n.blobimage=t,b())}),n.$on("answerGPSready",function(){"editAnswer"!=a.current.name||ne||E()}),n.$on("wikiReady",function(e,t){"editAnswer"==a.current.name&&G(t)}),g.innerWidth<512?(z.sm=!0,z.nsm=!1):(z.sm=!1,z.nsm=!0),function(){p(),z.userIsOwner&&"Establishment"==z.type&&U(),z.access=z.userIsOwner&&z.answer.isactive,v(z.answer.id),n.DEBUG_MODE&&console.log("Edit Answer Activated!")}()}angular.module("app").controller("editAnswer",e),e.$inject=["dialog","$stateParams","$state","$rootScope","catans","$modal","edit","editvote","answer","image","getgps","$window","getwiki","$http"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d){function g(){f.ranksqty=n.canswer.ranksqty,void 0==n.canswer&&a.go("cwrapper");var e=0;f.ranks=JSON.parse(n.canswer.ranks);for(var t=0;t<f.ranks.length;t++)e=n.content.map(function(e){return e.id}).indexOf(f.ranks[t].id),f.ranks[t].title=n.content[e].title.replace(" @ "+n.canswer.name,""),f.ranks[t].used=!0;if(f.ranks.length<n.canswer.ranksqty)for(var s=f.ranks.length;s<n.canswer.ranksqty;s++){var o={};o.title="Empty",o.used=!1,f.ranks.push(o)}console.log("vm.ranks - ",f.ranks),n.DEBUG_MODE&&console.log("Answer rankings manager activated!")}function u(e){n.rankIdx=e,n.rankforAnswerMode="edit",a.go("addRankforAnswer")}function m(){n.rankforAnswerMode="add",a.go("addRankforAnswer")}function p(t){var a=n.content.map(function(e){return e.id}).indexOf(f.ranks[t].id);b=t,e.deleteRank(n.content[a],v)}function v(){c.deleteTable(f.ranks[b].id),f.ranks.splice(b,1);for(var e=[],t={},a=0;a<f.ranks.length;a++)f.ranks[a].used&&(t={},t.id=f.ranks[a].id,t.bc=f.ranks[a].bc,t.fc=f.ranks[a].fc,e.push(t));var s=JSON.stringify(e);l.updateAnswer(n.canswer.id,["ranks"],[s]),g()}function h(){a.go("answerDetail",{index:n.canswer.id})}var f=this;f.title="answerRanksManager",f.editRank=u,f.addRank=m,f.deleteRank=p,f.goBack=h;var b=0;g()}angular.module("app").controller("answerRanksManager",e),e.$inject=["dialog","$stateParams","$state","$rootScope","catans","$modal","edit","editvote","answer","table","$window"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m,p,v,h,f,b,y,w,k,x,D,C,S,O,E){function P(){if(Re.ranking=o.title,$e=o.canswers,Re.fields=o.fields,Re.isAdmin=o.isAdmin,o.isLoggedIn=!!o.isLoggedIn&&o.isLoggedIn,Re.isLoggedIn=o.isLoggedIn,t.index){if(/^\d+$/.test(t.index)){var e=o.answers.map(function(e){return e.id}).indexOf(+t.index);Re.answer=o.answers[e]}else{var e=o.answers.map(function(e){return e.slug}).indexOf(t.index);Re.answer=o.answers[e]}}if(D.$parent.$parent.$parent.seo={pageTitle:Re.answer.name,metaDescription:Re.answer.addinfo},o.canswer=Re.answer,Re.type=Re.answer.type,void 0==o.cCategory){var a=C.get("ccategory");o.DEBUG_MODE&&console.log("@answerDetail - ccategory ",a);var s=o.content.map(function(e){return e.id}).indexOf(a);s>-1&&(o.cCategory=o.content[s])}if(o.inFavMode?Re.ranking=o.myfavs.title:o.cCategory?Re.ranking=o.cCategory.title:Re.ranking="",void 0==$e&&($e=[Re.answer]),Re.idx=$e.map(function(e){return e.id}).indexOf(Re.answer.id)+1,void 0==o.cCategory&&(Re.idx=0),2225==Re.answer.id?Re.igdemo=!0:Re.igdemo=!1,R(),Re.modeIsImage=void 0==o.modeIsImage||o.modeIsImage,void 0==Re.answer.location&&(Re.modeIsImage=!0),"answerDetail"!=o.previousState&&i.scrollTo(0,0),Re.showImageGallery=!1,o.$emit("showLogo"),M(),U(Re.answer.id),Z(),"Establishment"!=Re.type&&Re.type,"Establishment"==Re.type&&K(Re.answer.id),"Establishment"!=Re.type&&"PersonCust"!=Re.type||Q(Re.answer.id),H(),Re.answer.hasranks){var r=0;if(Re.myranks=JSON.parse(Re.answer.ranks),void 0!=Re.myranks&&Re.myranks.length>0)for(var e=0;e<Re.myranks.length;e++)r=o.content.map(function(e){return e.id}).indexOf(Re.myranks[e].id),Re.myranks[e].title=o.content[r].title.replace(" @ "+Re.answer.name,""),Re.myranks[e].image=o.content[r].image1url,void 0!=Re.myranks[e].image&&""!=Re.myranks[e].image||(Re.myranks[e].image=o.EMPTY_IMAGE)}if(o.cvotes?T():(o.cvotes=[],o.ceditvotes=[]),"Event"==Re.type){var c=JSON.parse(Re.answer.eventstr);we(Re.answer,c),Re.ehtml=l.eventHtml(Re.answer,Re.sm),Re.estyle="background-color:"+Re.answer.bc+";color:"+Re.answer.fc+";white-space:pre;"}Re.access=!1,o.isLoggedIn&&o.user.id==Re.answer.owner?(Re.userIsOwner=!0,Re.answer.isactive&&(Re.access=!0)):Re.userIsOwner=!1,o.userIsOwner=Re.userIsOwner,void 0==Re.answer.numcom?Re.numcom=0:Re.numcom=Re.answer.numcom,Re.ranking?Re.showNextnPrev=!0:Re.showNextnPrev=!1;var d=Re.answer.views+1;n.updateAnswer(Re.answer.id,["views"],[d]),Se(),o.DEBUG_MODE&&console.log("Answer details loaded"),window.prerenderReady=!0}function R(){if(!o.fields){var e=0;switch(Re.answer.type){case"Place":e=0;break;case"Person":e=1;break;case"Event":e=2;break;case"Organization":e=3;break;case"Short-Phrase":e=4;break;case"Activity":e=5;break;case"Establishment":e=6;break;case"Thing":e=7;break;case"PersonCust":e=8}var t=o.typeSchema[e].fields;o.fields=t}}function M(){void 0==Re.answer.owner||null==Re.answer.owner||0==Re.answer.owner?Re.answer.hasOwner=!1:Re.answer.hasOwner=!0,Re.bindtxt="","Establishment"==Re.type&&(Re.bindtxt="I represent this business"),"PersonCust"==Re.type&&(Re.bindtxt="I am this person"),"Event"==Re.type&&(Re.bindtxt="I organize this event")}function I(e){var t=0,a=0,n="";Re.relativetable=[];for(var s=o.R,i=o.GP,r=o.answersR,l=A.indexOf(+e),c=0,d=o.fields[0].name,g=!1,u=0;u<r.length;u++)if(A[u]!=e){switch(c=s[l][u],d){case"name":n=r[u].name;break;case"nickname":n=r[u].nickname;break;case"country":n=r[u].country,g=!0;break;case"club":n=r[u].club}i[l][u]?(t=Math.round(c/i[l][u]*100),a=100-t):(t=0,a=0),Re.relativetable.push({id:r[u].id,Rank:r[u].Rank,PctF:t,vsName:n,PctC:a,GP:i[l][u],isC:g})}}function $(e){_(),_e=!1,Ae=!1,Re.answer=$e[A.indexOf(+e)],o.canswer=Re.answer,U(Re.answer.id),Me=Re.catans.upV,Ie=Re.catans.downV,M(),H(),T(),I(e),K(Re.answer.id),Q(Re.answer.id),H()}function _(){o.DEBUG_MODE&&console.log("UpdateRecords @answerDetail");for(var e=0;e<Re.answerRanks.length;e++){var t=Re.answerRanks[e].voteRecordExists,a=!1,n={},s=o.thisuseractivity.map(function(e){return e.category}).indexOf(Re.answerRanks[e].id);s>=0?(a=!0,n=o.thisuseractivity[s]):a=!1,t&&Re.answerRanks[e].uservote.vote!=Re.answerRanks[e].dV&&0!=Re.answerRanks[e].dV&&(o.DEBUG_MODE&&console.log("UR-1"),c.patchRec(Re.answerRanks[e].uservote.id,Re.answerRanks[e].dV)),t&&Re.answerRanks[e].uservote.vote!=Re.answerRanks[e].dV&&0==Re.answerRanks[e].dV&&(o.DEBUG_MODE&&console.log("UR-2"),c.deleteRec(Re.answerRanks[e].uservote.id),n.votes<2?(o.DEBUG_MODE&&console.log("UR-3"),r.deleteRec(n.id)):(o.DEBUG_MODE&&console.log("UR-4"),r.patchRec(n.id,n.votes-1))),t||0==Re.answerRanks[e].dV||(o.DEBUG_MODE&&console.log("UR-5"),c.postRec(Re.answerRanks[e].catans,Re.answer.id,Re.answerRanks[e].id,Re.answerRanks[e].dV),a?(o.DEBUG_MODE&&console.log("UR-6"),r.patchRec(n.id,n.votes+1)):(o.DEBUG_MODE&&console.log("UR-7"),r.postRec(Re.answerRanks[e].id))),Re.answerRanks[e].upV==Re.answerRanks[e].upVi&&Re.answerRanks[e].downV==Re.answerRanks[e].downVi||(o.DEBUG_MODE&&console.log("UR-8"),m.updateRec(Re.answerRanks[e].catans,["upV","downV"],[Re.answerRanks[e].upV,Re.answerRanks[e].downV]))}if("Establishment"==Re.type||"PersonCust"==Re.type)for(var e=0;e<Re.vrows.length;e++){var i=Re.vrows[e].voteExists;i&&Re.vrows[e].dVi!=Re.vrows[e].dV&&(o.DEBUG_MODE&&console.log("UR-9"),o.cvrowvotes[Re.vrows[e].vidx].val=Re.vrows[e].dV,w.patchRec(Re.vrows[e].voteid,Re.vrows[e].dV)),i||0==Re.vrows[e].dV||(o.DEBUG_MODE&&console.log("UR-10"),w.postRec(Re.vrows[e].id,Re.vrows[e].dV)),Re.vrows[e].upV==Re.vrows[e].upVi&&Re.vrows[e].downV==Re.vrows[e].downVi||(o.DEBUG_MODE&&console.log("UR-11"),y.updateRec(Re.vrows[e].id,["upV","downV"],[Re.vrows[e].upV,Re.vrows[e].downV]))}_e=!0}function T(){for(var e=0;e<Re.answerRanks.length;e++){Re.answerRanks[e].voteRecordExists=!1;for(var t=0;t<o.cvotes.length;t++)if(o.cvotes[t].catans==Re.answerRanks[e].catans){Re.answerRanks[e].uservote=o.cvotes[t],Re.answerRanks[e].uservote.ansvidx=e,Re.answerRanks[e].voteRecordExists=!0;break}Re.answerRanks[e].voteRecordExists?Re.answerRanks[e].dV=Re.answerRanks[e].uservote.vote:Re.answerRanks[e].dV=0,N(Re.answerRanks[e])}}function L(){if(o.isLoggedIn)for(var e=0;e<o.cansvrows.length;e++)for(var t=0;t<o.cvrowvotes.length;t++)o.cvrowvotes[t].vrow==o.cansvrows[e].id&&(o.cansvrows[e].voteExists=!0,o.cansvrows[e].dVi=o.cvrowvotes[t].val,o.cansvrows[e].dV=o.cvrowvotes[t].val,o.cansvrows[e].voteid=o.cvrowvotes[t].id,o.cansvrows[e].vidx=t,B(o.cansvrows[e],o.cvrowvotes[t].val));J()}function B(e,t){1==t&&(e.upImage="thumbs_up_blue_table.png",e.downImage="thumbs_down_gray_table.png"),0==t&&(e.dVi=0,e.dV=0,e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_gray_table.png"),-1==t&&(e.dVi=-1,e.dV=-1,e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_blue_table.png")}function U(e){Re.numEdits=0;for(var t=0;t<o.edits.length;t++)o.edits[t].answer==e&&Re.numEdits++}function N(e){1==e.dV&&(e.thumbUp="thumbs_up_blue_table.png",e.thumbDn="thumbs_down_gray_table.png"),0==e.dV&&(e.thumbUp="thumbs_up_gray_table.png",e.thumbDn="thumbs_down_gray_table.png"),-1==e.dV&&(e.thumbUp="thumbs_up_gray_table.png",e.thumbDn="thumbs_down_blue_table.png")}function V(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=1,e.upV++,e.downV--;break;case 0:e.dV=1,e.upV++;break;case 1:e.dV=0,e.upV--}N(e),o.DEBUG_MODE&&console.log("UpVote")}function F(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=0,e.downV--;break;case 0:e.dV=-1,e.downV++;break;case 1:e.dV=-1,e.upV--,e.downV++}N(e),o.DEBUG_MODE&&console.log("DownVote")}function G(){o.DEBUG_MODE&&console.log("goBack"),"match"==o.previousState?a.go("match"):o.inFavMode?a.go("myfavs"):o.cCategory?a.go("rankSummary",{index:o.cCategory.id}):a.go("cwrapper")}function q(e){o.title=e.title,a.go("rankSummary",{index:e.id})}function j(){console.log("Delete Answer"),s.deleteType(function(){d.deleteRecordsbyCatans(o.cCategory.id,Re.answer.id),m.deleteRec(Re.answer.id,o.cCategory.id).then(function(){a.go("answerDetail",{index:Re.answer.id},{reload:!0})})},function(){n.deleteAnswer(Re.answer.id),d.deleteRecordsbyAnswer(Re.answer.id),g.deleteEditbyAnswer(Re.answer.id),u.deleteEditVotesbyAnswer(Re.answer.id),m.deleteAnswer(Re.answer.id),y.deleteVrowByAnswer(Re.answer.id),a.go("rankSummary",{index:o.cCategory.id})})}function z(e){var t=Re.answer.name,n=o.content.map(function(e){return e.id}).indexOf(e.id),i=o.content[n].title;s.deleteThisCatans(t,i,function(){d.deleteRecordsbyCatans(e.id,Re.answer.id),m.deleteRec(Re.answer.id,e.id).then(function(){a.go("answerDetail",{index:Re.answer.id},{reload:!0})})})}function Y(t){if(o.isLoggedIn)return o.DEBUG_MODE&&console.log("Answer Flagged"),e.flagAnswer("answer",Re.answer.id,t),void s.getDialog("answerFlagged");s.loginFacebook()}function W(t){if(o.isLoggedIn)return o.DEBUG_MODE&&console.log("Answer Comment Flagged"),e.flagAnswer("comment-answer",Re.answer.id,t),void s.getDialog("commentFlagged");s.loginFacebook()}function H(){Re.answerRanks=[];for(var e=0;e<o.catansrecs.length;e++)if(o.catansrecs[e].answer==Re.answer.id)for(var t=0;t<o.content.length;t++)if(o.content[t].id==o.catansrecs[e].category){var a=o.content[t];a.upV=o.catansrecs[e].upV,a.downV=o.catansrecs[e].downV,a.catans=o.catansrecs[e].id,a.rank=o.catansrecs[e].rank,a.uservote={},a.upVi=o.catansrecs[e].upV,a.downVi=o.catansrecs[e].downV,1==a.rank?a.icon="/assets/images/gold.png":2==a.rank?a.icon="/assets/images/silver.png":3==a.rank?a.icon="/assets/images/bronze.png":a.rank>3&&a.rank<11?a.icon="/assets/images/top10.png":a.rank>=11&&a.rank<21?a.icon="/assets/images/top20.png":a.rank>=21&&a.rank<51?a.icon="/assets/images/top50.png":a.rank>=51&&a.rank<101?a.icon="/assets/images/top100.png":a.icon="/assets/images/blank.png",Re.answerRanks.push(a)}Re.otherRanksExist=!0}function K(e){Re.specialsList=[];for(var t=0;t<o.specials.length;t++)if(o.specials[t].answer==e){p.formatdatetime(o.specials[t]),o.specials[t].name=Re.answer.name;var a=l.specialHtml(o.specials[t],Re.sm);o.specials[t].html=a;var n="background-color:"+o.specials[t].bc+";color:"+o.specials[t].fc+";white-space:pre;";o.specials[t].style=n,void 0!=o.specials[t].image&&o.specials[t].image!=o.EMPTY_IMAGE?o.specials[t].hasimage=!0:o.specials[t].hasimage=!1,Re.specialsList.push(o.specials[t])}}function X(e){e.showimage?e.showimage=!1:e.showimage=!0}function Q(e){o.cansvrows=[];for(var t=0;t<o.cvrows.length;t++)if(o.cvrows[t].answer==e){var a=o.cvrows[t];a.idx=t,a.voteExists=!1,a.dV=0,a.upVi=o.cvrows[t].upV,a.downVi=o.cvrows[t].downV,a.upImage="thumbs_up_gray_table.png",a.downImage="thumbs_down_gray_table.png",o.cansvrows.push(a)}L()}function J(){function e(e,t){return e.gnum-t.gnum}if(Re.vrows=[],o.cansvrows.length>0){Re.vrows=o.cansvrows.sort(e),Re.vrows[0].shdr=!0;for(var t=1;t<Re.vrows.length;t++)Re.vrows[t].gnum==Re.vrows[t-1].gnum?Re.vrows[t].shdr=!1:Re.vrows[t].shdr=!0;Re.vrows[Re.vrows.length-1].saddr=!0;for(var t=0;t<Re.vrows.length-1;t++)Re.vrows[t].gnum!=Re.vrows[t+1].gnum?Re.vrows[t].saddr=!0:Re.vrows[t].saddr=!1;Re.vrowgroups=[];for(var a=[],n=Re.vrows[0].gnum,t=0;t<Re.vrows.length;t++)n!=Re.vrows[t].gnum?(Re.vrowgroups.push(a),a=[],a.push(Re.vrows[t]),n=Re.vrows[t].gnum):a.push(Re.vrows[t]),t==Re.vrows.length-1&&Re.vrowgroups.push(a)}}function Z(){o.isAdmin?Re.deleteButton="inline":Re.deleteButton="none"}function ee(){s.url(Re.answer.imageurl)}function te(){a.go("cwrapper")}function ae(){G()}function ne(){s.bizRegistration(se)}function se(){o.isLoggedIn?s.bindAccount(o.user.name,Re.answer.name,oe):s.getDialog("notLoggedInBiz")}function oe(){o.DEBUG_MODE&&console.log("Bind business to user account"),n.updateAnswer(Re.answer.id,["owner"],[o.user.id]).then(ie);var e={};e=Re.answer,e.username=o.user.first_name+" "+o.user.last_name,f.adduseraccnt(e).then(function(){for(var e=!1,t=0;t<o.useraccnts.length;t++)""!=o.useraccnts[t].email&&(e=!0);e||o.$emit("showWarning")})}function ie(){a.go("answerDetail",{index:Re.answer.id},{reload:!0})}function re(){a.go("specials")}function le(){a.go("editvrows")}function ce(){a.go("answerRanksManager")}function de(){if(Re.igdemo)x.getImages().then(ge);else{o.blobs=[];for(var e=Re.answer.ig_image_urls.split(";"),t=0;t<e.length;t++)if(""!=e[t]){var a={};a.url=e[t],a.type="Instagram",o.blobs.push(a)}k.getImageList().then(ge)}Re.showImageGallery=!0}function ge(){Re.igdemo?Re.images=o.igimages:Re.images=o.blobs}function ue(e){a.go("rankSummary",{index:e.id})}function me(){var e=$e.length,t=$e.map(function(e){return e.id}).indexOf(Re.answer.id),n=t-1;n<0&&(n=e-1),o.isLoggedIn&&_(),a.go("answerDetail",{index:$e[n].id})}function pe(){var e=$e.length,t=$e.map(function(e){return e.id}).indexOf(Re.answer.id),n=t+1;n>e-1&&(n=0),o.isLoggedIn&&_(),a.go("answerDetail",{index:$e[n].id})}function ve(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=1,e.upV++,e.downV--;break;case 0:e.dV=1,e.upV++;break;case 1:e.dV=0,e.upV--}fe(e),o.DEBUG_MODE&&console.log("VRow UpVote")}function he(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=0,e.downV--;break;case 0:e.dV=-1,e.downV++;break;case 1:e.dV=-1,e.upV--,e.downV++}fe(e),o.DEBUG_MODE&&console.log("DownVote")}function fe(e){1==e.dV&&(e.upImage="thumbs_up_blue_table.png",e.downImage="thumbs_down_gray_table.png"),0==e.dV&&(e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_gray_table.png"),-1==e.dV&&(e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_blue_table.png")}function be(){v.loadComments("answer",Te).then(function(){S.all(Te.comments.map(function(e){return O.getFBUserById(e.user)})).then(function(e){for(var t=0;t<Te.comments.length;t++)Te.comments[t].picture=e[t]?e[t].picture.data.url:null})})}function ye(){v.postComment("answer",Te)}function we(e,t){e.bc=t.bc,e.fc=t.fc,e.freq=t.freq,e.edate=t.edate,e.sdate=t.sdate,e.etime=t.etime,e.etime2=t.etime2,e.stime=t.stime,e.stime2=t.stime2,e.mon=t.mon,e.tue=t.tue,e.wed=t.wed,e.thu=t.thu,e.fri=t.fri,e.sat=t.sat,e.sun=t.sun}function ke(e){s.seePhotos(Re.images,e,Re.answer,Re.userIsOwner)}function xe(e){var t="",n=0,s=!1;t=Re.addctsval,s=void 0!=Re.catisdup&&Re.catisdup;for(var i=0;i<o.content.length;i++)if(o.content[i].title==t){n=o.content[i].id;break}m.postRec2(Re.answer.id,n,s),Re.addctsactive=!1,setTimeout(function(){a.go("answerDetail",{index:Re.answer.id},{reload:!0})},1e3)}function De(e){Re.addctsopts=[];for(var t="",a=0;a<o.ctsOptions.length;a++)o.ctsOptions[a].indexOf("@neighborhood")>-1?(t=o.ctsOptions[a].replace("@neighborhood",Re.answer.cityarea),Re.addctsopts.push(t)):Re.addctsopts.push(o.ctsOptions[a]);Re.addctsactive=!0}function Ce(){Re.votemode=!0,Re.voteonstyle="background-color:#3277b3;color:#e6e6e6",Re.voteoffstyle="background-color:#e6e6e6;color:black",void 0==o.endorseDialogShown&&Oe()}function Se(){Re.votemode=!1,Re.voteoffstyle="background-color:#3277b3;color:#e6e6e6",Re.voteonstyle="background-color:#e6e6e6;color:black"}function Oe(){s.endorse(Re.type),o.endorseDialogShown=!0}function Ee(){null==E.access_token()?E.login():E.getMyRecentImages().then(function(e){s.chooseImgFromIgDlg(e.data.data,Re.answer,Re.userIsOwner)}).catch(function(e){console.log(e)}),o.$on("instagramLoggedIn",function(e,t){E.getMyRecentImages().then(function(e){console.log(e),s.chooseImgFromIgDlg(e.data.data,Re.answer,Re.userIsOwner)}).catch(function(e){console.log(e)})})}function Pe(){Re.dispRanks<=3?Re.dispRanks=Re.answerRanks.length:Re.dispRanks=3}var Re=this;Re.title="answerDetail";var Ae=!1,Me=0,Ie=0,$e=[],_e=!1;Re.numEdits=0,Re.relativetable=[],Re.catans=[],Re.sm=o.sm,Re.votemode=!1,Re.dispRanks=3,Re.UpVote=V,Re.DownVote=F,Re.refresh=$,Re.goBack=G,Re.goPrev=me,Re.goNext=pe,Re.deleteAnswer=j,Re.flagAnswer=Y,Re.deleteButton="none",Re.showUrl=ee,Re.closeRank=te,Re.closeAnswerDetail=ae,Re.rankSel=q,Re.bizRegDialog=ne,Re.openSpecials=re,Re.editVRows=le,Re.getImages=de,Re.showsimage=X,Re.gotoRank=ue,Re.vrowVoteUp=ve,Re.vrowVoteDown=he,Re.loadComments=be,Re.postComment=ye,Re.selectPhoto=ke,Re.cmFlag=W,Re.deleteThisCatans=z,Re.addRankforAnswer=ce,Re.votemodeON=Ce,Re.votemodeOFF=Se,Re.user=o.user,Re.endorseDialog=Oe,Re.selectInstagramImages=Ee,Re.showRanks=Pe,Re.addCatans=De,Re.addctsactive=!1,Re.addcts=xe;var Te={};Te.commLoaded=!1,Te.initials="",Te.bc="",Te.fc="",Te.comments=[],Te.newComment="",Re.cm=Te,Re.commentAllowed=!0,o.$on("$stateChangeStart",function(e,t,a,n,s){"answerDetail"==n.name&&"answerDetail"!=t.name&&!_e&&o.isLoggedIn&&_()});var Le=o.$on("refreshImages",function(){"answerDetail"==a.current.name&&de()}),Be=o.$on("fileUploaded",function(){"answerDetail"==a.current.name&&de()}),Ue=o.$on("answerDataLoaded",function(){Re.dataReady=!0,P()});D.$on("$destroy",Le),D.$on("$destroy",Be),D.$on("$destroy",Ue),o.answerDetailLoaded?(Re.dataReady=!0,P()):Re.dataReady=!1,window.prerenderReady=!1}angular.module("app").controller("answerDetail",e),e.$inject=["flag","$stateParams","$state","answer","dialog","$rootScope","$window","useractivity","htmlops","votes","matchrec","edit","editvote","catans","datetime","commentops","userdata","useraccnt","$location","vrows","vrowvotes","imagelist","instagram","$scope","$cookies","$q","fbusers","InstagramService"]}(),function(){"use strict";function e(t,a,n,s,o,i,r,l,c,d,g,u){function m(){s.cCategory.title.indexOf("San Diego")>-1&&(W=!0),s.cCategory.title.indexOf("Downtown")>-1&&(Y=!0);for(var e=0;e<s.districts.length;e++)s.cCategory.title.indexOf(s.districts[e])>-1&&(j=!0,z=s.districts[e])}function p(){U.emptyarray=[],U.neighborhoods=s.neighborhoods.concat(s.districts),U.fields=s.fields,U.type=s.cCategory.type,U.fields.opts=[],U.fields.val=[],U.fields.textstyle=[];for(var e=0;e<U.fields.length;e++)U.fields[e].val="","cityarea"==U.fields[e].name?U.fields[e].opts="c for c in vm.neighborhoods":U.fields[e].opts="c for c in vm.emptyarray","cityarea"==U.fields[e].name&&"Establishment"==s.cCategory.type&&1==s.NhImplied&&(U.fields[e].val=s.NhValue),
"addinfo"==U.fields[e].name?U.fields[e].textstyle="textarea":U.fields[e].textstyle="text"}function v(){q.name=U.ev.name,q.location=U.ev.location,q.addinfo=U.ev.addinfo,q.cityarea=U.ev.cityarea,q.website=U.ev.website}function h(){N=!0,U.ev.name.length<3&&(N=!1),V=N&&(U.numLinks>0||U.ngi)}function f(){a.go("rankSummary",{index:s.cCategory.id})}function b(){var e=[];if(v(),h(),!N)return void t.getDialog("missingDataImage");var a={};a.field="name",a.val=U.ev.name,a.cval=U.ev.name,e.push(a),r.getImageLinks(e,G,"add").then(k,y)}function y(){console.log("query failed, dont give up")}function w(){if(v(),h(),!V)return void t.getDialog("missingDataAnswer");e()}function k(e){for(var t=!1,a=0;a<e.length;a++){for(var n=0;n<F.length;n++)if(0==e[a].localeCompare(F[n])){t=!0;break}t||F.push(e[a])}U.numLinks=F.length,G++,(U.numLinks>10||G>=4)&&(U.searchDisabled="disabled"),G>1&&(U.imageCommand="Get more images"),U.linkIdx=0,U.imageURL=F[U.linkIdx],E(F[U.linkIdx],P),U.numLinks>0&&(U.imagefunctions="inline")}function x(){U.linkIdx++,U.linkIdx>=U.numLinks&&(U.linkIdx=0),U.imageURL=F[U.linkIdx],E(F[U.linkIdx],P)}function D(){U.linkIdx--,U.linkIdx<0&&(U.linkIdx=U.numLinks-1),U.imageURL=F[U.linkIdx],E(F[U.linkIdx],P)}function C(e){var t={};t.bc=e.bc,t.fc=e.fc,t.freq=e.freq,t.edate=e.edate,t.sdate=e.sdate,t.etime=e.etime,t.etime2=e.etime2,t.stime=e.stime,t.stime2=e.stime2,t.mon=e.mon,t.tue=e.tue,t.wed=e.wed,t.thu=e.thu,t.fri=e.fri,t.sat=e.sat,t.sun=e.sun;var a=JSON.stringify(t),o={};o.name=e.name,o.addinfo=e.addinfo,o.cityarea=e.cityarea,o.location=e.location,o.type="Event",o.website=e.website,o.imageurl=e.imageurl,o.views=0,o.eventstr=a,o.userid=s.user.id,U.bind&&(o.owner=s.user.id),$(),K&&!W?n.addAnswer2(o,[s.cCategory.id,H]).then(f):K&&W?n.addAnswer2(o,[H]).then(f):n.addAnswer(o).then(f)}function S(){var e={};e.bc=q.bc,e.fc=q.fc,e.freq=q.freq,e.edate=q.edate,e.sdate=q.sdate,e.etime=q.etime,e.etime2=q.etime2,e.stime=q.stime,e.stime2=q.stime2,e.mon=q.mon,e.tue=q.tue,e.wed=q.wed,e.thu=q.thu,e.fri=q.fri,e.sat=q.sat,e.sun=q.sun;var t=JSON.stringify(e),a=[],o=[];s.canswer.name!=U.ev.name&&(a.push("name"),o.push(U.ev.name)),s.canswer.addinfo!=U.ev.addinfo&&(a.push("addinfo"),o.push(U.ev.addinfo)),s.canswer.cityarea!=U.ev.cityarea&&(a.push("cityarea"),o.push(U.ev.cityarea)),s.canswer.location!=U.ev.location&&(a.push("location"),o.push(U.ev.location)),s.canswer.website!=U.ev.website&&(a.push("website"),o.push(U.ev.website)),s.canswer.imageurl!=U.imageURL&&(a.push("imageurl"),o.push(U.imageURL)),s.canswer.eventstr!=t&&(a.push("eventstr"),o.push(t)),s.canswer.owner!=U.ev.owner&&(a.push("owner"),o.push(U.ev.owner)),console.log("fields - ",a),console.log("vals - ",o),n.updateAnswer(U.ev.id,a,o)}function O(){t.howItWorks("addEvent")}function E(e,t,a){a=a||5e3;var n,s=!1,o=new Image;o.onerror=o.onabort=function(){s||(clearTimeout(n),t(e,"error"))},o.onload=function(){s||(clearTimeout(n),t(e,"success"))},o.src=e,n=setTimeout(function(){s=!0,t(e,"timeout")},a)}function P(e,t){"error"!=t&&"timeout"!=t||(U.imageURL=s.EMPTY_IMAGE)}function R(e){U.imageURL=e?s.EMPTY_IMAGE:F[U.linkIdx]}function A(){U.char=45-U.ev.name.length}function M(e){1==e&&(U.weekly=!1,U.onetime=!0,U.ev.freq="onetime"),2==e&&(U.weekly=!0,U.onetime=!1,U.ev.freq="weekly")}function I(){q=U.ev,q.imageurl=U.imageURL,q.date=q.sdate,"add"==s.eventmode?t.createEventPreview(q,C):t.createEventPreview(q,S)}function $(){var e="";if(Y||j||W){if(Y&&"Downtown"!=X.cityarea){e=s.cCategory.title.replace("Downtown",U.ev.cityarea);for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(K=!0,H=s.content[t].id)}if(j){e=s.cCategory.title.replace(z,"Downtown");for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(K=!0,H=s.content[t].id)}if(W){e=s.cCategory.title.replace("San Diego",U.ev.cityarea);for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(K=!0,H=s.content[t].id)}}}function _(){event.deleteEvent(q.id),a.go("specials")}function T(){a.go("rankSummary",{index:s.cCategory.id})}function L(){U.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"]}function B(){a.go("cwrapper")}var U=this;U.title="addEvent",U.header="table"+s.cCategory.id+".header",U.body="table"+s.cCategory.id+".body",U.searchDisabled="disabled",U.modalEnable=!0,U.publicfields=[],U.ranking=s.cCategory.title;var N=!1,V=!1,F=(s.events,[]);U.linkIdx=0,U.numLinks=0,U.imageCommand="Get images",U.searchDisabled="";var G=1;U.imagefunctions="none",U.ev={};var q={},j=!1,z="",Y=!1,W=!1,H=0,K=!1,X={};U.calladdEvent=w,U.rankSummary=f,U.callSearchImage=b,U.viewNext=x,U.viewPrev=D,U.closeRank=B,U.onNoGoodImages=R,U.showHowItWorksDialog=O,U.displayCharLength=A,U.frequencySel=M,U.showPreview=I,U.deleteSpecial=_,U.goBack=T,U.imageURL=s.EMPTY_IMAGE,U.header=s.header,u.innerWidth<512?(U.sm=!0,U.nsm=!1):(U.sm=!1,U.nsm=!0),function(){p(),m(),"edit"==s.eventmode&&(U.ev=JSON.parse(JSON.stringify(s.canswer)),i.formatdatetime(U.ev),U.isEdit=!0,"onetime"==U.ev.freq&&M(1),"weekly"==U.ev.freq&&M(2),console.log("vm.ev --- ",U.ev),U.imageURL=U.ev.imageurl),"add"==s.eventmode&&(U.char=45,U.ev.fc="hsl(0, 100%, 0%)",U.ev.bc="hsl(0, 0%, 100%)",M(1)),L(),console.log("Add Event Activated!")}()}angular.module("app").controller("addEvent",e),e.$inject=["dialog","$state","answer","$rootScope","$modal","datetime","image","catans","getgps","$timeout","getwiki","$window"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d){function g(){n.cCategory.title.indexOf("San Diego")>-1&&(W=!0)}function u(){T.emptyarray=[],T.neighborhoods=n.neighborhoods.concat(n.districts),T.establishmentNames=n.estNames,T.peopleNames=n.pplNames,T.placesNames=n.plaNames,T.fields=n.fields,T.type=n.cCategory.type,T.fields.opts=[],T.fields.val=[],T.fields.textstyle=[];for(var e=0;e<T.fields.length;e++)T.fields[e].val="","cityarea"==T.fields[e].name?T.fields[e].opts="c for c in vm.neighborhoods":T.fields[e].opts="c for c in vm.emptyarray","name"==T.fields[e].name&&"Establishment"==n.cCategory.type&&(T.fields[e].opts="c for c in vm.establishmentNames"),"name"==T.fields[e].name&&"Person"==n.cCategory.type&&(T.fields[e].opts="c for c in vm.peopleNames"),"name"==T.fields[e].name&&"Place"==n.cCategory.type&&(T.fields[e].opts="c for c in vm.placesNames"),"cityarea"==T.fields[e].name&&"Establishment"==n.cCategory.type&&1==n.NhImplied&&"Downtown"!=n.NhValue&&(T.fields[e].val=n.NhValue),"addinfo"==T.fields[e].name?T.fields[e].textstyle="textarea":T.fields[e].textstyle="text"}function m(){U||(X.imageurl=T.imageURL,"Short-Phrase"==n.cCategory.type&&(X.imageurl="none"),X.upV=0,X.downV=0,X.type=T.type,X.userid=n.user.id,X.views=0,G?e.checkSameAnswer(X,Q,D,S):e.addAnswer(X,T.imageURL,D),U=!0,l(function(){U=!1},1e3))}function p(){for(var e=0;e<T.fields.length;e++)switch(T.fields[e].name){case"name":X.name=T.fields[e].val;break;case"location":X.location=T.fields[e].val;break;case"addinfo":X.addinfo=T.fields[e].val;break;case"cityarea":X.cityarea=T.fields[e].val;break;case"phone":X.phone=T.fields[e].val;break;case"website":X.website=T.fields[e].val;break;case"email":X.email=T.fields[e].val}}function v(){L=!0;for(var e=0;e<T.fields.length;e++)if(T.fields[e].isrequired&&T.fields[e].val.length<3){L=!1;break}B="Short-Phrase"==n.cCategory.type||"PersonCust"==n.cCategory.type?L:L&&(T.numLinks>0||T.ngi)}function h(){t.go("rankSummary",{index:n.cCategory.id})}function f(){var t=[];if(p(),v(),!L)return void e.getDialog("missingDataImage");t=JSON.parse(JSON.stringify(T.fields)),o.getImageLinks(t,F,"add").then(w,b)}function b(){console.log("query failed, dont give up")}function y(){if(p(),v(),"Establishment"!=T.type&&"Person"!=T.type&&"Place"!=T.type||A(X),!B)return void e.getDialog("missingDataAnswer");m()}function w(e){for(var t=!1,a=0;a<e.length;a++){for(var n=0;n<V.length;n++)if(0==e[a].localeCompare(V[n])){t=!0;break}t||V.push(e[a])}T.numLinks=V.length,F++,(T.numLinks>10||F>=4)&&(T.searchDisabled="disabled"),F>1&&(T.imageCommand="Get more images"),T.linkIdx=0,T.imageURL=V[T.linkIdx],P(V[T.linkIdx],R),T.numLinks>0&&(T.imagefunctions="inline")}function k(){T.linkIdx++,T.linkIdx>=T.numLinks&&(T.linkIdx=0),T.imageURL=V[T.linkIdx],P(V[T.linkIdx],R)}function x(){T.linkIdx--,T.linkIdx<0&&(T.linkIdx=T.numLinks-1),T.imageURL=V[T.linkIdx],P(V[T.linkIdx],R)}function D(e){if(n.DEBUG_MODE&&console.log("No, different! @addAnswerConfirmed"),"Establishment"==e.type&&void 0!=e.location&&""!=e.location&&null!=e.location){r.getLocationGPS(e).then(function(){})}else O(),K&&!W?(n.DEBUG_MODE&&console.log("P1 - eqFound,inCity,eqRankIdx - ",K,W,H,e),a.addAnswer2(e,[n.cCategory.id,H]).then(h)):K&&W?(n.DEBUG_MODE&&console.log("P2 - eqFound,inCity,eqRankIdx - ",K,W,H,e),a.addAnswer2(e,[H]).then(h)):(n.DEBUG_MODE&&console.log("P3 - ",e),a.addAnswer(e).then(h)),e=void 0}function C(){N||(n.DEBUG_MODE&&console.log("@exec-addAnswerGPS"),N=!0,O(),K&&!W?(n.DEBUG_MODE&&console.log("P4 - eqFound,inCity,eqRankIdx - ",K,W,H,X),X&&a.addAnswer2(X,[n.cCategory.id,H]).then(h)):K&&W?(n.DEBUG_MODE&&console.log("P5 - eqFound,inCity,eqRankIdx - ",K,W,H,X),X&&a.addAnswer2(X,[H]).then(h)):(n.DEBUG_MODE&&console.log("P6",X),X&&a.addAnswer(X).then(h)),X=void 0)}function S(){n.DEBUG_MODE&&console.log("Yeah Same, @answerIsSame"),q?e.getDialog("answerDuplicated"):(O(),K&&!W?(n.DEBUG_MODE&&console.log("P7 - eqFound,inCity,eqRankIdx - ",K,W,H),i.postRec2(Q.id,H,!1),i.postRec2(Q.id,n.cCategory.id,!0).then(h)):K&&W?(n.DEBUG_MODE&&console.log("P8 - eqFound,inCity,eqRankIdx - ",K,W,H),i.postRec2(Q.id,H,!1).then(h)):(n.DEBUG_MODE&&console.log("P9"),i.postRec(Q.id).then(h)),X=void 0)}function O(){var e="";if(Y||j||W){if(Y&&"Downtown"!=X.cityarea){e=n.cCategory.title.replace("Downtown",X.cityarea);for(var t=0;t<n.content.length;t++)n.content[t].title==e&&(K=!0,H=n.content[t].id)}if(j){e=n.cCategory.title.replace(z,"Downtown");for(var t=0;t<n.content.length;t++)n.content[t].title==e&&(K=!0,H=n.content[t].id)}if(W){e=n.cCategory.title.replace("San Diego",X.cityarea);for(var t=0;t<n.content.length;t++)n.content[t].title==e&&(K=!0,H=n.content[t].id)}}}function E(){"Short-Phrase"==n.cCategory.type?e.howItWorks("shortPhrase"):e.howItWorks("addAnswer")}function P(e,t,a){a=a||5e3;var n,s=!1,o=new Image;o.onerror=o.onabort=function(){s||(clearTimeout(n),t(e,"error"))},o.onload=function(){s||(clearTimeout(n),t(e,"success"))},o.src=e,n=setTimeout(function(){s=!0,t(e,"timeout")},a)}function R(e,t){"error"!=t&&"timeout"!=t||(T.imageURL=n.EMPTY_IMAGE)}function A(e){if("Establishment"==T.type){for(var t=0;t<n.estAnswers.length;t++)if(e.name==n.estAnswers[t].name&&e.cityarea==n.estAnswers[t].cityarea){G=!0,Q=n.estAnswers[t];for(var a=0;a<n.catansrecs.length;a++)n.catansrecs[a].answer==n.estAnswers[t].id&&n.catansrecs[a].category==n.cCategory.id&&(q=!0)}}else if("Person"==T.type){for(var t=0;t<n.pplAnswers.length;t++)if(e.name==n.pplAnswers[t].name){G=!0,Q=n.pplAnswers[t];for(var a=0;a<n.catansrecs.length;a++)n.catansrecs[a].answer==n.pplAnswers[t].id&&n.catansrecs[a].category==n.cCategory.id&&(q=!0)}}else if("Place"==T.type)for(var t=0;t<n.plaAnswers.length;t++)if(e.name==n.plaAnswers[t].name){G=!0,Q=n.plaAnswers[t];for(var a=0;a<n.catansrecs.length;a++)n.catansrecs[a].answer==n.plaAnswers[t].id&&n.catansrecs[a].category==n.cCategory.id&&(q=!0)}}function M(){for(var e="",t=0;t<T.fields.length;t++)if("name"==T.fields[t].name){e=T.fields[t].val;break}e.length>0&&c.getWiki(e)}function I(e){for(var t=0;t<T.fields.length;t++)if("addinfo"==T.fields[t].name){T.fields[t].val=e;break}}function $(e){T.imageURL=e?n.EMPTY_IMAGE:V[T.linkIdx]}function _(){t.go("cwrapper")}var T=this;T.title="addAnswer",T.header="table"+n.cCategory.id+".header",T.body="table"+n.cCategory.id+".body",T.searchDisabled="disabled",T.modalEnable=!0,T.publicfields=[],T.ranking=n.cCategory.title;var L=!1,B=!1,U=!1,N=!1,V=(n.answers,[]);T.linkIdx=0,T.numLinks=0,T.imageCommand="Get images",T.searchDisabled="";var F=1;T.imagefunctions="none";var G=!1,q=!1,j=!1,z="",Y=!1,W=!1,H=0,K=!1,X={},Q={};T.callAddAnswer=y,T.rankSummary=h,T.callSearchImage=f,T.viewNext=k,T.viewPrev=x,T.closeRank=_,T.getWiki=M,T.onNoGoodImages=$,T.showHowItWorksDialog=E,T.imageURL=n.EMPTY_IMAGE,T.header=n.header,n.$on("answerGPSready",function(){"addAnswer"!=t.current.name||N||C()}),n.$on("wikiReady",function(e,a){"addAnswer"==t.current.name&&I(a)}),d.innerWidth<512?(T.sm=!0,T.nsm=!1):(T.sm=!1,T.nsm=!0),function(){u(),g(),n.DEBUG_MODE&&console.log("Add Answer Activated!")}()}angular.module("app").controller("addAnswer",e),e.$inject=["dialog","$state","answer","$rootScope","$modal","image","catans","getgps","$timeout","getwiki","$window"]}(),function(){"use strict";function e(e,t,a,n){function s(){return e({method:"GET",url:n+"settings/",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return a.setting=e.data.settings,e.data.settings})}function o(t){return e({method:"POST",url:n+"settings/",data:t,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return a.setting=e.data.settings,e.data.settings})}return{getSetting:s,setSetting:o}}angular.module("app").factory("setting",e),e.$inject=["$http","$q","$rootScope","SERVER_URL"]}(),angular.module("app").factory("InstagramService",["$rootScope","$location","$http","INSTAGRAM_CLIENT_ID",function(e,t,a,n){var s=n,o={_access_token:null,access_token:function(e){return angular.isDefined(e)&&(this._access_token=e),this._access_token},login:function(){var e=t.absUrl().split(t.path())[0]+"/";window.open("https://api.instagram.com/oauth/authorize/?client_id="+s+"&redirect_uri="+e+"&response_type=token&scope=likes+relationships+public_content+follower_list","Instagram Auth","width=400, height=600, centerscreen=true, chrome=yes")},getMyRecentImages:function(){return a.jsonp("https://api.instagram.com/v1/users/self/media/recent?access_token="+o.access_token())},getUserprofile:function(){return a.jsonp("https://api.instagram.com/v1/users/self/?access_token="+o.access_token()).then(function(e){return console.log(e),e}).catch(function(e){console.log(e)})}};return e.$on("igAccessTokenObtained",function(t,a){o.access_token(a.access_token.replace("#","").replace("!","")),e.$broadcast("instagramLoggedIn",{access_token:o._access_token})}),o}]),function(){"use strict";function e(e,t,a,n){function s(){return a.filterOptions=n.localStorage.getItem("Rank-X-Filters"),a.filterOptions?a.filterOptions=JSON.parse(a.filterOptions):a.filterOptions=l,a.filterOptions}function o(e){a.filterOptions=e,n.localStorage.setItem("Rank-X-Filters",JSON.stringify(e))}function i(){return a.initalHomeData=n.localStorage.getItem("Rank-X-HomeData"),!!a.initalHomeData&&(a.initalHomeData=JSON.parse(a.initalHomeData),a.$emit("initalHomeDataLoaded"),!0)}function r(e){a.initalHomeData=e,n.localStorage.setItem("Rank-X-HomeData",JSON.stringify(e))}var l={isNh:!1,isCity:!0,isNhRdy:"",cnh:"",isAllTopics:!0,ctopics:["LifeStyle","Social","Sports","Food","Beauty & Fashion","Family","Technology","Dating","City","Services","Health","Celebrities"]};return{loadFilterOptions:s,saveFilterOptions:o,saveInitalHomeData:r,loadInitalHomeData:i}}angular.module("app").factory("filter",e),e.$inject=["$http","$q","$rootScope","$window"]}(),function(){"use strict";function e(e,t,a,n){function s(e){l.push(e)}function o(e){var a=i(e);return a?t.when(a):n.api("/"+e+"?fields=first_name,gender,locale,picture,last_name,email","GET").then(function(e){return c.addFBUser(e),e},function(e){return null})}function i(e){return l.find(function(t){return t.id==e})}function r(e,t){for(var a=0;a<e.length;a++){var n=angular.copy(user[a]);c.getFBUserById(n[t]).then(function(e){})}return e}var l=[],c={findFBUserById:i,getFBUserById:o,addFBUser:s,loadProfilePicture:r};return c}angular.module("app").factory("fbusers",e),e.$inject=["$http","$q","$rootScope","$facebook"]}(),angular.module("app").directive("fileModel",["$parse",function(e){"use strict";return{restrict:"A",link:function(t,a,n){var s=e(n.fileModel),o=s.assign;a.bind("change",function(){t.$apply(function(){o(t,a[0].files[0])})})}}}]),angular.module("app").directive("bgBox2",["color",function(e){"use strict";return{templateUrl:"app/common/partials/bgbox2.html",transclude:!0,scope:{bc:"@",bc2:"@",fc:"@",shade:"@",text:"@",dir:"@",stats:"@",w:"@",h:"@"},link:function(t){var a=JSON.parse(t.stats);t.views=a.views,t.answers=a.answers,t.comments=a.numcom,"horizontal"==t.dir&&(t.dirHor=!0,t.dirVer=!1),"vertical"==t.dir&&(t.dirHor=!1,t.dirVer=!0),void 0==t.bc2&&(t.bc2=e.shadeColor(t.bc,t.shade/10))}}}]),angular.module("app").directive("bgBox",["color",function(e){"use strict";return{templateUrl:"app/common/partials/bgbox.html",transclude:!0,scope:{bc:"@",bc2:"@",fc:"@",shade:"@",text:"@",dir:"@",w:"@",h:"@"},link:function(t){"horizontal"==t.dir&&(t.dirHor=!0,t.dirVer=!1),"vertical"==t.dir&&(t.dirHor=!1,t.dirVer=!0),void 0==t.bc2&&(t.bc2=e.shadeColor(t.bc,t.shade/10))}}}]),function(){"use strict";angular.module("app").filter("orderObjectBy",function(){return function(e,t,a){var n=[];return angular.forEach(e,function(e){n.push(e)}),n.sort(function(e,a){return e[t]>a[t]?1:-1}),a&&n.reverse(),n}}).filter("objectLength",function(){return function(e){return e?Object.keys(e).length:0}}).filter("searchObject",function(){return function(e,t,a){function n(e,t){return e=(""+e).toLowerCase(),t=(""+t).toLowerCase(),-1!==e.indexOf(t)}if(!e)return null;var s=[];if(!t){for(var o=Object.keys(e),i=0,r=o.length;i<r;i++)s.push(e[o[i]]);return s}return angular.forEach(e,function(e){if(a&&""!=a)e[a]&&n(e[a],t)&&s.push(e);else for(var o=Object.keys(e),i=0,r=o.length;i<r;i++)if(n(e[o[i]],t)){s.push(e);break}}),s}})}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return c=e.data.resource}if(r()&&!a)return t.when(c);var s=d;return e.get(s).then(n,l)}function s(t,a){function n(e){console.log("Creating new query record was succesful")}var s={};s.resource=[];var o={};o.query=t,o.results=a,o.timestmp=Date.now(),s.resource.push(o);var i=d;return e.post(i,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,l)}function o(t){function a(e){console.log("Flushing queries db was succesful")}({}).resource=t,console.log("obj ---",t);var n=d;return e.delete(n,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(a,l)}function i(t){function a(e){return console.log("Deleting record was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var o=d+"/"+t;return e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/queries";return{getQueries:n,postQuery:s,flushAll:o,deleteRec:i}}angular.module("app").factory("query",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return i=e.data.resource}if(s()&&!a)return t.when(i);var l=r;return e.get(l).then(n,o)}function s(){return i.length>0}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/codeprice";return{get:n}}angular.module("app").factory("codeprice",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return i=e.data.resource}if(s()&&!a)return t.when(i);var l=r;return e.get(l).then(n,o)}function s(){return i.length>0}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/categorycode";return{get:n}}angular.module("app").factory("categorycode",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){var n=this;n.title="views",n.content=t.content,function(){console.log("views page Loaded!")}()}angular.module("app").controller("views",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){if(!p){p=!0;var e="",a=[],n=[];m.res=[];for(var o=!0,i="",r="",c=0;c<t.cblocks.length;c++){i="",r="",o=!0,{},n=[];for(var d=0;d<t.headlines.length;d++)if(t.cblocks[c].type==t.headlines[d].type){"city"==t.cblocks[c].scope&&(e=t.headlines[d].filter+" isMP"),"rx"==t.cblocks[c].scope&&(e=t.headlines[d].filter),"nh"==t.cblocks[c].scope&&(e=t.headlines[d].filter+" "+t.cblocks[c].scopename),a=e.split(" ");break}for(var g="",u=0;u<t.content.length;u++){g=t.content[u].tags+" "+t.content[u].title,o=!0;for(var v=0;v<a.length;v++){var h=a[v].charAt(0).toUpperCase()+a[v].slice(1),f=a[v].charAt(0).toLowerCase()+a[v].slice(1);o=o&&(g.indexOf(a[v])>-1||g.indexOf(a[v].toUpperCase())>-1||g.indexOf(h)>-1||g.indexOf(f)>-1)}o&&n.push(t.content[u].id)}l(n);for(var b=0;b<n.length;b++)i=i+":"+n[b];r=i.substring(1),s.update(t.cblocks[c].id,["catstr"],[r])}}}function r(){for(var e=!1,a=[],n=0;n<t.content.length;n++)t.content[n].title.indexOf("in Hillcrest")>-1&&a.push(t.content[n]);for(var s=0;s<a.length;s++){for(var i="",r="",l=a[s].title.replace("Hillcrest","San Diego"),c=0;c<t.content.length;c++)if(l==t.content[c].title){if(null==t.content[c].catstr||void 0==t.content[c].catstr||0==t.content[c].catstr.length){var d=t.content[c].id;if(473!=d&&3125!=d&&6949!=d&&7424!=d&&7675!=d&&3124!=d&&3163!=d&&3202!=d){console.log("Found gen rank --- ",t.content[c].title," ",t.content[c].id);for(var g=t.content[c].title.replace("San Diego",""),u=0;u<t.content.length;u++)t.content[u].title.indexOf(g)>-1&&u!=c&&(i=i+":"+t.content[u].id);r=i.substring(1),console.log("final catstr ---",r),o.update(t.content[c].id,["isatomic","catstr"],[!1,r])}}break}i="",r="",l=a[s].title.replace("Hillcrest","Downtown");for(var c=0;c<t.content.length;c++)if(l==t.content[c].title){if(null==t.content[c].catstr||void 0==t.content[c].catstr||0==t.content[c].catstr.length){var d=t.content[c].id;if(473!=d&&3125!=d&&6949!=d&&7424!=d&&7675!=d&&3124!=d&&3163!=d&&3202!=d){console.log("Found gen rank --- ",t.content[c].title," ",t.content[c].id);for(var g=t.content[c].title.replace("Downtown",""),u=0;u<t.content.length;u++)if(t.content[u].title.indexOf(g)>-1&&u!=c){e=!1;for(var n=0;n<t.districts.length;n++)t.content[u].title.includes(t.districts[n])&&(e=!0);e&&(i=i+":"+t.content[u].id)}r=i.substring(1),console.log("final catstr ---",r),o.update(t.content[c].id,["isatomic","catstr"],[!1,r])}}break}}}function l(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[a],e[a]=t;return e}function c(){if(!v){for(var e=["rankofweek","city","lifestyle","food","politics","services","social","beauty","sports","personalities","technology","dating","health"],t={},a=0;a<e.length;a++)t={},t.scope="city",t.ismp=!0,t.scopename="San Diego",t.catstr="0",t.type=e[a],s.addcblock(t);v=!0}}function d(){if(!f){for(var e=["rankofweeknh","neighborhood","lifestyle","food","services","social","beauty","health"],t={},a=0;a<h.length;a++)for(var n=0;n<e.length;n++)t={},t.scope="nh",t.ismp=!1,t.scopename=h[a],t.catstr="0",t.type=e[n],s.addcblock(t);f=!0}}function g(){if(!b){for(var e=["rxfeedback","rxsuggestion"],t={},a=0;a<e.length;a++)t={},t.scope="rx",t.scopename="RankX",t.ismp=!1,t.catstr="0",t.type=e[a],s.addcblock(t);b=!0}}function u(){for(var e=0;e<t.cblocks.length;e++)s.deleteRec(t.cblocks[e].id)}var m=this;m.title="updateHeaders",m.refresh=i,m.createCBlocksRecsCity=c,m.createCBlocksRecsNh=d,m.createCBlocksRecsRankX=g,m.deleteCBlocks=u,m.catStrings=r,m.isAdmin=t.isAdmin;var p=!1;!function(){console.log("updateHeaders page Loaded!")}();var v=!1,h=t.neighborhoods.concat(t.districts),f=!1,b=!1}angular.module("app").controller("updateHeaders",e),e.$inject=["$location","$rootScope","$state","headline","cblock","table"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c){function d(){function e(e){return e}var a=new Date,n=a.getTimezoneOffset();a.setMinutes(a.getMinutes()-n);var s=e(a.getMonth()+1)+"/"+e(a.getDate())+"/"+a.getFullYear();O=o.date2number(s),g(),t.DEBUG_MODE&&console.log("rodconsole page Loaded!")}function g(){var e=[];S=[],n.getall().then(function(t){S=t;for(var a=0;a<S.length;a++)if(e=m(S[a].main),e[0]){if(S[a].title=e[0].title,S[a].rankid=e[0].id,S[a].fimage=e[0].fimage,S[a].bc=e[0].bc,S[a].fc=e[0].fc,S[a].shade=e[0].shade,S[a].image1=e[0].image1url,S[a].image2=e[0].image2url,S[a].image3=e[0].image3url,S[a].isatomic=e[0].isatomic,S[a].shade=e[0].shade,S[a].datenum=o.date2number(S[a].date),void 0==S[a].bc||""==S[a].bc){var n=s.defaultRankColor(e[0]);S[a].bc=n[0],S[a].fc=n[1],S[a].shade=0}void 0!=S[a].fimage&&""!=S[a].fimage?(S[a].imageok=!0,E=!0):(S[a].imageok=!1,E=!1),void 0!=S[a].introtext&&""!=S[a].introtext?S[a].textok=!0:S[a].textok=!1}w(),u(),C.dataReady=!0})}function u(e){if("all"==e&&(C.next20IsSelected=!1,C.allIsSelected=!0),"next20"==e&&(C.next20IsSelected=!0,C.allIsSelected=!1),C.rods=[],C.next20IsSelected)for(var t=0;t<S.length;t++)S[t].datenum>=O&&C.rods.push(S[t]);else C.rods=S}function m(e){for(var a=e.split(" "),n="",s=[],o=0;o<t.content.length;o++){var i=!0;n=t.content[o].title;for(var r=0;r<a.length;r++){var l=a[r].charAt(0).toUpperCase()+a[r].slice(1),c=a[r].charAt(0).toLowerCase()+a[r].slice(1);i=i&&(n.indexOf(a[r])>-1||n.indexOf(a[r].toUpperCase())>-1||n.indexOf(l)>-1||n.indexOf(c)>-1)}if(i){s.push(t.content[o]);break}}return s}function p(e){C.overview=!1,C.detail=!0,C.rank=e,void 0!=C.rank.fimage&&""!=C.rank.fimage&&(C.rank.image3=C.rank.image2,C.rank.image2=C.rank.image1,C.rank.image1=C.rank.fimage),console.log(C.rank.bc),P="h"!=C.rank.bc.charAt(0)?C.rank.bc:s.hsl2rgb(C.rank.bc),C.rank.bc2=s.shadeColor(P,C.rank.shade/10),t.cmd1exe=!1,console.log("selRank",C.rank)}function v(){C.overview=!0,C.detail=!1}function h(){a.go("cwrapper")}function f(){C.rank.shade=C.rank.shade+1,C.rank.shade>10&&(C.rank.shade=10),P=s.hsl2rgb(C.rank.bc),C.rank.bc2=s.shadeColor(P,C.rank.shade/10)}function b(){C.rank.shade=C.rank.shade-1,C.rank.shade<-10&&(C.rank.shade=-10),P=s.hsl2rgb(C.rank.bc),C.rank.bc2=s.shadeColor(P,C.rank.shade/10)}function y(){E?(C.rank.fimage=t.blobimage,C.rank.image1=C.rank.fimage):(C.rank.fimage=t.blobimage,C.rank.image3=C.rank.image2,C.rank.image2=C.rank.image1,C.rank.image1=C.rank.fimage),t.cmd1exe=!1}function w(){function e(e,t){return o.date2number(e.date)-o.date2number(t.date)}S=S.sort(e)}function k(){if(void 0!=C.rank.fimage&&""!=C.rank.fimage){var e=["fimage","bc","fc","shade"];"h"==C.rank.bc.charAt(0)&&(C.rank.bc=s.hsl2rgb(C.rank.bc)),"h"==C.rank.fc.charAt(0)&&(C.rank.fc=s.hsl2rgb(C.rank.fc));var a=[C.rank.fimage,C.rank.bc,C.rank.fc,C.rank.shade],n="",o=[];if(C.rank.isatomic)console.log("rank:",C.rank.title),l.update(C.rank.rankid,e,a).then(function(){i.getDialog("rodimageuploadsuccess"),g(),v()});else{C.dataReady=!1,C.loadText="Saving data...",n=C.rank.title.replace(" in San Diego","");for(var c=0;c<t.content.length;c++)t.content[c].title.indexOf(n)>-1&&o.push(l.update(t.content[c].id,e,a));r.all(o).then(function(){C.dataReady=!0,i.getDialog("rodimageuploadsuccess"),g(),v()})}}else i.getDialog("nouploadedimage")}function x(){n.update(C.rank.id,["introtext"],[C.rank.introtext]).then(function(){i.getDialog("introTextSaved"),g()})}function D(){if(void 0!=C.rank.fimage&&""!=C.rank.fimage){c.deleteBlob(C.rank.fimage);var e=t.content.map(function(e){return e.id}).indexOf(C.rank.rankid),a=s.defaultRankColor(t.content[e]),n=["fimage","bc","fc","shade"],o=["",a[0],a[1],0],d="",u=[];if(C.rank.isatomic)l.update(C.rank.rankid,n,o).then(function(){i.getDialog("rodimagedeletesuccess"),g(),v()});else{C.dataReady=!1,C.loadText="Deleting image...",d=C.rank.title.replace(" in San Diego","");for(var m=0;m<t.content.length;m++)t.content[m].title.indexOf(d)>-1&&u.push(l.update(t.content[m].id,n,o));r.all(u).then(function(){C.dataReady=!0,i.getDialog("rodimagedeletesuccess"),g(),v()})}}else i.getDialog("nouploadedimage")}var C=this;C.title="rodconsole",C.selRank=p,C.goBack=v,C.plusShade=f,C.minusShade=b,C.refreshImages=y,C.filterData=u,C.goSaveImage=k,C.goSaveText=x,C.goDeleteImage=D,C.dataReady=!1;var S=[],O=0;C.overview=!0,C.detail=!1,C.rank={},C.sm=t.sm,C.allIsSelected=!0,C.next20IsSelected=!1,C.loadText="Loading data...";var E=!1;t.canswer={},t.canswer.id="featuredImages",C.testimage=t.EMPTY_IMAGE;var P="";t.$on("fileUploaded",function(e,n){t.cmd1exe=!!t.cmd1exe&&t.cmd1exe,"rodconsole"!=a.current.name||t.cmd1exe||(t.cmd1exe=!0,t.blobimage=n,y())}),i.enterPassword(d,h)}angular.module("app").controller("rodconsole",e),e.$inject=["$location","$rootScope","$state","rankofday","color","datetime","dialog","$q","table","imagelist"]}(),function(){"use strict";function e(e,t,a,n){function s(){for(var e=0;e<o.queries.length;e++)n.deleteRec(o.queries[e].id)}var o=this;o.title="queries",o.clearDb=s,o.isAdmin=t.isAdmin,function(){n.getQueries().then(function(e){o.queries=e,console.log("Queries Loaded!")})}()}angular.module("app").controller("queries",e),e.$inject=["$location","$rootScope","$state","query"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u){function m(){o.changeCommissionDlg(D.STRIPE_COMMISSION_PERCENTAGE,p)}function p(e){g.setSetting({STRIPE_COMMISSION_PERCENTAGE:parseInt(e)/100}).then(function(e){D.STRIPE_COMMISSION_PERCENTAGE=e.STRIPE_COMMISSION_PERCENTAGE})}function v(e){-1!=D.selectedPromoters.indexOf(e)?D.selectedPromoters.splice(D.selectedPromoters.indexOf(e),1):D.selectedPromoters.push(e)}function h(){D.selectedPromoters.forEach(function(e){D.payPromoter(e)})}function f(e){e.stripeid?r.payPromoter(e,D.STRIPE_COMMISSION_PERCENTAGE).then(function(t){D.notifications.push({message:"$"+e.balance*D.STRIPE_COMMISSION_PERCENTAGE+"transfered successfully to Promoter: "+e.firstname+" "+e.lastname,type:"success"}),e.lastPaymentDate=t.data.lastPaymentDate,e.payedThisMonth=!0}).catch(function(t){D.notifications.push({message:"$"+e.balance*D.STRIPE_COMMISSION_PERCENTAGE+"  to Promoter: "+e.firstname+" "+e.lastname+" transfer failed. ",type:"error"})}):window.alert("The promoter"+e.firstname+" "+e.lastname+" need to connect stipe account.")}function b(e){c.getAnswer(e.answer).then(function(t){e.answerObj=t})}function y(e){D.currentPromoter=e,D.detailview=!0,D.overview=!1}function w(){if(1==D.detailview)return D.overview=!0,void(D.detailview=!1)}function k(e){o.showBusinessDetailDlg(e,D.STRIPE_COMMISSION_PERCENTAGE)}function x(e){a.go("answerDetail",{index:e.slug})}var D=this;D.title="payment",D.dataReady=!1,D.promoters=[],D.isAdmin=t.isAdmin,D.detailview=!1,D.overview=!0,D.notifications=[],D.selectedPromoters=[],D.payPromoter=f,D.gotoanswer=x,D.goBack=w,D.goDetailView=y,D.showBusinessDetail=k,D.addOrRemovePromoter=v,D.paySelectedPromoters=h,D.changeCommission=m,function(){i.all([l.getall(),r.getallaccnts(),d.get(),g.getSetting()]).then(function(e){var a=e[1],n=e[2];e[0].forEach(function(s){var o=angular.copy(s);o.businesses=[];for(var i=0;i<a.length;i++)if(a[i].promocode==s.code){var r=angular.copy(a[i]);"Basic"==r.status&&(r.style="background-color:#bfbfbf"),r.istrial?(r.status="On Trial "+Math.ceil(moment.duration(moment(r.discountEndDate)-moment()).asDays())+" Days left",r.style="background-color:#b3b300"):(r.status="Active",r.style="background-color:#009900");for(var l=0;l<n.length;l++)if(n[l].code==r.bizcat){r.price=n[l].price;break}r.totalCommission=0,r.ispremium&&(r.totalCommission+=r.price*D.STRIPE_COMMISSION_PERCENTAGE),r.hasranks&&(r.totalCommission+=35*r.ranksqty*D.STRIPE_COMMISSION_PERCENTAGE),o.businesses.push(r),b(o.businesses[o.businesses.length-1])}for(o.payedThisMonth=!0,o.lastPaymentDate||(o.payedThisMonth=!1),(moment(o.lastPaymentDate).year()==moment(t.setting.serverDate).year()&&moment(o.lastPaymentDate).month()<moment(t.setting.serverDate).month()||moment(o.lastPaymentDate).year()<moment(t.setting.serverDate).year())&&(o.payedThisMonth=!1),o.balance=0,
i=0;i<o.businesses.length;i++)"Active"==o.businesses[i].status&&(o.balance+=o.businesses[i].monthlyCost);o.activeCount=o.businesses.filter(function(e){return"Active"==e.status}).length,o.ontrialCount=o.businesses.filter(function(e){return-1!=e.status.indexOf("On Trial")}).length,D.promoters.push(o),D.STRIPE_COMMISSION_PERCENTAGE=e[3].STRIPE_COMMISSION_PERCENTAGE?e[3].STRIPE_COMMISSION_PERCENTAGE:.2}),D.dataReady=!0})}(),function(){console.log("payment admin page Loaded!")}()}angular.module("app").controller("payment",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$q","useraccnt","promoter","answer","codeprice","setting","$timeout"]}(),function(){"use strict";function e(e,t,a,n,s,o,i){function r(){console.log("@getData"),console.log("$rootScope.catansrecs.length ",t.catansrecs.length),h.idx=f;var e={},a={},n=0,s=0;h.ans1=t.dupAns[f].ans1,h.ans2=t.dupAns[f].ans2,u(),h.ans1.catans=[],n=h.ans1.id;for(var o=0;o<t.catansrecs.length;o++)if(n==t.catansrecs[o].answer){e=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(e.rank=t.content[i].title);h.ans1.catans.push(e)}h.ans2.catans=[],s=h.ans2.id;for(var o=0;o<t.catansrecs.length;o++)if(s==t.catansrecs[o].answer){a=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(a.rank=t.content[i].title);h.ans2.catans.push(a)}console.log("vm.ans1.catans.length ",h.ans1.catans.length),console.log("vm.ans2.catans.length ",h.ans2.catans.length)}function l(e){f-=e,f<0&&(f=0),r()}function c(e){f+=e,f>=h.tot&&(f=h.tot),r()}function d(e){1==e&&(o.deleteAnswer(t.dupAns[f].ans1.id),n.deleteAnswer(t.dupAns[f].ans1.id)),2==e&&(o.deleteAnswer(t.dupAns[f].ans2.id),n.deleteAnswer(t.dupAns[f].ans2.id))}function g(e){if(1==e){h.addcts1opts=[];for(var t="",a=0;a<b.length;a++)b[a].indexOf("@neighborhood")>-1?(t=b[a].replace("@neighborhood",h.ans1.cityarea),h.addcts1opts.push(t)):h.addcts1opts.push(b[a]);h.addcts1active=!0}if(2==e){h.addcts2opts=[];for(var n="",a=0;a<b.length;a++)b[a].indexOf("@neighborhood")>-1?(n=b[a].replace("@neighborhood",h.ans2.cityarea),h.addcts2opts.push(n)):h.addcts2opts.push(b[a]);h.addcts2active=!0}}function u(){b=[];for(var e="",a=0;a<t.content.length;a++)t.content[a].title.indexOf("in Hillcrest")>-1&&(e=t.content[a].title.replace("Hillcrest","@neighborhood"),b.push(e)),t.content[a].tags.indexOf("isMP")>-1&&b.push(t.content[a].title)}function m(e){var a="",s={},o=0,i=!1;1==e&&(a=h.addcts1val,s=h.ans1,i=void 0!=h.cat1isdup&&h.cat1isdup),2==e&&(a=h.addcts2val,s=h.ans2,i=void 0!=h.cat2isdup&&h.cat2isdup);for(var l=0;l<t.content.length;l++)if(t.content[l].title==a){o=t.content[l].id;break}n.postRec2(s.id,o,i),1==e&&(h.addcts1active=!1),2==e&&(h.addcts2active=!1),setTimeout(function(){r()},1e3)}function p(e){n.deleteRec(e.answer,e.category),setTimeout(function(){r()},1e3)}function v(e){1==e&&a.go("editAnswer",{index:h.ans1.id}),2==e&&a.go("editAnswer",{index:h.ans2.id})}var h=this;h.title="mergeAnswers";var f=0;h.goPrev=l,h.goNext=c,h.delAnswer=d,h.addCatans=g,h.addcts=m,h.delCatans=p,h.editAnswer=v,h.addcts1active=!1,h.addcts2active=!1;var b=[];!function(){h.tot=t.dupAns.length-1,u(),r(),console.log("mergeAnswers page Loaded!")}()}angular.module("app").controller("mergeAnswers",e),e.$inject=["$location","$rootScope","$state","catans","$http","answer","$stateParams"]}(),function(){"use strict";function e(e,t,a,n,s){function o(){console.log("getRanks");for(var e="",a=0;a<t.content.length;a++)(t.content[a].title.indexOf("restaurant")>-1||t.content[a].title.indexOf("food")>-1||t.content[a].tags.indexOf("food")>-1)&&(e=e+":"+t.content[a].id);for(var s=e.substring(1),o=s.split(":").map(Number),i={},r=0,l=0,c=[],d=!1,a=0;a<t.catansrecs.length;a++){i=t.catansrecs[a];for(var g=0;g<o.length;g++)if(i.category==o[g]){if(r=i.answer,l=t.answers.map(function(e){return e.id}).indexOf(r),l<0&&(console.log("idx - ",r,"catansrec - ",i.id,i.answer,i.category),n.deleteRec(i.answer,i.category)),d=!1,c.length>0&&l>0)for(var u=0;u<c.length;u++)if(c[u].id==t.answers[l].id){d=!0;break}d||c.push(t.answers[l])}}console.log("Food ranks: - ",s),console.log("Food ranks length: - ",o.length)}var i=this;i.title="foodRanks",i.getRanks=o,function(){console.log("foodRanks page Loaded!")}()}angular.module("app").controller("foodRanks",e),e.$inject=["$location","$rootScope","$state","catans","$http"]}(),function(){"use strict";function e(e,t,a,n){function s(){n.getFlags().then(function(e){o.flags=e;for(var t=0;t<o.flags.length;t++){if("comment-rank"==o.flags[t].type||"comment-answer"==o.flags[t].type)switch(o.flags[t].flag){case 1:o.flags[t].desc="Off-Topic";break;case 2:o.flags[t].desc="Offensive";break;case 3:o.flags[t].desc="Spam"}if("answer"==o.flags[t].type)switch(o.flags[t].flag){case 1:o.flags[t].desc="Wrong Category";break;case 2:o.flags[t].desc="No longer active";break;case 3:o.flags[t].desc="Offensive";break;case 4:o.flags[t].desc="Spam"}}})}var o=this;o.title="flags",o.getFlags=s,function(){console.log("Flags page loaded!")}()}angular.module("app").controller("flags",e),e.$inject=["$location","$rootScope","$state","flag"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r){function l(){console.log("query Answer"),g.ansRes=[];for(var e=0,a={},n=0;n<t.answers.length;n++)t.answers[n].name.indexOf(g.val)>-1&&g.ansRes.push(t.answers[n]);for(var s=0;s<g.ansRes.length;s++){g.ansRes[s].catans=[],e=g.ansRes[s].id;for(var o=0;o<t.catansrecs.length;o++)if(e==t.catansrecs[o].answer){a=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(a.rank=t.content[i].title);g.ansRes[s].catans.push(a)}}}function c(e){r.deleteRec(e.answer,e.category)}function d(e){i.deleteAnswer(e.id)}var g=this;g.title="dbQuery",g.queryAnswer=l,g.delCatans=c,g.delAnswer=d,g.isAdmin=t.isAdmin,function(){g.isDET=t.isLoggedIn&&(12==t.user.id||30==t.user.id||41==t.user.id||42==t.user.id||30==t.user.id),console.log("dbQuery page Loaded!")}()}angular.module("app").controller("dbQuery",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","answer","catans"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g,u,m){function p(){var e=0,a=!1,n={};_.unrefans=[];for(var s=0;s<t.answers.length;s++){e=t.answers[s],a=!1;for(var o=0;o<t.catansrecs.length;o++)if(t.catansrecs[o].answer==e.id){a=!0;break}0==a&&(n.name=e.name,n.id=e.id,_.unrefans.push(n))}_.unrefans.length>0?_.showDelete=!0:_.showDelete=!1}function v(){for(var e=0;e<_.unrefans.length;e++)l.deleteAnswer(_.unrefans[e].id)}function h(){console.log("@ Show Possible Duplicated"),console.log("answers length",t.answers.length);var e={},a={};_.dupAnswers=[];for(var n=0,s=0,o="",i=0;i<t.answers.length;i++)if(s=.75*t.answers[i].name.length,e=t.answers[i],o=t.answers[i].name.slice(0,s),"Establishment"==t.answers[i].type&&o.length>8)for(var r=0;r<t.answers.length;r++)t.answers[r].name.indexOf(o)>-1&&i!=r&&(a={},a.id=n,a.add1=e.addinfo,a.nh1=e.cityarea,a.loc1=e.location,a.name1=e.name,a.image1=e.imageurl,a.id1=e.id,a.name2=t.answers[r].name,a.idx1=i,a.idx2=r,a.loc2=t.answers[r].location,a.nh2=t.answers[r].cityarea,a.add2=t.answers[r].addinfo,a.image2=t.answers[r].imageurl,a.id2=t.answers[r].id,_.dupAnswers.push(a),n++);console.log("finished")}function f(e){for(var a=0;a<t.catansrecs.length;a++)if(e.id2==t.catansrecs[a].answer){c.updateRec(t.catansrecs[a].id,["answer"],[e.id1]);break}l.deleteAnswer(e.id2),h()}function b(e){for(var a=0;a<t.catansrecs.length;a++)if(e.id1==t.catansrecs[a].answer){c.updateRec(t.catansrecs[a].id,["answer"],[e.id2]);break}l.deleteAnswer(e.id1),h()}function y(){var e={},a={};_.dupAnsNames=[];for(var n=0,s=0;s<t.answers.length;s++){e=t.answers[s];for(var o=0;o<t.answers.length;o++)e.name==t.answers[o].name&&e.cityarea==t.answers[o].cityarea&&s!=o&&(a={},a.id=n,a.add1=e.addinfo,a.nh1=e.cityarea,a.loc1=e.location,a.name1=e.name,a.image1=e.imageurl,a.id1=e.id,a.name2=t.answers[o].name,a.idx1=s,a.idx2=o,a.loc2=t.answers[o].location,a.nh2=t.answers[o].cityarea,a.add2=t.answers[o].addinfo,a.image2=t.answers[o].imageurl,a.id2=t.answers[o].id,_.dupAnsNames.push(a),n++)}}function w(){t.fields=t.typeSchema[6].fields;for(var e={},a={},n=[],s=0,o=0;o<t.answers.length;o++)if(e=t.answers[o],void 0!=e.location&&""!=e.location)for(var i=0;i<t.answers.length;i++)void 0!=t.answers[i].location&&""!=t.answers[i].location&&e.location==t.answers[i].location&&o!=i&&(a={},a.ans1=e,a.ans2=t.answers[i],n.push(a),s++);t.dupAns=n,console.log("@finished - showDuplicatedByLocation"),_.dupAnsRdy=!0}function k(){a.go("mergeAnswers")}function x(){}function D(){for(var e=[],a=0;a<t.content.length;a++)for(var n=a;n<t.content.length;n++)t.content[a].title==t.content[n].title&&a!=n&&(console.log("duplicated rank --- ",t.content[a].title),e.push(t.content[a]))}function C(){console.log("Clearing all catans vote sums to zero");for(var e=0;e<t.catansrecs.length;e++)0==t.catansrecs[e].upV&&0==t.catansrecs[e].downV||c.updateRec(t.catansrecs[e].id,["upV","downV"],[0,0])}function S(){console.log("syncUSerVotes"),d.loadAllVotes().then(function(e){t.allvotes=e,O()})}function O(){console.log("syncVotes");var e={},a={},n=[],s=[],o=0,i=0;_.syncp=[];for(var r={},l=0;l<t.catansrecs.length;l++){e=t.catansrecs[l],n=[],s=[],a={};for(var c=0;c<t.allvotes.length;c++)a=t.allvotes[c],a.catans==e.id&&(1==a.vote&&n.push(a),-1==a.vote&&s.push(a));n.length==e.upV&&s.length==e.downV||(r={},o=t.answers.map(function(e){return e.id}).indexOf(e.answer),i=t.content.map(function(e){return e.id}).indexOf(e.category),r.answername=t.answers[o].name,r.categorytitle=t.content[i].title,r.answer=t.answers[o].id,r.catans=e.id,r.category=t.content[i].id,r.caUpV=e.upV,r.caDownV=e.downV,r.nUpVlen=n.length,r.nDownVlen=s.length,_.syncp.push(r))}}function E(e){c.updateRec(e.catans,["upV","downV"],[e.nUpVlen,e.nDownVlen])}function P(){console.log("@estDistances, need to have GPS location stored-",t.answers.length),_.answerdist=[];for(var e=.017453292519943295,a=Math.cos,n=0,s=t.currentUserLatitude,o=t.currentUserLongitude,i=0,r=0,l=0,c={},d=0;d<t.answers.length;d++)"Establishment"==t.answers[d].type&&void 0!=t.answers[d].location&&""!=t.answers[d].location&&(i=t.answers[d].lat,r=t.answers[d].lng,c=t.answers[d],n=.5-a((i-s)*e)/2+a(s*e)*a(i*e)*(1-a((r-o)*e))/2,l=12742*Math.asin(Math.sqrt(n))/1.609,c.dist=l,(l>100||NaN==l)&&_.answerdist.push(c))}function R(e){a.go("answerDetail",{index:e.id})}function A(){for(var e=[],a={},n=1256,s=0;s<t.answers.length;s++)t.answers[s].imageurl.indexOf("http://")>-1&&(a={},a.id=n++,a.answer=t.answers[s].id,a.url=t.answers[s].imageurl,e.push(a));console.log(JSON.stringify(e))}function M(){var e=[],t="";g.get("../../../assets/images.json").then(function(a){e=a.data;for(var n=0;n<e.length;n++)e[n].url.indexOf("jpg")>-1&&(t="jpg"),e[n].url.indexOf("png")>-1&&(t="png"),e[n].url.indexOf("jpeg")>-1&&(t="jpeg"),l.updateAnswer(e[n].answer,["image"],["https://rankx.blob.core.windows.net/sandiego/"+e[n].answer+"/"+e[n].id+"."+t])})}function I(){var e=0,a={},n=0,s=0,i=u.get(),r=m.get();return o.all([i,r]).then(function(o){t.catcodes=o[0],t.codeprices=o[1],console.log("Category-codes loaded...");for(var i=0;i<t.answers.length;i++){if("Establishment"==t.answers[i].type)for(var r=0;r<t.catansrecs.length;r++)if(t.catansrecs[r].answer==t.answers[i].id){e=t.catansrecs[r].category;var c=t.content.map(function(e){return e.id}).indexOf(e);a=t.content[c];for(var d=0;d<t.catcodes.length;d++)if(a.title.indexOf(t.catcodes[d].category)>-1)if(void 0==t.answers[i].bizcat)console.log("---------- undefined!!------");else{for(var g=0;g<t.codeprices.length;g++)t.codeprices[g].code==t.answers[i].bizcat&&(n=t.codeprices[g].scale),t.codeprices[g].code==t.catcodes[d].code&&(s=t.codeprices[g].scale);s>n&&l.updateAnswer(t.answers[i].id,["bizcat"],[t.catcodes[d].code])}}i%100==0&&console.log(i," of ",t.answers.length)}})}function $(){}var _=this;_.title="dbMaint",_.showUrefAns=p,_.deleteAnswers=v,_.showPossibleDuplicated=h,_.syncToFirst=f,_.syncToSecond=b,_.showDuplicatedOnlyName=y,_.showDuplicatedByLocation=w,_.findPhoneWebsite=x,_.findDuplicatedRanks=D,_.clearAllCatansVotes=C,_.syncUserVotes=S,_.getAnswerBizCode=I,_.updatecatans=E,_.estDistances=P,_.gotoAnswer=R,_.createImagesJSON=A,_.updateUrls=M,_.goMerge=k,_.getSlugs=$,_.isAdmin=t.isAdmin,_.dupAnsRdy=!1,function(){console.log("dbMaint page Loaded!")}()}angular.module("app").controller("dbMaint",e),e.$inject=["$location","$rootScope","$state","$stateParams","Upload","$q","table","dialog","answer","catans","votes","$http","categorycode","codeprice"]}(),function(){"use strict";function e(e,t,a){function n(){m.selKeywords="active",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("queries")}function s(){m.selKeywords="",m.selViews="active",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("views")}function o(){m.selKeywords="",m.selViews="",m.selFlags="active",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("flags")}function i(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="active",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("addRank")}function r(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="active",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("dbMaint")}function l(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="active",m.selUpdate="",m.selFoodRanks="",m.selPayment="",a.go("dbQuery")}function c(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="active",m.selFoodRanks="",m.selPayment="",a.go("updateHeaders")}function d(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="active",m.selPayment="",a.go("foodRanks")}function g(){m.selKeywords="",m.selViews="",m.selFlags="",m.selRankings="",m.selDbMaint="",m.selQuery="",m.selUpdate="",m.selFoodRanks="",m.selPayment="active",a.go("payment")}function u(){a.go("content")}var m=this;m.title="admin",m.selKeywords="active",m.selViews="",m.selFlags="",m.selRankings="",m.goBack=u,m.keywords=n,m.views=s,m.flags=o,m.addRank=i,m.dbMaint=r,m.dbQuery=l,m.update=c,m.foodranks=d,m.payment=g,function(){m.isDET=t.isLoggedIn&&("10104518570729893"==t.user.id||30==t.user.id||41==t.user.id||42==t.user.id||30==t.user.id||0xaaf2b1002387==t.user.id),m.isAdmin=t.user.is_sys_admin,console.log("admin page Loaded!")}()}angular.module("app").controller("admin",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r){function l(){m=!("Enter a title..."==g.rankTitle||""==g.rankTitle||g.rankTitle.length<3),v=!("Enter a question..."==g.question||""==g.question||g.question.length<3),u.title=g.rankTitle+" @ "+t.canswer.name,u.tags="",u.keywords="",u.type="Thing",u.question=g.question,u.views=0,u.answers=0,u.ismp=!1,u.owner=t.canswer.id,p=!0,h=[g.bc,g.fc]}function c(){l();var e=[],n=[];if(m&&p&&v){if("add"==t.rankforAnswerMode)s.addTableforAnswer(u,h,t.canswer.id).then(function(){a.go("answerRanksManager")});else if(t.content[b].title!=g.rankTitle+" @ "+t.canswer.name&&(e.push("title"),n.push(g.rankTitle+" @ "+t.canswer.name)),t.content[b].question!=g.question&&(e.push("question"),n.push(g.question)),e.length>0&&s.update(t.content[b].id,e,n).then(function(){a.go("answerRanksManager")}),g.bc!=f[t.rankIdx].bc||g.fc!=f[t.rankIdx].fc){f[t.rankIdx].bc=g.bc,f[t.rankIdx].fc=g.fc;var i=JSON.stringify(f);r.updateAnswer(t.canswer.id,["ranks"],[i]).then(function(){a.go("answerRanksManager")})}}else m?v?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle")}function d(){a.go("answerRanksManager")}var g=this;g.title="addRankforAnswer",g.goBack=d;var u={},m=!0,p=!0,v=!0;g.addRankingforAnswer=c,g.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],g.isAdmin=t.isAdmin;var h=[],f=[],b=0;i.innerWidth<512?(g.sm=!0,g.nsm=!1):(g.sm=!1,g.nsm=!0),function(){console.log("@addRankforAnswer"),console.log("$rootScope.rankIdx ",t.rankIdx),console.log("$rootScope.canswer.ranks ",t.canswer.ranks),void 0==t.rankforAnswerMode&&a.go("cwrapper"),"edit"==t.rankforAnswerMode?(f=JSON.parse(t.canswer.ranks),b=t.content.map(function(e){return e.id}).indexOf(f[t.rankIdx].id),g.rankTitle=t.content[b].title.replace(" @ "+t.canswer.name,""),g.question=t.content[b].question,g.bc=f[t.rankIdx].bc,g.fc=f[t.rankIdx].fc,g.buttonLabel="Edit"):(g.rankTitle="Enter a title...",g.question="Enter a question...",g.bc="gray",g.fc="lightgray",g.buttonLabel="Add"),console.log("addRankforAnswer page Loaded!"),console.log("$rootScope.canswer - ",t.canswer)}()}angular.module("app").controller("addRankforAnswer",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$window","answer"]}(),function(){"use strict";function e(e,t,a,n,s,o){function i(){d.title=c.rankTitle,d.tags=c.tags,d.keywords=c.keywords,d.type=c.type,d.question=c.question,d.views=0,d.answers=0,(null==d.title||void 0==d.title||d.title.length<10)&&(g=!1),(null==d.question||void 0==d.question||d.question.length<10)&&(m=!1),"Person"!=d.type&&"Establishment"!=d.type&&"Short-Phrase"!=d.type&&"Event"!=d.type&&"Organization"!=d.type&&"Place"!=d.type&&"Activity"!=d.type&&"Thing"!=d.type&&"PersonCust"!=d.type&&(u=!1)}function r(){if(i(),console.log("vm.allNh --- ",c.allNh),0==c.allNh||void 0==c.allNh)g&&u&&m?(s.addTable(d),l()):g?m?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle");else if(g&&u&&m){for(var e=0;e<t.content.length;e++)if(t.content[e].title.indexOf("Yoga studios in")>-1){var a=JSON.parse(JSON.stringify(t.content[e]));a.id=void 0;var n=a.title.replace("Yoga studios in",c.rankTitle);a.title=n;var r=c.tags;a.tags=r,n.indexOf("Pacific Beach")>-1&&(a.tags=a.tags+" pb"),n.indexOf("Ocean Beach")>-1&&(a.tags=a.tags+" ob"),n.indexOf("Mission Beach")>-1&&(a.tags=a.tags+" mb"),n.indexOf("in San Diego")>-1&&(a.tags=a.tags+" isMP",a.isatomic=!1),n.indexOf("in Downtown")>-1&&(a.isatomic=!1),a.answers=0,a.views=0,a.answertags="",a.catstr="",s.addTable(a)}l()}else g?m?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle")}function l(){d={},c.rankTitle="",c.tags="",c.keywords="",c.type="",c.isatomic=!0,c.question="",c.image1url="",c.image2url="",c.image3url=""}var c=this;c.title="addRank";var d={},g=!0,u=!0,m=!0;c.addRanking=r,c.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],c.isAdmin=t.isAdmin,function(){console.log("addRank page Loaded!")}()}angular.module("app").controller("addRank",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog"]}(),function(){"use strict";function e(e,t,a,n,s,o,i,r,l,c,d,g){function u(){var e=!0,t=!0,a=!0;return $.rankTitle.length<10&&(s.getDialog("rankTitle"),e=!1),$.tags<5&&(s.getDialog("rankTags"),t=!1),$.question.length<10&&(s.getDialog("rankQuestion"),a=!1),e&&t&&a}function m(){u();var e=[],n=[];if(T&&L&&B){if("add"==t.rankforAnswerMode)d.addTableforAnswer(_,U,t.canswer.id).then(function(){a.go("answerRanksManager")});else if(t.content[V].title!=$.rankTitle+" @ "+t.canswer.name&&(e.push("title"),n.push($.rankTitle+" @ "+t.canswer.name)),t.content[V].question!=$.question&&(e.push("question"),n.push($.question)),e.length>0&&d.update(t.content[V].id,e,n).then(function(){a.go("answerRanksManager")}),$.bc!=N[t.rankIdx].bc||$.fc!=N[t.rankIdx].fc){N[t.rankIdx].bc=$.bc,N[t.rankIdx].fc=$.fc;var o=JSON.stringify(N);i.updateAnswer(t.canswer.id,["ranks"],[o]).then(function(){a.go("answerRanksManager")})}}else T?B?s.getDialog("rankType"):s.getDialog("rankQuestion"):s.getDialog("rankTitle")}function p(){u()&&(_.title=$.rankTitle,_.tags=$.tags,_.question=$.question,_.views=0,_.answers=0,_.ismp=!0,_.user=t.user.id,_.timestmp=Date.now(),_.bc=$.bc,_.fc=$.fc,_.shade=$.shade,_.keywords="",_.fimage=$.image,d.addTable(_).then(function(e){t.DEBUG_MODE&&console.log("table added --- ",e);var a=e.resource[0].id,n=_.title.toLowerCase();n=n.replace(/ /g,"-"),n=n+"-"+a,d.update(a,["slug"],[n]),A(a)}))}function v(e){1==e&&($.rankType="ESTABLISHMENTS",_.type="Establishment"),2==e&&($.rankType="PEOPLE",_.type="Person"),3==e&&($.rankType="ORGANIZATIONS",_.type="Organization"),4==e&&($.rankType="PLACES",_.type="Place"),5==e&&($.rankType="OPINIONS",_.type="Short-Phrase"),6==e&&($.rankType="CONTRACTORS",_.type="PersonCust"),7==e&&($.rankType="ITEM / OBJECTS",_.type="Thing"),8==e&&($.rankType="EVENTS",_.type="Event"),$.step=3}function h(e){1==e&&($.rankCat="FOOD",$.tags="food"),2==e&&($.rankCat="LIFESTYLE",$.tags="lifestyle"),3==e&&($.rankCat="HEALTH",$.tags="health"),4==e&&($.rankCat="SOCIAL",$.tags="social"),5==e&&($.rankCat="SPORTS",$.tags="sports"),6==e&&($.rankCat="PERSONALITIES",$.tags="personalities"),7==e&&($.rankCat="SERVICES",$.tags="services"),8==e&&($.rankCat="BEAUTY",$.tags="beauty"),9==e&&($.rankCat="CITY",$.tags="city"),10==e&&($.rankCat="POLITICS",$.tags="politics"),11==e&&($.rankCat="SCIENCE & TECH",$.tags="technology"),12==e&&($.rankCat="LOVE & RELATIONSHIPS",$.tags="dating"),13==e&&($.rankCat="FAMILY",$.tags="family"),$.step=2}function f(e){$.c1sel=!1,$.c2sel=!1,$.c3sel=!1,$.c4sel=!1,$.c5sel=!1,$.c6sel=!1,1==e&&($.c1sel=!0),2==e&&($.c2sel=!0),3==e&&($.c3sel=!0),4==e&&($.c4sel=!0),5==e&&($.c5sel=!0),6==e&&($.c6sel=!0),b(e)}function b(e){1==e&&($.bc="brown",$.fc="#f8f8ff"),2==e&&($.bc="#4682b4",$.fc="#f8f8ff"),3==e&&($.bc="#008080",$.fc="#f8f8ff"),4==e&&($.bc="gray",$.fc="#f8f8ff"),5==e&&($.bc="#a3297a",$.fc="#f8f8ff"),6==e&&($.bc="#c68c53",$.fc="#f8f8ff"),$.bc2=r.shadeColor($.bc,$.shade)}function y(){$.shade=$.shade+1,$.shade>10&&($.shade=10),$.bc2=r.shadeColor($.bc,$.shade/10)}function w(){$.shade=$.shade-1,$.shade<-10&&($.shade=-10),$.bc2=r.shadeColor($.bc,$.shade/10)}function k(){void 0==$.rankTitle?s.getDialog("rankTitle"):$.rankTitle.length<10?s.getDialog("rankTitle"):($.rankTitleVal=$.rankTitle,$.showAlert=!0)}function x(){var e=$.imageQuery.replace(" ","+");$.images=[],l.search(e).then(function(e){t.DEBUG_MODE&&console.log("Pixabay results - ",e),$.numResults=e.length;for(var a=0;a<$.numResults;a++)$.images.push(e[a]);$.image=$.images[$.i].previewURL})}function D(){$.i=$.i+1,$.i>$.images.length-1&&($.i=$.images.length-1),$.image=$.images[$.i].previewURL}function C(){$.i=$.i-1,$.i<0&&($.i=0),$.image=$.images[$.i].previewURL}function S(){$.step=7}function O(){$.showAlert=!1,0==$.resLength&&($.step=4)}function E(){0==$.tags.length?s.getDialog("rankTags"):$.step=6}function P(){void 0==$.question?s.getDialog("rankQuestion"):$.question.length<10?s.getDialog("rankQuestion"):$.step=5}function R(){s.whatisrankquestion()}function A(e){var n=e,o=$.images[$.i].webformatURL,i=$.rankTitle.toLowerCase();i=i.replace(/ /g,"-"),i=i+"-"+n,t.DEBUG_MODE&&console.log("Process Image - ",n,o,i),M(o,i,n),g(function(){s.getDialog("newRank"),a.go("rankSummary",{index:i})},2e3)}function M(e,a,n){c({method:"POST",url:"https://server.rank-x.com/ImageServer/SaveImage",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{imageurl:e,filename:a,rank:n}}).then(function(e){t.DEBUG_MODE&&console.log("Processing Image Success",e)},function(e){t.DEBUG_MODE&&console.log("Error Processing Image - ",e)})}function I(){a.go("cwrapper")}var $=this;$.title="addCustomRank",$.goBack=I,$.selType=v,$.selCat=h,$.minusShade=w,$.plusShade=y,$.valRank=k,$.alertOk=O,$.tagsOk=E,$.questionOk=P,$.getImages=x,$.nextImg=D,$.prevImg=C,$.selectImg=S,$.processImage=A,$.whatisrankquestion=R,$.csel=f,$.c1sel=!0,$.showAlert=!1;var _={},T=!0,L=!0,B=!0;$.editRank=m,$.addRank=p,$.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],$.isAdmin=t.isAdmin;var U=[],N=[],V=0;o.innerWidth<512?($.sm=!0,$.nsm=!1):($.sm=!1,$.nsm=!0),function(){$.resLength=-1,$.rankType="Select ranking type",$.rankCat="Choose a category",$.image=t.EMPTY_IMAGE,$.i=0,$.step=1,$.shade=0,b(1),$.buttonLabel="Add Rank",console.log("addCustomRank page Loaded!")}()}angular.module("app").controller("addCustomRank",e),e.$inject=["$location","$rootScope","$state","$stateParams","dialog","$window","answer","color","pixabay","$http","table","$timeout"]}(),angular.module("app").directive("notificationBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,a,n,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/admin/Partials/notification.drtv.html",transclude:!0,scope:{notifications:"="},controller:["$scope",function(e){}],link:function(e){console.log(e.notifications)}}}]),function(){"use strict";function e(e,t){var a=[{name:"promote",url:"/promote",views:{"@":{templateUrl:"app/promoters/Partials/promote.html",controller:"promote as vm"},"navbar@admin":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}}];$(a).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var a=[{name:"login",url:"/login",templateUrl:"app/login/partials/login.html",controller:"login as vm"},{name:"bizlogin",url:"/bizlogin",templateUrl:"app/login/partials/bizlogin.html",controller:"bizlogin as vm"},{name:"register",url:"/register",templateUrl:"app/login/partials/register.html",controller:"register as  vm"}];$(a).each(function(){e.state(this)})}angular.module("login").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var a=[{name:"customer",url:"/customer",views:{"@":{templateUrl:"app/customer/Partials/customer.html",controller:"customer as vm"},"navbar@customer":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}},resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}]}},{name:"mainphoto",parent:"customer",url:"/mainphoto",templateUrl:"app/customer/Partials/mainphoto.html",controller:"mainphoto as vm"},{name:"photogallery",parent:"customer",url:"/photogallery",templateUrl:"app/customer/Partials/photogallery.html",controller:"photogallery as vm"}];$(a).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var a=[{name:"admin",url:"/admin",views:{"@":{templateUrl:"app/admin/Partials/admin.html",controller:"admin as vm"},"navbar@admin":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"queries",parent:"admin",url:"/queries",templateUrl:"app/admin/Partials/queries.html",controller:"queries as vm"},{name:"views",parent:"admin",url:"/views",templateUrl:"app/admin/Partials/views.html",controller:"views as vm"},{name:"flags",parent:"admin",url:"/flags",templateUrl:"app/admin/Partials/flags.html",controller:"flags as vm"},{name:"addRank",parent:"admin",url:"/addRank",templateUrl:"app/admin/Partials/addRank.html",controller:"addRank as vm"},{name:"dbMaint",parent:"admin",url:"/dbMaint",templateUrl:"app/admin/Partials/dbMaint.html",controller:"dbMaint as vm"},{name:"mergeAnswers",parent:"admin",url:"/mergeAnswers",templateUrl:"app/admin/Partials/mergeAnswers.html",controller:"mergeAnswers as vm"},{name:"dbQuery",parent:"admin",url:"/dbQuery",templateUrl:"app/admin/Partials/dbQuery.html",controller:"dbQuery as vm"},{name:"updateHeaders",parent:"admin",url:"/updateHeaders",templateUrl:"app/admin/Partials/updateHeaders.html",controller:"updateHeaders as vm"},{name:"foodRanks",parent:"admin",url:"/foodRanks",templateUrl:"app/admin/Partials/foodRanks.html",controller:"foodRanks as vm"},{name:"payment",parent:"admin",url:"/payment",templateUrl:"app/admin/Partials/payment.html",controller:"payment as vm"},{name:"rodconsole",url:"/rodconsole",views:{"@":{templateUrl:"app/admin/Partials/rodconsole.html",controller:"rodconsole as vm"},"navbar@rodconsole":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}}];$(a).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}();var openModal=function(e,t){$(e).modal({backdrop:!t||1!=t.backdrop&&0!=t.backdrop?"static":t.backdrop,keyboard:t&&t.keyboard?t.keyboard:"false",show:"true"})},closeModal=function(e,t){$(e).modal("hide"),t&&t()};!function(){"user strict";angular.module("app").constant("INSTANCE_URL","https://api.rank-x.com").constant("APP_API_KEY","da4f7e05b7afc5beffe8d9d416abec73cf98ef89e3703beeb5144f325be5decc").constant("GOOGLE_API_KEY","AIzaSyC2gAzj80m1XpaagvunSDPgEvOCleNNe5A").constant("DEBUG_MODE",!1).constant("EMPTY_IMAGE","../../../assets/images/noimage.jpg").constant("INSTAGRAM_CLIENT_ID","c46745e083b7451a99461240e01da20b").constant("SERVER_URL","https://server.rank-x.com/").constant("STRIPE_CLIENT_ID","ca_AdOtLByD0cfx8W3d76nnKqLjruvHmGlh")}(),function(){"use strict";function e(e,t,a){t.otherwise("/home");var n=[{name:"layout",abstract:!0,url:"",views:{"@":{templateUrl:"app/layout/Partials/layout.html",controller:"layout as vm"},"navbar@layout":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"cwrapper",parent:"layout",url:"/home",templateUrl:"app/layout/Partials/cwrapper.html",controller:"cwrapper as vm"},{name:"rankSummary",parent:"layout",url:"/rankSummary/:index",templateUrl:"app/rank/Partials/RankSummary.html",controller:"rankSummary as vm"},{name:"editRanking",parent:"layout",url:"/editRanking/:index",templateUrl:"app/rank/Partials/editRanking.html",controller:"editRanking as vm",resolve:{rankings:["table",function(e){return e.getTables().then(function(e){return e})}]}},{name:"addAnswer",parent:"layout",url:"/addAnswer",templateUrl:"app/answer/Partials/addAnswer.html",controller:"addAnswer as vm"},{name:"addEvent",parent:"layout",url:"/addEvent",templateUrl:"app/answer/Partials/addEvent.html",controller:"addEvent as vm"},{name:"editAnswer",parent:"layout",url:"/editAnswer/:index",templateUrl:"app/answer/Partials/editAnswer.html",controller:"editAnswer as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}],edits:["edit",function(e){return e.getEdits().then(function(e){return e})}]}},{name:"specials",parent:"layout",url:"/specials",templateUrl:"app/customer/Partials/specials.html",controller:"specials as vm"},{name:"editspecial",parent:"layout",url:"/editspecial",templateUrl:"app/customer/Partials/editspecial.html",controller:"editspecial as vm"},{name:"addRankforAnswer",parent:"layout",url:"/addRankforAnswer",templateUrl:"app/admin/Partials/addRankforAnswer.html",controller:"addRankforAnswer as vm"},{name:"answerDetail",parent:"layout",url:"/answerDetail/:index",templateUrl:"app/answer/Partials/answerDetail.html",controller:"answerDetail as vm"},{name:"answerRanksManager",parent:"layout",url:"/answerRanksManager",templateUrl:"app/answer/Partials/answerRanksManager.html",controller:"answerRanksManager as vm"},{name:"editvrows",parent:"layout",url:"/editvrows",templateUrl:"app/customer/Partials/editvrows.html",controller:"editvrows as vm"},{name:"addCustomRank",url:"/addCustomRank",views:{"@":{templateUrl:"app/admin/Partials/addCustomRank.html",controller:"addCustomRank as vm"},"navbar@addCustomRank":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"match",parent:"layout",url:"/match",templateUrl:"app/rank/Partials/match.html",controller:"match as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}]}},{name:"about",url:"/about",views:{"@":{templateUrl:"app/layout/Partials/about.html",controller:"about as vm"},"navbar@about":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"privacypolicy",url:"/privacypolicy",views:{"@":{
templateUrl:"app/layout/Partials/privacypolicy.html",controller:"privacypolicy as vm"},"navbar@privacypolicy":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"mybusiness",url:"/mybusiness",parent:"layout",templateUrl:"app/layout/Partials/mybusiness.html",controller:"mybusiness as vm"},{name:"promoterconsole",url:"/promoterconsole",parent:"layout",templateUrl:"app/promoters/Partials/promoterconsole.html",controller:"promoterconsole as vm"},{name:"promotersignup",url:"/promotersignup",views:{"@":{templateUrl:"app/promoters/Partials/promotersignup.html",controller:"promotersignup as vm"},"navbar@promotersignup":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"favs",parent:"layout",url:"/favs",templateUrl:"app/layout/Partials/favs.html",controller:"favs as ctrl"},{name:"feeds",parent:"layout",url:"/feeds",templateUrl:"app/layout/Partials/feeds.html",controller:"feeds as vm"}];$(n).each(function(){e.state(this)}),a.html5Mode(!0)}angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",e])}(),function(){"use strict";function e(e,t,a,n){e.interceptors.push("httpInterceptor"),a.setAppId("1494723870571848"),n.resourceUrlWhitelist(["self","https://api.instagram.com/**"])}angular.module("app").config(e),e.$inject=["$httpProvider","$locationProvider","$facebookProvider","$sceDelegateProvider"]}(),function(){"use strict";function e(e,t,a,n,s){t.defaults.headers.common["X-Dreamfactory-API-Key"]=n,t.defaults.headers.common["X-DreamFactory-Session-Token"]=e.session_token;var o=s.location.hash.replace("#access_token=","").split("&")[0];if(-1!=s.location.hash.indexOf("access_token")){console.log("opener",s.opener);s.opener.angular.element(s.opener.document).scope().$broadcast("igAccessTokenObtained",{access_token:o}),s.close()}}angular.module("app").run(e),e.$inject=["$cookies","$http","$rootScope","APP_API_KEY","$window"]}(),angular.module("app").run(["$templateCache",function(e){e.put("app/admin/Partials/addCustomRank.html",'<div ui-view="navbar"></div><div class="container"><h4>Add a ranking about your city</h4><br><label><strong>Choose a category</strong></label><div class="dropdown" style="padding-bottom:10px"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="nhdropdown" style="width:100%">{{vm.rankCat}}&nbsp&nbsp<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-middle"><li ng-click="vm.selCat(1)"><a>FOOD</a></li><li ng-click="vm.selCat(2)"><a>LIFESTYLE</a></li><li ng-click="vm.selCat(3)"><a>HEALTH</a></li><li ng-click="vm.selCat(4)"><a>SOCIAL</a></li><li ng-click="vm.selCat(5)"><a>SPORTS</a></li><li ng-click="vm.selCat(6)"><a>PERSONALITIES</a></li><li ng-click="vm.selCat(7)"><a>SERVICES</a></li><li ng-click="vm.selCat(8)"><a>BEAUTY</a></li><li ng-click="vm.selCat(9)"><a>CITY</a></li><li ng-click="vm.selCat(10)"><a>POLITICS</a></li><li ng-click="vm.selCat(11)"><a>SCIENCE & TECH</a></li><li ng-click="vm.selCat(12)"><a>LOVE & RELATIONSHIPS</a></li><li ng-click="vm.selCat(13)"><a>FAMILY</a></li></ul></div><div ng-if="vm.step > 1"><label><strong>What are you ranking?</strong></label><div class="dropdown" style="padding-bottom:10px"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="nhdropdown" style="width:100%">{{vm.rankType}}&nbsp&nbsp<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-middle"><li ng-click="vm.selType(1)"><a>ESTABLISHMENTS - i.e. Best Pizza in San Diego</a></li><li ng-click="vm.selType(2)"><a>PEOPLE - i.e. Actors from San Diego</a></li><li ng-click="vm.selType(3)"><a>ORGANIZATIONS - i.e. Cell phone carries in San Diego</a></li><li ng-click="vm.selType(4)"><a>PLACES - i.e. Spots to catch a great sunset in San Diego</a></li><li ng-click="vm.selType(5)"><a>OPINIONS - i.e. Your favorite thing about San Diego?</a></li><li ng-click="vm.selType(6)"><a>CONTRACTORS - i.e. Music teachers in San Diego?</a></li><li ng-click="vm.selType(7)"><a>ITEM / OBJECTS - i.e. Unique souvenirs from San Diego?</a></li><li ng-click="vm.selType(8)"><a>EVENTS - i.e. Pool Parties in San Diego</a></li></ul></div></div><div ng-if="vm.step > 2"><label><strong>Ranking Title:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="i.e. The best fish tacos in San Diego" ng-model="vm.rankTitle"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.valRank()" type="button">Validate</button></span></div><div class="alert alert-warning" ng-if="vm.showAlert&&vm.resLength>0" style="padding-bottom:0px;margin-bottom:0px;"><strong>Error!</strong> You can not add this ranking because there are similar rankings to the one you are trying to create. Please enter a unique ranking title and validate again.<div class="text-right"><button class="btn btn-default" ng-click="vm.alertOk()">Got it</button></div></div><div class="alert alert-success" ng-if="vm.showAlert&&vm.resLength==0"><strong>Good one!</strong> This ranks does not have any duplicates.<br><div class="text-right"><button class="btn btn-default" ng-click="vm.alertOk()">Ok</button></div></div><div ng-if="vm.showAlert" style="background-color:beige"><search-block query="{{vm.rankTitleVal}}" ans="false" ranks="true" length="vm.resLength"></search-block></div></div><div ng-if="vm.step > 3"><label><strong>Ranking Question:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="i.e. Who makes the better fish tacos?" ng-model="vm.question"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.questionOk()" type="button">Ok</button></span></div><div class="text-right"><a href="" ng-click="vm.whatisrankquestion()">What is this?</a></div></div><div ng-if="vm.step > 4"><label><strong>Tags</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="i.e. food seafood" ng-model="vm.tags"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.tagsOk()" type="button">Ok</button></span></div><div class="text-right"><a href="" ng-click="vm.whataretags()">What are tags?</a></div></div><div ng-if="vm.step > 5"><div class="alert alert-info" ng-if="vm.step == 6"><strong>Select Image</strong><br>1. Enter a query and click the \'Search Images\' button.<br>2. Navigate the available images using the \'<<\' and="" \'="">>\' buttons.<br>3. When you find an image you like, click \'Select Image\'.<br><br></\'></div><label><strong>Image Query:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="Enter what to search for an image, i.e. taco" ng-model="vm.imageQuery"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.getImages()" type="button">Search Images</button></span></div><div class="text-center"><div class="btn-group"><button class="btn btn-default" ng-click="vm.prevImg()">&nbsp&nbsp<<&nbsp&nbsp< button=""><button class="btn btn-default" ng-click="vm.nextImg()">&nbsp&nbsp>>&nbsp&nbsp</button> <button class="btn btn-default" ng-click="vm.selectImg()">Select Image</button></&nbsp&nbsp<></button></div></div></div><br><div ng-if="vm.step > 6"><div class="alert alert-info" ng-if="vm.step == 7"><strong>Select Title Box Background Color</strong><br>1. Select a background color.<br>2. Adjust the shade factor to create attractive visual with your image.<br>3. When you are ready to submit, click the \'Add Rank\' button.</div><label><strong>Select Color Design:</strong></label><div class="container"><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(1)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c1sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:brown"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(2)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c2sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#4682b4"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(3)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c3sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#008080"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(4)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c4sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:gray"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(5)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c5sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#a3297a"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(6)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c6sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#c68c53"></div></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><div class="row" style="padding-top:10px"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="btn-group col-xs-6"><button class="btn btn-primary" ng-click="vm.minusShade()">&nbsp&nbsp<i class="fa fa-minus"></i>&nbsp&nbsp</button> <button class="btn btn-primary" ng-click="vm.plusShade()">&nbsp&nbsp<i class="fa fa-plus"></i>&nbsp&nbsp</button></div></div></div></div><div class="container" ng-if="vm.step > 5"><div class="row"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">Preview</h3></div></div></div><div class="row" style="padding-bottom:10px"><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div><div class="container-bgbox col-xs-6 col-sm-3 col-md-2 col-lg-2"><bg-box bc="{{vm.bc}}" bc2="{{vm.bc2}}" fc="{{vm.fc}}" text="{{vm.rankTitle}}" dir="horizontal" w="100%" h="{{vm.sm ? \'150px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img ng-src="{{vm.image}}" style="width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div></div><div class="text-center"><a href="https://pixabay.com/"><img src="https://pixabay.com/static/img/public/leaderboard_b.png" style="width:250px;height:auto" alt="Pixabay"></a></div></div><br><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.addRank()">{{vm.buttonLabel}}</button></div><br><br></div>'),e.put("app/admin/Partials/addRank.html",'<br><div class="row" ng-if="vm.isAdmin"><div class="col-sm-1"></div><div class="col-sm-10"><h4>Add Ranking</h4><label class="checkbox-inline"><input type="checkbox" ng-model="vm.allNh" value="">All Neighborhoods</label><p>To add a ranking to all neighborhoods, type title without actual neighborhood name:</p><p>For instance, for \'Best pizza in ###? , simply type \'Best pizza in\' and select the checkbox</p><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"><br><div class="form-group text-right"><button type="button" class="btn btn-primary" ng-click="vm.addRanking()">Add</button></div></div><div class="col-sm-1"></div></div>'),e.put("app/admin/Partials/addRankforAnswer.html",'<br><h4>Add Ranking</h4><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"><div class="text-right"><a href="" ng-click="">What is this?</a></div><br><div class="row"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div><h4>Preview</h4><div class="container" ng-if="true"><div class="row" ng-if="vm.type != \'Short-Phrase\'"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">The Favorites</h3></div></div></div><div class="row"><div class="container col-xs-6 col-sm-3 col-md-2 col-lg-2" style="background-color:{{vm.bc}};color:{{vm.fc}};height:{{vm.sm ? \'120px\':\'150px\'}};margin:0px;padding:0px;border:0px;position:relative;"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rankTitle}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rankTitle}}</h3></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img src="../../../assets/images/noimage.jpg" style="width:100%;height:{{vm.sm ? \'120px\':\'150px\'}};"></div></div></div><br><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.addRankingforAnswer()">{{vm.buttonLabel}}</button></div>'),e.put("app/admin/Partials/admin.html",'<div ui-view="navbar"></div><br><div class="text-center" ng-if="vm.isAdmin"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-default {{vm.selKeywords}}" ng-click="vm.keywords()">Searched-Keyword</button> <button class="btn btn-default {{vm.selViews}}" ng-click="vm.views()">Ranking-Answers Views</button> <button class="btn btn-default {{vm.selFlags}}" ng-click="vm.flags()">Answer Flags</button> <button class="btn btn-default {{vm.selAddRanking}}" ng-click="vm.addRank()">Add Ranking</button> <button class="btn btn-default {{vm.selDbMaint}}" ng-click="vm.dbMaint()">dB Maint</button> <button class="btn btn-default {{vm.selQuery}}" ng-click="vm.dbQuery()">Query</button> <button class="btn btn-default {{vm.selUpdate}}" ng-click="vm.update()">Update Headlines</button> <button class="btn btn-default {{vm.selFoodRanks}}" ng-click="vm.foodranks()">Food Ranks</button> <button class="btn btn-default {{vm.selPayment}}" ng-click="vm.payment()">Payment</button></div></div><button class="btn btn-default {{vm.selQuery}}" ng-click="vm.dbQuery()" ng-if="vm.isDET">Query</button><br><br><div ui-view=""></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),e.put("app/admin/Partials/dbMaint.html",'<div class="container" ng-if="vm.isAdmin"><h1>Database Maintenance</h1><button class="btn btn-success" ng-click="vm.showUrefAns()">Unreferenced Answers</button><br><button class="btn btn-danger" ng-click="vm.deleteAnswers()">Delete Answers</button> <button class="btn btn-default" ng-click="vm.showPossibleDuplicated()">Show Possible Duplicated</button> <button class="btn btn-default" ng-click="vm.showDuplicatedOnlyName()">Show Duplicated Only Name</button> <button class="btn btn-default" ng-click="vm.showDuplicatedByLocation()">Show Duplicated By Location</button><br><button class="btn btn-default" ng-click="vm.findPhoneWebsite()">Phone Numbers & Website</button><br><button class="btn btn-default" ng-click="vm.findDuplicatedRanks()">Duplicated Ranks</button><br><button class="btn btn-default" ng-click="vm.clearAllCatansVotes()">Clear Catans Votes</button><br><button class="btn btn-default" ng-click="vm.syncUserVotes()">Sync User Votes</button><br><button class="btn btn-default" ng-click="vm.estDistances()">Establishment Distances</button><br><button class="btn btn-default" ng-click="vm.createImagesJSON()">createImagesJSON</button><br><button class="btn btn-default" ng-click="vm.updateUrls()">updateUrls</button><br><button class="btn btn-default" ng-click="vm.getAnswerBizCode()">getAnswerBizCode</button><br><button class="btn btn-default" ng-click="vm.getSlugs()">get Slugs</button><br><br><p ng-repeat="x in vm.unrefans track by $index">{{x.name}} --- {{x.id}}</p><div ng-repeat="x in vm.dupAnswers track by $index"><img src="{{x.image1}}" style="width:120px"> <img src="{{x.image2}}" style="width:120px"><p>{{x.name1}} --- {{x.idx1}} --- {{x.loc1}} --- {{x.nh1}} --- {{x.add1}} --- {{x.id1}}</p><p>{{x.name2}} --- {{x.idx2}} --- {{x.loc2}} --- {{x.nh2}} --- {{x.add2}} --- {{x.id2}}</p><button class="btn btn-default" ng-click="vm.syncToFirst(x)">Sync 1st</button> <button class="btn btn-default" ng-click="vm.syncToSecond(x)">Sync 2nd</button><p>-------------------------------------------------------</p></div><div ng-repeat="x in vm.dupAnsNames track by $index"><img src="{{x.image1}}" style="width:120px"> <img src="{{x.image2}}" style="width:120px"><p>{{x.name1}} --- {{x.idx1}} --- {{x.loc1}} --- {{x.nh1}} --- {{x.add1}} --- {{x.id1}}</p><p>{{x.name2}} --- {{x.idx2}} --- {{x.loc2}} --- {{x.nh2}} --- {{x.add2}} --- {{x.id2}}</p><button class="btn btn-default" ng-click="vm.syncToFirst(x)">Sync 1st</button> <button class="btn btn-default" ng-click="vm.syncToSecond(x)">Sync 2nd</button><p>-------------------------------------------------------</p></div><p ng-repeat="x in vm.resDupRanks track by $index">{{x.title}} --- {{x.id}}</p><div ng-repeat="x in vm.syncp">{{x.answername}} - {{x.categoryname}} - caUpV {{x.caUpV}} - nUpVotes {{x.nUpVlen}} - caDownV {{x.caDownV}} - nDownVotes {{x.nDownVlen}} <button class="btn btn-primary" ng-click="vm.updatecatans(x)">Fix</button></div><div ng-repeat="x in vm.answerdist"><div class="row">{{x.name}} - {{x.location}} - {{x.dist}} <button class="btn btn-default" ng-click="vm.gotoAnswer(x)">Go to Answer</button></div></div><button ng-if="vm.dupAnsRdy" class="btn btn-primary" ng-click="vm.goMerge()">Go Merge Screen</button></div>'),e.put("app/admin/Partials/dbQuery.html",'<div class="container" ng-if="vm.isAdmin || vm.isDET"><h1>Database Query</h1><input class="form-control" ng-model="vm.val" placeholder="Enter answer to search"> <button class="btn btn-primary" ng-click="vm.queryAnswer()">Query</button><div ng-repeat="x in vm.ansRes"><h4 class="text-left">{{$index+1}}. {{x.name}}</h4><img src="{{x.imageurl}}" style="width:120px"><br>Id: {{x.id}} Added by User: {{x.userid}}<br>Neighborhood: {{x.cityarea}}<br>Address: {{x.location}}<br>Website: {{x.website}}<br>Phone: {{x.phone}}<br>Additional Info: {{x.addinfo}}<br><button class="btn btn-danger" ng-click="vm.delAnswer(x)">Delete Answer</button><br>Categories<br><div ng-repeat="y in x.catans">{{y.rank}} --- {{y.id}} --- {{y.category}} --- {{y.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(y)">Delete Catans</button><br></div></div></div>'),e.put("app/admin/Partials/flags.html",'<h1>Flags</h1><br><button class="btn btn-danger" ng-click="vm.getFlags()">Get Flags</button><table class="table table-hover cursor"><tbody><thead><tr><th>Type</th><th>Flag</th><th>Go To</th></tr></thead><tbody><tr ng-repeat="x in vm.flags"><td>{{x.type}}</td><td>{{x.desc}}</td><td>{{x.number}}</td></tr></tbody></tbody></table>'),e.put("app/admin/Partials/foodRanks.html",'<br><br><h1>Get Food Ranks</h1><br><br><button class="btn btn-primary" ng-click="vm.getRanks()">Get Food Ranks</button>'),e.put("app/admin/Partials/mergeAnswers.html",'<h1>Merge Answers</h1><br><h3>Pair {{vm.idx}} of {{vm.tot}}</h3><div class="row"><div class="text-left col-xs-6"><button class="btn-success" ng-click="vm.goPrev(50)">&lt;&lt;&lt</button> <button class="btn-success" ng-click="vm.goPrev(10)">&lt;&lt</button> <button class="btn-success" ng-click="vm.goPrev(1)">&lt</button></div><div class="text-right col-xs-6"><button class="btn-success" ng-click="vm.goNext(1)">&gt</button> <button class="btn-success" ng-click="vm.goNext(10)">&gt;&gt</button> <button class="btn-success" ng-click="vm.goNext(50)">&gt;&gt;&gt</button></div></div><br><div class="container"><div class="row"><div class="col-xs-6 col-sm-6 col-lg-6"><h4 class="radio"><input type="radio" ng-model="vm.ans1_NameSel" name="nameOption">{{vm.ans1.name}}</h4><div class="text-left btn-group"><button class="btn btn-danger" ng-click="vm.delAnswer(1)">Delete Answer</button> <button class="btn btn-primary" ng-click="vm.editAnswer(1)">Edit Answer</button></div><br><input type="radio" class="radio-inline" ng-model="vm.ans1_ImageSel" name="imageOption"> <img src="{{vm.ans1.imageurl}}" style="width:40%;height:100px"><p class="text-left"><input type="radio" ng-model="vm.ans1_AddressSel" name="addressOption">&nbsp{{vm.ans1.location}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_NhSel" name="nhOption">&nbsp{{vm.ans1.cityarea}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_PhoneSel" name="phoneOption">&nbsp{{vm.ans1.phone}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_WebsiteSel" name="websiteOption">&nbsp{{vm.ans1.website}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_AddinfoSel" name="addinfoOption">&nbsp{{vm.ans1.addinfo}}</p><div ng-repeat="y in vm.ans1.catans track by $index">{{y.rank}} --- {{y.id}} --- {{y.category}} --- {{y.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(y)">Delete Catans</button><br></div><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans(1)">Add Catans</button></div><div class="input-group" ng-if="vm.addcts1active"><input type="text" class="form-control" ng-model="vm.addcts1val" bs-options="c for c in vm.addcts1opts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts(1)">Add</button></span></div><label class="checkbox-inline" ng-if="vm.addcts1active"><input type="checkbox" ng-model="vm.cat1isdup">Is Dup</label></div><div class="col-xs-6 col-sm-6 col-lg-6"><h4 class="radio"><input type="radio" ng-model="vm.ans2_NameSel" name="nameOption">{{vm.ans2.name}}</h4><div class="text-left btn-group"><button class="btn btn-danger" ng-click="vm.delAnswer(2)">Delete Answer</button> <button class="btn btn-primary" ng-click="vm.editAnswer(2)">Edit Answer</button></div><br><input type="radio" class="radio-inline" ng-model="vm.ans2_ImageSel" name="imageOption"> <img src="{{vm.ans2.imageurl}}" style="width:40%;height:100px"><p class="text-left"><input type="radio" ng-model="vm.ans2_AddressSel" name="addressOption">&nbsp{{vm.ans2.location}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_NhSel" name="nhOption">&nbsp{{vm.ans2.cityarea}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_PhoneSel" name="phoneOption">&nbsp{{vm.ans2.phone}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_WebsiteSel" name="websiteOption">&nbsp{{vm.ans2.website}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_AddinfoSel" name="addinfoOption">&nbsp{{vm.ans2.addinfo}}</p><div ng-repeat="x in vm.ans2.catans track by $index">{{x.rank}} --- {{x.id}} --- {{x.category}} --- {{x.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(x)">Delete Catans</button><br></div><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans(2)">Add Catans</button></div><div class="input-group" ng-if="vm.addcts2active"><input type="text" class="form-control" ng-model="vm.addcts2val" bs-options="c for c in vm.addcts2opts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts(2)">Add</button></span></div><label class="checkbox-inline" ng-if="vm.addcts2active"><input type="checkbox" ng-model="vm.cat2isdup">Is Dup</label></div></div></div>'),e.put("app/admin/Partials/notification.drtv.html",'<div><div class="alert fade in" ng-repeat="notification in notifications" ng-class="notification.type==\'success\' ? \'alert-success\' : \'alert-warning\'"><a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a> <strong>{{noticiation.type.toUpperCase()}}</strong> {{notification.message}}</div></div>'),e.put("app/admin/Partials/payment.html",'<br><div class="row" ng-if="vm.isAdmin"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading your promoters information...</p></div></div><div ng-if="vm.dataReady"><div class="container"><h3>Promoters</h3><div style="font-size: 18px; padding: 16px; background-color: darkgray; margin-bottom: 20px; border-radius: 5px;">Current Commission Fee is {{vm.STRIPE_COMMISSION_PERCENTAGE*100}}%. <button class="btn btn-primary pull-right btn-sm" ng-click="vm.changeCommission()">Change</button></div><button ng-class="vm.selectedPromoters.length == 0 ? \'disabled\' : \'\'" class="btn btn-primary pull-right" style="margin-bottom:10px" ng-click="vm.paySelectedPromoters()">Pay Selected Promoters</button><div style="clear:both"></div><table class="table" ng-if="vm.overview"><tbody><thead style="border-style:none;"><tr><th></th><th>Promoter</th><th>Code</th><th>Business On Trial</th><th>Business Active</th><th>Total Fee</th><th>Commission to Promoter</th><th>Last Payed Date</th><th></th></tr></thead><tr ng-repeat="promoter in vm.promoters" style="cursor:pointer;"><td><input type="checkbox" ng-if="!promoter.payedThisMonth" ng-click="vm.addOrRemovePromoter(promoter)"></td><td ng-click="vm.goDetailView(promoter)">{{promoter.firstname + \' \' + promoter.lastname}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.code}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.ontrialCount}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.activeCount}}</td><td ng-click="vm.goDetailView(promoter)">${{promoter.balance / 100}}</td><td ng-click="vm.goDetailView(promoter)">${{promoter.balance / 100 * vm.STRIPE_COMMISSION_PERCENTAGE}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.lastPaymentDate}}</td><td><button ng-if="!promoter.payedThisMonth" class="btn btn-primary" ng-click="vm.payPromoter(promoter)">Pay</button> <button ng-if="promoter.payedThisMonth" class="btn btn-primary disabled">Paid This Month</button></td></tr></tbody></table><div ng-if="vm.detailview"><table class="table" ng-if="vm.currentPromoter.businesses.length >= 1"><thead style="border-style:none;"><tr><th>Business</th><th>Total Commission After Trial</th><th>Status</th></tr></thead><tbody><tr ng-repeat="x in vm.currentPromoter.businesses" style="cursor:pointer;"><td ng-click="vm.gotoanswer(x.answerObj)">{{x.answerObj.name}}</td><td ng-click="vm.showBusinessDetail(x)">${{x.totalCommission}}</td><td align="middle" style="{{x.style}}" ng-click="vm.showBusinessDetail(x)">{{x.status}}</td></tr></tbody></table><div ng-if="vm.currentPromoter.businesses.length == 0">No Businesses.</div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div></div>'),e.put("app/admin/Partials/queries.html",'<div class="container" ng-if="vm.isAdmin"><h1>Queries</h1><br><a ng-click="vm.clearDb()" class="btn btn-danger">Clear Database</a><br><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>User Input</th><th>Num. Results</th></tr></thead><tbody><tr ng-repeat="x in vm.queries | orderBy: \'-results\'"><td>{{x.query}}</td><td>{{x.results}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div></div>'),
e.put("app/admin/Partials/rodconsole.html",'<div ui-view="navbar"></div><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">{{vm.loadText}}</p></div></div><div ng-if="vm.dataReady"><div class="container"><div ng-if="vm.overview"><h2>Ranking of the Day Admin Console</h2><div class="row"><div class="col-xs-6"><label class="checkbox-inline"><input type="checkbox" ng-change=\'vm.filterData("all")\' ng-model="vm.allIsSelected" ng-checked="vm.allIsSelected">&nbspAll</label></div><div class="col-xs-6"><label class="checkbox-inline"><input type="checkbox" ng-change=\'vm.filterData("next20")\' ng-model="vm.next20IsSelected" ng-checked="vm.next20IsSelected">&nbspNext 20</label></div></div><br><table class="table"><tbody><thead style="border-style:none;"><tr><th>Date</th><th>Title</th><th>Image</th><th>Text</th></tr></thead><tr ng-repeat="x in vm.rods" style="cursor:pointer;" ng-click="vm.selRank(x)"><td align="middle">{{x.datenum}}</td><td align="middle">{{x.title}}</td><td align="middle" style="background-color:{{x.imageok ? \'palegreen\':\'grey\'}}">{{x.imageok ? \'Ready\':\'None\'}}</td><td align="middle" style="background-color:{{x.textok ? \'palegreen\':\'grey\'}}">{{x.textok ? \'Ready\':\'None\'}}</td></tr></tbody></table></div><div ng-if="vm.detail"><h2>{{vm.rank.title}}</h2><br><p class="text-left"><strong>Date:</strong>{{vm.rank.date}}</p><br><div class="row"><div class="text-right col-xs-6"><label>Background Color:</label></div><div class="col-xs-6"><color-picker ng-model="vm.rank.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div></div><br><div class="row"><div class="text-right col-xs-6"><label>Font Color:</label></div><div class="col-xs-6"><color-picker ng-model="vm.rank.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div></div><br><div class="row"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="col-xs-5 sm-4 md-2 lg-2"><div class="input-group"><span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.minusShade()"><i class="fa fa-minus"></i></button></span> <input style="text-align:center" class="form-control" ng-model="vm.rank.shade" type="text" placeholder="vm.rank.shade"> <span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.plusShade()"><i class="fa fa-plus"></i></button></span></div></div></div><br><div class="row"><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" style="color:{{vm.rank.fc}};height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative; background: {{vm.rank.bc}}; background: -webkit-linear-gradient(left, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: -o-linear-gradient(right, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: -moz-linear-gradient(right, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: linear-gradient(to right, {{vm.rank.bc}}, {{vm.rank.bc2}});"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rank.title}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rank.title}}</h3></div><div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img src="{{vm.rank.image1}}" style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img src="{{vm.rank.image2}}" style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm hidden-md col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img src="{{vm.rank.image3}}" style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title1}}</h3></div></div><div class="container hidden-xs hidden-sm col-md-4 col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title2}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title3}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title3}}</h3></div></div></div><br><div class="row"><div class="text-left col-xs-6"><blob-upload></blob-upload></div><div class="text-right col-xs-6"><button class="btn btn-danger" ng-click="vm.goDeleteImage()">Delete Image</button> <button class="btn btn-success" ng-click="vm.goSaveImage()">Save Image & Design</button></div></div><label class="control-label capitalize">Intro Text:</label> <textarea id="textarea1" class="form-control" ng-model="vm.rank.introtext" rows="6">\n        </textarea><br><div class="text-right"><button class="btn btn-success" ng-click="vm.goSaveText()">Save Intro Text</button></div><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div></div></div>'),e.put("app/admin/Partials/updateHeaders.html",'<div class="container" ng-if="vm.isAdmin"><br><br><h1>Refresh Headlines</h1><br><div class="text-center"><button ng-click="vm.catStrings()" class="btn btn-primary">Check for Empty Category Strings</button><br><br><button ng-click="vm.refresh()" class="btn btn-success">Shuffle Headers</button><br><br><button ng-click="vm.createCBlocksRecsCity()" class="btn btn-success">Create C-Blocks City</button><br><br><button ng-click="vm.createCBlocksRecsNh()" class="btn btn-success">Create C-Blocks Neighborhood</button><br><br><button ng-click="vm.createCBlocksRecsRankX()" class="btn btn-success">Create C-Blocks RankX</button><br><br><button ng-click="vm.deleteCBlocks()" class="btn btn-warning">Delete ALL C-Blocks</button></div><div ng-repeat="x in vm.res track by $index">{{x.modeNum}} - {{x.htitle}} - {{x.scope}} - {{x.title}}</div></div>'),e.put("app/admin/Partials/views.html",'<h1>Views</h1><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>Ranking</th><th>Views</th></tr></thead><tbody><tr ng-repeat="x in vm.content | orderBy: \'-views\'"><td>{{x.title}}</td><td>{{x.views}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div>'),e.put("app/answer/Partials/addAnswer.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px;"><h4>&nbsp&nbspAdd a new <span ng-if="vm.type == \'Establishment\'"><em>Establishment</em> to this list.</span> <span ng-if="vm.type == \'Organization\'"><em>Organization or Company</em> to this list.</span> <span ng-if="vm.type == \'Person\'"><em>Person</em> to this list.</span> <span ng-if="vm.type == \'PersonCust\'"><em>Professional</em> to this list.</span> <span ng-if="vm.type == \'Place\'"><em>Place</em> to this list.</span> <span ng-if="vm.type == \'Short-Phrase\'"><em>Answer</em> to this list.</span> <span ng-if="vm.type == \'Thing\'"><em>Item</em> to this list.</span> <span ng-if="vm.type == \'Event\'"><em>Event</em> to this list.</span></h4></div><div class="text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it works?</u></p></div><br><div class="row" style="margin:0px;"><div class="col-sm-12 col-md-5"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"> <img src="../../../assets/images/powered_by_google_on_white.png" ng-if="vm.type!=\'PersonCust\'"></div><div class="" ng-show="{{vm.type == \'Short-Phrase\'}}"><div class="container-answer" style="width:100%;height:auto" ng-if="vm.type == \'Short-Phrase\'"><br><h2 style="text-align:center"><strong>{{vm.fields[0].val}}</strong></h2><br><h4 style="text-align:center">{{vm.fields[1].val}}</h4></div></div><div ng-if="vm.type != \'PersonCust\'"><div class="form-group text-right"><button type="submit" class="btn btn-primary {{vm.searchDisabled}}" ng-click="vm.callSearchImage()" ng-show="{{vm.type != \'Short-Phrase\'}}">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&raquo</button> <a style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a></div><label class="checkbox-inline" ng-show="{{vm.type != \'Short-Phrase\'}}"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi">No good images were found</label></div></div><br ng-if="vm.sm"><form class="form-horizontal col-sm-12 col-md-7" role="form" name="answerForm"><div class="form-group" ng-repeat="x in vm.fields"><label class="control-label capitalize" ng-if="!x.onlybyowner" style="padding-left:10px">{{x.isrequired ? \'**\':\'\'}}{{x.label}}:</label> <input class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" type="{{x.textstyle}}" bs-typeahead-on-select="vm.onSelect(x.val)" placeholder="{{x.label}}" ng-hide="{{x.name==\'addinfo\'}}" ng-if="!x.onlybyowner" style="width:94%;margin-left:10px;margin-right:10px;"> <textarea class="form-control" ng-model="x.val" placeholder="{{x.label}}" ng-model-options="{debounce: 2500}" ng-show="{{x.name==\'addinfo\'}}" rows="3" ng-if="!x.onlybyowner" id="textarea2" style="width:94%;margin-left:10px;margin-right:10px;"></textarea></div><div class="text-right" ng-if="vm.type == \'Person\'"><button ng-click="vm.getWiki()" class="btn btn-primary" style="background-color:#595959;border-color:black">Get from Wikipedia</button></div></form></div><div class="row form-group" style="margin:0px;"><div class="text-center"><button ng-click="vm.rankSummary()" class="btn btn-danger">Cancel</button><button type="submit" class="btn btn-success" ng-click="vm.callAddAnswer()">Add Answer</button></div></div>'),e.put("app/answer/Partials/addEvent.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px;"><h4>{{ vm.isEdit ? \'Edit Event\':\'Add Event\'}}</h4></div><div class="text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it works?</u></p></div><br><div class="row" style="margin:0px;"><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-right">** Event Title:</p></div><div class="col-xs-12 col-sm-4 col-md-4"><input class="form-control" ng-model="vm.ev.name" type="text" placeholder="Event Title" ng-change="vm.displayCharLength()" maxlength="45" style="background-color:{{vm.ev.bc}};color:{{vm.ev.fc}}"></div><div class="col-xs-8 hidden-sm hidden-md hidden-lg hidden-xl"></div><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-left">{{vm.char}} chars left</p></div></div><br ng-if="!vm.sm"><div ng-if="!vm.sm"><div class="row" style="margin:0px;"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.ev.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.ev.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div></div><br ng-if="!vm.sm"><br><p class="text-left">Frequency</p><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.ev.freq == \'onetime\'? \'active\':\'\'}}" ng-click="vm.frequencySel(1)">One-Time</button> <button class="btn btn-primary {{vm.ev.freq == \'weekly\'? \'active\':\'\'}}" ng-click="vm.frequencySel(2)">Weekly</button></div><br><br><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">Start date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.sdate" type="text"></datepicker></div></div></div><div class="row" ng-if="vm.onetime"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">Start time:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.ev.stime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime}}</option></select></div></div></div><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">End date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.edate" type="text"></datepicker></div></div><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">End time:</p></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.ev.etime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime}}</option></select></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="text-center"><div class="col-xs-12 col-sm-12 col-md-12" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.mon" value="">Mon</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.tue" value="">Tue</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.wed" value="">Wed</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.thu" value="">Thu</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.fri" value="">Fri</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.sat" value="">Sat</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.sun" value="">Sun</label></div></div></div><br><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.ev.stime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.ev.stime2}}</option></select></div></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">End time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.ev.etime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.ev.etime2}}</option></select></div></div></div><div class="row" style="margin:0px;"><form class="form-horizontal col-xs-12 col-sm-12 col-md-6" role="form" name="answerForm"><div class="form-group" style="padding:10px"><label class="control-label">Neighborhood:</label> <input class="form-control" ng-model="vm.ev.cityarea" bs-typeahead="" bs-options="c for c in vm.neighborhoods" type="text" placeholder="{{vm.ev.cityarea}}"></div><div class="form-group" style="padding:10px"><label class="control-label">Location:</label> <input class="form-control" ng-model="vm.ev.location" type="text" placeholder="{{vm.ev.location}}"></div><div class="form-group" style="padding:10px"><label class="control-label">Website:</label> <input class="form-control" ng-model="vm.ev.website" type="text" placeholder="{{vm.ev.website}}"></div><div class="form-group" style="padding:10px"><label class="control-label">Additional Info:</label> <textarea class="form-control" ng-model="vm.ev.addinfo" placeholder="{{vm.ev.addinfo}}" rows="4" style="background-color:{{vm.ev.bc}};color:{{vm.ev.fc}};width:100%"></textarea></div></form><div class="col-xs-12 col-sm-12 col-md-6"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"> <img src="../../../assets/images/powered_by_google_on_white.png"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary {{vm.searchDisabled}}" ng-click="vm.callSearchImage()" ng-show="{{vm.type != \'Short-Phrase\'}}">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&raquo</button> <a style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a></div><label class="checkbox-inline"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi" ng-show="{{vm.type != \'Short-Phrase\'}}">No good images were found</label></div></div><br><div class="radio"><label><input type="radio" ng-model="vm.nobind" name="optradio" checked="true">Do not bind event to my account, let anyone make changes.</label></div><div class="radio"><label><input type="radio" ng-model="vm.bind" name="optradio">Bind this event to my account, only I can make changes.</label></div><br><div class="row" style="margin:0px;"><div class="form-group text-center"><button type="button" class="btn btn-success" ng-click="vm.goBack()">Back</button> <button type="button" class="btn btn-primary" ng-click="vm.showPreview()">Preview</button> <button type="button" class="btn btn-danger" ng-click="vm.deleteSpecial()" style="display:{{vm.isEdit ? \'inline\':\'none\'}}">Delete</button></div></div>'),
e.put("app/answer/Partials/answerDetail.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading details...</p></div></div><div ng-if="vm.dataReady"><cat-bar ng-if="vm.ranking" text="{{vm.ranking}}" left-fn="vm.goPrev()" right-fn="vm.goNext()" close-rank="vm.closeAnswerDetail()"></cat-bar><div class="row" style="margin:5px;"><div class="col-xs-6 col-sm-3 col-md-2"><div class="text-left"><small class="text-muted">&nbsp;&nbsp;&nbsp{{vm.answer.views}}&nbspviews</small></div></div><div class="col-xs-6 col-sm-9 col-md-10"><div ng-show="{{vm.type == \'Establishment\' || vm.type == \'PersonCust\' || vm.type == \'Event\' }}" class="text-right"><p style="display:{{vm.answer.hasOwner ? \'none\':\'inline\'}};" class="hiw" ng-click="vm.bizRegDialog()"><u>{{vm.bindtxt}}</u></p><span class="glyphicon glyphicon-lock" style="display:{{vm.answer.hasOwner ? \'inline\':\'none\'}}"></span></div></div></div><answer-header ans="{{vm.answer}}" idx="{{vm.idx}}"></answer-header><div ng-if="vm.type == \'Event\'"><br><div ng-bind-html="vm.ehtml" style="{{vm.estyle}}"><br></div></div><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header">Endorsements</h3></div><div class="text-right" style="padding-bottom:5px">Vote:&nbsp<div class="btn-group btn-toggle"><button class="btn btn-sm btn-default" style="{{vm.voteonstyle}}" ng-click="vm.votemodeON()">ON</button> <button class="btn btn-sm btn-default" style="{{vm.voteoffstyle}}" ng-click="vm.votemodeOFF()">OFF</button></div><button class="btn btn-default" ng-click="vm.endorseDialog()"><i class="fa fa-question-circle"></i></button></div><p class="text-left" ng-if="vm.type != \'Short-Phrase\'"><strong>{{vm.answer.name}}</strong> is featured in the following ranks:</p><div class="well well-light-ranks col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-repeat="r in vm.answerRanks | orderBy:\'rank\' | limitTo:vm.dispRanks"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h4 class="sub-header">{{(vm.type == \'Short-Phrase\') ? vm.answer.name : r.title}}</h4></div><p class="text-center" ng-if="vm.type == \'Short-Phrase\'">on {{r.title}}</p><div class="row" ng-if="!vm.votemode" style="padding-bottom:5px; margin-top:0px"><img style="height:55px;width:auto;" class="col-xs-3 col-md-1 col-lg-1" ng-src="{{r.icon}}"><div class="col-xs-6"><p style="padding-top:10px">Ranked <strong>#{{r.rank}}</strong> out of <strong>{{r.answers}}</strong></p></div><a href="" class="text-center col-xs-3" ng-click="vm.gotoRank(r)">Full ranking</a></div><div class="row" ng-if="vm.votemode" style="padding-top:3px;padding-left:75px;height:55px"><div class="col-xs-2 col-md-2 col-lg-2" style="padding-right:20px"><img style="height:30px;width:auto" class="cursor" ng-src="../../../assets/images/{{r.thumbUp}}" ng-click="vm.UpVote(r)"> <label><font size="4">&nbsp&nbsp&nbsp&nbsp{{r.upV}}</font></label></div><div class="col-xs-2 col-md-2 col-lg-2" style="padding-left:100px"><img style="height:30px;width:auto" class="cursor" ng-src="../../../assets/images/{{r.thumbDn}}" ng-click="vm.DownVote(r)"> <label><font size="4">&nbsp&nbsp&nbsp&nbsp{{r.downV}}</font></label></div></div><p style="display:{{vm.deleteButton}};color:red" ng-click="vm.deleteThisCatans(r)">&lt;&lt;Delete&gt;&gt;</p></div><p ng-show="{{vm.answerRanks.length > 3}}" style="background-color:lightgray;cursor:pointer" ng-click="vm.showRanks()">{{vm.dispRanks > 3 ? \'Show less\':(\'Show more (\' + (vm.answerRanks.length - 3) + \')\') }}</p><div ng-if="vm.isAdmin"><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans()">Add Catans</button></div><div class="input-group" ng-if="vm.addctsactive"><input type="text" class="form-control" ng-model="vm.addctsval" bs-options="c for c in vm.addctsopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts()">Add</button></span></div><label class="checkbox-inline" ng-if="vm.addctsactive"><input type="checkbox" ng-model="vm.catisdup">Is Dup</label></div></div><div class="container col-xs-12" ng-if="vm.answer.hasranks"><div class="row" ng-if="vm.type != \'Short-Phrase\'"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">The Favorites</h3></div></div></div><div class="row" style="padding:0px;margin:0px;border:0px"><div ng-repeat="n in vm.myranks"><div class="container col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoRank(n)" style="border-top:3px solid white;border-bottom:3px solid white;background-color:{{n.bc}};color:{{n.fc}};height:{{vm.sm ? \'90px\':\'120px\'}};margin:0px;padding:0px;position:relative"><h3 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{n.title}}<h4 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{n.title}}</h4></h3></div><div class="col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoRank(n)" style="margin:0px;padding:0px;"><img ng-src="{{n.image}}" style="border-top:3px solid white;border-bottom:3px solid white;width:95%;height:{{vm.sm ? \'90px\':\'120px\'}}"></div></div></div><div class="text-right"><a href="" ng-if="vm.userIsOwner" ng-click="vm.addRankforAnswer()">Edit Ranking/List</a></div></div><div class="col-xs-12" ng-if="true"><div class="row" ng-if="vm.type != \'Short-Phrase\'"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">Photo Gallery</h3></div></div></div><div class="text-right" ng-if="vm.type != \'Short-Phrase\'"><a ng-if="!vm.igdemo" type="button" class="btn btn-success btn-block" ng-click="vm.getImages()" style="display:{{vm.showImageGallery == false ? \'inline\':\'none\'}}">Show Images</a> <a ng-if="vm.igdemo" type="button" class="btn btn-default btn-block" ng-click="vm.getImages()" style="background-color:#cc0099;color:#e6e6e6;display:{{vm.showImageGallery == false ? \'inline\':\'none\'}}">Instagram&nbsp&nbsp <img ng-src="/assets/images/1485384923_9_-_Instagram.png" style="width:50px"></a></div><div style="display:{{vm.showImageGallery == true ? \'inline\':\'none\'}}"><div class="col-xs-6 col-sm-4 col-md-3 col-lg-2" ng-repeat="x in vm.images" style="margin:0px;padding:0px;"><a ng-click="vm.selectPhoto($index)" class="thumbnail"><img ng-src="{{x.url}}" style="width:100%;height:120px"></a></div><div ng-if="vm.images.length == 0">No images in Photo Gallery.</div></div><div class="text-right" ng-if="vm.type != \'Short-Phrase\'"><div ng-if="vm.showImageGallery && vm.isLoggedIn && vm.userIsOwner" style="display:{{vm.isLoggedIn ? \'inline\':\'none\'}}"><blob-upload></blob-upload></div><a ng-if="vm.showImageGallery && vm.isLoggedIn && vm.userIsOwner" type="button" class="btn btn-primary pull-right" ng-click="vm.selectInstagramImages()" style="display:{{vm.isLoggedIn ? \'inline\':\'none\'}}">Select from Instagram Images</a></div></div><div class="col-xs-12" ng-if="vm.answer.ispremium"><div ng-show="{{vm.type == \'Establishment\' || vm.type == \'PersonCust\' }}"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header">Specials</h3></div><div ng-repeat="x in vm.specialsList"><div ng-bind-html="x.html" style="{{x.style}}"><br></div><p ng-if="x.hasimage" style="background-color:lightgray;cursor:pointer" ng-click="vm.showsimage(x)">{{x.showimage ? \'Hide Flyer\':\'Show Flyer\'}}</p><div class="text-middle" ng-if="x.showimage"><img class="displayed" ng-src="{{x.image}}" style="height:{{vm.mxheight}};width:auto;max-width:96%;margin-left:auto;margin-right:auto;"><br></div></div><div class="text-right"><a href="" ng-if="vm.userIsOwner" ng-click="vm.openSpecials()">Edit Specials</a></div></div></div><div class="col-xs-12"><div ng-show="{{vm.type == \'Establishment\' || vm.type == \'PersonCust\' }}"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header">How do we do?</h3></div><table class="table table-hover cursor" ng-repeat="x in vm.vrowgroups track by $index"><thead class="thead-inverse"><tr><th colspan="5" class="text-center" style="background-color:#d9d9d9;width:100%">{{x[0].gtitle}}</th></tr></thead><tbody><tr ng-repeat="item in x"><td align="middle" style="width:10%"><img ng-src="../../../assets/images/{{item.upImage}}" style="max-height:30px;margin:0px;" ng-click="vm.vrowVoteUp(item)"></td><td align="left" style="width:10%">{{item.upV}}</td><td align="middle" style="width:60%">{{item.title}}</td><td align="right" style="width:10%">{{item.downV}}</td><td align="middle" style="width:10%"><img ng-src="../../../assets/images/{{item.downImage}}" style="max-height:30px;margin:0px;" ng-click="vm.vrowVoteDown(item)"></td></tr></tbody></table><div class="text-right"><a href="" ng-if="vm.userIsOwner&&false" ng-click="vm.editVRows()">Edit VoteRows</a></div></div></div><div class="col-xs-12" ng-if="false"><div ng-show="{{vm.type != \'Establishment\' && vm.type != \'PersonCust\' && vm.type != \'Event\' }}"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header">Versus Table</h3></div><table class="table table-hover cursor"><tbody><thead><tr><th align="middle" style="width:15%">Pct (%)</th><th align="middle" style="width:60%">vs. Opponent</th><th align="middle" style="width:15%">Pct (%)</th><th align="middle" style="width:10%">GP</th></tr></thead><tbody><tr ng-repeat="x in vm.relativetable | orderBy: \'-Rank\'"><td align="middle" style="width:15%">{{x.PctF}}</td><td align="middle" style="width:60%">{{x.vsName}}</td><td align="middle" style="width:15%">{{x.PctC}}</td><td align="middle" style="width:10%">{{x.GP}}</td></tr></tbody></tbody></table></div></div><br><div class="text-center"><button ng-click="vm.loadComments()" class="btn btn-default" ng-class="vm.cm.commLoaded ? \'disabled\' : \'\'" style="background-color:#e6e6e6;width:100%">COMMENTS ({{vm.numcom}})</button></div><br><div style="display:{{vm.cm.commLoaded ? \'inline\':\'none\'}}"><div ng-repeat="x in vm.cm.comments"><div class="row"><div class="col-xs-12 media"><div ng-if="!x.picture" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body">{{x.body}}<br><small style="color:#bfbfbf">{{x.username}} - {{x.date}}&nbsp&nbsp <span class="dropdown"><i type="button" class="fa fa-flag dropdown-toggle" data-toggle="dropdown"></i><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="vm.cmFlag(1)">Off-Topic</a></li><li><a ng-click="vm.cmFlag(2)">Offensive</a></li><li><a ng-click="vm.cmFlag(3)">Spam</a></li></ul></span></small></div></div></div><br></div><div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length == 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>Nobody has commented yet. Be the first. Log in and leave a comment.</small></p></div><div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length > 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>You must log in to leave a comment.</small></p></div><div style="display:{{(vm.cm.commLoaded && vm.isLoggedIn && !vm.commentAllowed) ? \'inline\':\'none\'}}"><br><p><small>Endorse one or more answers to leave a comment.</small></p></div><div style="display:{{(vm.isLoggedIn && vm.commentAllowed) ? \'inline\':\'none\'}}"><div class="media"><div ng-if="!user.picture.data.url" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="user.picture.data.url" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{user.picture.data.url}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body"><textarea class="form-control" ng-model="vm.cm.newComment" placeholder="Leave a comment" style="margin-left:0px;margin-right:0px;"></textarea></div></div><br><div class="text-right"><button ng-click="vm.postComment()" class="btn btn-primary">Post</button></div></div></div><br><div class="btn-group" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button><div class="btn-group" role="group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Flag</button><ul class="dropdown-menu dropdown-menu-left" role="menu"><li><a ng-click="vm.flagAnswer(1)">Wrong Category</a></li><li><a ng-click="vm.flagAnswer(2)">No longer active</a></li><li><a ng-click="vm.flagAnswer(3)">Offensive</a></li><li><a ng-click="vm.flagAnswer(4)">Spam</a></li></ul></div><button type="button" ng-click="vm.deleteAnswer()" class="btn btn-danger" style="display:{{vm.deleteButton}}">Delete</button></div><br><br></div>'),e.put("app/answer/Partials/answerRanksManager.html",'<h2>Custom Ranking Manager</h2><br><p class="text-left">You have purchased <strong>{{vm.ranksqty}}</strong> ranks that are currently active.</p><table class="table"><tbody><thead style="border-style:none;"><tr><th>Name</th><th></th><th></th></tr></thead><tr ng-repeat="x in vm.ranks" style="cursor:pointer;"><td ng-if="x.used" style="width:80%">{{x.title}}</td><td ng-if="!x.used" style="width:80%;color:#808080"><i>Empty</i></td><td ng-if="x.used" style="width:10%"><button class="btn btn-primary" ng-click="vm.editRank($index)">Edit</button></td><td ng-if="x.used" style="width:10%"><button class="btn btn-danger" ng-click="vm.deleteRank($index)">Delete</button></td><td ng-if="!x.used" style="width:10%"><button class="btn btn-success" ng-click="vm.addRank()">Add</button></td></tr></tbody></table><p class="text-left">Custom ranks are a great way to engage your audience with your products and services.</p><div class="text-center"><button class="btn btn-success">Purchase additional Ranks</button><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div>'),e.put("app/answer/Partials/answerheader.html",'<div class="container hidden-xs" ng-if="!isShortPhrase"><div class="row"><div class="container col-sm-6 col-md-4 col-lg-4" style="height:{{mxheight}}px;margin:0px;padding:0px;border:0px;"><div class="container-bgbox"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{idx > 0 ? idx + \'. \' + answer.name:answer.name}}" dir="vertical" w="100%" h="120px"></bg-box></div><div class="container" style="width:100%; height:{{mxheight-120}}px;background-color:#d8d8d8;"><br ng-if="!sm"><strong ng-if="answer.location">Address:</strong> <a ng-if="answer.location" href="http://maps.apple.com/maps?q={{answer.location}}" target="_blank">{{answer.location}}</a><br ng-if="answer.location"><strong ng-if="answer.cityarea">{{(answer.cityarea) ? \'Neighboorhood:\' : ""}}</strong> {{(answer.cityarea) ? answer.cityarea : ""}}<br style="display:{{(answer.cityarea) ? \'inline\' : \'none\'}}"><strong ng-if="answer.phone">Phone:</strong> <a ng-if="answer.phone" href="tel:{{answer.phone}}">{{answer.phone}}</a><br style="display:{{(answer.phone) ? \'inline\' : \'none\'}}"><strong ng-if="answer.website">Website:</strong> <a ng-if="answer.website.indexOf(\'http\') >=0" href="{{answer.website}}" target="_blank">{{answer.website}}</a> <a ng-if="answer.website.indexOf(\'http\') == -1" href="http://{{answer.website}}" target="_blank">{{answer.website}}</a><br ng-if="answer.website"><strong ng-if="answer.email">{{(answer.email) ? \'Email:\' : ""}}</strong> {{(answer.email) ? answer.email : ""}}<br style="display:{{(answer.email) ? \'inline\' : \'none\'}}"><i style="display:{{hrset ? \'inline\':\'none\'}}">{{hourstr}}</i><div class="text-center answer_info_buttons"><br><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="!answer.hasOwner || userIsOwner" ng-click="editAnswer()" target="_blank">Edit&nbsp&nbsp<span class="fa fa-pencil"></span></a><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="isMobile && answer.phone" href="tel:{{answer.phone}}" target="_blank">Call&nbsp&nbsp<span class="fa fa-phone"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" href="http://maps.apple.com/maps?q={{answer.lat}}, {{answer.lng}}" target="_blank">Directions&nbsp&nbsp<span class="fa fa-map-marker"></span></a> <a type="button" class="btn btn-default hidden-md hidden-lg hidden-xl" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" ng-click="toggleimgmode()">{{imgmode}}&nbsp&nbsp<span class="{{imgmodeicon}}"></span></a></div></div></div><div class="col-sm-6 col-md-4 col-lg-4" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="{{answer.imageurl}}" alt="Moustiers Sainte Marie" style="height:{{mxheight}}px;width:100%;margin-left:auto;margin-right:auto;" ng-click="showUrl()" ng-if="modeIsImage"> <img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width2}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="!modeIsImage"></div><div class="hidden-sm col-md-4 col-lg-4" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width3}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="hasMap"><div class="container" style="background-color:#d8d8d8;width:{{width3}}px;height:{{mxheight}}px;margin-left:auto;margin-right:auto;" ng-if="!hasMap"></div></div></div></div><div class="container hidden-sm hidden-md hidden-lg hidden-xl" ng-if="!isShortPhrase"><div class="container-bgbox"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{idx > 0 ? idx + \'. \' + answer.name:answer.name}}" dir="vertical" w="100%" h="75px"></bg-box></div><div class="container" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="{{answer.imageurl}}" alt="Moustiers Sainte Marie" style="height:auto;width:100%;" ng-click="showUrl()" ng-if="modeIsImage"> <img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="!modeIsImage"></div></div><div class="container-answer" style="width:100%;height:auto" ng-if="isShortPhrase"><br><h2 style="text-align:center"><strong>{{answer.name}}</strong></h2><br><h4 style="text-align:center">{{answer.addinfo}}</h4></div><div class="answer_info row" ng-if="!isShortPhrase&&!isEvent" style="padding:0px;margin:0px;border:0px;"><div class="container hidden-sm hidden-md hidden-lg hidden-xl"><br ng-if="answer.location"><strong ng-if="answer.location">Address:</strong> <a ng-if="answer.location" href="http://maps.apple.com/maps?q={{answer.location}}" target="_blank">{{answer.location}}</a><br ng-if="answer.location"><div class="row"><div class="col-xs-9"><strong ng-if="answer.cityarea">{{(answer.cityarea) ? \'Neighboorhood:\' : ""}}</strong> {{(answer.cityarea) ? answer.cityarea : ""}}<br style="display:{{(answer.cityarea) ? \'inline\' : \'none\'}}"><strong ng-if="answer.phone">Phone:</strong> <a ng-if="answer.phone" href="tel:{{answer.phone}}">{{answer.phone}}</a><br style="display:{{(answer.phone) ? \'inline\' : \'none\'}}"><strong ng-if="answer.website">Website:</strong> <a ng-if="answer.website.indexOf(\'http\') >=0" href="{{answer.website}}" target="_blank">{{answer.website}}</a> <a ng-if="answer.website.indexOf(\'http\') == -1" href="http://{{answer.website}}" target="_blank">{{answer.website}}</a><br ng-if="answer.website"><strong ng-if="answer.email">{{(answer.email) ? \'Email:\' : ""}}</strong> {{(answer.email) ? answer.email : ""}}<br style="display:{{(answer.email) ? \'inline\' : \'none\'}}"></div><div class="col-xs-3 text-left"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;margin-top:15px;" ng-if="!answer.hasOwner || userIsOwner" ng-click="editAnswer()" target="_blank">&nbsp&nbsp<span class="fa fa-pencil"></span></a></div></div><i style="display:{{hrset ? \'inline\':\'none\'}}">{{hourstr}}</i></div><div class="hidden-sm hidden-md hidden-lg hidden-xl text-center answer_info_buttons" style="padding-top:10px;"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="isMobile && answer.phone" href="tel:{{answer.phone}}" target="_blank">Call&nbsp&nbsp<span class="fa fa-phone"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" href="http://maps.apple.com/maps?q={{answer.lat}}, {{answer.lng}}" target="_blank">Directions&nbsp&nbsp<span class="fa fa-map-marker"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" ng-click="toggleimgmode()">{{imgmode}}&nbsp&nbsp<span class="{{imgmodeicon}}"></span></a></div></div><div style="padding:5px"></div><div ng-if="!isShortPhrase && !isEvent" style="display:{{answer.addinfo ? \'inline\':\'none\'}};"><span>{{answer.addinfo_teaser}}</span> <span ng-show="completeinfo">{{answer.addinfo_complete}}</span> <span ng-if="answer.addinfo.length > 0" ng-click="showcomplete()" style="background-color:lightgray;cursor:pointer">{{moretext}}</span><br style="display:{{answer.addinfo ? \'inline\':\'none\'}}"></div>'),e.put("app/answer/Partials/blobupload.html",'<button type="file" ngf-select="uploadFiles($file, $invalidFiles)" accept="image/*" ngf-max-size="3MB" class="btn btn-primary text-center" ngf-resize="{width: 100, height: 100, quality: .1, type: \'image/jpeg\', ratio: \'19:11\', centerCrop: true, pattern=\'.jpg\', restoreExif: false}" role="button" ngf-validate-after-resize="boolean" ngf-model-invalid="invalidFiles">Upload New Image</button><br><br><div style="font:smaller">{{errFile.name}} {{errorMsg}}</div><div style="font:smaller"><span class="progress" ng-show="f.progress >= 0"><div style="width:{{f.progress}}%" ng-bind="f.progress + \'%\'"></div></span></div><br>'),e.put("app/answer/Partials/catbar.html",'<div class="container"><div class="row"><div class="container-bgbox col-xs-1"><bg-box bc="{{bc}}" bc2="{{bc}}" fc="{{fc}}" text="<" dir="horizontal" w="100%" h="{{ht}}px" ng-click="goPrev()"></bg-box></div><div class="container-bgbox col-xs-10"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{text}}" dir="horizontal" w="100%" h="{{ht}}px" ng-click="selRank()"></bg-box></div><div class="container-bgbox col-xs-1"><bg-box bc="{{bc2}}" bc2="{{bc2}}" fc="{{fc}}" text=">" dir="horizontal" w="100%" h="{{ht}}px" ng-click="goNext()"></bg-box></div></div></div>'),e.put("app/answer/Partials/editAnswer.html",'<div class="well-answer" ng-if="vm.nsm"><h2 class="sub-header">{{vm.answer.name}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#b3b3b3;color:#4d4d4d;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-answer" ng-if="vm.sm"><h3 class="sub-header">{{vm.answer.name}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#b3b3b3;color:#4d4d4d;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px"><div class="col-sm-6"><h3>Edit Answer Profile</h3></div><div class="col-sm-6 text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it Works</u></p></div></div><br><div class="row" style="margin:0px"><div class="col-sm-12 col-md-6"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img class="displayed-uc" src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"> <img src="../../../assets/images/powered_by_google_on_white.png" ng-if="vm.type!=\'PersonCust\' && !vm.userIsOwner"></div><div class="container-answer" style="width:100%; max-height:300px;" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer.addinfo}}</h4></div><br><div ng-if="vm.userIsOwner" style="display:{{vm.userIsOwner ? \'inline\':\'none\'}}"><blob-upload></blob-upload></div><div style="display:{{vm.userIsOwner ? \'none\':\'inline\'}}" ng-if="vm.type!=\'PersonCust\'"><button type="submit" class="btn btn-primary" ng-click="vm.editImage()">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" style="display:{{vm.imagefunctions}}">&raquo</button> <a style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a> <button type="submit" class="btn btn-success" ng-click="vm.selectImage()" style="display:{{vm.imagefunctions}}">Select</button></div><br><label class="checkbox-inline" ng-show="{{vm.type != \'Short-Phrase\'}}"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi">No good images were found</label></div><form class="form-horizontal col-sm-12 col-md-6" role="form" name="answerForm" ng-repeat="x in vm.fields"><div style="display:{{x.field!=\'addinfo\' ? \'inline\':\'none\'}}" ng-hide="{{x.onlybyowner && !vm.userIsOwner}}"><label class="control-label capitalize">{{x.label}}:</label><div class="input-group"><input type="text" class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" placeholder="{{x.cval}}"> <span class="input-group-btn text-right"><button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div></div><div class="input-group" style="display:{{x.field==\'addinfo\' ? \'inline\':\'none\'}}" ng-hide="{{!vm.access && (vm.type == \'PersonCust\')}}"><label class="control-label capitalize">{{x.label}}:</label> <textarea id="textarea1" class="form-control" ng-model="x.val" placeholder="{{x.cval}}" rows="5" ng-model-options="{debounce: 2500}">\n            </textarea><br><br><span class="input-group-btn text-right"><button ng-click="vm.getWiki()" class="btn btn-primary" style="background-color:#595959;border-color:gray;margin-right:10px" ng-if="vm.type == \'Person\'">Get from Wikipedia</button> <button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div></form></div><br><div class="well well-light-edit" ng-repeat="x in vm.edits"><div ng-if="x.field != \'addinfo\'"><p><strong>{{x.username}}</strong> has edited the <strong class="capitalize"><em>{{x.field}}</em></strong> of <strong><em>{{x.name}}</em></strong> to <strong><em>{{x.nval}}</em></strong>.</p></div><div ng-if="x.field == \'addinfo\'"><p><strong>{{x.username}}</strong> has edited the information of <strong><em>{{x.name}}</em></strong> to:<br><br>{{x.nval}}.</p></div><img src="{{x.imageURL}}" class="displayed" style="height:150px;display:{{x.display}}"><div class="row form-group"><div class="text-center"><label>{{x.upV}}</label> <label></label> <button class="btn btn-primary {{x.agree}}" ng-click="vm.editAgree(x, $index)">Agree</button> <button type="submit" class="btn btn-primary {{x.disagree}}" ng-click="vm.editDisagree(x, $index)">Disagree</button> <label></label> <label>{{x.downV}}</label></div></div></div><div ng-if="vm.sm && vm.userIsOwner && vm.type == \'Establishment\'"><div class="text-center"><label>Service Hours</label></div><br><div ng-repeat="x in vm.openhours"><div class="container-hours"><div class="row"><div class="col-xs-6 col-sm-6 col-md-2"><p>{{x.day}}:</p></div><div class="col-xs-6 col-sm-6 col-md-2"><select ng-model="x.opn" ng-change="vm.hoursChanged()" ng-options="n for n in vm.openOptions"></select></div></div><div class="row"><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">From:</p></div><div class="col-xs-4 col-sm-4 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.st" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">To:</p></div><div class="col-xs-4 col-sm-4 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.ct" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div></div></div><br></div></div><div ng-if="vm.nsm && vm.userIsOwner && vm.type == \'Establishment\'"><div class="container" style="background-color:#e6e6e6;padding-right:50px;padding-left:10px;padding-top:10px;padding-bottom:0px;"><div class="text-center"><label>Service Hours</label></div><br><div class="container" ng-repeat="x in vm.openhours"><div class="row"><div class="col-xs-2 col-sm-2 col-md-2"><p>{{x.day}}:</p></div><div class="col-xs-2 col-sm-2 col-md-2"><select ng-model="x.opn" ng-change="vm.hoursChanged()" ng-options="n for n in vm.openOptions"></select></div><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">From:</p></div><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.st" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">To:</p></div><div class="col-xs-2 col-sm-2 col-md-2" style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.ct" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div></div><br></div></div></div><div class="text-right" ng-if="vm.userIsOwner && vm.type == \'Establishment\'"><a ng-click="vm.updateHours()" class="btn btn-primary {{vm.updateHoursEn}}">Update Hours</a></div><br><div class="text-center"><a ng-click="vm.answerDetail()" class="btn btn-success">Back</a></div><br>'),e.put("app/layout/Partials/about.html",'<div ui-view="navbar"></div><div class="container"><div class="jumbotron"><br><div class="row"><div class="col-sm-0 col-md-2 col-lg-3"></div><div class="col-sm-12 col-md-8 col-lg-6"><img src="{{vm.logoimage}}" class="displayed-uc" alt="Cinque Terre" style="width:100%;height:{{vm.sm ? \'100px\':\'200px\'}}"></div><div class="col-sm-0 col-md-2 col-lg-3"></div></div><br><br><p>Rank-X collects users preferences to generate truly collective rankings on all things that are important to you.</p><br></div><div class="well"><div class="form-group text-left"><p>San Diego, CA - 2016</p><p>Contact: contact@rank-x.com</p></div></div><br><div class="form-group text-center"><button type="button" class="btn btn-primary" ng-click="vm.goBack()">Back</button></div></div><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),
e.put("app/layout/Partials/city-selection.html",'<div class="modal fade" id="selectCityModal" tabindex="-1" role="dialog" aria-labelledby="selectCityModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="selectCityModalLabel">Select City</h4></div><div class="modal-body" style="height: 250px"><div class="col-md-12" style="height: 250px"><div class="col-md-6"><input placeholder="Search City" class="form-control" ng-model="searchCity"></div><div class="clearfix" style="margin-bottom: 24px"></div><div class="col-md-3" ng-repeat="city in cities | searchObject : searchCity : \'name\' | orderObjectBy : \'name\'"><a href="#" ng-click="selectCity(city)" ng-if="city.is_active">{{city.name}}</a></div><div class="col-md-12 text-center" style="height: 150px;padding-top: 50px" ng-if="(cities | searchObject : searchCity : \'name\' | objectLength) == 0"><span class="text-muted">City not found.</span></div></div></div></div></div></div>'),e.put("app/layout/Partials/cwrapper.html",'<br ng-if="vm.isCity"><br ng-if="vm.sm"><div class="row"><div class="col-xs-12 col-sm-6 col-md-8 col-lg-8"><div class="col-xs-12 col-md-6" ng-repeat="ranking in vm.initalHomeData" ng-if="vm.initalHomeData.length<4"><rank-item rank-object="ranking"></rank-item></div><div class="col-xs-12 col-md-6" ng-repeat="ranking in vm.initalHomeData.slice(0, 4)" ng-if="vm.initalHomeData.length>=4"><rank-item rank-object="ranking"></rank-item></div></div><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4"><userfeed-block ng-if="vm.pageDataLoaded" show-all="false"></userfeed-block><div ng-if="!vm.pageDataLoaded" class="col-xs-12 text-center"><a><img src="/assets/images/scrolling.gif" class="img" style="width:15px;height:15px"> Loading Feed...</a></div></div></div><div class="row"><div class="col-xs-12 col-sm-6 col-md-8 col-lg-8"><div class="col-xs-12 col-md-6" ng-repeat="ranking in vm.initalHomeData.slice(4)" ng-if="vm.initalHomeData.length>=4"><rank-item rank-object="ranking"></rank-item></div></div><div class="col-xs-12 col-md-4"><trend-block ng-if="vm.pageDataLoaded"></trend-block><div ng-if="!vm.pageDataLoaded" class="col-xs-12 text-center"><a><img src="/assets/images/scrolling.gif" class="img" style="width:15px;height:15px"> Loading ...</a></div></div></div><div class="row"><div infinite-scroll="vm.loadMore()" infinite-scroll-distance="0" infinite-scroll-disabled="(!vm.pageDataLoaded || vm.scrollDataLoading) || vm.endReached" class="col-xs-12" id="inifinite-container"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-repeat="rankingID in vm.scrollingData.slice(vm.startIndex, vm.currentIndex)"><rank-item rank-object="vm.uniqueResult[rankingID]"></rank-item></div><div ng-if="(vm.pageDataLoaded || vm.scrollDataLoading) && !vm.endReached" class="col-xs-12 text-center"><a><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"> Loading More...</a></div><div ng-if="vm.endReached" class="col-xs-12 text-center" style="border: 1px solid #00b3e4;font-size: 20px">End Reached.</div></div></div><div ng-if="vm.fbm"><div class="well-small" style="background-color:#d9d9d9;color:#24478f; padding:5px;"><p>Thanks for visiting Rank-X. You can use the ranks below to give us feedback and suggestions or you can also reach us by email at:<br><strong>contact@rank-x.com</strong></p></div><br><div class="row" style="border:0px;padding:0px;margin:0px;"><div class="col-md-6" style="border:0px;padding:3px;margin:0px;"><content-block type="rxfeedback" dynamic="false"></content-block></div><div class="col-md-6" style="border:0px;padding:3px;margin:0px;"><content-block type="rxsuggestion" dynamic="false"></content-block></div></div><div class="text-right"><button class="btn btn-default" ng-click="vm.goHome()">Home</button></div></div>'),e.put("app/layout/Partials/favs.html",'<ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#myfavs">My Favorites</a></li><li><a data-toggle="tab" href="#myfriends">My Friends</a></li></ul><div class="tab-content"><div id="myfavs" class="tab-pane fade in active"><div ng-controller="myfavs as vm"><h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mylifestyleans | limitTo:vm.maxRes2" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfoodans | limitTo:vm.maxRes1" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myservicesans | limitTo:vm.maxRes3" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myhealthans | limitTo:vm.maxRes4" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mybeautyans | limitTo:vm.maxRes5" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div><div id="myfriends" class="tab-pane fade"><div ng-controller="myfriends as vm"><h3>My Friends\' Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.lifestyleans | limitTo:vm.maxRes2 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(2,x)">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.foodans | limitTo:vm.maxRes1 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(1,x)">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.servicesans | limitTo:vm.maxRes3 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(3,x)">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.healthans | limitTo:vm.maxRes4 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(4,x)">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.beautyans | limitTo:vm.maxRes5 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(5,x)">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div></div>'),e.put("app/layout/Partials/feedback.html",'<div class="row"><div class="col-lg-6"><content-block type="rxfeedback" dynamic="false"></content-block></div><div class="col-lg-6"><content-block type="rxsuggestion" dynamic="false"></content-block></div></div>'),e.put("app/layout/Partials/feeds.html",'<userfeed-block show-all="true"></userfeed-block>'),e.put("app/layout/Partials/layout.html",'<div ui-view="navbar"></div><div class="container" style="padding-left:5px;padding-right:5px;"><div id="veil" ng-show="vm.isLoading"></div><div id="feedLoading" ng-show="vm.isLoading"><div style="text-align: center" ng-if="vm.isLoading"><div class="loading-pulse"></div><p style="font-size:large">{{vm.veilMsg}}</p></div></div><div ng-hide="vm.isLoading"><div class="input-group" style="width:100%" ng-if="vm.isAdmin"><div class="text-center" style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.selEditRank}}" ng-click="vm.editRank()">Edit Mode</button> <button class="btn btn-primary {{vm.selViewRank}}" ng-click="vm.viewRank()">View Mode</button></div><button class="btn btn-danger" ng-click="vm.applyFilters()">apply Rule</button></div><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"></div><div class="container"><div class="row" style="padding-bottom:10px"><div class="col-xs-7 col-sm-9 col-md-10 col-lg-10"><div class="input-group"><input type="text" class="form-control" placeholder="Search San Diego" ng-model="vm.val" ng-change="vm.getResults()" id="SearchInput"><div class="input-group-btn"><button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button></div></div></div><div class="col-xs-5 col-sm-3 col-md-2 col-lg-2"><div class="text-center input-group-btn"><button class="btn btn-default" ng-click="vm.gotoHome()"><i class="glyphicon glyphicon-home"></i></button> <button class="btn btn-default" ng-class="vm.showFilters ? \'active\' : \'\'" ng-click="vm.toggleFilterBox()" type="submit"><i class="glyphicon glyphicon-tasks"></i></button> <button class="btn btn-default" ng-click="vm.goAddRank()"><i class="glyphicon glyphicon-plus"></i></button></div></div></div><div class="col-xs-12" ng-if="vm.showFilters" style="font-size: 18px"><h2>Filters</h2><hr><form class="row form-horizontal"><div class="col-xs-12 col-sm-5"><fieldset style="margin-top:10px"><legend style="text-align:center">Location</legend><div class="row" style="margin-bottom: 10px;padding:20px 0px" ng-class="vm.filterOptions.isCity ? \'active-back\' : \'\'"><div class="col-xs-5"><button class="btn btn-primary" ng-class="vm.filterOptions.isCity ? \'active\' : \'\'" ng-click="vm.switchLocationScope(\'city\')">In City:</button></div><div class="col-xs-7">San Diego</div></div><div class="row" ng-class="vm.filterOptions.isNh ? \'active-back\' : \'\'" style="padding:20px 0px"><div class="col-xs-5"><button class="btn btn-primary" ng-class="vm.filterOptions.isNh ? \'active\' : \'\'" ng-click="vm.switchLocationScope(\'neighborhood\')">Neighborhood:</button></div><div class="col-xs-7"><ui-select ng-model="vm.filterOptions.cnh" on-select="vm.selectNh($item, $model)" title="Choose a Neighborhood" ng-disabled="!vm.filterOptions.isNh"><ui-select-match><span ng-bind="$select.selected"></span></ui-select-match><ui-select-choices repeat="item in (vm.nhs | filter: $select.search) track by item"><span ng-bind="item"></span></ui-select-choices></ui-select></div></div></fieldset></div><div class="col-xs-12 col-sm-7"><fieldset style="margin-top:10px"><legend style="text-align:center">Topics</legend><div class="col-xs-12"><ul class="list-group" style="list-style-type: none;"><li class=""><div class="checkbox"><label><input type="checkbox" value="Select All" ng-checked="vm.filterOptions.isAllTopics" ng-click="vm.selectTopic(\'All\')">Select All</label></div></li></ul></div><div class="col-xs-6"><ul class="list-group" style="list-style-type: none;"><li class="" ng-repeat="topic in vm.allTopics.slice(0, vm.allTopics.length/2)"><div class="checkbox"><label><input type="checkbox" value="{{topic}}" ng-checked="vm.filterOptions.ctopics.indexOf(topic) > -1 ? \'selected\' : \'\'" ng-click="vm.selectTopic(topic)">{{topic}}</label></div></li></ul></div><div class="col-xs-6"><ul class="list-group" style="list-style-type: none;"><li class="" ng-repeat="topic in vm.allTopics.slice(vm.allTopics.length/2)"><div class="checkbox"><label><input type="checkbox" value="{{topic}}" ng-checked="vm.filterOptions.ctopics.indexOf(topic) > -1 ? \'selected\' : \'\'" ng-click="vm.selectTopic(topic)">{{topic}}</label></div></li></ul></div></fieldset></div><button class="btn btn-default pull-right" ng-click="vm.toggleFilterBox()">Hide Filters</button> <button class="btn btn-default pull-right" ng-click="vm.applyFilters()">Apply</button></form><hr></div></div><div ng-show="vm.searchActive"><search-block ng-click="vm.hideSearch()" query="{{vm.val}}" ans="true" ranks="true" length="vm.slen"></search-block></div><div ui-view="" ng-if="!vm.isLoading&&!vm.searchActive"></div></div></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is a registered trademark property of Rank-X LLC. San Diego, CA - 2017 <span><a ng-click="vm.goPrivacyPolicy()">Privacy Policy</a></span> <span><a ng-click="vm.goRankofDayConsole()">RoD</a></span></p></div></footer>'),
e.put("app/layout/Partials/mybusiness.html",'<div ui-view="navbar"></div><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading your business accounts...</p></div></div><div ng-if="vm.dataReady"><div class="container"><div class="container" ng-if="!vm.noAns&&vm.overview" id="mybiztable-container"><h3>My Business</h3><table class="table" id="mybiztable"><tbody><thead style="border-style:none;"><tr><th class="text-center">Name</th><th colspan="2" text-align="center" class="text-center">Memberships</th></tr></thead><tr ng-repeat="x in vm.mybizs" style="cursor:pointer;"><td ng-click="vm.gotoanswer(x)">{{x.name}}</td><td align="center" style="{{x.style}}" ng-click="vm.gotomanage(x)">{{x.status}}</td><td align="center" style="{{x.style2}}" ng-click="vm.gotomanage(x)">{{x.status2}}</td></tr></tbody></table><div ng-if="vm.noAns"><br><p>You have not bound your account to any business. If you own or represent a business in this city, bound your account so you can manage its account.</p></div></div><div class="container" ng-if="vm.manageview"><h3>{{vm.business.name}}</h3><h4 align="center" style="background-color:#b3b3b3;padding:5px">Contact Info</h4><div><p class="text-left"><strong>Name:</strong>&nbsp{{vm.business.firstname}} {{vm.business.lastname}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.business.email}}</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.editContact()" class="btn btn-default">Edit</button></div><h4 align="center" style="background-color:#b3b3b3;padding:5px">Business Info</h4><div><p class="text-left"><strong>Business Name:</strong>&nbsp{{vm.business.name}}</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.business.location}}</p><p class="text-left"><strong>Phone:</strong>&nbsp{{vm.business.phone}}</p><p class="text-left"><strong>Membership:</strong>&nbsp{{vm.business.status}}</p></div><div class="text-right"><a href="" ng-click="vm.unbind(vm.business.id)">Unbind this business from my account</a></div><h4 align="center" style="background-color:#b3b3b3;padding:5px" ng-if="vm.business.isPremium||vm.business.hasRanks">Subscriptions</h4><div class="text-right"><div class="btn-group" ng-if="vm.business.isPremium||vm.business.hasRanks" style="padding-bottom:5px"><button type="button" class="btn btn-default" ng-class="vm.showPaymentInfo?\'active\':\'\'" ng-click="vm.showPaymentInfoEditClicked()">{{vm.showPaymentInfo?\'Hide Payment Info\':\'Show Payment Info\'}}</button> <button type="button" class="btn btn-default" ng-class="vm.showInvoices?\'active\':\'\'" ng-click="vm.showInvoicsClicked()">{{vm.showInvoices?\'Hide Invoices\':\'Show Invoices\'}}</button></div></div><div ng-if="vm.showPaymentInfo && !vm.business.loadingInvoices"><h3>Payment Information</h3><hr><div class="text-center"><span>Now you are billing with {{vm.business.customer.sources.data[0].brand}} Card <code> **** - **** - **** - {{vm.business.customer.sources.data[0].last4}} </code> Please Click here to change the card.</span><br><button id="updateCardButton" name="updateCardButton" class="btn btn-success" onclick="updateCardNumberButton()" style="margin-top:10px">Update Card Details</button></div><form action="https://server.rank-x.com/StripeServer/changeSource" method="POST" ng-submit="changeCardNumber()" id="updateCardNumberForm"><div style="display: none"><script src="https://checkout.stripe.com/checkout.js" class="stripe-button" data-key="pk_test_q9kbYzvzE6uMwZH9ZUjfK6Xq" data-email="{{vm.business.email}}" data-label="Update Card Details" data-name="Rank-X" data-description="Update Card Details" data-panel-label="Subscribe" data-image="/assets/images/rankx-logo-small-2-square.png" data-locale="auto" data-zip-code="true">\n            <\/script></div><input type="hidden" id="userId" name="userId" value="{{vm.business.user}}"> <input type="hidden" id="useraccntId" name="useraccntId" value="{{vm.business.accountid}}"> <input type="hidden" id="stripeId" name="stripeId" value="{{vm.business.stripeid}}"></form></div><div ng-if="vm.showInvoices && !vm.business.loadingInvoices"><h3>Invoices</h3><hr><table class="table"><thead style="border-style:none;"><tr><th style="width:25%" text-align="center">Date</th><th style="width:15%" text-align="center">SubTotal</th><th style="width:15%" text-align="center">Discount</th><th style="width:15%" text-align="center">Total</th><th style="width:20%" class="text-center">Status</th><th style="width:20%"></th></tr></thead><tbody><tr ng-repeat="invoice in vm.business.invoices"><td>{{invoice.date}}</td><td>{{invoice.subtotal/100 + \' \' + invoice.currency.toUpperCase()}}</td><td>{{invoice.discountMsg}}</td><td>{{invoice.total/100 + \' \' + invoice.currency.toUpperCase()}}</td><td>{{invoice.paid ? \'Paid\' : \'\'}}</td><td></td></tr></tbody></table><button class="btn btn-default pull-right" ng-click="vm.hideInvoices()">Hide Invoices</button></div><div ng-if="vm.business.isPremium||vm.business.hasRanks"><h3>Subscriptions</h3><hr><table class="table"><tbody><thead style="border-style:none;"><tr><th style="width:45%" text-align="center">Subscription</th><th style="width:15%" text-align="center">Monthly Cost</th><th style="width:20%"></th><th style="width:20%"></th></tr></thead><tr ng-if="vm.business.isPremium" style="cursor:pointer;"><td style="width:45%">Premium Membership</td><td style="width:15%">${{vm.business.price}}</td><td style="width:20%"></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelPremium()">Cancel</button></td></tr><tr ng-if="vm.business.hasRanks" style="cursor:pointer;"><td style="width:45%">{{vm.business.ranksQty}} Custom Ranks</td><td style="width:15%">${{vm.business.ranksQty*35}}</td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.editRanks()">Edit</button></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelAllRanks()">Cancel</button></td></tr><tr style="cursor:pointer;"><td style="width:45%"></td><td style="width:15%"></td><td style="width:20%"></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelAll()" ng-if="vm.business.hasranks&&vm.business.ispremium">Cancel All</button></td></tr></tbody></table></div><div class="well" ng-if="!vm.business.isPremium"><h2 class="text-center">Upgrade to Premium</h2><h3 class="text-center">${{vm.business.price}} / month</h3><i class="fa fa-check"></i><strong>&nbspGet more exposure</strong> within San Diego<br><i class="fa fa-check"></i>&nbspLet people know all your <strong>specials, promotions and special events</strong><br><i class="fa fa-check"></i><strong>&nbspDrive more traffic</strong> to your business<br><i class="fa fa-check"></i><strong>&nbspBe the best</strong> at what you do.<br><div class="text-center"><a href="" ng-click="">Learn More</a></div><label class="checkbox-inline"><input type="checkbox" ng-model="vm.getPremium" value="">Get Premium Membership</label></div><div class="well" ng-if="!vm.business.hasRanks"><h2 class="text-center">Purchase Rankings</h2><h3 class="text-center">$35 / month each</h3><i class="fa fa-check"></i>&nbspCreate <strong>unique rankings and lists</strong> for your own products and services<br><i class="fa fa-check"></i>&nbsp<strong>Focus</strong> on each of your products<br><i class="fa fa-check"></i><strong>&nbspEngage</strong> your audience<br><i class="fa fa-check"></i><strong>&nbspGet feedback</strong> from your customers.<br><div class="text-center"><a href="" ng-click="">Learn More</a></div><div class="row"><div class="col-xs-7 col-sm-9 col-md-10 col-lg-10"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.getRanks" value="">Purchase Ranks</label></div><div class="col-xs-5 col-sm-3 col-md-2 col-lg-2"><div class="input-group" ng-if="vm.getRanks"><span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.minusQty()"><i class="fa fa-minus"></i></button></span> <input style="text-align:center" class="form-control" ng-model="vm.ranksQty" type="text" placeholder="vm.ranksQty"> <span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.plusQty()"><i class="fa fa-plus"></i></button></span></div></div></div></div><div class="row" ng-if="vm.sell"><br><div class="col-xs-12"><div class="input-group"><span class="input-group-addon" style="color:red">Promo Code:</span> <input class="form-control" style="color:red;" ng-model="vm.promocode" type="text" placeholder="Enter code..."> <span class="input-group-btn"><button class="btn btn-default" ng-click="vm.checkcode()">Check Code</button></span></div></div></div><div class="text-center" ng-if="vm.sell"><br><p><i>{{vm.codeMsg}}</i></p></div><div class="text-center" ng-if="vm.sell"><br><button class="btn btn-success" ng-click="vm.goCheckout()" ng-class="(vm.getPremium || vm.getRanks) ? \'\' : \'disabled\'">Checkout</button></div></div><div class="container" ng-if="vm.checkout"><h3>Checkout</h3><br><p style="text-align:center">You are purchasing the following subscriptions for the business <strong>{{vm.business.name}}</strong>:</p><br><table class="table"><tbody><thead style="border-style:none;"><tr><th class="text-center">Name</th><th class="text-center">Quantity</th><th class="text-center">Total</th><th class="text-center"></th></tr></thead><tr ng-if="vm.getPremium"><td style="width:70%">Premium Membership</td><td style="width:15%" align="center">1</td><td style="width:15%" align="center">${{vm.business.price}}</td></tr><tr ng-if="vm.getRanks"><td style="width:70%">Custom Rankings</td><td style="width:15%" align="center">{{vm.ranksQty}}</td><td style="width:15%" align="center">${{vm.ranksQty*35}}</td></tr><tr><td style="width:85%" colspan="2">Total</td><td style="width:15%" align="center">${{vm.total}}</td></tr></tbody></table><p>You have a valid code to try the above subscriptions free for 60 days. You will not be charged until the 60 day trial period expires. Afterwards your card will be charged <strong>${{vm.total}}</strong> monthly.</p><p>You can log in and cancel or make modifications to your account at any time.</p><label class="checkbox-inline"><input type="checkbox" ng-model="vm.acceptTOS" value="">I have read and understood the <a href="">Terms of Service</a></label><div class="text-center"><br><button id="checkoutButton" name="checkoutButton" class="btn btn-success" onclick="clickStripeButton()">Pay with Card</button><br><div ng-show="!vm.showCurrentPlan"><form action="https://server.rank-x.com/StripeServer/charge" method="POST"><div style="display:none"><script src="https://checkout.stripe.com/checkout.js" class="stripe-button" data-key="pk_test_q9kbYzvzE6uMwZH9ZUjfK6Xq" data-email="{{vm.business.email}}" data-label="Pay with Card" data-name="Rank-X" data-description="Premium Membership Subscription" data-panel-label="Subscribe" data-image="/assets/images/rankx-logo-small-2-square.png" data-locale="auto" data-zip-code="true">\n            <\/script></div><input type="hidden" id="userEmail" name="userEmail" value="{{vm.business.email}}"> <input type="hidden" id="userId" name="userId" value="{{vm.business.user}}"> <input type="hidden" id="useraccntId" name="useraccntId" value="{{vm.business.accountid}}"> <input type="hidden" id="stripeId" name="stripeId" value="{{vm.business.stripeid}}"> <input type="hidden" id="getPremiumPlan" name="getPremiumPlan" value="{{vm.getPremium}}"> <input type="hidden" id="getCustomRanks" name="getCustomRanks" value="{{vm.getRanks}}"> <input type="hidden" id="ranksQuantity" name="ranksQuantity" value="{{vm.ranksQty}}"> <input type="hidden" id="couponValid" name="couponValid" value="{{vm.codeOk}}"> <input type="hidden" id="couponValid" name="promoCode" value="{{vm.promocode}}"></form></div></div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div><br><br></div></div><script>\n        function eventFire(el, etype){\n          if (el.fireEvent) {\n            el.fireEvent(\'on\' + etype);\n          } else {\n            var evObj = document.createEvent(\'Events\');\n            evObj.initEvent(etype, true, false);\n            el.dispatchEvent(evObj);\n          }\n        }\n        function clickCancelPlanButton() {\n          showLoaderBriefDouble();\n          console.log("about to fire click event");\n          var resultOfEventFire = eventFire(document.getElementById(\'confirmCancelPlan\'), \'click\');\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\n        }\n        function clickStripeButton() {\n          console.log("about to fire click event");\n          var resultOfEventFire = eventFire(document.getElementsByClassName(\'stripe-button-el\')[0], \'click\');\n\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\n        }\n\n        function updateCardNumberButton() {\n          console.log("about to fire update stripe info event");\n\t\t  var resultOfEventFire = eventFire($(\'#updateCardNumberForm .stripe-button-el\')[0], \'click\');\n\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\n        }\n        <\/script>'),e.put("app/layout/Partials/myfavs.html",'<h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mylifestyleans | limitTo:vm.maxRes2" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfoodans | limitTo:vm.maxRes1" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myservicesans | limitTo:vm.maxRes3" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myhealthans | limitTo:vm.maxRes4" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mybeautyans | limitTo:vm.maxRes5" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div>'),e.put("app/layout/Partials/myfriends.html",'<h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.lifestyleans | limitTo:vm.maxRes2 track by $index" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.foodans | limitTo:vm.maxRes1 track by $index" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.servicesans | limitTo:vm.maxRes3 track by $index" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.healthans | limitTo:vm.maxRes4 track by $index" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.beautyans | limitTo:vm.maxRes5 track by $index" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div>'),e.put("app/layout/Partials/navbar.html",'<nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/cwrapper" ng-click="vm.gotoHome()" style="cursor:pointer;padding:0px;border:0px;margin:0px;"><img src="/assets/images/logosqwborder.jpg" style="width:60px;"></a> <a class="navbar-brand home-link" href="/cwrapper" ng-click="vm.gotoHome()">Home</a> <a class="navbar-brand navbar-profile-picture-wrapper" ng-show="vm.user" href="/favs" ng-click="vm.gotofavs()"><img class="img-responsive img-circle navbar-profile-picture" ng-src="{{vm.user.picture.data.url}}"> <span>{{vm.user.first_name}}</span></a> <a class="navbar-brand" ng-if="vm.warning" style="background-color:#33cccc;color:black;margin:2px" ng-click="vm.goWarning()"><i class="fa fa-warning"></i></a> <a class="navbar-brand" ng-if="vm.coordsRdy" ng-click="vm.goCoords()" style="margin:0px;"><i class="fa fa-location-arrow"></i></a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li ng-if="vm.hasBusiness"><a href="/mybusiness" ng-click="vm.gotomybusiness()">My Business</a></li><li ng-if="vm.isPromoter"><a href="/promoterconsole" ng-click="vm.goPromoterConsole()">Promote</a></li><li><a href="/about" ng-click="vm.gotoAbout()">About</a></li><li><a href="/tour" ng-click="vm.gotoTour()">Tour</a></li><li><a href="/home" ng-click="vm.gotoFeedback()">Feedback</a></li><li ng-if="!vm.isLoggedIn"><a href="/login" ng-click="vm.goToLogin()">Login</a></li><li ng-if="vm.isLoggedIn"><a href="/logout" ng-click="vm.logout()" class="">Logout</a></li></ul></div></div></nav>'),
e.put("app/layout/Partials/privacypolicy.html",'<div ui-view="navbar"></div><style>\n    #ppBody {\n        font-size: 11pt;\n        width: 100%;\n        margin: 0 auto;\n        text-align: justify;\n    }\n    \n    #ppHeader {\n        font-family: verdana;\n        font-size: 21pt;\n        width: 100%;\n        margin: 0 auto;\n    }\n    \n    .ppConsistencies {\n        display: none;\n    }\n</style><div class="container"><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><div id="ppHeader"><span><img src="/assets/images/logo_sq.png" style="width:80px"></span> Rank-X Privacy Policy</div><div id="ppBody"><div class="ppConsistencies"><div class="col-2"><div class="quick-links text-center">Information Collection</div></div><div class="col-2"><div class="quick-links text-center">Information Usage</div></div><div class="col-2"><div class="quick-links text-center">Information Protection</div></div><div class="col-2"><div class="quick-links text-center">Cookie Usage</div></div><div class="col-2"><div class="quick-links text-center">3rd Party Disclosure</div></div><div class="col-2"><div class="quick-links text-center">3rd Party Links</div></div><div class="col-2"></div></div><div style="clear:both;height:10px;"></div><div class="ppConsistencies"><div class="col-2"><div class="col-12 quick-links2 gen-text-center">Google AdSense</div></div><div class="col-2"><div class="col-12 quick-links2 gen-text-center">Fair Information Practices<div class="col-8 gen-text-left gen-xs-text-center" style="font-size:12px;position:relative;left:20px;">Fair information<br>Practices</div></div></div><div class="col-2"><div class="col-12 quick-links2 gen-text-center coppa-pad">COPPA</div></div><div class="col-2"><div class="col-12 quick-links2 quick4 gen-text-center caloppa-pad">CalOPPA</div></div><div class="col-2"><div class="quick-links2 gen-text-center">Our Contact Information<br></div></div></div><div style="clear:both;height:10px;"></div><div class="innerText">This privacy policy has been compiled to better serve those who are concerned with how their \'Personally Identifiable Information\' (PII) is being used online. PII, as described in US privacy law and information security, is information that can be used on its own or with other information to identify, contact, or locate a single person, or to identify an individual in context. Please read our privacy policy carefully to get a clear understanding of how we collect, use, protect or otherwise handle your Personally Identifiable Information in accordance with our website.<br></div><span id="infoCo"></span><br><div class="grayText"><strong>What personal information do we collect from the people that visit our website?</strong></div><br><div class="innerText">We do not collect information from visitors of our site.</div>or other details to help you with your experience.</div><br><div class="grayText"><strong>When do we collect information?</strong></div><br><div class="innerText">We collect information from users when:<br><br><strong>1.</strong>When users log in via Facebook we obtain basic information such as first and last name. A record for each user is created to keep track of votes and activities on the site.<strong>We do not have access, nor store Facebook login credentials.</strong><br><br><strong>2.</strong> When users add answers to the rankings, and endorse, comment or edit. This information is stored to keep track of the user preferences (shown in Favorites) and to keep track of singularity of votes in the rankings.<br></div><span id="infoUs"></span><br><div class="grayText"><strong>How do we use your information?</strong></div><br><div class="innerText">We may use the information we collect from you when you register, make a purchase, sign up for our newsletter, respond to a survey or marketing communication, surf the website, or use certain other site features in the following ways:<br><br></div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To ask for ratings and reviews of services or products</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> To comment and review services<br><span id="infoPro"></span><br><div class="grayText"><strong>How do we protect your information?</strong></div><br><div class="innerText">Our website is scanned on a regular basis for security holes and known vulnerabilities in order to make your visit to our site as safe as possible.<br><br></div><div class="innerText">We use regular Malware Scanning.<br><br></div><div class="innerText">Your personal information is contained behind secured networks and is only accessible by a limited number of persons who have special access rights to such systems, and are required to keep the information confidential. In addition, all sensitive/credit information you supply is encrypted via Secure Socket Layer (SSL) technology.</div><br><div class="innerText">We implement a variety of security measures when a user enters, submits, or accesses their information to maintain the safety of your personal information.</div><br><div class="innerText">All transactions are processed through a gateway provider and are not stored or processed on our servers.</div><span id="coUs"></span><br><div class="grayText"><strong>Do we use \'cookies\'?</strong></div><br><div class="innerText">Yes. Cookies are small files that a site or its service provider transfers to your computer\'s hard drive through your Web browser (if you allow) that enables the site\'s or service provider\'s systems to recognize your browser and capture and remember certain information. For instance, we use cookies to help us remember you and keep you from needing to log in everytime you visit the website. They are also used to help us understand your preferences based on previous or current site activity, which enables us to provide you with improved services. We also use cookies to help us compile aggregate data about site traffic and site interaction so that we can offer better site experiences and tools in the future.</div><div class="innerText"><br><strong>We use cookies to:</strong></div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Understand and save user\'s preferences for future visits.</div><div class="innerText"><br>You can choose to have your computer warn you each time a cookie is being sent, or you can choose to turn off all cookies. You do this through your browser settings. Since browser is a little different, look at your browser\'s Help Menu to learn the correct way to modify your cookies.<br></div><br><div class="innerText">If you turn cookies off, some features will be disabled. It won\'t affect the user\'s experience that make your site experience more efficient and may not function properly.</div><br><div class="innerText">However, you will still be able to navigate through the website.</div><br><span id="trDi"></span><br><div class="grayText"><strong>Third-party disclosure</strong></div><br><div class="innerText">We do not sell, trade, or otherwise transfer to outside parties your Personally Identifiable Information.</div><span id="trLi"></span><br><div class="grayText"><strong>Third-party links</strong></div><br><div class="innerText">We do not include or offer third-party products or services on our website.</div><span id="gooAd"></span><br><div class="blueText"><strong>Google</strong></div><br><div class="innerText">Google\'s advertising requirements can be summed up by Google\'s Advertising Principles. They are put in place to provide a positive experience for users. https://support.google.com/adwordspolicy/answer/1316548?hl=en<br><br></div><div class="innerText">We use Google AdSense Advertising on our website.</div><div class="innerText"><br>Google, as a third-party vendor, uses cookies to serve ads on our site. Google\'s use of the DART cookie enables it to serve ads to our users based on previous visits to our site and other sites on the Internet. Users may opt-out of the use of the DART cookie by visiting the Google Ad and Content Network privacy policy.<br></div><div class="innerText"><br><strong>We have implemented the following:</strong></div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Demographics and Interests Reporting</div><br><div class="innerText">We, along with third-party vendors such as Google use first-party cookies (such as the Google Analytics cookies) and third-party cookies (such as the DoubleClick cookie) or other third-party identifiers together to compile data regarding user interactions with ad impressions and other ad service functions as they relate to our website.</div><div class="innerText"><br><strong>Opting out:</strong><br>Users can set preferences for how Google advertises to you using the Google Ad Settings page. Alternatively, you can opt out by visiting the Network Advertising Initiative Opt Out page or by using the Google Analytics Opt Out Browser add on.</div><span id="calOppa"></span><br><div class="blueText"><strong>California Online Privacy Protection Act</strong></div><br><div class="innerText">CalOPPA is the first state law in the nation to require commercial websites and online services to post a privacy policy. The law\'s reach stretches well beyond California to require any person or company in the United States (and conceivably the world) that operates websites collecting Personally Identifiable Information from California consumers to post a conspicuous privacy policy on its website stating exactly the information being collected and those individuals or companies with whom it is being shared. - See more at: http://consumercal.org/california-online-privacy-protection-act-caloppa/#sthash.0FdRbT51.dpuf<br></div><div class="innerText"><br><strong>According to CalOPPA, we agree to the following:</strong><br></div><div class="innerText">Users can visit our site anonymously.</div><div class="innerText">Once this privacy policy is created, we will add a link to it on our home page or as a minimum, on the first significant page after entering our website.<br></div><div class="innerText">Our Privacy Policy link includes the word \'Privacy\' and can easily be found on the page specified above.</div><div class="innerText"><br>You will be notified of any Privacy Policy changes:</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Others</div><div class="innerText">when visiting page</div><div class="innerText">Can change your personal information:</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> By logging in to your account</div><div class="innerText"><br><strong>How does our site handle Do Not Track signals?</strong><br></div><div class="innerText">We honor Do Not Track signals and Do Not Track, plant cookies, or use advertising when a Do Not Track (DNT) browser mechanism is in place.</div><div class="innerText"><br><strong>Does our site allow third-party behavioral tracking?</strong><br></div><div class="innerText">It\'s also important to note that we do not allow third-party behavioral tracking</div><span id="coppAct"></span><br><div class="blueText"><strong>COPPA (Children Online Privacy Protection Act)</strong></div><br><div class="innerText">When it comes to the collection of personal information from children under the age of 13 years old, the Children\'s Online Privacy Protection Act (COPPA) puts parents in control. The Federal Trade Commission, United States\' consumer protection agency, enforces the COPPA Rule, which spells out what operators of websites and online services must do to protect children\'s privacy and safety online.<br><br></div><div class="innerText">We do not specifically market to children under the age of 13 years old.</div><span id="ftcFip"></span><br><div class="blueText"><strong>Fair Information Practices</strong></div><br><div class="innerText">The Fair Information Practices Principles form the backbone of privacy law in the United States and the concepts they include have played a significant role in the development of data protection laws around the globe. Understanding the Fair Information Practice Principles and how they should be implemented is critical to comply with the various privacy laws that protect personal information.<br><br></div><div class="innerText"><strong>In order to be in line with Fair Information Practices we will take the following responsive action, should a data breach occur:</strong></div><div class="innerText">We will notify the users via in-site notification</div><div class="innerText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&bull;</strong> Within 7 business days</div><div class="innerText"><br>We also agree to the Individual Redress Principle which requires that individuals have the right to legally pursue enforceable rights against data collectors and processors who fail to adhere to the law. This principle requires not only that individuals have enforceable rights against data users, but also that individuals have recourse to courts or government agencies to investigate and/or prosecute non-compliance by data processors.</div><span id="canSpam"></span><br><div class="blueText"><strong>CAN SPAM Act</strong></div><br><div class="innerText">The CAN-SPAM Act is a law that sets the rules for commercial email, establishes requirements for commercial messages, gives recipients the right to have emails stopped from being sent to them, and spells out tough penalties for violations.<br><br></div><div class="innerText"><strong>We collect your email address in order to:</strong></div><div class="innerText"><br><strong>To be in accordance with CANSPAM, we agree to the following:</strong></div><div class="innerText"><br>If at any time you would like to unsubscribe from receiving future emails, you can email us at <strong>contact@rank-x.com</strong> and we will promptly remove you from <strong>ALL</strong> correspondence.<br><span id="ourCon"></span><br><div class="blueText"><strong>Contacting Us</strong></div><br><div class="innerText">If there are any questions regarding this privacy policy, you may contact us using the information below.<br><br></div><div class="innerText">Rank-X, LLC</div>San Diego, California<div class="innerText">USA</div><div class="innerText">contact@rank-x.com</div><div class="innerText"><br>Last Edited on 2017-01-30</div></div><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><br></div>'),e.put("app/layout/Partials/searchresults.html",'<div ng-show="vm.searchActive"><search-block></search-block></div>'),e.put("app/common/partials/bgbox.html",'<div ng-if="dirHor"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}}; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3></div></div><div ng-if="dirVer"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}}; background: {{bc}}; background: -webkit-linear-gradient({{bc}}, {{bc2}}); background: -o-linear-gradient({{bc}}, {{bc2}}); background: -moz-linear-gradient({{bc}}, {{bc2}}); background: linear-gradient({{bc}}, {{bc2}});"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3></div></div>'),e.put("app/common/partials/bgbox2.html",'<div ng-if="dirHor"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h-30}}px; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><h3 class="text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3></div><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div><div ng-if="dirVer"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}}; background: {{bc}}; background: -webkit-linear-gradient({{bc}}, {{bc2}}); background: -o-linear-gradient({{bc}}, {{bc2}}); background: -moz-linear-gradient({{bc}}, {{bc2}}); background: linear-gradient({{bc}}, {{bc2}});"><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3></div><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div>'),e.put("app/content/partials/content-block.html",'<div style="display:{{hideme ? \'none\':\'inline\'}}"><table class="table" style="border-style:none;" ng-if="isRoW"><tbody><thead><tr><th style="color:{{fc}};width:50%;border-style:none; background: {{bgc}}; background: -webkit-linear-gradient(left, {{bgc}}, {{bgc2}}); background: -o-linear-gradient(right, {{bgc}}, {{bgc2}}); background: -moz-linear-gradient(right, {{bgc}}, {{bgc2}}); background: linear-gradient(to right, {{bgc}}, {{bgc2}});">{{headline}}</th></tr></thead></tbody></table><div class="container" ng-if="isRoW"><div class="row" ng-if="isRoW" ng-click="rankSel(results[0],false)"><div class="container-bgbox col-xs-6 col-sm-6 col-md-4 col-lg-3"><bg-box bc="{{rdbc}}" shade="{{shade}}" fc="{{rdfc}}" text="{{rankOfDay}}" dir="horizontal" w="100%" h="{{sm ? \'150px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image1}}" style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image2}}" style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm hidden-md col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image3}}" style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" ng-if="isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{title1}}</h3></div></div><div class="container hidden-xs hidden-sm col-md-4 col-lg-3" ng-if="isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{title2}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-if="isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{title3}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{title3}}</h3></div></div></div></div><table class="table" style="border-style:none;" ng-if="!isRoW"><tbody><thead ng-if="!isRoW" style="border-style:none;"><tr><th style="background-color:{{bgc}};color:{{fc}};width:50%; background: {{bgc}}; background: -webkit-linear-gradient(left, {{bgc}}, {{bgc2}}); background: -o-linear-gradient(right, {{bgc}}, {{bgc2}}); background: -moz-linear-gradient(right, {{bgc}}, {{bgc2}}); background: linear-gradient(to right, {{bgc}}, {{bgc2}});">{{headline}}</th></tr></thead><tr><td><div class="row" style="width:100%;border:0px;padding:0px;margin:0px;"><div ng-repeat="x in resultsTop" style="border:0px;padding:0px;margin:0px;"><div class="clearfix" ng-if="$index % 3 == 0" style="border:0px;padding:0px;margin:0px;"></div><div class="col-xs-4" ng-click="rankSel(x,false)" style="cursor:pointer;border:0px;padding:0px;margin:0px;" href="{{\'/rankSummary/\' + x.slug}}"><a href="{{\'/rankSummary/\' + x.slug}}"><img ng-src="{{x.image1url}}" style="width:100%;height:{{thumbheight}};" ng-if="!x.isShortPhrase" alt="{{x.titlex}}"></a><div style="width:100%;height:{{thumbheight}};background-color:darkgrey;color:black;position:relative;" ng-if="x.isShortPhrase"><br><p style="text-align:center;position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><strong>{{x.title1}}</strong></p></div><p style="font-size:small;padding:0px;border:0px;margin:0px;">{{x.titlex}}</p></div></div></div></td></tr><tr ng-repeat="x in results | limitTo:maxRes" ng-click="rankSel(x,false)" style="cursor:pointer;"><td style="width:50%;"><a href="{{\'/rankSummary/\' + x.slug}}" ng-click="rankSel(x,false)">{{x.title}} <small class="text-muted">&nbsp;&nbsp;&nbsp;&nbsp;{{x.answers}}&nbspanswers-{{x.views}}&nbspviews</small></a></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="seeMore(maxRes, btext)" ng-if="!resLT6 && modType!=\'rankofweek\'">&lt;&lt;{{btext}}&gt;&gt;</p></div>'),e.put("app/content/partials/rank-block.html",'<div class="container" style="padding-bottom:10px"><div class="row" ng-click="rankSel(resultsTop[0],false)" ng-if="isBasic"><div class="container-bgbox col-xs-6 col-sm-3 col-md-3 col-lg-2"><bg-box2 bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{title}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}" stats="{{stats}}"></bg-box2></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-2" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image1}}" style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div></div><div class="row" ng-click="rankSel(resultsTop[0],false)" ng-if="isGrid4"><div class="container-bgbox col-xs-6 col-sm-6 col-md-3 col-lg-3"><bg-box bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{title}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}"></bg-box></div><div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" style="margin:0px;padding-right:15px;border:0px;"><div class="row"><img ng-src="{{image1}}" style="width:{{w4}}px;height:75px;margin:0px;padding:0px;border:0px;"> <img ng-src="{{image2}}" style="width:{{w4}}px;height:75px;margin:0px;padding:0px;border:0px;"></div><div class="row"><img ng-src="{{image3}}" style="width:{{w4}}px;height:75px;margin:0px;padding:0px;border:0px;"> <img ng-src="{{image4}}" style="width:{{w4}}px;height:75px;margin:0px;padding:0px;border:0px;"></div></div></div></div>'),e.put("app/content/partials/search-block.html",'<table class="table" style="border-style:none;"><tbody><tr ng-repeat="x in resRanks track by $index | limitTo:maxRes" ng-click="rankSel(x,false)" style="cursor:pointer;"><td style="width:50%;"><i class="fa fa-list-ol" aria-hidden="true"></i> - {{x.title}} <small class="text-muted">&nbsp;&nbsp;&nbsp;&nbsp;{{x.answers}}&nbspanswers-{{x.views}}&nbspviews</small></td></tr><tr ng-repeat="x in resAnswers track by $index | limitTo:maxRes" ng-click="ansSel(x,false)" style="cursor:pointer;"><td style="width:50%;"><i class="{{x.icon}}" aria-hidden="true"></i> - {{x.name}}, {{x.cityarea}} <small class="text-muted">&nbsp;&nbsp;&nbsp;&nbsp;{{x.views}}&nbspviews</small></td></tr></tbody></table>'),e.put("app/content/partials/trend-block.html",'<div class="container" style="max-height:200px"><div class="row"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4"><ul class="nav nav-tabs"><li class="active" style="cursor: pointer"><a data-toggle="tab" ng-click="seeTab(1)">Popular</a></li><li style="cursor: pointer"><a data-toggle="tab" ng-click="seeTab(2)">Newest</a></li></ul><div class="tab-content"><div class="tab-pane in active" ng-show="popular" style="padding-top:10px;padding-bottom:10px; max-height: 340px; overflow-y: scroll;"><div class="col-xs-12 media ranking-blog-item" ng-repeat="ranking in popularOrder" style="cursor: pointer;" ng-click="rankSel(ranking)"><div class="profile-avatar-wrapper media-left"><img src="{{ranking.image1url ? ranking.image1url : \'../../../assets/images/noimage.jpg\'}}"></div><div class="media-body" style="vertical-align: middle;">{{ranking.title}} <span class="pull-right">{{ranking.views}} Views</span></div></div></div><div class="tab-pane in active" ng-show="newest" style="padding-top:10px;padding-bottom:10px; max-height: 340px; overflow-y: scroll;"><div class="col-xs-12 media ranking-blog-item" ng-repeat="ranking in newestOrder" ng-click="rankSel(ranking)" style="cursor: pointer;"><div class="profile-avatar-wrapper media-left"><img src="{{ranking.image1url ? ranking.image1url : \'../../../assets/images/noimage.jpg\'}}"></div><div class="media-body" style="vertical-align: middle;">{{ranking.title}} <span class="pull-right">{{ranking.timestmp.slice(0, 10)}}</span></div></div></div></div></div></div></div>'),e.put("app/content/partials/userfeed-block.html",'<table class="table"><tbody><thead><tr><th style="{{headerStyle}}">Feed <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="refreshFeed()"><span class="glyphicon glyphicon-refresh" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></th></tr></thead></tbody></table><div ng-repeat="x in feeds | orderBy:\'-id\' | limitTo:fres" style="padding:0px;border:0px;margin-top:10px;"><div class="row" style="margin:4px"><div class="col-xs-12 media"><div ng-if="!x.picture" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"></div><div ng-if="x.action == \'addedAnswer\'" class="media-body" style="vertical-align: middle;">added <a ng-click="gotoAnswer(x)">{{x.text1}}</a> to <a ng-click="gotoRank(x)">{{x.text2}}</a>.</div><div ng-if="x.action == \'upVoted\'" class="media-body" style="vertical-align: middle;">endorsed <a ng-click="gotoAnswer(x)">{{x.text1}}</a> in <a ng-click="gotoRank(x)">{{x.text2}}</a>.</div><div ng-if="x.action == \'downVoted\'" class="media-body" style="vertical-align: middle;">voted down <a ng-click="gotoAnswer(x)">{{x.text1}}</a> in <a ng-click="gotoRank(x)">{{x.text2}}</a>.</div><div ng-if="x.action == \'commentR\'" class="media-body" style="vertical-align: middle;">posted a comment in <a ng-click="gotoRank(x)">{{x.text2}}</a>.</div><div ng-if="x.action == \'commentA\'" class="media-body" style="vertical-align: middle;">posted a comment for <a ng-click="gotoAnswer(x)">{{x.text1}}</a>.</div><div ng-if="x.action == \'editA\'" class="media-body" style="vertical-align: middle;">edited the information of <a ng-click="gotoAnswer(x)">{{x.text1}}</a>.</div><div ng-if="x.action == \'upVotedVrow\'" class="media-body" style="vertical-align: middle;">endorsed the <em>{{x.text2}}</em> of <a ng-click="gotoAnswer(x)">{{x.text1}}</a>.</div><div ng-if="x.action == \'downVotedVrow\'" class="media-body" style="vertical-align: middle;">voted down the <em>{{x.text2}}</em> of <a ng-click="gotoAnswer(x)">{{x.text1}}</a>.</div><div ng-if="x.action == \'binded\'" class="media-body" style="vertical-align: middle;">bound account to <a ng-click="gotoAnswer(x)">{{x.text1}}</a>.</div></div></div></div><p class="text-right" style="color:blue;" ng-if="showAll == \'false\'" ng-click="seeMoreFeed()">{{ftext}}&gt;&gt;</p>'),e.put("app/customer/Partials/customer.html",'<div ui-view="navbar"></div><br><h2>Select business you wish to manage</h2><div ng-repeat="x in vm.answers"><label><input type="radio" name="businessradio" ng-click="vm.selAnswer(x)">&nbsp;&nbsp;{{x.name}}, {{x.location}}, {{x.cityarea}}</label></div><br><div class="text-center"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-success {{vm.loadMainPhoto}}" ng-click="vm.loadMainPhoto()">Main Photo</button> <button class="btn btn-primary {{vm.loadSpecials}}" ng-click="vm.loadSpecials()">Specials</button> <button class="btn btn-danger {{vm.loadPhotoGallery}}" ng-click="vm.loadPhotoGallery()">Photo Gallery</button></div></div><br><br><div ui-view=""></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),
e.put("app/customer/Partials/editspecial.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.header}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><h3>{{ vm.isEdit ? \'Edit Special\':\'Add Special\'}}</h3><br><div class="well"><div class="row"><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-right">Specials Title:</p></div><div class="col-xs-12 col-sm-4 col-md-4"><input class="form-control" ng-model="vm.sp.stitle" type="text" placeholder="Special Banner" ng-change="vm.displayCharLength()" maxlength="25" style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}}"></div><div class="col-xs-8 hidden-sm hidden-md hidden-lg hidden-xl"></div><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-left">{{vm.char}} chars left</p></div></div><br><div class="row"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.sp.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.sp.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div><p class="text-left">Frequency</p><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.sp.freq == \'onetime\'? \'active\':\'\'}}" ng-click="vm.frequencySel(1)">One-Time</button> <button class="btn btn-primary {{vm.sp.freq == \'weekly\'? \'active\':\'\'}}" ng-click="vm.frequencySel(2)">Weekly</button></div><br><br><br><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">Start date:</p></div></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.sdate" type="text"></datepicker></div></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><select ng-model="vm.sp.stime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime}}</option></select></div></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">End date:</p></div></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.edate" type="text"></datepicker></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><p class="text-right">End time:</p></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><select ng-model="vm.sp.etime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime}}</option></select></div></div><div class="row"><div class="text-center"><div class="col-xs-12 col-sm-12 col-md-12" ng-if="vm.weekly"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.mon" value="">Mon</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.tue" value="">Tue</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.wed" value="">Wed</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.thu" value="">Thu</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.fri" value="">Fri</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sat" value="">Sat</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sun" value="">Sun</label></div></div></div><br><div class="row"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><select ng-model="vm.sp.stime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime2}}</option></select></div></div></div><div class="row"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><p class="text-right">End time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><select ng-model="vm.sp.etime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime2}}</option></select></div></div></div><br><div class="row"><div class="col-sm-0 col-md-3 col-lg-3"></div><div class="container col-sm-12 col-md-6 col-lg-6"><p>Event Details</p><textarea class="form-control" ng-model="vm.sp.details" placeholder="{{x.label}}" rows="4" style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}};width:100%"></textarea></div><div class="col-sm-0 col-md-3 col-lg-3"></div><br></div><div class="row"><div class="col-sm-0 col-md-3 col-lg-3"></div><div class="container col-sm-12 col-md-6 col-lg-6"><div class=""><p>Event Image</p><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"><div ng-if="vm.userIsOwner"><blob-upload></blob-upload></div></div></div><div class="col-sm-0 col-md-3 col-lg-3"></div><br></div><br><div class="form-group text-center"><button type="button" class="btn btn-success" ng-click="vm.goBack()">Back</button> <button type="button" class="btn btn-primary" ng-click="vm.showPreview()">Preview</button> <button type="button" class="btn btn-danger" ng-click="vm.deleteSpecial()" style="display:{{vm.isEdit ? \'inline\':\'none\'}}">Delete</button></div></div>'),e.put("app/customer/Partials/editvrows.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.header}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><div ng-repeat="x in vm.vrows track by $index"><div style="display:{{x.shdr ? \'inline\':\'none\'}}"><br></div><div class="row"><div style="display:{{x.shdr ? \'inline\':\'none\'}}"><div class="col-xs-10" style="background-color:gray;color:white;"><p>{{x.gtitle}}</p></div><div class="col-xs-2"><button type="button" class="btn btn-default" ng-click="vm.editVRowGroupDiag(x)"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></div></div></div><div style="display:{{x.title != \'-\' ? \'inline\':\'none\'}}"><div class="row"><div class="col-xs-10" style="background-color:#d9d9d9;padding-top:2px;padding-bottom:2px;">{{x.title}}</div><div class="col-xs-2"><div class="btn-group"><button type="button" class="btn btn-default" ng-click="vm.deleteVRowDiag(x)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div></div></div></div><div style="display:{{x.saddr ? \'inline\':\'none\'}}"><div class="row"><div class="col-xs-10"><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.addVRowDiag(x)">Add Vote Row</button></div></div><div class="col-xs-2"></div></div></div></div><br><div class="text-left"><button type="button" class="btn btn-default" ng-click="vm.addVRowGroupDiag()">Add Group</button></div><div class="text-right"><button type="button" class="btn btn-success" ng-click="vm.closeRank()">Go Back</button></div>'),e.put("app/customer/Partials/mainphoto.html","<h1>Main Photo</h1>"),e.put("app/customer/Partials/photogallery.html","<h1>Photo Gallery</h1>"),e.put("app/customer/Partials/specials.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading specials...</p></div></div><div ng-if="vm.dataReady"><h2>Specials Manager</h2><br><p class="text-left">You have purchased premium membership for this Establishment. You can add up to 7 specials and promotions.</p><table class="table"><tbody><thead style="border-style:none;"><tr><th>Special</th><th></th><th></th></tr></thead><tr ng-repeat="x in vm.specialsList" style="cursor:pointer;"><td ng-if="x.used" style="width:80%">{{x.stitle}}</td><td ng-if="!x.used" style="width:80%;color:#808080"><i>Empty</i></td><td ng-if="x.used" style="width:10%"><button class="btn btn-primary" ng-click="vm.selSpecial(x)">Edit</button></td><td ng-if="x.used" style="width:10%"><button class="btn btn-danger" ng-click="vm.deleteSpecial(x)">Delete</button></td><td ng-if="!x.used" style="width:10%"><button class="btn btn-success" ng-click="vm.addSpecial()">Add</button></td></tr></tbody></table><p class="text-left">Specials are a great way to let people know all the great offers you have at any time.</p><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div>'),e.put("app/login/partials/add-user-detail.html",'<div class="modal fade" id="addUserDetailModal" tabindex="-1" role="dialog" aria-labelledby="addUserDetailModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h4 class="modal-title" id="addUserDetailModalLabel">Add User Detail</h4></div><div class="modal-body" style="height: 214px"><div class="col-md-12"><form class="form-horizontal" role="form" name="answerForm"><div class="col-md-12"><div class="form-group"><label for="birthdate">Birth Date:</label><datepicker date-year-title="selected year" date-max-limit="{{maxDate}}" date-format="yyyy/MM/dd" date-month-title="selected year"><input id="birthdate" ng-model="user.birth_date" class="form-control"></datepicker></div><div class="form-group"><label>Gender:</label><div class="clearfix"></div><label class="radio-inline"><input name="gender" type="radio" value="Male" ng-model="user.gender">Male</label> <label class="radio-inline"><input name="gender" type="radio" value="Female" ng-model="user.gender">Female</label> <label class="radio-inline"><input name="gender" type="radio" value="Other" ng-model="user.gender">Other</label></div><div class="row form-group"><button type="submit" class="btn btn-success" ng-click="addUserDetail()">Add Detail</button><p class="hiw" ng-click="whyThisInfoDialog()"><u>why you need this?</u></p></div></div></form></div></div></div></div></div>'),e.put("app/login/partials/bizlogin.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">Rank-X</h1><h1 class="text-center">Business Registration</h1></div><div class="panel-body"><form ng-submit="vm.submit()" ng-if="!vm.isProgressing"><div class="form-group"><label>Email</label> <input type="email" class="form-control" ng-model="vm.username"></div><div class="form-group"><label>Password</label> <input type="password" class="form-control" ng-model="vm.password"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary">Sign In</button></div></form><div style="text-align: center" ng-if="vm.isProgressing"><div class="loading-pulse"></div><p class="text-muted">Loading...</p></div></div></div>'),e.put("app/login/partials/login.html",'<div class="panel panel-primary signin-card"><div class="panel-heading" style="background-color:lightgray;"><img src="/assets/images/rankxlogo_noheadline.png" style="width:100%; padding:10px;"></div><div class="panel-body"><form ng-submit="vm.submit()" ng-if="!vm.isProgressing"><div class="form-group text-center"><button type="button" class="btn btn-primary form-control" ng-click="vm.facebookLogin()"><i class="fa fa-facebook"></i> Login</button><br><br><button type="button" class="btn btn-default form-control" style="vertical-align:middle;" ng-click="vm.goBack()">Cancel</button></div><br><p class="hiw" ng-click="vm.whyFacebookDialog()"><u>why Facebook?</u></p></form><div style="text-align: center" ng-if="vm.isProgressing"><div class="loading-pulse"></div><p class="text-muted">Loading...</p></div></div></div>'),e.put("app/login/partials/register.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">Register</h1></div><div class="panel-body"><form name="registerForm"><div class="form-group"><label>First Name</label> <input type="text" name="firstName" class="form-control" ng-model="vm.firstName"></div><div class="form-group"><label>Last Name</label> <input type="text" name="lastName" class="form-control" ng-model="vm.lastName"></div><div class="form-group"><label>Email</label> <input type="email" class="form-control" ng-model="vm.username"></div><div class="form-group"><label>Password</label> <input type="password" name="password" class="form-control" ng-model="vm.password"></div><div class="form-group"><label>Confirm Password</label> <input type="password" name="confirm" class="form-control" ng-model="vm.confirm"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary" ng-click="vm.signIn()">Sign In</button> <button type="button" class="btn btn-primary" ng-click="vm.register()">Register</button></div></form></div></div>'),e.put("app/rank/Partials/RankChat.html",'<div class="container"><div class="row"><div class="col-md-6"><h1 class="page-heading">This is a test</h1></div></div></div>'),e.put("app/rank/Partials/RankSummary.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading rank...</p></div></div><div ng-if="vm.dataReady"><div class="container"><div class="row"><div class="container-bgbox col-xs-6 col-sm-6 col-md-4 col-lg-3"><bg-box bc="{{vm.bc}}" shade="{{vm.shade}}" fc="{{vm.fc}}" text="{{vm.ranking}}" dir="horizontal" w="100%" h="{{vm.sm ? \'200px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image1}}" style="display:{{vm.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'200px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image2}}" style="display:{{vm.image2 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'200px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm hidden-md col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image3}}" style="display:{{vm.image3 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'200px\':\'200px\'}};"></div><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'200px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title1}}</h3></div></div><div class="container hidden-xs hidden-sm col-md-4 col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'200px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title2}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-if="vm.isShortPhrase" style="background-color:lightgray;color:black;height:{{sm ? \'200px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title3}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title3}}</h3></div></div></div></div><br><p class="text-left" ng-if="vm.sm">&nbsp&nbspSort by:</p><div class="row" style="margin:0px;padding:0px;"><div class="col-xs-9 col-sm-10 col-md-10 col-lg-10"><div class="btn-group text-left"><p>{{vm.sm ? \'\':\'Sort by:\'}}<span><button class="btn btn-default {{vm.selRank}}" ng-click="vm.sortByRank()" ng-if="vm.type != \'Event\' && !vm.fnm">Rank</button> <button class="btn btn-default {{vm.selUpV}}" ng-click="vm.sortByUpV()">Popular</button> <button class="btn btn-default {{vm.selDistance}}" ng-click="vm.sortByDistance()" ng-show="{{vm.type == \'Establishment\'}}">Distance</button> <button class="btn btn-default {{vm.selDate}}" ng-click="vm.sortByDate()" ng-show="{{vm.type == \'Event\'}}">Date</button></span></p></div></div><div class="col-xs-3 col-sm-2 col-md-2 col-lg-2 btn-group text-right"><button class="btn btn-default" ng-click="vm.share()" style="padding-right:5px">Share&nbsp&nbsp<span class="glyphicon glyphicon-share"></span></button></div></div><div class="row" style="margin:0px;"><div class="col-xs-6 text-right"><button ng-click="vm.goRank()" class="btn btn-success {{vm.rankDisabled}}">Rank</button></div><div class="col-xs-6 btn-group text-right"><h4>Contributors: <b style="color:blue;"><i>{{vm.numContributors}}&nbsp&nbsp</i></b></h4></div></div><br><table class="table table-hover cursor"><tbody><thead><tr><th>{{vm.showR ? \'Rank\' : \'Votes\'}}</th><th ng-show="{{!vm.sm && !vm.fnm && !vm.isE}}">Votes</th><th class="capitalize" ng-repeat="h in vm.fields | filter:{isrequired:true}">{{h.label}}</th><th ng-show="{{vm.type == \'Establishment\' && vm.haveLocation}}">Distance (mi)</th><th ng-show="{{vm.type == \'Event\'}}">Date</th><th ng-show="{{vm.type == \'Establishment\'}}">Specials</th></tr></thead><tbody><tr ng-repeat="x in vm.answers track by $index" ng-click="vm.answerDetail(x)"><td>{{vm.showR ? x.Rank : x.upV}}</td><td ng-show="{{!vm.sm && !vm.fnm && !vm.isE}}">{{x.upV}}</td><td ng-repeat="h in vm.fields | filter:{isrequired:true}"><a style="text-decoration: none;" href="{{\'/answerDetail/\' + x.slug }}">{{ x[h.name]}}</a></td><td ng-show="{{vm.type == \'Establishment\' && vm.haveLocation}}">{{x.dist}}</td><td ng-show="{{vm.type == \'Event\'}}">{{x.date}}</td><td ng-show="{{vm.type == \'Establishment\'}}" style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></tbody></table><div class="row" style="margin:0px;"><div class="col-xs-2" style="padding:0px"><a class="btn btn-primary" ng-click="vm.addAnswer()">+</a></div><div class="col-xs-10" style="display:{{vm.hideInfoBox ? \'none\':\'inline\'}};padding:0px;" ng-if="!vm.addInfoMsgAck || vm.noAnswers"><div class="alert alert-warning" style="padding-top: 5px;padding-bottom: 5px;"><a class="close" data-dismiss="alert" aria-label="close" ng-click="vm.closeAddInfoMsg()">&times;</a> <span class="glyphicon glyphicon-arrow-left"></span><strong>&nbsp;&nbsp; {{vm.noAnswers ? \'Oops, we have nothing on this list.\':\'Are we missing one?\'}}</strong>&nbsp;&nbsp;Use the \'+\' button to add a new <span ng-if="vm.type == \'Establishment\'">Establishment.</span> <span ng-if="vm.type == \'Organization\'">Organization or Company.</span> <span ng-if="vm.type == \'Person\'">Person.</span> <span ng-if="vm.type == \'PersonCust\'">Professional.</span> <span ng-if="vm.type == \'Place\'">Place.</span> <span ng-if="vm.type == \'Short-Phrase\'">Answer.</span> <span ng-if="vm.type == \'Thing\'">Item.</span> <span ng-if="vm.type == \'Event\'">Event.</span></div></div></div><br><br ng-if="!vm.sm"><div class="text-center"><button ng-click="vm.loadComments()" class="btn btn-default" ng-class="vm.cm.commLoaded ? \'disabled\' : \'\'" style="background-color:#e6e6e6;width:100%">COMMENTS ({{vm.numcom}})</button></div><br ng-if="!vm.sm"><div style="display:{{vm.cm.commLoaded ? \'inline\':\'none\'}}"><div ng-repeat="x in vm.cm.comments"><div class="col-xs-12 media"><div ng-if="!x.picture" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body">{{x.body}}<br><small style="color:#bfbfbf">{{x.username}} - {{x.date}}&nbsp&nbsp <span class="dropdown"><i type="button" class="fa fa-flag dropdown-toggle" data-toggle="dropdown"></i><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="vm.cmFlag(1)">Off-Topic</a></li><li><a ng-click="vm.cmFlag(2)">Offensive</a></li><li><a ng-click="vm.cmFlag(3)">Spam</a></li></ul></span></small></div></div><br></div><div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length == 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>Nobody has commented yet. Be the first. Log in, endorse answers and leave a comment.</small></p></div><div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length > 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>You must log in and endorse one or more answers to leave a comment.</small></p></div><div style="display:{{(vm.cm.commLoaded && vm.isLoggedIn && !vm.commentAllowed) ? \'inline\':\'none\'}}"><br><p><small>Endorse one or more answers to leave a comment.</small></p></div><div style="display:{{(vm.isLoggedIn && vm.commentAllowed) ? \'inline\':\'none\'}}"><div class="media"><div ng-if="!user.picture.data.url" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="user.picture.data.url" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{user.picture.data.url}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body"><textarea class="form-control" ng-model="vm.cm.newComment" placeholder="Leave a comment" style="margin-left:0px;margin-right:0px;"></textarea></div></div><div class="text-right"><button ng-click="vm.postComment()" class="btn btn-primary">Post</button></div></div></div></div>'),e.put("app/rank/Partials/editRanking.html",'<div class="container"><h3>Edit Ranking</h3><div class="row" style="padding-bottom:10px"><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div><div class="container-bgbox col-xs-6 col-sm-3 col-md-2 col-lg-2"><bg-box bc="{{vm.bc}}" bc2="{{vm.bc2}}" fc="{{vm.fc}}" text="{{vm.rankTitle}}" dir="horizontal" w="100%" h="{{vm.sm ? \'200px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img ng-src="{{vm.image}}" style="width:100%;height:{{vm.sm ? \'200px\':\'200px\'}};"></div><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div></div><br><div><label><strong>Image Query:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="Enter what to search for an image, i.e. taco" ng-model="vm.imageQuery"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.getImages()" type="button">Search Images</button></span></div><div class="text-center"><div class="btn-group"><button class="btn btn-default" ng-click="vm.prevImg()">&nbsp&nbsp<<&nbsp&nbsp< button=""><button class="btn btn-default" ng-click="vm.nextImg()">&nbsp&nbsp>>&nbsp&nbsp</button> <button class="btn btn-default" ng-click="vm.selectImg()">Select Image</button></&nbsp&nbsp<></button></div></div></div><br><div><label><strong>Select Color Design:</strong></label><div class="container"><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(1)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c1sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:brown"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(2)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c2sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#4682b4"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(3)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c3sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#008080"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(4)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c4sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:gray"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(5)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c5sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#a3297a"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(6)" style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c6sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#c68c53"></div></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><div class="row" style="padding-top:10px"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="btn-group col-xs-6"><button class="btn btn-primary" ng-click="vm.minusShade()">&nbsp&nbsp<i class="fa fa-minus"></i>&nbsp&nbsp</button> <button class="btn btn-primary" ng-click="vm.plusShade()">&nbsp&nbsp<i class="fa fa-plus"></i>&nbsp&nbsp</button></div></div></div></div><br><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>AnswerTags:</strong></label> <input class="form-control" ng-model="vm.answertags" type="text" placeholder="{{vm.answertags}}"> <label><strong>IsAtomic:</strong></label> <input class="form-control" ng-model="vm.isatomic" type="text" placeholder="{{vm.isatomic}}"> <label><strong>Category-Strings:</strong></label> <input class="form-control" ng-model="vm.catstr" type="text" placeholder="{{vm.catstr}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"> <label><strong>isMP Flag:</strong></label> <input class="form-control" ng-model="vm.ismp" type="text" placeholder="{{vm.ismp}}"><br><div class="form-group text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.goEdit()">Edit</button> <button type="button" class="btn btn-danger" ng-click="vm.goDelete()">Delete</button></div><br></div>'),e.put("app/rank/Partials/match.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.table.title}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.table.title}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><h3>{{vm.table.question}}</h3><div class="form-group text-center"><div class="well well-dark">Rank match <strong>{{vm.GP}}</strong> of <strong>{{vm.Tot}}</strong></div></div><div class="row"><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer1.name) ? vm.answer1.name : ""}} {{(f.name == "cityarea" && vm.answer1.cityarea) ? " - "+ vm.answer1.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer1.imageurl}}" ng-click="vm.selectAnswer(1)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; height:auto;" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer1.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer1.addinfo}}</h4></div></div><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer2.name) ? vm.answer2.name : ""}} {{(f.name == "cityarea" && vm.answer2.cityarea) ? " - "+ vm.answer2.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer2.imageurl}}" ng-click="vm.selectAnswer(2)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; height:auto;" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer2.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer2.addinfo}}</h4></div></div></div><br><div class="row"><div class="form-group text-left col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(1)" type="button" class="btn btn-success">Details</button></div><div class="form-group text-right col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(2)" type="button" class="btn btn-success">Details</button></div></div><div class="form-group text-center"><button ng-click="vm.skipMatch()" type="button" class="btn btn-default">I don\'t know, Skip</button> <button ng-click="vm.rankSummary()" type="button" class="btn btn-danger">Stop</button></div><br>'),
e.put("app/promoters/Partials/promote.html",'<div ui-view="navbar"></div><br><div class="container"><h2>Become a Rank-X Promoter</h2><br><p class="text-left">Thank you for your interest in becoming a Rank-X promotor. Please read carefully the information below.</p><div class="accordion" role="tablist" aria-multiselectable="true"><div class-="" "card"=""><div class="card-header" role="tab" id="headingOne" ng-click="vm.show(1)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">What is Rank-X?</a></h3></div><div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne" ng-show="vm.showOne"><div class="card-block"><p class="text-left">Rank-X is a San Diego based company with a web application designed to create interactive content in the forms of rankings, lists and opinions. We like to focus on things on our city but also cover general topics. Our goal is to be the best source of information for the best services, food, events and things happening around our city in a clean and elegant way. In addition to best deals and specials that different businesses offer. If you have not already done so, please take a time to look at the website. <span><a href="/#!/home">Click here</a></span></p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingTwo" ng-click="vm.show(2)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseTwo">What does Rank-X sells?</a></h3></div><div id="collapseTwo" class="collapse show" role="tabpanel" aria-labelledby="headingTwo" ng-show="vm.showTwo"><div class="card-block"><p class="text-left">Rank-X sells premium memberships to businesses and brands that wish to stand out from others, and to those that wish to promote their specials and promotions with users.</p><div class="row"><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img1.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">All of the content is generated by lists.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img2.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">When content is presented, a far right column is saved for specials. <i>Premium Business</i> (Demo Restaurant 1) gets highlighted with a short description of the current special.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img3.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">Inside an Establishment detail, a <i>Premium Business</i> can create detail boxes to advertise their specials.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img4.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">Each special can contain an image that can be displayed. Images can contain <strong>coupons</strong>, <strong>flyers</strong>, <strong>bar codes</strong>, etc. It is up to the business the content of the image to be displayed.</p></div></div><p class="text-left"><i>Premium Business</i> can edit and control real-time the specials and promotions that are shown.</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingThree" ng-click="vm.show(3)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">How much do businesses pay for Premium Membership?</a></h3></div><div id="collapseThree" class="collapse show" role="tabpanel" aria-labelledby="headingThree" ng-show="vm.showThree"><div class="card-block"><p class="text-left">Premium memberships for Rank-X cost $99 per month. When using a promo code businneses get 60 days free trial.</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingFour" ng-click="vm.show(4)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseFour">What does it mean to be a Rank-X Promotor?</a></h3></div><div id="collapseFour" class="collapse show" role="tabpanel" aria-labelledby="headingFour" ng-show="vm.showFour"><div class="card-block"><p class="text-left">Rank-X promotors are people working as independent contractors that help us promote, advertise and give feedback about the application. The success of Rank-X will depend strongly on its ability to spread the word out about its exsitance to businesses and to get business to subscribe to Rank-X to advertise their specials and promotions. Thus, Rank-X promotors have three basic responsibilities.</p><p class="text-left"><strong>1. Become familiar with the app.</strong> Rank-X Promotors are expected to understand the working of the application, to participate regularly in the rankings, add content and do their best so the content of the application is always engaging, accurate and useful.</p><p class="text-left"><strong>2. Market the application.</strong> Rank-X Promotors are expected to connect with business owners in their area show the value that Rank-X can have in their bussiness. The amount of money earned by a Rank-X promoter will be directly proportional to the amount of businesses they get to sign up.</p><p class="text-left"><strong>3. Provide constant Feedback.</strong> Rank-X Promotors are expected to provide feedback of the workings of the app so it can be continually improved. By keeping the application running smoothly, with help customer retention and</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingFive" ng-click="vm.show(5)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseFive">What are the benefits of becoming a Rank-X Promotor?</a></h3></div><div id="collapseFive" class="collapse show" role="tabpanel" aria-labelledby="headingFive" ng-show="vm.showFive"><div class="card-block"><p class="text-left">All payments to promotors are strictly based on commissions. Rank-X offers lasting commissions on all accounts that a Rank-X promotor closes. As long as the account that the promoter closed are active, the Promotor will continue receiving commission. There is no limit on how much money a promotor can make.</p><p class="text-left">Consider the example of a Rank-X promoter that closes one business per month and receives $30 commission per business (actual commission might vary). Promoter sign ups come with a 60 days free trial for that business. After free trial expires, and business start paying subscription, Rank-X promoter will get paid commission for that account as shown in the table below.</p><table class="table table-hover cursor"><thead><tr><th align="middle">Month</th><th align="middle">Accnt 1</th><th align="middle">Accnt 2</th><th align="middle">Accnt 3</th><th align="middle">Commission</th></tr></thead><tbody align="middle"><tr><td>1st</td><td>On trial</td><td>-</td><td>-</td><td>$0.00</td></tr><tr><td>2nd</td><td>On trial</td><td>On trial</td><td>-</td><td>$0.00</td></tr><tr><td>3rd</td><td>Active</td><td>On trial</td><td>On trial</td><td>$30.00</td></tr><tr><td>4th</td><td>Active</td><td>Active</td><td>On trial</td><td>$60.00</td></tr><tr><td>5th</td><td>Active</td><td>Active</td><td>Active</td><td>$90.00</td></tr></tbody></table></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingSix" ng-click="vm.show(6)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">How do I become a Rank-X promoter?</a></h3></div><div id="collapseSix" class="collapse show" role="tabpanel" aria-labelledby="headingSix" ng-show="vm.showSix"><div class="card-block"><p class="text-left">Becoming a Rank-X promoter is very simple. Only requirement is that you must have an active Facebook account. There is no cost to becoming a promoter, its completely free. To begin, login to Rank-X using your Facebook account. Once you are logged in, click the \'Promote\' link at the bottom of the page. It will redirect you to the Promoter Console, where you will be asked to fill in a form and you will get your Promoter Code right away.</p></div></div></div><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer></div></div>'),e.put("app/promoters/Partials/promoterconsole.html",'<div ui-view="navbar"></div><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div class="loading-pulse"></div><p style="font-size:large">loading your accounts...</p></div></div><div ng-if="vm.dataReady"><div class="container"><h3>Promoter Console</h3><div ng-if="vm.userIsPromoter"><h4 align="center" style="background-color:#b3b3b3;padding:5px">Account Information</h4><div ng-if="!vm.promoter.stripeid" style="padding: 10px;background-color: indianred;border-radius: 10px;text-align: center;margin-bottom:10px">You should link your stripe account to get payed. <a class="btn btn-primary" ng-click="vm.connectStripe()">Connect with Stripe</a></div><div ng-if="vm.notifications.length != 0"><notification-block notifications="vm.notifications"></notification-block></div><p class="text-left"><strong>First Name:</strong>&nbsp{{vm.promoter.firstname}}</p><p class="text-left"><strong>Last Name:</strong>&nbsp{{vm.promoter.lastname}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.promoter.email}}</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.promoter.address}}</p><p class="text-left"><strong>Phone Number:</strong>&nbsp{{vm.promoter.phone}}</p><p class="text-left"><strong>Promoter Code:</strong>&nbsp{{vm.promoter.code}}</p><div class="text-right" role="group"><button type="button" ng-click="vm.goEdit()" class="btn btn-default">Edit</button></div><h4 align="center" style="background-color:#b3b3b3;padding:5px">Accounts</h4><table class="table" ng-if="!vm.noAns&&vm.overview"><tbody><thead style="border-style:none;"><tr><th class="text-center">Business Name</th><th class="text-center">Status</th><th class="text-center">Commission (after trial)</th></tr></thead><tr ng-repeat="x in vm.myaccnts" style="cursor:pointer;"><td ng-click="vm.gotoanswer(x.answerObj)">{{x.name}}</td><td align="middle" style="{{x.style}}" ng-click="vm.gotomanage(x)">{{x.status}}</td><td ng-click="vm.gotomanage(x)" style="text-align:right">${{x.totalCommission}}</td></tr></tbody></table><div ng-if="vm.manageview"><p class="text-left"><strong>Business Name:</strong>&nbsp{{vm.business.answerObj.name}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.business.email}}</p><p class="text-left"><strong>Owner/Contact Name:</strong>&nbsp{{vm.business.username}}</p><p class="text-left"><strong>Last Name:</strong>&nbsp{{vm.promoter.lastname}}</p><p class="text-left"><strong>Status:</strong><span align="middle" style="{{x.style}}">{{x.business.status}}</span></p><p class="text-left"><table class="table" ng-if="vm.business.status==\'Active\'"><tbody><thead style="border-style:none;"><tr><th style="width:45%" text-align="center">Subscription</th><th style="width:15%" text-align="center">Commission</th></tr></thead><tr ng-if="vm.business.ispremium" style="cursor:pointer;"><td style="width:45%">Premium Membership</td><td style="width:15%">${{vm.business.price*vm.STRIPE_COMMISSION_PERCENTAGE}}</td></tr><tr ng-if="vm.business.hasranks" style="cursor:pointer;"><td style="width:45%">{{vm.business.ranksqty}} Custom Ranks</td><td style="width:15%">${{vm.business.ranksqty*35*vm.STRIPE_COMMISSION_PERCENTAGE}}</td></tr><tr><td style="width:45%">Total</td><td style="width:15%; background-color: darkgray;">${{vm.business.totalCommission}}</td></tr></tbody></table></p><p class="text-left" ng-if="vm.business.status.indexOf(\'On Trial\') != -1">Will be active from {{vm.business.discountEndDate}}.</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.promoter.address}}</p><p class="text-left"><strong>Phone Number:</strong>&nbsp{{vm.promoter.phone}}</p></div><div ng-if="vm.noAns"><br><p>No businesses have signed up using your promoter code. For tips and suggestions on how to get businesses to sign up using your promoter code <a href="" ng-click="vm.gotoPromotePage()">click here</a>.</p></div></div><div ng-if="!vm.userIsPromoter"><p>You are currently not registered to be a Promoter. Rank-X promoters help spread the word out about the app to local businesses, as well as monitoring the accuracy of content of the application. In exchange, promoters get paid monthly commissions on all businesses accounts they bring to Rank-X.</p><div class="text-center"><button type="button" ng-click="vm.goSignup()" class="btn btn-success">Sign Up</button> <button type="button" ng-click="vm.gotoPromotePage()" class="btn btn-primary">Learn More</button></div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div>'),e.put("app/promoters/Partials/promotersignup.html",'<div ui-view="navbar"></div><div class="container"><h3>Promoter Sign Up</h3><br><form class="form-horizontal" role="form" name="answerForm"><div class="form-group"><label class="control-label capitalize" style="padding-left:10px">First Name:</label> <input class="form-control" ng-model="vm.promoter.firstname" placeholder="{{vm.promoter.firstname}}" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Last Name:</label> <input class="form-control" ng-model="vm.promoter.lastname" placeholder="{{vm.promoter.lastname}}" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Email:</label> <input class="form-control" ng-model="vm.promoter.email" placeholder="Your email address" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Phone:</label> <input class="form-control" ng-model="vm.promoter.phone" placeholder="123-123-1234" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Address:</label> <input class="form-control" ng-model="vm.promoter.address" placeholder="Your address" style="width:94%;margin-left:10px;margin-right:10px;"></div></form><br><div class="row"><div class="col-xs-3 col-sm-3 col-md-2"><div class="text-right"><button class="btn btn-primary" ng-click="vm.getcode()">Get Code</button></div></div><div class="col-xs-9 col-sm-9 col-md-10"><h3 style="color:blue; margin:2px">{{vm.code}}</h3></div></div><br><div class="text-center"><button class="btn btn-success" ng-click="vm.submit()">Submit</button></div><br></div>')}]);