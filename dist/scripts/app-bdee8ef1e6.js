function calculateAge(e){var t=Date.now()-e.getTime(),a=new Date(t);return Math.abs(a.getUTCFullYear()-1970)}!function(){"use strict";angular.module("app",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMessages","pascalprecht.translate","tmh.dynamicLocale","login","ui.router","ui.bootstrap.modal","mgcrea.ngStrap","720kb.datepicker"])}(),function(){"use strict";function e(e){function t(t,o){for(var r=t.length,l=r*(r-1)/2,c=o.length,d=0,u=0,g=0,m=0,p=0;r>p;p++){a[p]=new Array(r),n[p]=new Array(r);for(var v=0;r>v;v++)a[p][v]=0,n[p][v]=0;s[p]=t[p].id}for(p=0;c>p;p++)d=s.indexOf(o[p].hs),u=s.indexOf(o[p].ls),d>=0&&u>=0&&(o[p].sel==o[p].hs?a[d][u]++:o[p].sel==o[p].ls&&a[u][d]++,n[d][u]++,n[u][d]++);for(g=0,p=0;r>p;p++)for(v=0;r>v;v++)g+=n[p][v];for(m=g/(4*l),p=0;r>p;p++){for(t[p].Rank=0,g=0,v=0;r>v;v++)t[p].Rank=t[p].Rank+a[p][v],g+=n[p][v];t[p].Rank=t[p].Rank/g,m>g&&(t[p].Rank=t[p].Rank*(g/m))}for(var h=0;r>h;h++)for(v=0;r>v;v++)h!=v&&t[v].Rank>=t[h].Rank&&a[h][v]>a[v][h]&&n[h][v]>=m&&(t[h].Rank=t[v].Rank+.01);i=t,e.answersR=i,e.R=a,e.GP=n,e.A=s}e.A=[];var a=[],n=[],s=[],i=[],o={computeRanking:t};return o}angular.module("app").service("rank",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(t){function a(e){return console.log("creating match record was succesful"),e.data}var n={};n.resource=[],n.resource.push(t),l.push.apply(l,t);var s=c+"/_table/matchtable";return e.post(s,t,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,o)}function s(a){function n(e){return l=e.data.resource}if(r()&&!a)return t.when(l);var s=c+"/_table/matchtable";return e.get(s).then(n,o)}function i(t){function a(a){function n(e){console.log("deleting records succesful")}return s=c+"/_table/matchtable?filter=hs="+t,e["delete"](s).then(n,o)}for(var n=0;n<l.length;n++)(l[n].ls==t||l[n].hs==t)&&l.splice(n,1);var s=c+"/_table/matchtable?filter=ls="+t;return e["delete"](s).then(a,o)}function o(e){throw e}function r(){return l.length>0}var l=[],c="/api/v2/mysql",d={GetMatchTable:s,postRec:n,deleteRecordsbyAnswer:i};return d}angular.module("app").factory("matchrec",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s,i,o,r,l,c,d,u,g,m,p,v){function h(){d.rankIsActive=!0,d.objNumAct=d.objNum,k(),f(),x(),R.tableimage=d.cCategory.imagefile,o.computeRanking(d.canswers,d.cmrecs),R.answers=l("orderBy")(R.answers,"-Rank"),0==R.answers.length&&(R.numAns=0,c.update(d.cCategory.id,["views","answers"],[d.cCategory.views+1,d.canswers.length])),1==R.answers.length&&(R.numAns=1,"Short-Phrase"==d.cCategory.type?(R.isShortPhrase=!0,R.title1=R.answers[0].name,R.addinfo1=R.answers[0].addinfo,R.image1=R.title1+"##"+R.title1):(R.isShortPhrase=!1,R.image1=R.answers[0].imageurl),c.update(d.cCategory.id,["views","answers","image1url"],[d.cCategory.views+1,d.canswers.length,R.image1])),2==R.answers.length&&(R.numAns=2,"Short-Phrase"==d.cCategory.type?(R.isShortPhrase=!0,R.title1=R.answers[0].name,R.addinfo1=R.answers[0].addinfo,R.image1=R.title1+"##"+R.title1,R.title2=R.answers[1].name,R.addinfo2=R.answers[1].addinfo,R.image2=R.title2+"##"+R.title2):(R.isShortPhrase=!1,R.image1=R.answers[0].imageurl,R.image2=R.answers[1].imageurl),c.update(d.cCategory.id,["views","answers","image1url","image2url"],[d.cCategory.views+1,d.canswers.length,R.image1,R.image2])),R.answers.length>2&&(R.numAns=3,"Short-Phrase"==d.cCategory.type?(R.isShortPhrase=!0,R.title1=R.answers[0].name,R.addinfo1=R.answers[0].addinfo,R.image1=R.title1+"##"+R.title1,R.title2=R.answers[1].name,R.addinfo2=R.answers[1].addinfo,R.image2=R.title2+"##"+R.title2,R.title3=R.answers[2].name,R.addinfo3=R.answers[2].addinfo,R.image3=R.title3+"##"+R.title3):(R.isShortPhrase=!1,R.image1=R.answers[0].imageurl,R.image2=R.answers[1].imageurl,R.image3=R.answers[2].imageurl),c.update(d.cCategory.id,["views","answers","image1url","image2url","image3url"],[d.cCategory.views+1,d.canswers.length,R.image1,R.image2,R.image3])),console.log("Rank Summary Loaded!")}function f(){if(d.isLoggedIn){p.loadVotesTable().then(function(e){for(var t=0;t<e.length;t++)for(var a=0;a<d.ccatans.length;a++)if(e[t].catans==d.ccatans[a].id){var n=e[t];d.cvotes.push(n)}}),m.loadEditVotesTable().then(function(e){for(var t=0;t<e.length;t++)if(e[t].category==d.cCategory.id){var a=e[t];d.ceditvotes.push(a)}}),d.cmrecs_user=[];for(var e=0;e<d.cmrecs.length;e++)d.cmrecs[e].user==d.user.id&&d.cmrecs_user.push(d.cmrecs[e]);d.cuseractivity_user=[];for(var e=0;e<d.cuseractivity.length;e++)if(d.cuseractivity[e].user==d.user.id){d.userHasRank=!0,d.userActRecId=d.cuseractivity[e].id;break}}}function b(e){a.go("answerDetail",{index:e})}function y(){return d.canswers.length>1?void a.go("match"):void e.getDialog("answersFew")}function w(){return d.isLoggedIn?P?void e.getDialog("answersFull"):void a.go("addAnswer"):void e.getDialog("notLoggedIn")}function k(){d.cCategory={};for(var e=0;e<d.content.length;e++)if(d.content[e].id==t.index){d.cCategory=d.content[e];break}var a=[],s=0;switch(d.cCategory.type){case"Place":s=0;break;case"Person":s=1;break;case"Event":s=2;break;case"Organization":s=3;break;case"Short-Phrase":s=4;break;case"Activity":s=5;break;case"Establishment":s=6}if(a=d.typeSchema[s].fields,d.fields=a,R.fields=d.fields,R.type=d.cCategory.type,d.NhImplied=!1,d.NhValue="","Establishment"==d.cCategory.type)for(var e=0;e<d.neighborhoods.length;e++)if(d.cCategory.title.includes(d.neighborhoods[e])){d.NhImplied=!0,d.NhValue=d.neighborhoods[e];break}if(d.NhImplied)for(var e=0;e<R.fields.length;e++)"cityarea"==R.fields[e].name&&(R.fields[e].isrequired=!1);d.answers=n,d.canswers=[],d.ccatans=[],d.B=[];for(var e=0;e<r.length;e++)if(r[e].category==d.cCategory.id)for(var o=0;o<n.length;o++)if(r[e].answer==n[o].id){d.canswers.push(n[o]),d.ccatans.push(r[e]),d.B.push(r[e].id);break}R.answers=d.canswers;for(var l=.017453292519943295,c=Math.cos,u=0,m=d.currentUserLatitude,p=d.currentUserLongitude,h=0,f=0,b=0,e=0;e<R.answers.length;e++)h=R.answers[e].lat,f=R.answers[e].lng,u=.5-c((h-m)*l)/2+c(m*l)*c(h*l)*(1-c((f-p)*l))/2,b=12742*Math.asin(Math.sqrt(u))/1.609,R.answers[e].dist=b.toPrecision(3);d.cmrecs=[];for(var e=0;e<i.length;e++)i[e].category==d.cCategory.id&&d.cmrecs.push(i[e]);d.cedits=[];for(var e=0;e<g.length;e++)if(g[e].category==d.cCategory.id){var y=g[e];d.cedits.push(y)}d.cuseractivity=[];for(var e=0;e<v.length;e++)if(v[e].category==d.cCategory.id){var w=v[e];d.cuseractivity.push(w)}R.numContributors=d.cuseractivity.length}function x(){P=d.canswers.length>=20?!0:!1}function A(){d.isLoggedIn?d.cmrecs_user.length>0?(R.selOverall="",R.selPersonal="active",R.numContributors=1,o.computeRanking(d.canswers,d.cmrecs_user)):e.getDialog("noPersonalRank"):e.getDialog("notLoggedIn")}function C(){R.selOverall="active",R.selPersonal="",R.numContributors=d.cuseractivity.length,o.computeRanking(d.canswers,d.cmrecs)}function S(){a.go("cwrapper")}function $(){d.addInfoMsgAck=!0,R.addInfoMsgAck=!0}var R=this;R.title="rankSummary",R.addAnswerDisabled="",R.ranking=d.title,R.answerDetail=b,R.addAnswer=w,R.goRank=y,R.closeRank=S,R.rankOverall=C,R.rankPersonal=A,R.closeAddInfoMsg=$,R.selOverall="active",R.selPersonal="";d.cvotes=[],d.ceditvotes=[],d.cmrecs_user=[],d.catansrecs=r;var P=!1;d.userHasRank=!1,d.userActRecId=0;R.addInfoMsgAck=d.addInfoMsgAck?d.addInfoMsgAck:!1,d.$on("$stateChangeSuccess",function(e,t,a,n,s){d.previousState=n.name}),h()}angular.module("app").controller("rankSummary",e),e.$inject=["dialog","$stateParams","$state","answers","answer","mrecs","rank","catansrecs","$filter","table","$rootScope","$modal","edits","editvote","votes","useractivities"]}(),function(){"use strict";function e(e,t,a,n,s,i,o,r){function l(){s.$on("$stateChangeSuccess",function(e,t,a,n,i){s.previousState=n.name}),s.$on("$stateChangeStart",function(e,t,a,n,o){"match"==n.name&&R.length>0&&(i.postRec(R),s.userHasRank?r.patchRec(s.userActRecId):r.postRec(),R=[])}),p(),v(),u()}function c(e){if(!s.isLoggedIn)return void t.getDialog("notLoggedIn");var a={};a.user=s.user.id,a.hs=b.answer1.id,a.ls=b.answer2.id,a.category=s.cCategory.id,a.timestmp=Date.now(),1==e&&(a.sel=b.answer1.id),2==e&&(a.sel=b.answer2.id),R.push(a),s.cmrecs_user.push(a),S++,S>=A&&(S=0),P=!0,u()}function d(){S++,S>=A&&(S=0),u()}function u(){if(b.GP=s.cmrecs_user.length,b.Tot=A,s.cmrecs_user.length>=A)return t.getDialog(P?"goodJobRankComplete":"rankComplete"),void g();if($)for(var e=y[C[S]],a=w[C[S]],n=!1,i=0;i<s.cmrecs_user.length;i++)if(s.cmrecs_user[i].hs==k[e].id&&s.cmrecs_user[i].ls==k[a].id){n=!0;break}n&&d(),b.answer1=k[y[C[S]]],b.answer2=k[w[C[S]]],h()}function g(){e.go("rankSummary",{index:b.table.id})}function m(t){1===t?e.go("answerDetail",{index:b.answer1.id}):e.go("answerDetail",{index:b.answer2.id})}function p(){y=[],w=[];for(var e=0;x-1>=e;e++)for(var t=e+1;x-1>=t;t++)y.push(e),w.push(t)}function v(){function e(e){var t,a,n=e.length;if(n)for(;--n;)a=Math.floor(Math.random()*(n+1)),t=e[a],e[a]=e[n],e[n]=t;return e}for(var t=0;A>t;t++)C[t]=t;C=e(C)}function h(){b.fields=s.fields}function f(){e.go("cwrapper")}var b=this;b.title="match",b.header="table"+s.cCategory.id+".header",b.body="table"+s.cCategory.id+".body",b.ranking=s.title;var y=[],w=[],k=s.canswers,x=k.length,A=x*(x-1)/2,C=[],S=0,$=s.cmrecs_user.length>0,R=[],P=!1;b.table=s.cCategory,b.type=s.cCategory.type,b.answer1,b.answer2,b.selectAnswer=c,b.rankSummary=g,b.skipMatch=d,b.answerDetail=m,b.closeRank=f,l()}angular.module("app").controller("match",e),e.$inject=["$state","dialog","$location","answer","$rootScope","matchrec","$modal","useractivity"]}(),function(){"use strict";function e(e,t,a,n,s,i){function o(){t.rankIsActive=!0,t.objNumAct=t.objNum,r(),console.log("editRanking page Loaded!")}function r(){t.cCategory={};for(var e=0;e<t.content.length;e++)if(t.content[e].id==n.index){t.cCategory=t.content[e];break}g.rankTitle=t.cCategory.title,g.tags=t.cCategory.tags,g.keywords=t.cCategory.keywords,g.type=t.cCategory.type,g.question=t.cCategory.question}function l(){t.$emit("closeRank")}function c(){var e=JSON.parse(JSON.stringify(t.cCategory)),a=[],n=[];e.title!=g.rankTitle&&(a.push("title"),n.push(g.rankTitle)),e.tags!=g.tags&&(a.push("tags"),n.push(g.tags)),e.keywords!=g.keywords&&(a.push("keywords"),n.push(g.keywords)),e.type!=g.type&&(a.push("type"),n.push(g.type)),e.question!=g.question&&(a.push("question"),n.push(g.question)),s.update(e.id,a,n)}function d(){i.deleteRank(u)}function u(){s.deleteTable(t.cCategory.id)}var g=this;g.title="editRanking",g.ranking=t.title,g.closeRank=l,g.goEdit=c,g.goDelete=d,g.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event"],o()}angular.module("app").controller("editRanking",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog"]}(),function(){"use strict";function e(e,t,a){function n(n){function s(e){return l=e.data.resource}if(o()&&!n)return t.when(l);var i=c+"?filter=(user="+a.user.id+")";return e.get(i).then(s,r)}function s(){function t(e){return console.log("User detail successfully added."),e.data}var n={};n.user=a.user.id,n.birth_date=a.user.birth_date,n.gender=a.user.gender;var s={};s.resource=[],s.resource.push(n),l.push(n);var i=c;return e.post(i,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(t,r)}function i(t){function a(e){return console.log("User detail successfully updated."),e.data}var n={};n.resource=[];var s={};s.id=t,s.timestmp=Date.now(),n.resource.push(s);var i=c;return e.patch(i,n,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,r)}function o(){return l.length>0}function r(e){throw e}var l=[],c="/api/v2/mysql/_table/user_detail",d={getUserDetail:n,addUserDetail:s,updateUserDetail:i};return d}angular.module("app").factory("userDetail",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s){function i(t){return e.post("/api/v2/user/session",t).then(function(t){e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,a.session_token=t.data.session_token,n.user=t.data;try{window.localStorage.user=JSON.stringify(t.data)}catch(s){}})}function o(){var e=t.defer(),a=s+"/api/v2/user/session?service=facebook";return e.resolve({url:a}),e.promise}function r(t){function s(t){console.log("oauth results",t),e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,a.session_token=t.data.session_token,n.user=t.data;try{window.localStorage.user=JSON.stringify(t.data)}catch(s){}}return e.post("/api/v2/user/session?oauth_callback=true&service=facebook&"+t).then(s,c)}function l(){return e["delete"]("/api/v2/user/session").then(function(t){delete e.defaults.headers.common["X-DreamFactory-Session-Token"],a.remove("session_token"),delete n.user,n.isLoggedIn=!1;try{window.localStorage.removeItem("user")}catch(s){}})}function c(e){throw console.log("error",e),e}function d(t){return console.log("options",t),e.post("/api/v2/user/register?login=true",t).then(function(e){console.log("register result",e)},function(e){console.log("error",e)})}var u={initiate:i,loginWithFacebook:o,oauthWithFacebook:r,register:d,logout:l};return u}angular.module("app").factory("login",e),e.$inject=["$http","$q","$cookies","$rootScope","INSTANCE_URL"]}(),function(){"use strict";angular.module("login",["ngResource","ngCookies","ui.router"]).run(["$rootScope",function(e){try{e.user=JSON.parse(window.localStorage.user),e.user&&(e.isLoggedIn=!0)}catch(t){}}]).config(function(){})}(),function(){"use strict";function e(e,t,a,n){function s(e){return e.url.indexOf("/api/v2")>-1&&(e.url=n+e.url),"post"===e.method.toLowerCase()&&e.url.indexOf("/api/v2/user/session")>-1&&delete e.headers["X-DreamFactory-Session-Token"],e}function i(a){return console.log("result",a),302==a.status?(console.log("result",a),e.path("/login"),t.reject(a)):((401===a.status||403===a.status&&a.data.error.message.indexOf("token")>-1)&&e.path("/login"),t.reject(a))}var o={request:s,responseError:i};return o}angular.module("login").factory("httpInterceptor",e),e.$inject=["$location","$q","$injector","INSTANCE_URL"]}(),function(){"use strict";function e(e,t,a){function n(){t.isLoggedIn=!1}function s(){console.log("register",s),a.register({email:o.username,password:o.password,first_name:o.firstName||"Address",last_name:o.lastName||"Book"}).then(function(){e.path("/login")},function(e){o.message=e.Message,console.log("Error: ",e)})}function i(){e.path("/login")}var o=this;o.title="register",o.username="",o.password="",o.confirm="",o.firstName="",o.lastName="",o.message="",o.register=s,o.signIn=i,n()}angular.module("login").controller("register",e),e.$inject=["$location","$rootScope","login"]}(),function(){"use strict";function e(e,t,a,n,s,i,o){function r(){var e=location.search,t=e.lastIndexOf("?");t>=0&&(e=e.substr(t+1)),e&&(g.isProgressing=!0,n.oauthWithFacebook(e).then(function(e){a.isLoggedIn=!0,i.getUserDetail().then(function(e){if(0==Object.keys(e).length)a.openUserDetailModal();else{a.user.age=calculateAge(new Date(e[0].birth_date)),a.user.gender=e[0].gender,a.user.birth_date=e[0].birth_date;try{window.localStorage.user=JSON.stringify(a.user)}catch(t){}}}),console.log("isLoggedIn",a.isLoggedIn),o.go("cwrapper",{},{location:"replace"})},function(){g.isProgressing=!1})),console.log("vm.code",g.code),a.isLoggedIn=!1}function l(){console.log("submit"),n.initiate({email:g.username,password:g.password}).then(function(){a.isLoggedIn=!0,console.log("isLoggedIn",a.isLoggedIn),e.path("/")})}function c(){n.loginWithFacebook().then(function(e){t.location=e.url})}function d(){e.path("/register")}function u(){s.getDialog("whyFacebook")}var g=this;g.title="login",g.username="",g.password="",g.code="",g.isProgressing=!1,g.submit=l,g.register=d,g.redirectForFacebook=c,g.whyFacebookDialog=u,r()}angular.module("login").controller("login",e),e.$inject=["$location","$window","$rootScope","login","dialog","userDetail","$state"]}(),angular.module("app").directive("userDetailModal",["$rootScope","userDetail","dialog",function(e,t,a){return{restrict:"E",templateUrl:"app/login/partials/add-user-detail.html",link:function(n,s,i,o){n.maxDate=moment().format("YYYY-MM-DD"),e.openUserDetailModal=function(){e.user&&(e.user.gender="Male",e.user.birth_date=""),openModal("#addUserDetailModal")},e.addUserDetail=function(){t.addUserDetail().then(function(a){t.getUserDetail().then(function(t){if(0==Object.keys(t).length)e.openUserDetailModal();else{e.user.age=calculateAge(new Date(t[0].birth_date)),e.user.gender=t[0].gender,e.user.birth_date=t[0].birth_date;try{window.localStorage.user=JSON.stringify(e.user)}catch(a){}}}),closeModal("#addUserDetailModal")})},e.whyThisInfoDialog=function(){a.getDialog("whyUserData")},e.user&&(e.user.birth_date&&e.user.gender||e.openUserDetailModal())}}}]),function(){"use strict";function e(e,t,a){function n(a){function n(e){return o=e.data.resource}if(s()&&!a)return t.when(o);var l=r;return e.get(l).then(n,i)}function s(){return o.length>0}function i(e){throw e}var o=[],r="/api/v2/mysql/_table/cities",l={getCities:n};return l}angular.module("app").factory("city",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("citySelectionModal",["$rootScope",function(e){return{restrict:"E",templateUrl:"app/layout/Partials/city-selection.html",link:function(t,a,n,s){e.selectedCity=JSON.parse(window.localStorage.selectedCity)}}}]),function(){"use strict";function e(e,t,a,n,s,i,o){function r(){console.log("Navbar Loaded!")}function l(){s.go("about")}function c(){s.go("admin")}function d(){s.go("customer")}function u(){e.path("/login")}function g(){n.logout().then(function(){b.user="",b.isLoggedIn=!1,s.go("cwrapper",{},{location:"replace"})})}function m(){openModal("#selectCityModal")}function p(){a.cities||i.getCities().then(function(e){a.cities=e,h()})}function v(e){a.currentUserLatitude=e.coords.latitude,a.currentUserLongitude=e.coords.longitude,o.put("currentUserLatitude",a.currentUserLatitude),o.put("currentUserLongitude",a.currentUserLongitude),a.isLoggedIn&&(a.user.latitude=a.currentUserLatitude,a.user.longitude=a.currentUserLongitude,console.log("Geo Location is set for logged in user.")),console.log("Geo Location is set for user.")}function h(){function e(e){var a=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);v(e),t.geocode({latLng:a},function(e,t){if(t==google.maps.GeocoderStatus.OK)if(e[0]){{var a=e[0].formatted_address,n=a.split(","),s=n.length;n[s-1],n[s-2]}i=n[s-3],f(i)}else f();else f()})}var t;t=new google.maps.Geocoder,navigator.geolocation&&navigator.geolocation?navigator.geolocation.getCurrentPosition(e):f()}function f(e){if(a.selectedCity);else{var t=!1,n={};angular.forEach(a.cities,function(a){a.name==e.trim()&&a.is_active&&(t=!0,n=a)}),0==t?openModal("#selectCityModal"):(a.selectedCity=n,window.localStorage.selectedCity=JSON.stringify(a.selectedCity),a.$digest())}}var b=this;b.title="navbar",b.user=a.user,b.isLoggedIn=a.isLoggedIn?a.isLoggedIn:!1,b.logout=g,b.goToLogin=u,b.gotoAbout=l,b.gotoAdmin=c,b.gotoCustomer=d,b.openCitySelection=m,r(),p(),a.getCurrentPositionOfUser=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){v(e)},function(e){},{maximumAge:6e4,timeout:5e3,enableHighAccuracy:!0}):console.log("Geo location not supported.")}}angular.module("app").controller("navbar",e),e.$inject=["$location","$translate","$rootScope","login","$state","city","$cookieStore"]}(),function(){"use strict";function e(e,t,a,n){function s(){n(i,1e3),console.log("Layout Loaded!")}function i(){r.isLoading=!1}function o(){t.sval=r.val,t.$emit("searchRank")}var r=this;r.title="layout",r.header="",r.searchRank=o,r.isLoading=t.canswers?!1:!0,s(),t.selectCity=function(e){t.selectedCity=e,window.localStorage.selectedCity=JSON.stringify(t.selectedCity),closeModal("#selectCityModal")}}angular.module("app").controller("layout",e),e.$inject=["$location","$rootScope","$translate","$timeout"]}(),function(){"use strict";function e(e,t,a,n,s,i,o,r,l,c){function d(){console.log("activate cwrapper!"),w.isNh=e.isNh,w.isCity=e.isCity,w.isNhRdy=e.isNhRdy,w.nhs=e.neighborhoods,w.searchActive=e.searchActive,w.cnh=e.cnh}function u(){console.log("init cwrapper!"),e.isAdmin=!1,w.isAdmin=!1,e.content={},v(1),w.cnh="Select Neighborhood",e.cnh=w.cnh,w.isNhRdy=!1,e.isNhRdy=!1,e.content=o,e.specials=c,e.answers=i,g(),m(),a.get("../../../assets/fields.json").success(function(t){e.typeSchema=t,console.log("Fields Loaded!")}),a.get("../../../assets/dialogs.json").success(function(t){e.dialogs=t,console.log("Dialogs Loaded!")}),e.cwrapperLoaded=!0}function g(){w.searchArray=[],w.empty=[],w.cTags={},e.searchStr=[];for(var t=0;t<e.content.length;t++)e.searchStr[t]=e.content[t].tags+" "+e.content[t].title;e.neighborhoods=["Downtown","La Jolla","Pacific Beach","Hillcrest","University Heights","Old Town","Del Mar","Ocean Beach","North Park","Mission Hills","Barrio Logan","City Heights","Clairemont","La Mesa","Point Loma","South Park","Scripps Ranch","Mission Beach","Kensington","Cardiff by the Sea","Coronado","Leucadia","Oceanside","National City","Rancho Santa Fe","Solana Beach","Poway","El Cajon","Escondido","Carlsbad","San Ysidro","Otay Mesa","Linda Vista","Chula Vista","Encinitas","Golden Hills","Spring Valley","Rancho San Diego"],e.districts=["Columbia","Core","Cortez Hill","East Village","Gaslamp Quarter","Horton Plaza","Little Italy","Marina","Seaport Village"],w.nhs=e.neighborhoods}function m(){e.estAnswers=[],e.estNames=[];for(var t=0;t<i.length;t++)"Establishment"==i[t].type&&(e.estNames.push(i[t].name),e.estAnswers.push(i[t]))}function p(t){e.inputVal=t,e.searchActive=e.inputVal.length>0?!0:!1,w.searchActive=e.searchActive,e.$emit("refreshRanks")}function v(t){1==t&&(w.isNh=!1,w.isCity=!0,e.isNh=!1,e.isCity=!0,w.val="",e.inputVal="",e.searchActive=!1,e.$emit("loadNh")),2==t&&(w.isNh=!0,w.isCity=!1,e.isNh=!0,e.isCity=!1,w.val="",e.inputVal="",e.searchActive=!1,e.isNhRdy&&e.$emit("loadNh")),w.searchActive=e.searchActive}function h(t){e.cnh=t,w.cnh=t,w.isNhRdy=!0,e.isNhRdy=w.isNhRdy,e.$emit("loadNh")}function f(){e.editMode=!0,w.selEditRank="active",w.selViewRank=""}function b(){e.editMode=!1,w.selEditRank="",w.selViewRank="active"}function y(){e.$emit("applyRule")}var w=this;w.title="cwrapper",w.switchScope=v,w.refreshRanks=p,w.viewRank=b,w.editRank=f,w.applyRule=y,w.selnh=h,e.editMode=!1,w.content=[],w.emptyspace="",e.searchActive=!1,w.searchActive=e.searchActive,e.cwrapperLoaded?d():u()}angular.module("app").controller("cwrapper",e),e.$inject=["$rootScope","$state","$http","$stateParams","$scope","answers","rankings","query","table","specials"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("About page Loaded!")}function s(){a.go("cwrapper")}var i=this;i.title="about",i.goBack=s,n()}angular.module("app").controller("about",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return p=e.data.resource}if(c()&&!a)return t.when(p);var s=h;return e.get(s).then(n,g)}function s(a,n){function s(e){return m=e.data}if(u(a)&&!n)return t.when(m);var i=h+"/"+a;return e.get(i).then(s,g)}function i(a,n){function s(e){return v=e.data.resource}if(d()&&!n)return t.when(v);var i=h+"/?filter=answer="+a;return e.get(i).then(s,g)}function o(t){function a(e){var a=t;return a.id=e.data.resource[0].id,p.length>0&&p.push(a),v.length>0&&v.push(a),console.log("result",e),e.data}var n=h,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,g)}function r(t){function a(e){return console.log("updating special succesful"),e.data}var n={};n.resource=[],n.resource.push(t);var s=h;if(p.length>0)for(var i=0;i<p.length;i++)p[i].id==t.id&&(p[i]=t);if(v.length>0)for(var i=0;i<v.length;i++)v[i].id==t.id&&(v[i]=t);return e.patch(s,n,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,g)}function l(t){function a(e){return console.log("Deleting special was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var i=h+"/"+t;if(p.length>0){var o=p.map(function(e){return e.id}).indexOf(t);o>-1&&p.splice(o,1)}if(v.length>0){var o=v.map(function(e){return e.id}).indexOf(t);o>-1&&v.splice(o,1)}return e["delete"](i,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,g)}function c(){return p.length>0}function d(){return v.length>0}function u(e){return m&&m.id==e}function g(e){throw e}var m,p=[],v=[],h="/api/v2/mysql/_table/specials",f={getSpecials:n,getSpecial:s,addSpecial:o,updateSpecial:r,deleteSpecial:l,getSpecialsbyAnswer:i};return f}angular.module("app").factory("special",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e){function t(e){if("onetime"==e.freq){a(e,"stime"),a(e,"etime");var t=new Date(e.sdate),n=t.toString();e.sdate=n.substring(0,15),t=new Date(e.edate),n=t.toString(),e.edate=n.substring(0,15)}"weekly"==e.freq&&(a(e,"stime2"),a(e,"etime2"))}function a(e,t){var a="";switch(t){case"stime":a=e.stime;break;case"etime":a=e.etime;break;case"stime2":a=e.stime2;break;case"etime2":a=e.etime2}if(null!=a&&void 0!=a&&(a.includes("00:00")||a.includes("30:00"))){a=a.replace("00:00","00"),a=a.replace("30:00","30");var n=parseInt(a.substring(0,2))<12;if(a+=n?" AM":" PM",!n){var s=parseInt(a.substring(0,2))-12,i="";i=10>s?"0"+s.toString():s.toString(),a=a.replace(a.substring(0,2),i)}}switch(t){case"stime":e.stime=a;break;case"etime":e.etime=a;break;case"stime2":e.stime2=a;break;case"etime2":e.etime2=a}}var n={formatdatetime:t,formatTime:a};return n}angular.module("app").service("datetime",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a,n,s){function i(){s.getSpecialsbyAnswer(t.cust.canswer).then(function(e){t.cust.specials=e,o()}),console.log("Specials Page loaded!")}function o(){c.specialsList=t.cust.specials}function r(){t.specialmode="add",a.go("editspecial")}function l(e){t.cspecial=e,t.specialmode="edit",a.go("editspecial")}var c=this;c.title="specials",c.addSpecial=r,c.selSpecial=l,c.specialsList=[],t.cust.specials=[],i()}angular.module("app").controller("specials",e),e.$inject=["$location","$rootScope","$state","dialog","special"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("photogallery page Loaded!")}var s=this;s.title="photogallery",n()}angular.module("app").controller("photogallery",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("mainphoto page Loaded!")}var s=this;s.title="mainphoto",n()}angular.module("app").controller("mainphoto",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n,s,i){function o(){"edit"==t.specialmode&&(p.sp=JSON.parse(JSON.stringify(t.cspecial)),i.formatdatetime(p.sp),p.isEdit=!0,"onetime"==p.sp.freq&&l(1),"weekly"==p.sp.freq&&l(2),p.sp.bc=p.sp.bc,p.sp.fc=p.sp.fc),"add"==t.specialmode&&(p["char"]=25,p.sp.fc="hsl(0, 100%, 0%)",p.sp.bc="hsl(0, 0%, 100%)",l(1)),m(),console.log("editspecial page Loaded!")}function r(){p["char"]=25-p.sp.stitle.length}function l(e){1==e&&(p.weekly=!1,p.onetime=!0,p.sp.freq="onetime"),2==e&&(p.weekly=!0,p.onetime=!1,p.sp.freq="weekly")}function c(){v=p.sp,v.name="Your business",v.answer=t.cust.canswer,v.freq=p.onetime?"onetime":"weekly",n.createSpecialPreview(v,d)}function d(){0==p.isEdit?("onetime"==p.sp.freq&&(v.stime2=null,v.etime2=null),"weekly"==p.sp.freq&&(v.stime=null,v.sdate=null,v.etime=null,v.edate=null),s.addSpecial(v).then()):s.updateSpecial(v),a.go("specials")}function u(){s.deleteSpecial(p.sp.id),a.go("specials")}function g(){a.go("specials")}function m(){p.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"]}var p=this;p.title="editspecial",p.sp={};var v={};p.displayCharLength=r,p.frequencySel=l,p.showPreview=c,p.deleteSpecial=u,p.goBack=g,p.isEdit=!1,o()}angular.module("app").controller("editspecial",e),e.$inject=["$location","$rootScope","$state","dialog","special","datetime"]}(),function(){"use strict";function e(e,t,a,n,s,i){function o(){n.getAnswerbyCustomer(t.cust.id).then(function(e){t.custans=e.resource,console.log("Customer-Answer records: ",t.custans),r()}),console.log("customer page Loaded!")}function r(){m.answers=t.custans}function l(e){t.cust.canswer=e.id,console.log("current answer ",e.id,e.name)}function c(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("mainphoto")}function d(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("specials")}function u(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):a.go("photogallery")}function g(){a.go("content")}var m=this;m.title="customer",m.selMainPhoto="active",m.selSpecials="",m.selPhotoGallery="",m.goBack=g,m.loadMainPhoto=c,m.loadSpecials=d,m.loadPhotoGallery=u,m.selAnswer=l,t.cust={},t.cust.id=1,o()}angular.module("app").controller("customer",e),e.$inject=["$location","$rootScope","$state","answer","dialog","special"]}(),function(){"use strict";function e(e,t,a){function n(a){if(r()&&!a)return t.when(c);var n=d+"?offset=0",s=d+"?offset=1000",i=e.get(n),o=e.get(s);return t.all([i,o]).then(function(e){return c=e[0].data.resource.concat(e[1].data.resource),console.log("tables length: ",c.length),c},l)}function s(t){function a(e){var a=t;return a.id=e.data.resource[0].id,c.push(a),console.log("result",e),e.data}var n=d,s=[];return s.push(t),e.post(n,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,l)}function i(t){function a(e){return console.log("Deleting answer was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var i=d+"/"+t,o=c.map(function(e){return e.id}).indexOf(t);return o>-1&&c.splice(o,1),e["delete"](i,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,l)}function o(t,n,s){function i(e){return console.log("updating ranking record succesful"),e.data}var o={};o.resource=[];var r={};r.id=t;for(var c=0;c<n.length;c++)switch(n[c]){case"views":r.views=s[c];break;case"answers":r.answers=s[c];break;case"title":r.title=s[c];break;case"tags":r.tags=s[c];break;case"keywords":r.keywords=s[c];break;case"type":r.type=s[c];break;case"question":r.question=s[c];break;case"image1url":r.image1url=s[c];break;case"image2url":r.image2url=s[c];break;case"image3url":r.image3url=s[c]}o.resource.push(r);for(var u=d,g=0,c=0;c<a.content.length;c++)if(a.content[c].id==t){g=c;break}for(var c=0;c<n.length;c++)switch(n[c]){case"answers":a.content[g].answers=s[c];break;case"views":a.content[g].views=s[c];break;case"title":a.content[g].title=s[c];break;case"tags":a.content[g].tags=s[c];break;case"keywords":a.content[g].keywords=s[c];break;case"type":a.content[g].type=s[c];break;case"question":a.content[g].question=s[c];break;case"image1url":a.content[g].image1url=s[c];break;case"image2url":a.content[g].image2url=s[c];break;case"image3url":a.content[g].image3url=s[c]}return e.patch(u,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(i,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/ranking",u={getTables:n,update:o,addTable:s,deleteTable:i};return u}angular.module("app").factory("table",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("contentBlock",["$rootScope","$state",function(e,t){"use strict";return{templateUrl:"app/content/partials/content-block.html",transclude:!0,scope:{modeNum:"=mode",isDynamic:"=dynamic",isRoW:"=rankofweek"},controller:["$scope","query","$filter","$http","answer",function(t,a,n,s,i){function o(){if(void 0!=e.inputVal&&c.isDynamic){var t=!1,n=e.inputVal;if(e.isNh&&(n=n+" "+e.cnh),c.resultsT=[],
c.resultsB=[],n.length>=3){for(var s=n.split(" "),i=0;i<e.content.length;i++){for(var o=!0,r=0;r<s.length;r++){var l=s[r].charAt(0).toUpperCase()+s[r].slice(1),u=s[r].charAt(0).toLowerCase()+s[r].slice(1);o=o&&(e.searchStr[i].includes(s[r])||e.searchStr[i].includes(s[r].toUpperCase())||e.searchStr[i].includes(l)||e.searchStr[i].includes(u))}o&&c.resultsT.push(e.content[i])}t=n.length>=d?!0:!1,c.resultsT.length<=5&&n.length%3==0&&t&&a.postQuery(n,c.resultsT.length),d=n.length}else c.resultsT=[],c.resultsB=[]}}function r(){var t=[],a=[],s="",i=[];if(c.modeNum<9){switch(c.resultsT=[],c.resultsB=[],c.modeNum){case 1:t=["rankOfWeek","best mexican restaurant"],a=["Ranking of the Week","Ranking of Week"],c.fc="#f8f8ff",c.bgc="black";break;case 2:t=[" "," "],a=["Most Popular","Most Popular"],c.fc="#f8f8ff",c.bgc="#4682b4";break;case 3:t=["food","food"],a=["Food","Food"],c.fc="#f8f8ff",c.bgc="brown";break;case 4:t=["lifestyle","fitness"],a=["LifeStyle","Fitness"],c.fc="#f8f8ff",c.bgc="green";break;case 5:t=["politics","neighborhood"],a=["City and Politics","Neighboorhood Topics"],c.fc="#f8f8ff",c.bgc="gray";break;case 6:t=["sports","services"],a=["Sports","Services"],c.fc="#f8f8ff",c.bgc="blue";break;case 7:t=["dating","beauty"],a=["Dating and Relationships","Beauty"],c.fc="#f8f8ff",c.bgc="#b22222";break;case 8:t=["technology","health"],a=["Technology","Health"],c.fc="#f8f8ff",c.bgc="gray"}e.isNh?(s=t[1]+" "+e.cnh,c.headline=a[1]+" - "+e.cnh):(s=t[0],c.headline=a[0]);for(var o=s.split(" "),r=0;r<e.content.length;r++){for(var l=!0,d=0;d<o.length;d++){var u=o[d].charAt(0).toUpperCase()+o[d].slice(1),g=o[d].charAt(0).toLowerCase()+o[d].slice(1);l=l&&(e.searchStr[r].includes(o[d])||e.searchStr[r].includes(o[d].toUpperCase())||e.searchStr[r].includes(u)||e.searchStr[r].includes(g))}l&&i.push(e.content[r])}i=n("orderBy")(i,"-views"),c.resultsT=i,c.isRoW&&c.resultsT.length>0&&(c.image1=c.resultsT[0].image1url,c.image2=c.resultsT[0].image2url,c.image3=c.resultsT[0].image3url)}}function l(){console.log("apply Rule")}var c=t;c.title="mycontent",c.resultsT=[],c.resultsB=[],c.maxRes=6,c.btext="see more";var d=0;c.isDynamic||r(),e.$on("refreshRanks",function(t){c.input=e.inputVal,o()}),e.$on("loadNh",function(e){r()}),e.$on("applyRule",function(e){l()})}],link:function(a){a.rankSel=function(a,n){e.title=a.title,e.editMode?t.go("editRanking",{index:a.id}):t.go("rankSummary",{index:a.id})},a.seeMore=function(e,t){6==a.maxRes?(a.btext="see less",a.maxRes=60):(a.btext="see more",a.maxRes=6)}}}}]),function(){"use strict";angular.module("app").filter("orderObjectBy",function(){return function(e,t,a){var n=[];return angular.forEach(e,function(e){n.push(e)}),n.sort(function(e,a){return e[t]>a[t]?1:-1}),a&&n.reverse(),n}}).filter("objectLength",function(){return function(e){return e?Object.keys(e).length:0}}).filter("searchObject",function(){return function(e,t,a){function n(e,t){return e=(""+e).toLowerCase(),t=(""+t).toLowerCase(),-1!==e.indexOf(t)}if(!e)return!1;var s=[];if(!t){for(var i=Object.keys(e),o=0,r=i.length;r>o;o++)s.push(e[i[o]]);return s}return angular.forEach(e,function(e){if(a&&""!=a)e[a]&&n(e[a],t)&&s.push(e);else for(var i=Object.keys(e),o=0,r=i.length;r>o;o++)if(n(e[i[o]],t)){s.push(e);break}}),s}})}(),angular.module("app").directive("fileModel",["$parse",function(e){"use strict";return{restrict:"A",link:function(t,a,n){var s=e(n.fileModel),i=s.assign;a.bind("change",function(){t.$apply(function(){i(t,a[0].files[0])})})}}}]),function(){"use strict";function e(e,t,a){function n(n){function s(e){return c=e.data.resource}if(r()&&!n)return t.when(c);var i=d+"/_table/votetable/?filter=user="+a.user.id;return e.get(i).then(s,l)}function s(t,n){function s(e){var t=o;return t.id=e.data.resource[0].id,c.push(t),a.cvotes.push(t),console.log("Creating new voting record was succesful"),e.data}var i={};i.resource=[];var o={};o.user=a.user.id,o.catans=t,o.vote=n,o.timestmp=Date.now(),i.resource.push(o);var r=d+"/_table/votetable";return e.post(r,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,l)}function i(t,a){function n(e){return console.log("Updating vote record was succesful"),e.data}var s={};s.resource=[];var i={};i.id=t,i.vote=a,i.timestmp=Date.now(),s.resource.push(i);var o=d+"/_table/votetable",r=c.map(function(e){return e.id}).indexOf(t);return c[r].vote=a,c[r].timestmp=i.timestmp,e.patch(o,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,l)}function o(t){function a(e){return console.log("Deleting vote records was succesful"),e.data}for(var n=0;n<c.length;n++)c[n].answer==t&&c.splice(n,1);var s=d+"/_table/votetable?filter=answer="+t;return e["delete"](s).then(a,l)}function r(e){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql",u={loadVotesTable:n,patchRec:i,postRec:s,deleteVotesbyAnswer:o};return u}angular.module("app").factory("votes",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return l=e.data.resource}if(o()&&!a)return t.when(l);var s=c;return e.get(s).then(n,r)}function s(){function t(e){return console.log("creating useractivity record was succesful"),e.data}var n={};n.user=a.user.id,n.category=a.cCategory.id,n.timestmp=Date.now();var s={};s.resource=[],s.resource.push(n),l.push(n);var i=c;return e.post(i,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(t,r)}function i(t){function a(e){return console.log("Updating useractivity record was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,s.timestmp=Date.now(),n.resource.push(s);var i=c;return e.patch(i,n,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,r)}function o(){return l.length>0}function r(e){throw e}var l=[],c="/api/v2/mysql/_table/useractivity",d={getAllUserActivity:n,postRec:s,patchRec:i};return d}angular.module("app").factory("useractivity",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t){function a(a){function n(e){return r=e.data.resource}if(s()&&!a)return t.when(r);var o=l;return e.get(o).then(n,i)}function n(t,a){function n(e){return o=e.data}var s=l+"/?fields=field&filter=tableid="+t;return e.get(s).then(n,i)}function s(){return r.length>0}function i(e){throw e}var o,r=[],l="/api/v2/mysql/_table/tablefield",c={getAllTableFields:a,getTableFields:n};return c}angular.module("app").factory("tablefield",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){function a(e,t,a){function o(e){return console.log("query succeded"),i=e,s(i)}function r(e){console.log("image query failed")}var l=n(e,t,a);return l.then(o,r)}function n(a,n,s){for(var i="",o="https://www.googleapis.com/customsearch/v1?",r="&cx=000139851817949790257%3Aqwkdgi2q2ew",l="&key=AIzaSyBr143lDEROCrUWdKvqPQmhQ5BoFo13oSE",c="&num=10&searchType=image&fileType=jpg%2C+png%2C+bmp&imgType=photo&imgSize=large&filter=1",d="",u="",g="",m="",p=t.cCategory.keywords,v=[],h=0;h<a.length;h++)"edit"==s?v[h]=a[h].cval:"add"==s&&(v[h]=a[h].val);switch(a.length){case 1:v[0]&&(d=v[0]);break;case 2:v[0]&&(d=v[0]),v[1]&&(u=v[1]);break;case 3:v[0]&&(d=v[0]),v[1]&&(u=v[1]),v[2]&&(g=v[2]);break;case 4:v[0]&&(d=v[0]),v[1]&&(u=v[1]),v[2]&&(g=v[2]),v[3]&&(m=v[3])}switch(n){case 1:i="q="+d+" "+u+" "+g+" "+m+" "+p;break;case 2:i="q="+d+" "+p;break;case 3:i="q="+d+" "+g+" "+m+" "+p;break;case 4:i="q="+d+" "+u+" "+p}var f=o+i+r+c+l;return console.log("url",f),e.get(f)}function s(e){for(var t=[],a=!1,n=!1,s=0,i=0,r=0,l=0;o>l;l++)if(a=!1,n=!1,i=e.data.items[l].image.height,r=e.data.items[l].image.width,r>i&&1.8>r/i&&(a=!0),s=e.data.items[l].link.length,("g"==e.data.items[l].link[s-1]||"p"==e.data.items[l].link[s-1])&&(n=!0),a&&n){var c=e.data.items[l].link;t.push(c)}return t}var i=[],o=10,r={imageSearch:n,getImageLinks:a,filterImageResults:s};return r}angular.module("app").factory("image",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(t,n){function o(e){return console.log("creating flag answer record was succesful"),e.data}var r={};r.user=a.user.id,r.answer=t,r.flag=n,r.timestmp=Date.now();var l={};l.resource=[],l.resource.push(r);var c=i;return e.post(c,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(o,s)}function s(e){throw e}var i="/api/v2/mysql/_table/flagtable",o={flagAnswer:n};return o}angular.module("app").factory("flag",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){this.uploadFileToUrl=function(t,a){var n="/api/v2/files/images/"+t.name;return e.post(n,t,{headers:{"Content-Type":"multipart/form-data"}}).success(function(e){console.log("Uploading file was succesful")}).error(function(e){console.log("There was a problem uploading your file")})}}angular.module("app").service("fileupload",e),e.$inject=["$http","$cookies","APP_API_KEY"]}(),function(){"use strict";function e(e,t){function a(t){function a(e){return console.log("result",e),e.data}console.log("file",t);var n=i+"/"+t.name;return e.post(n,t,{headers:{"Content-Type":"multipart/form-data"}}).then(a,s)}function n(a){function n(e){return e.data}var o=i+"/"+encodeURIComponent(a);return e.get(o,{params:{api_key:t}}).then(n,s)}function s(e){throw console.log("Error: ",e),e}var i="/api/v2/files/images",o={uploadFile:a,getFile:n};return o}angular.module("app").factory("file",e),e.$inject=["$http","APP_API_KEY"]}(),function(){"use strict";function e(e,t,a){function n(n){function s(e){return d=e.data.resource}if(l()&&!n)return t.when(d);var i=u+"/_table/editvotetable/?filter=user="+a.user.id;return e.get(i).then(s,c)}function s(t){function n(e){for(var n={},s=0;s<e.data.resource.length;s++)n=t[s],n.id=e.data.resource[s].id,d.push(n),a.ceditvotes.push(n);return console.log("Creating new voting record for edit was succesful"),e.data}var s={};s.resource=[],s.resource.push(t);var i=u+"/_table/editvotetable";return e.post(i,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(n,c)}function i(t,a){function n(e){return console.log("Updating vote record for edit was succesful"),e.data}var s={};s.resource=[];var i={};i.id=t,i.vote=a,i.timestmp=Date.now(),s.resource.push(i);var o=u+"/_table/editvotetable",r=d.map(function(e){return e.id}).indexOf(t);return d[r].vote=a,d[r].timestmp=i.timestmp,e.patch(o,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,c)}function o(t){function a(e){return console.log("Deleting edit vote records for answer was succesful"),e.data}for(var n=0;n<d.length;n++)d[n].answer==t&&d.splice(n,1);var s=u+"/_table/editvotetable?filter=answer="+t;return e["delete"](s).then(a,c)}function r(t){function a(e){return console.log("Deleting edit vote records for answer was succesful"),e.data}for(var n=0;n<d.length;n++)d[n].edit==t&&d.splice(n,1);var s=u+"/_table/editvotetable?filter=edit="+t;return e["delete"](s).then(a,c)}function l(e){return d.length>0}function c(e){throw e}var d=[],u="/api/v2/mysql",g={loadEditVotesTable:n,patchEditVoteRec:i,postEditVoteRec:s,deleteEditVotes:r,deleteEditVotesbyAnswer:o};return g}angular.module("app").factory("editvote",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return d=e.data.resource}if(l()&&!a)return t.when(d);var s=u;return e.get(s).then(n,c)}function s(t){function n(e){var n=t;return n.id=e.data.resource[0].id,d.push(n),a.cedits.push(n),console.log("Adding new Edit succesful",e),e.data}var s=u,i=[];return i.push(t),e.post(s,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(n,c)}function i(t,a,n){function s(e){return console.log("updating edit vote counts succesful"),e.data}var i={};i.resource=[];var o={};o.id=t,o.upV=a,o.downV=n,i.resource.push(o);var r=u;return e.patch(r,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,c)}function o(t){function a(e){return console.log("Deleting answer was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var i=u+"/"+t,o=d.map(function(e){return e.id}).indexOf(t);return o>-1&&d.splice(o,1),e["delete"](i,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,c)}function r(t){function a(e){return console.log("Deleting edits for answer was succesful"),e.data}for(var n=0;n<d.length;n++)d[n].answer==t&&d.splice(n,1);var s=u+"?filter=answer="+t;return e["delete"](s).then(a,c)}function l(){return d.length>0}function c(e){throw e}var d=[],u="/api/v2/mysql/_table/edittable",g={getEdits:n,addEdit:s,updateEdit:i,deleteEdit:o,deleteEditbyAnswer:r};return g}angular.module("app").factory("edit",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t){function a(e,t){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function n(e){var n=t.dialogs["dialog."+e+".title"],s=t.dialogs["dialog."+e+".text"];a(n,s)}function s(e,t,a){var n="",s="",i="",o="";n="Please Confirm",i="Cancel",o="Confirm","image"==t&&(s="You want to change the image of <strong><em>"+e.name+"</em></strong> to this one: </br><img src="+e.imageURL+' class="thumbnail" style="width:60%; max-height:150px">'),"field"==t&&(s='You want to change the <strong class="capitalize"><em>'+e.field+"</em></strong> of <strong><em>"+e.name+"</em></strong> to <strong><em>"+e.nval+"</em></strong>."),BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:s,closable:!0,draggable:!0,btnCancelLabel:i,btnOKLabel:o,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&a(e)}})}function i(e,a,n){for(var s="",i="",r="",l=("table"+t.cCategory.id+".header",0);l<t.fields.length;l++){switch(t.fields[l].name){case"name":r='<strong class="capitalize">Name</strong>: '+e.name+"</br>";break;case"location":r=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":r='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>";break;case"addinfo":r=e.addinfo?'<strong class="capitalize">Additional Info</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>"}s+=r}o(e,i,s,a,n)}function o(e,a,n,s,i){var o="",r="",l="",c="";o="Please Confirm",l="Cancel",c="Confirm",r="You want to add the following answer to <strong>"+t.header+"</strong>. </br></br>"+n+"</br>With the following image:<img src="+s+' class="thumbnail" style="width:60%; max-height:150px">',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:o,message:r,closable:!0,draggable:!0,btnCancelLabel:l,btnOKLabel:c,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&i(e)}})}function r(e,t,a,n){var s="",i="";"approve"==a&&(s="Changed Approved",i="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> gets approved."),"reject"==a&&(s="Changed Rejected",i="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> has been rejected."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:s,message:i,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,s){n(t,a),e.close()}}]})}function l(e){var t="",a="";"editAnswer"==e&&(a="Information Edits",t="Use edits to correct, add or update information in a profile. All edits need to be accepted by other users before they are approved. </br></br>An edit or change becomes approved when the number of people that agree exceeds the number of people that disagree by 5. </br></br>An edit or change gets rejected when the number of people that disagree exceeds those that agree by 5. </br></br> Only one edit per field at a time is allowed. Make sure you vote on the edits you agree or disagree."),"addAnswer"==e&&(a="Add an Answer",t="1. Fill out the form. The fields marked with * are required. All other fields are not required but recommended. <br/><br/>2. Click the 'Load Images' button. <br/><br/>3. Use '>>' and '<<' buttons to browse through the images. You can 'Load More' images.<br/><br/>4. When you find the image you like 'Add' your answer to the ranking.<br/><br/><br/>NOTE: Not all images will correspond to your answer. Entering all fields will help with the image results."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function c(e){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Image URL",message:e,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function d(e,a,n,s){for(var i="",o="",r="",l="",c=0;c<t.fields.length;c++){switch(t.fields[c].name){case"name":r='<strong class="capitalize">Name</strong>: '+e.name+"</br>",l='<strong class="capitalize">Name</strong>: '+a.name+"</br>";break;case"location":r=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>",l=a.location?'<strong class="capitalize">Location</strong>: '+a.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":r='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>",l='<strong class="capitalize">City Area</strong>: '+a.cityarea+"</br>";break;case"addinfo":r=e.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>",l=a.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+a.addinfo+"</br>":"<strong>Additional Info</strong>: </br>"}i+=r,o+=l}u(e,i,a,o,n,s)}function u(e,t,a,n,s,i){var o="",r="",l="",c="";o="Just checking",l="No, they are different",c="Yeah, same",r='Are these the same establishment? </br></br><div class="row"><div class="col-sm-6">'+t+"</br><img src="+e.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div><div class="col-sm-6">'+n+"</br><img src="+a.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div></div>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:o,message:r,closable:!0,draggable:!0,btnCancelLabel:l,btnOKLabel:c,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t?i():s(e)}})}function g(e,t){var a="",n="",s="",i="";a="Scope of Delete",s="Just this category",i="Everywhere",n="Choose scope to delete:",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(a){a?t():e()}})}function m(e,t){var a="",n="",s="",i="",o="";if(a="Special Preview",s="Back",i="Save Special","weekly"==e.freq&&(o="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"")+"<br>From: "+e.stime2+" to "+e.etime2),"onetime"==e.freq){var r=e.sdate==e.edate;o=r?e.sdate+" from "+e.stime+" to "+e.etime:"Starts: "+e.sdate+" at "+e.stime+"<br>Ends: "+e.edate+" at "+e.etime}n='This is how this special will look: </br></br>In the ranking summary:<br><table class="table table-hover cursor "><thead><tr><th>Rank</th><th>Name</th><th>Neighborhood</th><th>Distance</th><th>Specials</th></tr></thead><tbody><tr><td>1</td><td>'+e.name+'</td><td>Neighborhood</td><td>1.5</td><td style="background-color:'+e.bc+";color:"+e.fc+';">'+e.stitle+'<td></tr></tbody></table><br>Inside your business profile:<br><br><div style="background-color:'+e.bc+";color:"+e.fc+';"><p><strong>'+e.stitle+" @ "+e.name+"</strong></p><p>"+o+"</p><p>"+e.details+"</p></div>",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:n,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function p(e){var t="",a="",n="",s="";t="Confirm Delete",n="Cancel",s="Delete",a="Just confirming, do you want to delete?",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:t,message:a,closable:!0,draggable:!0,btnCancelLabel:n,btnOKLabel:s,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&e()}})}var v={editConfirm:s,getDialog:n,showDialog:a,howItWorks:l,addAnswer:i,showAddAnswer:o,editChangeEffective:r,checkSameAnswer:d,showSameAnswer:u,deleteType:g,deleteRank:p,url:c,createSpecialPreview:m};return v}angular.module("app").factory("dialog",e),e.$inject=["$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(a){if(l()&&!a)return t.when(d);var n=u+"?offset=0",s=u+"?offset=1000",i=e.get(n),o=e.get(s);return t.all([i,o]).then(function(e){return d=e[0].data.resource.concat(e[1].data.resource),console.log("No. Cat-Ans: ",d.length),d},c)}function s(t){function n(e){return console.log("creating catans record was succesful"),e.data}var s={};s.answer=t,s.category=a.cCategory.id,s.upV=0,s.downV=0,s.timestmp=Date.now();var i={};i.resource=[],i.resource.push(s),d.push(s);var o=u;return e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(n,c)}function i(t){function a(e){return console.log("Deleting catans records was succesful"),e.data}for(var n=0;n<d.length;n++)d[n].answer==t&&d.splice(n,1);var s=u+"?filter=answer="+t;return e["delete"](s).then(a,c)}function o(t,n){function s(e){return console.log("Deleting catans records by answer and category was succesful"),e.data}for(var i=0;i<d.length;i++)d[i].answer==t&&d[i].category==a.cCategory.id&&d.splice(i,1);var o=u+"?filter=(answer="+t+") AND (category="+n+")";return e["delete"](o).then(s,c)}function r(t,n,s){function i(e){return console.log("updating catans record succesful"),e.data}console.log("val  ",s);var o={};o.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"upV":r.upV=s[l];break;case"downV":r.downV=s[l]}o.resource.push(r);for(var d=u,g=a.B.indexOf(+t),l=0;l<n.length;l++)switch(n[l]){case"upV":a.ccatans[g].upV=s[l];break;case"downV":a.ccatans[g].downV=s[l]}return e.patch(d,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(i,c)}function l(){return d.length>0}function c(e){throw e}var d=[],u="/api/v2/mysql/_table/catans",g={getAllcatans:n,postRec:s,deleteRec:o,deleteAnswer:i,updateRec:r};return g}angular.module("app").factory("catans",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a,n){function s(a){if(u()&&!a)return t.when(v);var n=h+"?offset=0",s=h+"?offset=1000",i=e.get(n),o=e.get(s);return t.all([i,o]).then(function(e){return v=e[0].data.resource.concat(e[1].data.resource),console.log("No. Answers: ",v.length),v},m)}function i(a,n){function s(e){return p=e.data}if(g(a)&&!n)return t.when(p);var i=h+"/"+a;return e.get(i).then(s,m)}function o(t){function a(e){return e.data}var n=h+"/?filter=customer="+t;return e.get(n).then(a,m)}function r(t){function a(e){var a=t;return a.id=e.data.resource[0].id,v.push(a),n.postRec(a.id),console.log("result",e),e.data}var s=h,i=[];return i.push(t),e.post(s,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(a,m)}function l(t,n,s){function i(e){return console.log("updating answer succesful"),e.data}var o={};o.resource=[];var r={};r.id=t;for(var l=0;l<n.length;l++)switch(n[l]){case"name":r.name=s[l];break;case"addinfo":r.addinfo=s[l];break;case"cityarea":r.cityarea=s[l];break;case"location":r.location=s[l];break;case"image":r.imageurl=s[l];break;case"views":r.views=s[l];break;case"lat":r.lat=s[l];break;case"lng":r.lng=s[l]}o.resource.push(r);for(var c=h,d=a.A.indexOf(+t),l=0;l<n.length;l++)switch(n[l]){case"name":a.canswers[d].name=s[l];break;case"addinfo":a.canswers[d].addinfo=s[l];break;case"cityarea":a.canswers[d].cityarea=s[l];break;case"location":a.canswers[d].location=s[l];break;case"image":a.canswers[d].imageurl=s[l];break;case"views":a.canswers[d].views=s[l];break;case"lat":a.canswers[d].lat=s[l];break;case"lng":a.canswers[d].lng=s[l]}return e.patch(c,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(i,m)}function c(t,a){function n(e){return console.log(" answer flagged succesful"),e.data}var s={};s.resource=[];var i={};i.id=t,i.flag=a,s.resource.push(i);var o=h;return e.patch(o,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,m)}function d(t){function a(e){return console.log("Deleting answer was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var i=h+"/"+t,o=v.map(function(e){return e.id}).indexOf(t);return o>-1&&v.splice(o,1),e["delete"](i,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,m)}function u(){return v.length>0}function g(e){return p&&p.id==e}function m(e){throw e}var p,v=[],h="/api/v2/mysql/_table/answers",f={getAnswers:s,getAnswer:i,addAnswer:r,updateAnswer:l,deleteAnswer:d,flagAnswer:c,getAnswerbyCustomer:o};return f}angular.module("app").factory("answer",e),e.$inject=["$http","$q","$rootScope","catans"]}(),function(){"use strict";function e(e,t,a,n,s,i,o,r,l,c){function d(){u(),g(T.answer.id),console.log("Edit Answer Activated!")}function u(){for(var e=0;e<s.fields.length;e++){switch(U={},U.field=s.fields[e].name,s.fields[e].name){case"name":U.cval=T.answer.name;break;case"cityarea":U.cval=T.answer.cityarea;break;case"location":U.cval=T.answer.location;break;case"addinfo":U.cval=T.answer.addinfo}U.val="",U.label=s.fields[e].label,U.opts="country"==U.field?"c for c in vm.countries":"c for c in vm.emptyarray",T.fields.push(U)}for(var e=0;e<T.fields.length;e++)T.fields[e].val=T.fields[e].cval;console.log("fields  ",T.fields)}function g(e){T.edits=[],V=[],_=[];for(var t={},a=0;a<s.cedits.length;a++)if(s.cedits[a].answer==e){switch(t=s.cedits[a],t.vote=0,t.idx=a,t.agree="",t.disagree="",s.fields[0].name){case"name":t.name=T.answer.name}T.edits.push(t),V.push(s.cedits[a].upV),_.push(s.cedits[a].downV)}h(T.answer.id)}function m(t){if(!s.isLoggedIn)return void e.getDialog("notLoggedIn");for(var a=!1,n=0;n<T.edits.length;n++)if(T.edits[n].field==t.field){a=!0;break}if(a)return void e.getDialog("editFieldExists");var i={};switch(i.field=t.field,t.field){case"name":i.cval=T.answer.name;break;case"nickname":i.cval=T.answer.nickname;break;case"club":i.cval=T.answer.club;break;case"country":i.cval=T.answer.country}switch(i.nval=t.val,i.cval||(i.cval=""),i.answer=T.answer.id,i.upV=0,i.downV=0,i.imageURL="",i.display="none",s.fields[0].name){case"name":i.name=T.answer.name}i.user=s.user.id,i.username=s.user.name,i.category=s.cCategory.id,i.timestmp=Date.now(),e.editConfirm(i,"field",$)}function p(){if(!s.isLoggedIn)return void e.getDialog("notLoggedIn");for(var t=!1,a=0;a<T.edits.length;a++)if("image"==T.edits[a].field){t=!0;break}if(t)return void e.getDialog("editFieldExists");var n=c.getImageLinks(T.fields,z,"edit");n.then(D,L)}function v(){var t={};switch(t.field="image",t.cval=T.answer.imageurl,t.nval="",t.imageURL=T.imageURL,t.display="inline",t.answer=T.answer.id,t.upV=0,t.downV=0,s.fields[0].name){case"name":t.name=T.answer.name}t.user=s.user.id,t.username=s.user.name,t.category=s.cCategory.id,t.timestmp=Date.now(),e.editConfirm(t,"image",R)}function h(e){for(var t={},a=0;a<s.ceditvotes.length;a++)s.ceditvotes[a].answer==e&&(t=s.ceditvotes[a],N.push(t));for(a=0;a<T.edits.length;a++)for(var n=0;n<N.length;n++)T.edits[a].id==N[n].edit&&(T.edits[a].vote=N[n].vote);y()}function f(t,a){if(s.isAdmin)return void e.editChangeEffective(T.edits[a],a,"approve",x);if(!s.isLoggedIn)return void e.getDialog("notLoggedIn");switch(t.vote){case 1:T.edits[a].vote=0,T.edits[a].upV--;break;case 0:T.edits[a].vote=1,T.edits[a].upV++;break;case-1:T.edits[a].vote=1,T.edits[a].upV++,T.edits[a].downV--}w(a),y()}function b(t,a){if(s.isAdmin)return void e.editChangeEffective(T.edits[a],a,"reject",x);if(!s.isLoggedIn)return void e.getDialog("notLoggedIn");switch(t.vote){case 1:T.edits[a].vote=-1,T.edits[a].upV--,T.edits[a].downV++;break;case 0:T.edits[a].vote=-1,T.edits[a].downV++;break;case-1:T.edits[a].vote=0,T.edits[a].downV--}w(a),y()}function y(){for(var e=0;e<T.edits.length;e++)switch(T.edits[e].vote){case 1:T.edits[e].agree="active",T.edits[e].disagree="";break;case 0:T.edits[e].agree="",T.edits[e].disagree="";break;case-1:T.edits[e].agree="",T.edits[e].disagree="active"}}function w(t){if(T.edits[t].upV>T.edits[t].downV){if(T.edits[t].upV-T.edits[t].downV>=j)return void e.editChangeEffective(T.edits[t],t,"approve",x)}else if(T.edits[t].downV>T.edits[t].upV&&T.edits[t].downV-T.edits[t].upV>=B)return void e.editChangeEffective(T.edits[t],t,"reject",x)}function k(){console.log("updateRecords @ editAnswer");for(var e=!1,t=[],a={},n=0;n<T.edits.length;n++){e=!1;for(var i=0;i<N.length;i++)if(T.edits[n].id==N[i].edit){e=!0;break}e?r.patchEditVoteRec(N[i].id,T.edits[n].vote):0!=T.edits[n].vote&&(a={},a.edit=T.edits[n].id,a.user=s.user.id,a.category=s.cCategory.id,a.answer=T.edits[n].answer,a.vote=T.edits[n].vote,a.timestmp=Date.now(),t.push(a)),(T.edits[n].upV!=V[n]||T.edits[n].downV!=_[n])&&o.updateEdit(T.edits[n].id,T.edits[n].upV,T.edits[n].downV)}t.length>0&&(r.postEditVoteRec(t),t=[]),O=!0}function x(e,t){"approve"==t&&(A(e),P()),"reject"==t&&C(e)}function A(e){console.log("Edit has been approved"),"image"==T.edits[e].field?l.updateAnswer(T.edits[e].answer,[T.edits[e].field],[T.edits[e].imageURL]):l.updateAnswer(T.edits[e].answer,[T.edits[e].field],[T.edits[e].nval]),o.deleteEdit(T.edits[e].id),r.deleteEditVotes(T.edits[e].id),s.cedits.splice(T.edits[e].idx,1),T.edits.splice(e,1)}function C(e){console.log("Edit has been discarded"),o.deleteEdit(T.edits[e].id),r.deleteEditVotes(T.edits[e].id),s.cedits.splice(T.edits[e].idx,1),T.edits.splice(e,1)}function S(){e.howItWorks("editAnswer")}function $(e){k(),O=!1;var t=o.addEdit(e);console.log("creating edit"),t.then(function(){g(T.answer.id)})}function R(e){k(),O=!1;var t=o.addEdit(e);t.then(function(){g(T.answer.id),T.imageURL=T.answer.imageurl,T.imagefunctions="none"})}function P(){a.go("answerDetail",{index:T.answer.id})}function D(e){F=F.concat(e),T.numLinks=F.length,z++,(T.numLinks>10||z>4)&&(T.searchDisabled="disabled"),z>1&&(T.imageCommand="Load More Images"),T.linkIdx=0,T.imageURL=F[T.linkIdx],T.numLinks>0&&(T.imagefunctions="inline")}function L(){console.log("query failed, dont give up")}function M(){T.linkIdx++,T.linkIdx>=T.numLinks&&(T.linkIdx=0),T.imageURL=F[T.linkIdx]}function I(){T.linkIdx--,T.linkIdx<0&&(T.linkIdx=T.numLinks-1),T.imageURL=F[T.linkIdx]}function E(){a.go("cwrapper")}var T=this;T.title="editAnswer",T.header="table"+s.cCategory.id+".header",T.body="table"+s.cCategory.id+".body",T.answer={},T.showHowItWorksDialog=S,T.editField=m,T.editAgree=f,T.editImage=p,T.selectImage=v,T.viewPrev=I,T.viewNext=M,T.closeRank=E,T.editDisagree=b,T.answerDetail=P,T.ranking=s.title;var q=s.A;t.index&&(T.answer=s.canswers[q.indexOf(+t.index)]),T.imageURL=T.answer.imageurl,T.fields=[];var U={};T.edits=[];var V=[],_=[],N=[],O=!1,j=1,B=1,F=[];T.linkIdx=0,T.numLinks=0,T.imageCommand="Change Image";var z=3;T.imagefunctions="none",T.emptyarray=[],s.$on("$stateChangeSuccess",function(e,t,a,n,i){s.previousState=n.name}),s.$on("$stateChangeStart",function(e,t,a,n,s){"editAnswer"==n.name&&(O||k())}),d()}angular.module("app").controller("editAnswer",e),e.$inject=["dialog","$stateParams","$state","answers","$rootScope","$modal","edit","editvote","answer","image"]}(),function(){"use strict";function e(e,t,a,n,s,i,o,r,l,c,d,u){function g(){i.$on("$stateChangeSuccess",function(e,t,a,n,s){i.previousState=n.name}),i.$on("$stateChangeStart",function(e,t,a,n,s){"answerDetail"==n.name&&(z||f())}),m(),p(T.answer.id),y(T.answer.id),L(),b(T.catans.id),v(T.answer.id),D(T.answer.id),P(),console.log("Answer details loaded")}function m(){T["public"]=i.canswers["public"]}function p(e){for(var t=0;t<i.ccatans.length;t++)i.ccatans[t].answer==e&&(T.catans=i.ccatans[t]);O=T.catans.upV,j=T.catans.downV}function v(e){var t=0,a=0,n="";T.relativetable=[];for(var s=i.R,o=i.GP,r=i.answersR,l=B.indexOf(+e),c=0,d=i.fields[0].name,u=!1,g=0;g<r.length;g++)if(B[g]!=e){
switch(c=s[l][g],d){case"name":n=r[g].name;break;case"nickname":n=r[g].nickname;break;case"country":n=r[g].country,u=!0;break;case"club":n=r[g].club}o[l][g]?(t=Math.round(c/o[l][g]*100),a=100-t):(t=0,a=0),T.relativetable.push({id:r[g].id,Rank:r[g].Rank,PctF:t,vsName:n,PctC:a,GP:o[l][g],isC:u})}}function h(e){f(),z=!1,q=!1,T.answer=F[B.indexOf(+e)],y(T.answer.id),O=T.catans.upV,j=T.catans.downV,m(),p(T.answer.id),b(T.catans.id),v(e),D(T.answer.id),P()}function f(){console.log("UpdateRecords @ answerDetail"),q&&U.vote!=_&&(i.cvotes[N].vote=_,o.patchRec(U.id,_)),q||0==_||o.postRec(V,_),(T.catans.upV!=O||T.catans.downV!=j)&&(console.log("vm.catans.upV",T.catans.upV,O),console.log("vm.catans.downV",T.catans.downV,j),d.updateRec(T.catans.id,["upV","downV"],[T.catans.upV,T.catans.downV])),z=!0}function b(e){for(var t=0;t<i.cvotes.length;t++)if(i.cvotes[t].catans==e){U=i.cvotes[t],N=t,q=!0;break}q?(_=U.vote,V=U.catans):(_=0,V=e),w(_)}function y(e){T.numEdits=0;for(var t=0;t<i.cedits.length;t++)i.cedits[t].answer==e&&T.numEdits++}function w(e){1==e&&(T.answer.thumbUp="thumbs_up_blue.png",T.answer.thumbDn="thumbs_down_gray.png"),0==e&&(T.answer.thumbUp="thumbs_up_gray.png",T.answer.thumbDn="thumbs_down_gray.png"),-1==e&&(T.answer.thumbUp="thumbs_up_gray.png",T.answer.thumbDn="thumbs_down_blue.png")}function k(){if(!i.isLoggedIn)return void s.getDialog("notLoggedIn");switch(_){case-1:_=1,T.catans.upV++,T.catans.downV--;break;case 0:_=1,T.catans.upV++;break;case 1:_=0,T.catans.upV--}w(_),console.log("UpVote")}function x(){if(!i.isLoggedIn)return void s.getDialog("notLoggedIn");switch(_){case-1:_=0,T.catans.downV--;break;case 0:_=-1,T.catans.downV++;break;case 1:_=-1,T.catans.upV--,T.catans.downV++}w(_),console.log("DownVote")}function A(){if(console.log("goBack"),z||f(),"match"==i.previousState)a.go("match");else{var e=T.answer.views+1;n.updateAnswer(T.answer.id,["views"],[e]),a.go("rankSummary",{index:i.cCategory.id})}}function C(e){i.title=e.title,a.go("rankSummary",{index:e.id})}function S(){a.go("editAnswer",{index:T.answer.id})}function $(){s.deleteType(function(){d.deleteRec(T.answer.id,i.cCategory.id).then(function(){a.go("rankSummary",{index:i.cCategory.id})})},function(){n.deleteAnswer(T.answer.id),r.deleteRecordsbyAnswer(T.answer.id),o.deleteVotesbyAnswer(T.answer.id),l.deleteEditbyAnswer(T.answer.id),c.deleteEditVotesbyAnswer(T.answer.id),d.deleteAnswer(T.answer.id),a.go("rankSummary",{index:i.cCategory.id})})}function R(t){return i.isLoggedIn?(console.log("answer flagged!!!"),e.flagAnswer(T.catans.id,t),void s.getDialog("answerFlagged")):void s.getDialog("notLoggedIn")}function P(){T.otherRanks=[];for(var e=0;e<i.catansrecs.length;e++)if(i.catansrecs[e].answer==T.answer.id&&i.catansrecs[e].category!=i.cCategory.id)for(var t=0;t<i.content.length;t++)i.content[t].id==i.catansrecs[e].category&&T.otherRanks.push(i.content[t]);T.otherRanksExist=T.otherRanks.length>0?!0:!1}function D(e){T.specialsList=[];for(var t=0;t<i.specials.length;t++)if(i.specials[t].answer==e){u.formatdatetime(i.specials[t]),i.specials[t].name=T.answer.name;var a=E(i.specials[t]);i.specials[t].html=a;var n="background-color:"+i.specials[t].bc+";color:"+i.specials[t].fc+";white-space:pre;";i.specials[t].style=n,T.specialsList.push(i.specials[t])}}function L(){T.deleteButton=i.isAdmin?"inline":"none"}function M(){s.url(T.answer.imageurl)}function I(){a.go("cwrapper")}function E(e){var t="",a="";if("weekly"==e.freq&&(a="Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":"")+"<br>From: "+e.stime2+" to "+e.etime2),"onetime"==e.freq){var n=e.sdate==e.edate;a=n?e.sdate+" from "+e.stime+" to "+e.etime:"Starts: "+e.sdate+" at "+e.stime+"<br>Ends: "+e.edate+" at "+e.etime}return t="<div ><p><strong>"+e.stitle+" @ "+e.name+"</strong></p><p>"+a+"</p><p>"+e.details+"</p></div>"}var T=this;T.title="answerDetail",T.ranking=i.title;var q=!1,U={},V=0,_=0,N=0,O=0,j=0,B=i.A,F=i.canswers,z=!1;T.numEdits=0,T.relativetable=[],T.catans=[],T.UpVote=k,T.DownVote=x,T.refresh=h,T.goBack=A,T.editAnswer=S,T.deleteAnswer=$,T.flagAnswer=R,T.deleteButton="none",T.showUrl=M,T.closeRank=I,T.rankSel=C,T.fields=i.fields,T.type=i.cCategory.type,t.index&&(T.answer=F[B.indexOf(+t.index)]),g()}angular.module("app").controller("answerDetail",e),e.$inject=["flag","$stateParams","$state","answer","dialog","$rootScope","votes","matchrec","edit","editvote","catans","datetime"]}(),function(){"use strict";function e(e,t,a,n,s,i,o){function r(){l(),console.log("Add Answer Activated!")}function l(){$.emptyarray=[],$.neighborhoods=n.isDowntown?n.districts:n.neighborhoods,$.establishmentNames=n.estNames,$.fields=n.fields,$.type=n.cCategory.type,$.fields.opts=[],$.fields.val=[],$.fields.textstyle=[];for(var e=0;e<$.fields.length;e++)$.fields[e].val="",$.fields[e].opts="cityarea"==$.fields[e].name?"c for c in vm.neighborhoods":"c for c in vm.emptyarray","name"==$.fields[e].name&&"Establishment"==n.cCategory.type&&($.fields[e].opts="c for c in vm.establishmentNames"),"cityarea"==$.fields[e].name&&"Establishment"==n.cCategory.type&&1==n.NhImplied&&($.fields[e].val=n.NhValue),$.fields[e].textstyle="addinfo"==$.fields[e].name?"textarea":"text"}function c(){E.imageurl=D[$.linkIdx],"Short-Phrase"==n.cCategory.type&&(E.imageurl="none"),E.upV=0,E.downV=0,E.type=$.type,E.userid=n.user.id,E.views=0,M?e.checkSameAnswer(E,T,y,w):e.addAnswer(E,$.imageURL,y)}function d(){for(var e=0;e<$.fields.length;e++)switch($.fields[e].name){case"name":E.name=$.fields[e].val;break;case"location":E.location=$.fields[e].val;break;case"addinfo":E.addinfo=$.fields[e].val;break;case"cityarea":E.cityarea=$.fields[e].val}}function u(){R=!0;for(var e=0;e<$.fields.length;e++)if($.fields[e].isrequired&&$.fields[e].val.length<3){R=!1;break}P="Short-Phrase"==n.cCategory.type?R:R&&$.numLinks>0}function g(){t.go("rankSummary",{index:n.cCategory.id})}function m(){var t=[];if(d(),u(),!R)return void e.getDialog("missingDataImage");t=JSON.parse(JSON.stringify($.fields));var a=i.getImageLinks(t,L,"add");a.then(h,p)}function p(){console.log("query failed, dont give up")}function v(){return d(),u(),C(E),P?void c():void e.getDialog("missingDataAnswer")}function h(e){for(var t,a=!1,n=0;n<e.length;n++){for(var s=0;s<D.length;s++)if(t=e[n].localeCompare(D[s]),0==t){a=!0;break}a||D.push(e[n])}$.numLinks=D.length,L++,($.numLinks>10||L>=4)&&($.searchDisabled="disabled"),L>1&&($.imageCommand="More images"),$.linkIdx=0,$.imageURL=D[$.linkIdx],x(D[$.linkIdx],A),$.numLinks>0&&($.imagefunctions="inline")}function f(){$.linkIdx++,$.linkIdx>=$.numLinks&&($.linkIdx=0),$.imageURL=D[$.linkIdx],x(D[$.linkIdx],A)}function b(){$.linkIdx--,$.linkIdx<0&&($.linkIdx=$.numLinks-1),$.imageURL=D[$.linkIdx],x(D[$.linkIdx],A)}function y(e){console.log("addAnswerConfrimed"),a.addAnswer(e).then(g)}function w(){console.log("answerIsSame"),I?e.getDialog("answerDuplicated"):o.postRec(T.id),g()}function k(){e.howItWorks("addAnswer")}function x(e,t,a){a=a||5e3;var n,s=!1,i=new Image;i.onerror=i.onabort=function(){s||(clearTimeout(n),t(e,"error"))},i.onload=function(){s||(clearTimeout(n),t(e,"success"))},i.src=e,n=setTimeout(function(){s=!0,t(e,"timeout")},a)}function A(e,t){("error"==t||"timeout"==t)&&($.imageURL="../../../assets/images/noimage.jpg")}function C(e){for(var t=0;t<n.estAnswers.length;t++)if(e.name==n.estAnswers[t].name){M=!0,T=n.estAnswers[t];for(var a=0;a<n.catansrecs.length;a++)n.catansrecs[a].answer==n.estAnswers[t].id&&n.catansrecs[a].category==n.cCategory.id&&(I=!0)}}function S(){t.go("cwrapper")}var $=this;$.title="addAnswer",$.header="table"+n.cCategory.id+".header",$.body="table"+n.cCategory.id+".body",$.searchDisabled="disabled",$.modalEnable=!0,$.publicfields=[],$.ranking=n.title;var R=!1,P=!1,D=(n.answers,[]);$.linkIdx=0,$.numLinks=0,$.imageCommand="Load images",$.searchDisabled="";var L=1;$.imagefunctions="none";var M=!1,I=!1,E={},T={};$.callAddAnswer=v,$.rankSummary=g,$.callSearchImage=m,$.viewNext=f,$.viewPrev=b,$.closeRank=S,$.showHowItWorksDialog=k,$.imageURL="../../../assets/images/noimage.jpg",$.header=n.header,r()}angular.module("app").controller("addAnswer",e),e.$inject=["dialog","$state","answer","$rootScope","$modal","image","catans"]}(),function(){"use strict";function e(e,t,a){function n(a){function n(e){return c=e.data.resource}if(r()&&!a)return t.when(c);var s=d;return e.get(s).then(n,l)}function s(t,a){function n(e){console.log("Creating new query record was succesful")}var s={};s.resource=[];var i={};i.query=t,i.results=a,i.timestmp=Date.now(),s.resource.push(i);var o=d;return e.post(o,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,l)}function i(t){function a(e){console.log("Flushing queries db was succesful")}var n={};n.resource=t,console.log("obj ---",t);var s=d;return e["delete"](s,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(a,l)}function o(t){function a(e){return console.log("Deleting record was succesful"),e.data}var n={};n.resource=[];var s={};s.id=t,n.resource.push(s);var i=d+"/"+t;return e["delete"](i,s,{headers:{"Content-Type":"multipart/form-data"},body:n}).then(a,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/queries",u={getQueries:n,postQuery:s,flushAll:i,deleteRec:o};return u}angular.module("app").factory("query",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("views page Loaded!")}var s=this;s.title="views",s.content=t.content,n()}angular.module("app").controller("views",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n){function s(){n.getQueries().then(function(e){o.queries=e,console.log("Queries Loaded!")})}function i(){for(var e=0;e<o.queries.length;e++)n.deleteRec(o.queries[e].id)}var o=this;o.title="queries",o.clearDb=i,s()}angular.module("app").controller("queries",e),e.$inject=["$location","$rootScope","$state","query"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("flags page Loaded!")}var s=this;s.title="flags",n()}angular.module("app").controller("flags",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a){function n(){console.log("admin page Loaded!")}function s(){a.go("queries")}function i(){a.go("views")}function o(){a.go("flags")}function r(){a.go("addRank")}function l(){a.go("content")}var c=this;c.title="admin",c.selKeywords="active",c.selViews="",c.selFlags="",c.selRankings="",c.goBack=l,c.keywords=s,c.views=i,c.flags=o,c.addRank=r,n()}angular.module("app").controller("admin",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,a,n,s,i){function o(){console.log("addRank page Loaded!")}function r(){d.title=c.rankTitle,d.tags=c.tags,d.keywords=c.keywords,d.type=c.type,d.question=c.question,d.views=0,d.answers=0,(null==d.title||void 0==d.title||d.title.length<10)&&(u=!1),(null==d.question||void 0==d.question||d.question.length<10)&&(m=!1),"Person"!=d.type&&"Establishment"!=d.type&&"Short-Phrase"!=d.type&&"Event"!=d.type&&"Organization"!=d.type&&"Place"!=d.type&&"Activity"!=d.type&&(g=!1)}function l(){r(),u&&g&&m?s.addTable(d):i.getDialog(u?m?"rankType":"rankQuestion":"rankTitle")}var c=this;c.title="addRank";var d={},u=!0,g=!0,m=!0;c.addRanking=l,c.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event"],o()}angular.module("app").controller("addRank",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog"]}(),function(){"use strict";function e(e,t){var a=[{name:"login",url:"/login",templateUrl:"app/login/partials/login.html",controller:"login as vm"},{name:"register",url:"/register",templateUrl:"app/login/partials/register.html",controller:"register as  vm"}];$(a).each(function(){e.state(this)})}var t=angular.module("login");t.config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var a=[{name:"customer",url:"/customer",views:{"@":{templateUrl:"app/customer/Partials/customer.html",controller:"customer as vm"},"navbar@customer":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}},resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}]}},{name:"mainphoto",parent:"customer",url:"/mainphoto",templateUrl:"app/customer/Partials/mainphoto.html",controller:"mainphoto as vm"},{name:"specials",parent:"customer",url:"/specials",templateUrl:"app/customer/Partials/specials.html",controller:"specials as vm"},{name:"editspecial",parent:"customer",url:"/editspecial",templateUrl:"app/customer/Partials/editspecial.html",controller:"editspecial as vm"},{name:"photogallery",parent:"customer",url:"/photogallery",templateUrl:"app/customer/Partials/photogallery.html",controller:"photogallery as vm"}];$(a).each(function(){e.state(this)})}var t=angular.module("app");t.config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var a=[{name:"admin",url:"/admin",views:{"@":{templateUrl:"app/admin/Partials/admin.html",controller:"admin as vm"},"navbar@admin":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"queries",parent:"admin",url:"/queries",templateUrl:"app/admin/Partials/queries.html",controller:"queries as vm"},{name:"views",parent:"admin",url:"/views",templateUrl:"app/admin/Partials/views.html",controller:"views as vm"},{name:"flags",parent:"admin",url:"/flags",templateUrl:"app/admin/Partials/flags.html",controller:"flags as vm"},{name:"addRank",parent:"admin",url:"/addRank",templateUrl:"app/admin/Partials/addRank.html",controller:"addRank as vm"}];$(a).each(function(){e.state(this)})}var t=angular.module("app");t.config(["$stateProvider","$urlRouterProvider",e])}();var openModal=function(e,t){$(e).modal({backdrop:!t||1!=t.backdrop&&0!=t.backdrop?"static":t.backdrop,keyboard:t&&t.keyboard?t.keyboard:"false",show:"true"})},closeModal=function(e,t){$(e).modal("hide"),t&&t()};!function(){"user strict";angular.module("app").constant("INSTANCE_URL","http://bitnami-dreamfactory-df88.westus.cloudapp.azure.com").constant("APP_API_KEY","7e9a54a80a6ae850bc38ff768d75e143e75c273d1f7e2f265648020bf8c42a3b").constant("DEBUG_MODE",!0)}(),function(){"use strict";function e(e,t){t.otherwise("/cwrapper");var a=[{name:"layout","abstract":!0,url:"",views:{"@":{templateUrl:"app/layout/Partials/layout.html",controller:"layout as vm"},"navbar@layout":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"cwrapper",parent:"layout",url:"",views:{"@layout":{templateUrl:"app/layout/Partials/cwrapper.html",controller:"cwrapper as vm"}},resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}],rankings:["table",function(e){return e.getTables().then(function(e){return e})}],specials:["special",function(e){return e.getSpecials().then(function(e){return e})}],mrecs:["matchrec",function(e){return e.GetMatchTable().then(function(e){return e})}],edits:["edit",function(e){return e.getEdits().then(function(e){return e})}],useractivities:["useractivity",function(e){return e.getAllUserActivity().then(function(e){return e})}],catansrecs:["catans",function(e){return e.getAllcatans().then(function(e){return e})}]}},{name:"rankSummary",parent:"layout",url:"/rankSummary/:index",templateUrl:"app/rank/Partials/RankSummary.html",controller:"rankSummary as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}],mrecs:["matchrec",function(e){return e.GetMatchTable().then(function(e){return e})}],edits:["edit",function(e){return e.getEdits().then(function(e){return e})}],useractivities:["useractivity",function(e){return e.getAllUserActivity().then(function(e){return e})}],catansrecs:["catans",function(e){return e.getAllcatans().then(function(e){return e})}]}},{name:"editRanking",parent:"layout",url:"/editRanking/:index",templateUrl:"app/rank/Partials/editRanking.html",controller:"editRanking as vm",resolve:{rankings:["table",function(e){return e.getTables().then(function(e){return e})}]}},{name:"addAnswer",parent:"layout",url:"/addAnswer",templateUrl:"app/answer/Partials/addAnswer.html",controller:"addAnswer as vm"},{name:"editAnswer",parent:"layout",url:"/editAnswer/:index",templateUrl:"app/answer/Partials/editAnswer.html",controller:"editAnswer as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}],edits:["edit",function(e){return e.getEdits().then(function(e){return e})}]}},{name:"answerDetail",parent:"layout",url:"/answerDetail/:index",templateUrl:"app/answer/Partials/answerDetail.html",controller:"answerDetail as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}]}},{name:"match",parent:"layout",url:"/match",templateUrl:"app/rank/Partials/match.html",controller:"match as vm",resolve:{answers:["answer",function(e){return e.getAnswers().then(function(e){return e})}]}},{name:"about",url:"/about",views:{"@":{templateUrl:"app/layout/Partials/about.html",controller:"about as vm"},"navbar@about":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}}];$(a).each(function(){e.state(this)})}var t=angular.module("app");t.config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e){e.interceptors.push("httpInterceptor")}var t=angular.module("app");t.config(e),e.$inject=["$httpProvider"]}(),function(){"use strict";function e(e,t,a,n){t.defaults.headers.common["X-Dreamfactory-API-Key"]=n,t.defaults.headers.common["X-DreamFactory-Session-Token"]=e.session_token}angular.module("app").run(e),e.$inject=["$cookies","$http","$rootScope","APP_API_KEY"]}(),angular.module("app").run(["$templateCache",function(e){e.put("app/admin/Partials/addRank.html",'<br><div class="row"><div class="col-sm-1"></div><div class="col-sm-10"><h4>Add Ranking</h4><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"><br><div class="form-group text-right"><button type="button" class="btn btn-primary" ng-click="vm.addRanking()">Add</button></div></div><div class="col-sm-1"></div></div>'),e.put("app/admin/Partials/admin.html",'<div ui-view="navbar"></div><br><div class="text-center"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-success {{vm.selKeywords}}" ng-click="vm.keywords()">Searched-Keyword</button> <button class="btn btn-primary {{vm.selViews}}" ng-click="vm.views()">Ranking-Answers Views</button> <button class="btn btn-danger {{vm.selFlags}}" ng-click="vm.flags()">Answer Flags</button> <button class="btn btn-primary {{vm.selAddRanking}}" ng-click="vm.addRank()">Add Ranking</button></div></div><br><br><div ui-view=""></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),e.put("app/admin/Partials/flags.html",'<h1>Flags</h1><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>Category</th><th>Answer</th><th>Flag</th></tr></thead><tbody><tr><td>Which are best breweries in San Diego?</td><td>Brewery A</td><td>Duplicated</td></tr><tr><td>What is best thing to say to a woman?</td><td>You are fat</td><td>Offensive</td></tr><tr><td>Best beaches to go with the family</td><td>Pacific Beach</td><td>Duplicated</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div>'),e.put("app/admin/Partials/queries.html",'<h1>Queries</h1><br><a ng-click="vm.clearDb()" class="btn btn-danger">Clear Database</a><br><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>User Input</th><th>Num. Results</th></tr></thead><tbody><tr ng-repeat="x in vm.queries | orderBy: \'-results\'"><td>{{x.query}}</td><td>{{x.results}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div>'),e.put("app/admin/Partials/views.html",'<h1>Views</h1><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>Ranking</th><th>Views</th></tr></thead><tbody><tr ng-repeat="x in vm.content | orderBy: \'-views\'"><td>{{x.title}}</td><td>{{x.views}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div>'),e.put("app/answer/Partials/addAnswer.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><div class="row"><h4>Add a new answer</h4></div><div class="text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it works?</u></p></div><br><div class="row"><div class="col-sm-12 col-md-5"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"></div><div class="" ng-show="{{vm.type == \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; max-height:300px;"></div><p>Background Image</p></div><div class="form-group text-right"><button type="submit" class="btn btn-primary {{vm.searchDisabled}}" ng-click="vm.callSearchImage()" ng-show="{{vm.type != \'Short-Phrase\'}}">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-disabled="vm.numLinks === 0" style="display:{{vm.imagefunctions}}">&raquo</button> <a style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a></div></div><form class="form-horizontal col-sm-10 col-md-6" role="form" name="answerForm"><div class="form-group" ng-repeat="x in vm.fields"><label class="col-sm-4 col-md-4 control-label capitalize">{{x.isrequired ? \'**\':\'\'}}{{x.label}}:</label><div class="col-sm-8 col-md-8"><input class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" type="{{x.textstyle}}" bs-typeahead-on-select="vm.onSelect(x.val)" placeholder="{{x.label}}" ng-hide="{{x.name==\'addinfo\'}}"><textarea class="form-control" ng-model="x.val" placeholder="{{x.label}}" ng-show="{{x.name==\'addinfo\'}}" rows="3"></textarea></div></div><div class="row form-group"><div class="text-right"><button ng-click="vm.rankSummary()" class="btn btn-danger">Cancel</button><button type="submit" class="btn btn-success" ng-click="vm.callAddAnswer()">Add</button></div></div></form></div>'),e.put("app/answer/Partials/answerDetail.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><div class="row"><div><h3><span ng-repeat="f in vm.fields" ng-show="{{vm.type != \'Short-Phrase\'}}">{{(f.name == "name" && vm.answer.name) ? vm.answer.name : ""}}</span></h3><strong>{{(vm.answer.location) ? \'Address:\' : ""}}</strong> {{(vm.answer.location) ? vm.answer.location : ""}}<br style="display:{{(vm.answer.location) ? \'inline\' : \'none\'}}"><strong>{{(vm.answer.cityarea) ? \'Neighboorhood:\' : ""}}</strong> {{(vm.answer.cityarea) ? vm.answer.cityarea : ""}}<br style="display:{{(vm.answer.cityarea) ? \'inline\' : \'none\'}}"><small class="text-muted">&nbsp;&nbsp;&nbsp{{vm.answer.views}}&nbspviews</small></div><br style="display:{{vm.answer.addinfo ? \'inline\':\'none\'}}"><div class="col-md-6 col-lg-6"><p style="display:{{vm.type == \'Short-Phrase\' ? \'none\':\'inline\'}}">{{vm.answer.addinfo}}</p><br style="display:{{vm.answer.addinfo ? \'inline\':\'none\'}}"><img class="displayed" src="{{vm.answer.imageurl}}" alt="Moustiers Sainte Marie" style="width:100%;height:300px" ng-click="vm.showUrl()" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; max-height:300px;" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer.addinfo}}</h4></div><br><br><p>Vote up if you support this answer in this ranking. Vote down if this answer is weak and does not belong in this ranking.</p><div class="row"><label style="width:10%" class="col-md-1 col-lg-1"><font size=""></font></label> <img style="width:20%" class="img-circle col-md-1 col-lg-1 cursor" src="../../../assets/images/{{vm.answer.thumbUp}}" ng-click="vm.UpVote()"> <label style="width:20%" class="col-md-1 col-lg-1"><font size="5">{{vm.catans.upV}}</font></label> <img style="width:20%" class="img-circle col-md-1 col-lg-1 cursor" src="../../../assets/images/{{vm.answer.thumbDn}}" ng-click="vm.DownVote()"> <label style="width:20%" class="col-md-1 col-lg-1"><font size="5">{{vm.catans.downV}}</font></label> <label style="width:10%" class="col-md-1 col-lg-1"><font size=""></font></label></div><br><button type="button" class="btn btn-primary btn-block" ng-click="vm.editAnswer()">Edit {{vm.numEdits > 0? "("+vm.numEdits+")" : ""}}</button><br><a ng-click="vm.goBack()" class="btn btn-success">Back</a><div class="btn-group"><button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown">Flag<span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li><a id="action-x" ng-click="vm.flagAnswer(1)">Flag Offensive</a></li><li><a id="action-y" ng-click="vm.flagAnswer(2)">Flag Duplicated</a></li></ul></div><a ng-click="vm.deleteAnswer()" class="btn btn-danger" style="display:{{vm.deleteButton}}">Delete</a><br><br></div><div class="col-md-6 col-lg-6"><div ng-repeat="x in vm.specialsList"><div ng-bind-html="x.html" style="{{x.style}}"><br></div></div><table class="table table-hover cursor" id="mytable"><tbody><thead><tr><th>Pct (%)</th><th>vs. Opponent</th><th>Pct (%)</th><th>GP</th></tr></thead><tbody><tr ng-repeat="x in vm.relativetable | orderBy:\'-Rank\'" ng-click="vm.refresh(x.id)"><td align="middle">{{x.PctF}}</td><td align="middle">{{x.vsName}}</td><td align="middle">{{x.PctC}}</td><td align="middle">{{x.GP}}</td></tr></tbody></tbody></table><p class="text-left" ng-show="vm.otherRanksExist"><strong>{{vm.answer.name}}</strong> is also feautured in the following ranks:</p><br><div ng-repeat="r in vm.otherRanks"><p ng-click="vm.rankSel(r)">{{r.title}}</p></div></div></div><br>'),e.put("app/answer/Partials/editAnswer.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><div class="row"><div class="col-sm-6"><h3>Edit Answer Profile</h3></div><div class="col-sm-6 text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it Works</u></p></div></div><br><div class="row"><div class="col-sm-12 col-md-6"><div class=""><img class="displayed-uc" src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"></div><div class="container-answer" style="width:100%; max-height:300px;" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer.addinfo}}</h4></div><br><button type="submit" class="btn btn-primary" ng-click="vm.editImage()">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" style="display:{{vm.imagefunctions}}">&raquo</button> <a style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a> <button type="submit" class="btn btn-success" ng-click="vm.selectImage()" style="display:{{vm.imagefunctions}}">Select</button></div><form class="form-horizontal col-sm-12 col-md-6" role="form" name="answerForm"><div class="form-group" ng-repeat="x in vm.fields"><label class="control-label capitalize">{{x.label}}:</label><div class="input-group" style="display:{{x.field!=\'addinfo\' ? \'inline\':\'none\'}}"><input class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" type="text" placeholder="{{x.cval}}"> <span class="input-group-btn text-right"><button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div><div class="input-group" style="display:{{x.field==\'addinfo\' ? \'inline\':\'none\'}}"><textarea class="form-control" ng-model="x.val" placeholder="{{x.cval}}" rows="5"></textarea> <span class="input-group-btn text-right"><button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div></div></form></div><br><div class="well well-light-edit" ng-repeat="x in vm.edits"><p><strong>{{x.username}}</strong> has edited the <strong class="capitalize"><em>{{x.field}}</em></strong> of <strong><em>{{x.name}}</em></strong> to <strong><em>{{x.nval}}</em></strong>.</p><img src="{{x.imageURL}}" "="" class="displayed" style="height:150px;display:{{x.display}}"><div class="row form-group"><div class="text-center"><label>{{x.upV}}</label> <label></label> <button class="btn btn-primary {{x.agree}}" ng-click="vm.editAgree(x, $index)">Agree</button> <button type="submit" class="btn btn-primary {{x.disagree}}" ng-click="vm.editDisagree(x, $index)">Disagree</button> <label></label> <label>{{x.downV}}</label></div></div></div><div class="text-center"><a ng-click="vm.answerDetail()" class="btn btn-success">Back</a></div><br>'),e.put("app/content/partials/content-block.html",'<div class="well-sm" style="background-color:{{bgc}};color:{{fc}}"><h3 class="sub-header">{{headline}}</h3></div><div class="row" style="display:{{isRoW ? \'inline\':\'none\'}}"><div class="col-sm-6 col-md-6 col-lg-4"><img class="displayed" src="{{image1}}" style="width:100%;max-height:150px;display:{{image1 != undefined ? \'inline\':\'none\'}}"></div><div class="hidden-xs col-sm-6 col-md-6 col-lg-4"><img class="displayed" src="{{image2}}" style="width:100%;max-height:150px;display:{{image2 != undefined ? \'inline\':\'none\'}}"></div><div class="hidden-xs hidden-sm hidden-md col-lg-4"><img class="displayed" src="{{image3}}" style="width:100%;max-height:150px;display:{{image3 != undefined ? \'inline\':\'none\'}}"></div></div><div class="container"><div ng-repeat="x in resultsT | orderBy: \'-views\' | limitTo:maxRes"><h4 ng-click="rankSel(x, $index)">{{x.title}} <small class="text-muted">&nbsp;&nbsp;&nbsp;&nbsp;{{x.answers}}&nbspanswers-{{x.views}}&nbspviews</small></h4></div></div><p class="text-right" style="color:blue;" ng-click="seeMore(maxRes, btext)" ng-hide="{{isRoW}}">&lt;&lt;{{btext}}&gt;&gt;</p>'),e.put("app/customer/Partials/customer.html",'<div ui-view="navbar"></div><br><h2>Select business you wish to manage</h2><div ng-repeat="x in vm.answers"><label><input type="radio" name="businessradio" ng-click="vm.selAnswer(x)">&nbsp;&nbsp;{{x.name}}, {{x.location}}, {{x.cityarea}}</label></div><br><div class="text-center"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-success {{vm.loadMainPhoto}}" ng-click="vm.loadMainPhoto()">Main Photo</button> <button class="btn btn-primary {{vm.loadSpecials}}" ng-click="vm.loadSpecials()">Specials</button> <button class="btn btn-danger {{vm.loadPhotoGallery}}" ng-click="vm.loadPhotoGallery()">Photo Gallery</button></div></div><br><br><div ui-view=""></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),
e.put("app/customer/Partials/editspecial.html",'<h1>{{ vm.isEdit ? \'Edit Special\':\'Add Special\'}}</h1><br><div class="well"><div class="row"><div class="col-sm-4 col-md-4"><p class="text-right">Specials Title:</p></div><div class="col-sm-4 col-md-4"><input class="form-control" ng-model="vm.sp.stitle" type="text" placeholder="Special Banner" ng-change="vm.displayCharLength()" maxlength="25" style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}}"></div><div class="col-sm-4 col-md-4"><p class="text-left">{{vm.char}} chars left</p></div></div><br><div class="row"><div class="col-sm-6 col-md-4"><p class="text-right">Background Color</p></div><div class="col-sm-1 col-md-1"><color-picker ng-model="vm.sp.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-sm-6 col-md-1"><p class="text-right">Font Color</p></div><div class="col-sm-1 col-md-1"><color-picker ng-model="vm.sp.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div></div><h4>Schedule</h4><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.sp.freq == \'onetime\'? \'active\':\'\'}}" ng-click="vm.frequencySel(1)">One-Time</button> <button class="btn btn-primary {{vm.sp.freq == \'weekly\'? \'active\':\'\'}}" ng-click="vm.frequencySel(2)">Weekly</button></div><br><br><br><div class="row"><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="text-right">Start date:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.sdate" type="text"></datepicker></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="text-right">Start time:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.sp.stime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime}}</option></select></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="text-right">End date:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.edate" type="text"></datepicker></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="text-right">End time:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.sp.etime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime}}</option></select></div></div><div class="row"><div class="col-sm-12 col-md-4" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.mon" value="">Mon</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.tue" value="">Tue</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.wed" value="">Wed</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.thu" value="">Thu</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.fri" value="">Fri</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sat" value="">Sat</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sun" value="">Sun</label></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">Start time:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.sp.stime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime2}}</option></select></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">End time:</p></div><div class="col-sm-2 col-md-2 col-lg-1" style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.sp.etime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime2}}</option></select></div></div><br><div class="row"><div class="col-sm-0 col-md-3 col-lg-3"></div><div class="container col-sm-12 col-md-6 col-lg-6"><p>Event Details</p><textarea class="form-control" ng-model="vm.sp.details" placeholder="{{x.label}}" rows="4" style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}};width:100%"></textarea></div><div class="col-sm-0 col-md-3 col-lg-3"></div><br></div><br><div class="form-group text-center"><button type="button" class="btn btn-success" ng-click="vm.goBack()">Back</button> <button type="button" class="btn btn-primary" ng-click="vm.showPreview()">Preview</button> <button type="button" class="btn btn-danger" ng-click="vm.deleteSpecial()" style="display:{{vm.isEdit ? \'inline\':\'none\'}}">Delete</button></div></div>'),e.put("app/customer/Partials/mainphoto.html","<h1>Main Photo</h1>"),e.put("app/customer/Partials/photogallery.html","<h1>Photo Gallery</h1>"),e.put("app/customer/Partials/specials.html",'<h1>Specials</h1><label>{{vm.specialsList.length > 0? \'Choose a special to Edit\':\'There are no specials registered to this answer\'}}</label><div ng-repeat="x in vm.specialsList"><label><input type="radio" name="specialradio" ng-click="vm.selSpecial(x)">&nbsp;&nbsp;{{x.stitle}}, {{x.freq}}</label></div><br><button ng-click="vm.addSpecial()" class="btn btn-primary">Add Special</button>'),e.put("app/layout/Partials/about.html",'<div ui-view="navbar"></div><div class="container"><div class="jumbotron"><br><div class="row"><div class="col-sm-0 col-md-2 col-lg-3"></div><div class="col-sm-12 col-md-8 col-lg-6"><img src="../../../assets/images/rankxlogo.png" class="displayed-uc" alt="Cinque Terre" style="width:100%;max-height:200px"></div><div class="col-sm-0 col-md-2 col-lg-3"></div></div><br><br><p>Rank-X collects users preferences to generate truly collective rankings on all things that are important to you.</p><br></div><div class="well"><div class="form-group text-left"><p>San Diego, CA - 2016</p><p>Contact: contact@rank-x.com</p></div></div><br><div class="form-group text-center"><button type="button" class="btn btn-primary" ng-click="vm.goBack()">Back</button></div></div><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),e.put("app/layout/Partials/city-selection.html",'<div class="modal fade" id="selectCityModal" tabindex="-1" role="dialog" aria-labelledby="selectCityModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="selectCityModalLabel">Select City</h4></div><div class="modal-body" style="height: 250px"><div class="col-md-12" style="height: 250px"><div class="col-md-6"><input placeholder="Search City" class="form-control" ng-model="searchCity"></div><div class="clearfix" style="margin-bottom: 24px"></div><div class="col-md-3" ng-repeat="city in cities | searchObject : searchCity : \'name\' | orderObjectBy : \'name\'"><a href="#" ng-click="selectCity(city)" ng-if="city.is_active">{{city.name}}</a></div><div class="col-md-12 text-center" style="height: 150px;padding-top: 50px" ng-if="(cities | searchObject : searchCity : \'name\' | objectLength) == 0"><span class="text-muted">City not found.</span></div></div></div></div></div></div>'),e.put("app/layout/Partials/cwrapper.html",'<div class="input-group" style="width:100%"><div class="text-center" style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.selEditRank}}" ng-click="vm.editRank()">Edit Mode</button> <button class="btn btn-primary {{vm.selViewRank}}" ng-click="vm.viewRank()">View Mode</button></div><button class="btn btn-danger" ng-click="vm.applyRule()">apply Rule</button></div><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><br style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"></div><div class="row"><div class="text-center col-sm-12 col-md-4"><div class="btn-group"><button class="btn btn-default {{vm.isCity ? \'active\':\'\'}}" ng-click="vm.switchScope(1)">San Diego</button> <button class="btn btn-default {{vm.isNh ? \'active\':\'\'}}" ng-click="vm.switchScope(2)">Neighborhood</button></div></div><br class="hidden-lg"><div class="col-sm-12 col-md-8"><div class="input-group"><input type="text" class="form-control" placeholder="Search" ng-model="vm.val" ng-change="vm.refreshRanks(vm.val)"><div class="input-group-btn"><button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button></div></div></div></div><div style="display:{{vm.isNh ? \'inline\':\'none\'}}"><br><div class="dropdown"><button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" style="width:200px">{{vm.cnh}} <span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-middle"><li ng-repeat="x in vm.nhs | orderBy: x"><a ng-click="vm.selnh(x)">{{x}}</a></li></ul></div></div><div style="display:{{vm.searchActive ? \'inline\':\'none\'}}"><content-block mode="9" dynamic="true"></content-block></div><br><div style="display:{{((vm.isNhRdy || vm.isCity) && (vm.searchActive == false)) ? \'inline\':\'none\'}}"><content-block mode="1" dynamic="false" rankofweek="true"></content-block><content-block mode="2" dynamic="false"></content-block><content-block mode="3" dynamic="false"></content-block><content-block mode="4" dynamic="false"></content-block><content-block mode="5" dynamic="false"></content-block><content-block mode="6" dynamic="false"></content-block><content-block mode="7" dynamic="false"></content-block><content-block mode="8" dynamic="false"></content-block></div>'),e.put("app/layout/Partials/layout.html",'<div ui-view="navbar"></div><div class="container"><div id="veil" ng-show="vm.isLoading"></div><div id="feedLoading" ng-show="vm.isLoading">Loading...</div><div class="container-fluid" ng-hide="vm.isLoading"><br><div class="row"><div class="col-sm-0 col-md-1 col-lg-1"></div><div class="col-sm-12 col-md-10 col-lg-10"><img src="../../../assets/images/rankxlogosd.png" title="{{selectedCity.name}}" alt="{{selectedCity.name}}" style="width:100%;max-height:250px"></div><div class="col-sm-0 col-md-1 col-lg-1"></div></div><br><div ui-view=""></div><br></div></div><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),e.put("app/layout/Partials/navbar.html",'<nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#">RANK-X</a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right" ng-show="vm.user"><li><a href=""><i class="fa fa-user"></i> Welcome {{vm.user.first_name}}</a></li></ul><ul class="nav navbar-nav navbar-right"><li ng-show="!vm.isLoggedIn"><a href="#/login">Login</a></li><li ng-show="vm.isLoggedIn"><a href="" ng-click="vm.logout()">Logout</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href="" ng-click="vm.gotoAbout()">About</a></li><li><a href="" ng-click="vm.openCitySelection()"><i style="color: #FFF;font-size: 20px" class="fa fa-map-marker"></i> {{selectedCity.name || \'Select City\'}}</a></li></ul></div></div></nav>'),e.put("app/login/partials/add-user-detail.html",'<div class="modal fade" id="addUserDetailModal" tabindex="-1" role="dialog" aria-labelledby="addUserDetailModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h4 class="modal-title" id="addUserDetailModalLabel">Add User Detail</h4></div><div class="modal-body" style="height: 214px"><div class="col-md-12"><form class="form-horizontal" role="form" name="answerForm"><div class="col-md-12"><div class="form-group"><label for="birthdate">Birth Date:</label><datepicker date-year-title="selected year" date-max-limit="{{maxDate}}" date-format="yyyy/MM/dd" date-month-title="selected year"><input id="birthdate" ng-model="user.birth_date" class="form-control"></datepicker></div><div class="form-group"><label>Gender:</label><div class="clearfix"></div><label class="radio-inline"><input name="gender" type="radio" value="Male" ng-model="user.gender">Male</label> <label class="radio-inline"><input name="gender" type="radio" value="Female" ng-model="user.gender">Female</label> <label class="radio-inline"><input name="gender" type="radio" value="Other" ng-model="user.gender">Other</label></div><div class="row form-group"><button type="submit" class="btn btn-success" ng-click="addUserDetail()">Add Detail</button><p class="hiw" ng-click="whyThisInfoDialog()"><u>why you need this?</u></p></div></div></form></div></div></div></div></div>'),e.put("app/login/partials/login.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">RankX</h1></div><div class="panel-body"><form ng-submit="vm.submit()" ng-if="!vm.isProgressing"><div class="form-group text-center"><button type="button" class="btn btn-primary form-control" ng-click="vm.redirectForFacebook()"><i class="fa fa-facebook"></i> Login</button></div><br><p class="hiw" ng-click="vm.whyFacebookDialog()"><u>why Facebook?</u></p></form><div style="text-align: center" ng-if="vm.isProgressing"><div class="loading-pulse"></div><p class="text-muted">Loading...</p></div></div></div>'),e.put("app/login/partials/register.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">Register</h1></div><div class="panel-body"><form name="registerForm"><div class="form-group"><label>First Name</label> <input type="text" name="firstName" class="form-control" ng-model="vm.firstName"></div><div class="form-group"><label>Last Name</label> <input type="text" name="lastName" class="form-control" ng-model="vm.lastName"></div><div class="form-group"><label>Email</label> <input type="email" class="form-control" ng-model="vm.username"></div><div class="form-group"><label>Password</label> <input type="password" name="password" class="form-control" ng-model="vm.password"></div><div class="form-group"><label>Confirm Password</label> <input type="password" name="confirm" class="form-control" ng-model="vm.confirm"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary" ng-click="vm.signIn()">Sign In</button> <button type="button" class="btn btn-primary" ng-click="vm.register()">Register</button></div></form></div></div>'),e.put("app/rank/Partials/RankChat.html",'<div class="container"><div class="row"><div class="col-md-6"><h1 class="page-heading">This is a test</h1></div></div></div>'),e.put("app/rank/Partials/RankSummary.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><br><div class="row" style="display:{{vm.isShortPhrase == false? \'inline\':\'none\'}}"><div class="col-sm-6 col-md-6 col-lg-4"><img class="displayed" src="{{vm.image1}}" style="width:100%;max-height:200px;display:{{vm.image1 != undefined ? \'inline\':\'none\'}}"></div><div class="hidden-xs col-sm-6 col-md-6 col-lg-4"><img class="displayed" src="{{vm.image2}}" style="width:100%;max-height:200px;display:{{vm.image2 != undefined ? \'inline\':\'none\'}}"></div><div class="hidden-xs hidden-sm hidden-md col-lg-4"><img class="displayed" src="{{vm.image3}}" style="width:100%;max-height:200px;display:{{vm.image3 != undefined ? \'inline\':\'none\'}}"></div></div><div class="row" style="display:{{vm.isShortPhrase == true? \'inline\':\'none\'}}"><div class="col-sm-6 col-md-6 col-lg-4"><div class="container-answer" style="width:100%; max-height:300px;"><br><h2 style="text-align:center"><strong>{{vm.title1}}</strong></h2><br><h4 style="text-align:center">{{vm.addinfo1}}</h4></div></div><div class="hidden-xs col-sm-6 col-md-6 col-lg-4"><div class="container-answer" style="width:100%; max-height:300px;"><br><h2 style="text-align:center"><strong>{{vm.title2}}</strong></h2><br><h4 style="text-align:center">{{vm.addinfo2}}</h4></div></div><div class="hidden-xs hidden-sm hidden-md col-lg-4"><div class="container-answer" style="width:100%; max-height:300px;"><br><h2 style="text-align:center"><strong>{{vm.title3}}</strong></h2><br><h4 style="text-align:center">{{vm.addinfo3}}</h4></div></div></div><br><div class="text-center"><a href="http://twitter.com/home?status=" title="Share in Twitter" target="_blank" class="btn btn-twitter"><i class="fa fa-twitter"></i></a><a href="https://www.facebook.com/sharer/sharer.php" title="Share in Facebook" target="_blank" class="btn btn-facebook"><i class="fa fa-facebook">acebook</i></a><a href="https://plus.google.com/share?url=" title="Share in Google+" target="_blank" class="btn btn-googleplus"><i class="fa fa-google-plus"></i></a></div><div class="row"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.selOverall}}" ng-click="vm.rankOverall()">Overall</button> <button class="btn btn-primary {{vm.selPersonal}}" ng-click="vm.rankPersonal()">Personal</button></div><div class="btn-group text-right col-sm-6 col-md-6"><h4>Contributors: <b style="color:blue;"><i>{{vm.numContributors}}</i></b></h4></div></div><div class="text-center"><button ng-click="vm.goRank()" class="btn btn-success">Go Rank</button></div><br><table class="table table-hover cursor"><tbody><thead><tr><th>Rank</th><th class="capitalize" ng-repeat="h in vm.fields | filter:(h.isrequired=true)">{{h.label}}</th><th ng-show="{{vm.type == \'Establishment\'}}">Distance (mi)</th><th ng-show="{{vm.type == \'Establishment\'}}">Specials</th></tr></thead><tbody><tr ng-repeat="x in vm.answers" ng-click="vm.answerDetail(x.id)"><td>{{$index+1}}</td><td ng-repeat="h in vm.fields | filter:(h.isrequired=true)">{{ x[h.name]}}</td><td ng-show="{{vm.type == \'Establishment\'}}">{{x.dist}}</td><td ng-show="{{vm.type == \'Establishment\'}}" class="{{x.style}}">{{x.specials}}</td></tr></tbody></tbody></table><div class="row"><div class="col-sm-1"><a class="btn btn-primary" ng-click="vm.addAnswer()">+</a></div><div class="col-sm-11" style="display:{{vm.addInfoMsgAck == false ? \'inline\':\'none\'}}"><div class="alert alert-warning" style="padding-top: 5px;padding-bottom: 5px;"><a class="close" data-dismiss="alert" aria-label="close" ng-click="vm.closeAddInfoMsg()">&times;</a> <span class="glyphicon glyphicon-arrow-left"></span><strong>&nbsp;&nbsp;Are we missing one?</strong>&nbsp;&nbsp;Use the \'+\' button to add a new answer.</div></div></div><br><br>'),e.put("app/rank/Partials/editRanking.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><h4>Edit Ranking</h4><br><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"><br><div class="form-group text-right"><button type="button" class="btn btn-primary" ng-click="vm.goEdit()">Edit</button> <button type="button" class="btn btn-danger" ng-click="vm.goDelete()">Delete</button></div><br>'),e.put("app/rank/Partials/match.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><h3>{{vm.table.question}}</h3><div class="form-group text-center"><div class="well well-dark">Match <strong>{{vm.GP + 1}}</strong> of <strong>{{vm.Tot}}</strong></div></div><div class="row"><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer1.name) ? vm.answer1.name : ""}} {{(f.name == "cityarea" && vm.answer1.cityarea) ? " - "+ vm.answer1.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer1.imageurl}}" ng-click="vm.selectAnswer(1)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; max-height:300px;" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer1.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer1.addinfo}}</h4></div></div><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer2.name) ? vm.answer2.name : ""}} {{(f.name == "cityarea" && vm.answer2.cityarea) ? " - "+ vm.answer2.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer2.imageurl}}" ng-click="vm.selectAnswer(2)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; max-height:300px;" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer2.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer2.addinfo}}</h4></div></div></div><br><div class="row"><div class="form-group text-left col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(1)" type="button" class="btn btn-success">Details</button></div><div class="form-group text-right col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(2)" type="button" class="btn btn-success">Details</button></div></div><div class="form-group text-center"><button ng-click="vm.skipMatch()" type="button" class="btn btn-default">I don\'t know, Skip</button> <button ng-click="vm.rankSummary()" type="button" class="btn btn-danger">Stop</button></div><br>')}]);