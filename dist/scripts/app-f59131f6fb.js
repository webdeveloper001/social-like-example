function calculateAge(e){var t=Date.now()-e.getTime(),n=new Date(t);return Math.abs(n.getUTCFullYear()-1970)}!function(){"use strict";angular.module("app",["angulike","color.picker","ngFileUpload","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMessages","pascalprecht.translate","tmh.dynamicLocale","login","ui.router","ui.bootstrap.modal","mgcrea.ngStrap","720kb.datepicker","720kb.socialshare","ngFacebook","ui.select","infinite-scroll","datatables"])}(),function(){"use strict";function e(e){function t(t,i){for(var r=t.length,l=r*(r-1)/2,c=i.length,d=0,u=0,g=0,m=0,p=0;p<r;p++){n[p]=new Array(r),a[p]=new Array(r);for(var h=0;h<r;h++)n[p][h]=0,a[p][h]=0;s[p]=t[p].id}for(p=0;p<c;p++)d=s.indexOf(i[p].hs),u=s.indexOf(i[p].ls),d>=0&&u>=0&&(i[p].sel==i[p].hs?n[d][u]++:i[p].sel==i[p].ls&&n[u][d]++,a[d][u]++,a[u][d]++);for(g=0,p=0;p<r;p++)for(h=0;h<r;h++)g+=a[p][h];for(m=g/(4*l),p=0;p<r;p++){for(t[p].Rank=0,g=0,h=0;h<r;h++)t[p].Rank=t[p].Rank+n[p][h],g+=a[p][h];t[p].Rank=t[p].Rank/g,g<m&&(t[p].Rank=t[p].Rank*(g/m))}for(var f=0;f<r;f++)for(h=0;h<r;h++)f!=h&&t[h].Rank>=t[f].Rank&&n[f][h]>n[h][f]&&a[f][h]>=m&&(t[f].Rank=t[h].Rank+.01);o=t,e.answersR=o,e.R=n,e.GP=a,e.A=s}e.A=[];var n=[],a=[],s=[],o=[];return{computeRanking:t}}angular.module("app").service("rank",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(t){function a(e){return n.DEBUG_MODE&&console.log("creating match record was succesful"),e.data}var s={};s.resource=[],s.resource.push(t),u.push.apply(u,t);var o=g;return e.post(o,t,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,c)}function s(n){function a(e){return l(e.data.resource),u}if(d()&&!n)return t.when(u);var s=g;return e.get(s).then(a,c)}function o(t){function a(e){var t=e.data.resource,a=u.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&u.push(e)}),n.DEBUG_MODE&&console.log("mrecsX data loaded"),t}for(var s="?filter=(",o=0;o<t.length;o++)s=s+"category="+t[o].category+")OR(";s=s.substring(0,s.length-3);var i=g;return e.get(i).then(a,c)}function i(t){function a(e){n.DEBUG_MODE&&console.log("deleting match records succesful")}for(var s=0;s<u.length;s++)u[s].ls!=t&&u[s].hs!=t||u.splice(s,1);var o=g+"?filter=(ls="+t+") OR (hs="+t+")";return e.delete(o).then(a,c)}function r(t,a){function s(e){console.log("deleting match records category-hs pair succesful")}function o(e){n.DEBUG_MODE&&console.log("deleting match records category-ls pair succesful")}for(var i=0;i<u.length;i++)u[i].ls!=a&&u[i].hs!=a||u.splice(i,1);var r=g+"?filter=(category="+t+") AND (hs="+a+")";e.delete(r).then(s,c);var l=g+"?filter=(category="+t+") AND (ls="+a+")";e.delete(l).then(o,c)}function l(e){u.length=0,e.forEach(function(e){u.push(e)})}function c(e){throw e}function d(){return u.length>0}var u=[];n.mrecs=u;var g="/api/v2/mysql/_table/matchtable";return{GetMatchTable:s,GetMatchTableX:o,postRec:a,deleteRecordsbyAnswer:i,deleteRecordsbyCatans:r}}angular.module("app").factory("matchrec",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b,y,w,k,x,R,A,E,O,S,D,C){function I(){if(we.dataReady=!0,p.DEBUG_MODE&&console.log("$rootScope.isCustomRank - ",p.isCustomRank),p.cCategory=null,p.isCustomRank){for(var e=0;e<p.customranks.length;e++)if(p.customranks[e].id==t.index||p.customranks[e].slug==t.index){p.cCategory=p.customranks[e];break}}else for(var e=0;e<p.content.length;e++)if(p.content[e].id==t.index||p.content[e].slug==t.index){p.cCategory=p.content[e];break}p.DEBUG_MODE&&console.log("$rootScope.cCategory - ",p.cCategory.id,p.cCategory.cat),p.cCategory||n.go("cwrapper"),we.ranking=p.cCategory.title,p.rankIsNearMe&&(we.ranking=we.ranking.replace("in San Diego","close to me")),11942==p.cCategory.id&&(we.foodNearMe=!0,De=!0,we.fnm=!0,we.showR=!1,void 0!=p.coordsRdy&&0!=p.coordsRdy||q()),we.loadingAnswers=!0,O(function(){De?p.coordsRdy&&P():P(),we.loadingAnswers=!1})}function P(){ke=p.answers,xe=p.catansrecs,Re=p.alluseractivity,Ae=p.mrecs,p.inFavMode=!1,Ce=void 0!=p.rankIsNearMe&&p.rankIsNearMe,u.scrollTo(0,0),p.$emit("showLogo"),p.rankIsActive=!0,p.objNumAct=p.objNum,U(),De||ye(0),ae(),m.$parent.$parent.$parent.seo={pageTitle:p.cCategory.title,metaDescription:p.cCategory.question},0==we.answers.length?we.noAnswers=!0:we.noAnswers=!1,N(),p.cvotes?pe():(p.cvotes=[],p.ceditvotes=[]),G(),z(),r.computeRanking(p.canswers,p.cmrecs);for(var e=0;e<we.answers.length;e++)we.answers[e].Rank=e+1;if(Y(),void 0==p.cCategory.numcom?we.numcom=0:we.numcom=p.cCategory.numcom,1==p.cCategory.isatomic&&!De)for(var e=0;e<we.answers.length;e++)we.answers[e].Rank!=we.answers[e].catansrank&&void 0!=we.answers[e].catans&&(p.DEBUG_MODE&&console.log("RS-1"),a.updateRec(we.answers[e].catans,["rank"],[we.answers[e].Rank]));if(0==we.answers.length&&(we.numAns=0,De||p.cCategory.isGhost||(p.isCustomRank?S.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,"","",""]):c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,"","",""]))),1==we.answers.length&&(we.numAns=1,"Short-Phrase"==p.cCategory.type?(we.isShortPhrase=!0,we.title1=we.answers[0].name,we.addinfo1=we.answers[0].addinfo,we.image1=we.title1+"##"+we.addinfo1,null!=p.cCategory.fimage&&void 0!=p.cCategory.fimage&&""!=p.cCategory.fimage?(we.hasfimage=!0,we.fimage=p.cCategory.fimage):we.hasfimage=!1):(we.isShortPhrase=!1,void 0!=we.answers[0].imageurl&&null!=we.answers[0].imageurl&&""!=we.answers[0].imageurl?(we.image1=we.answers[0].imageurl,we.image1ok=!0):we.image1ok=!1),De||p.cCategory.isGhost||(p.isCustomRank?S.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,"",""]):c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,"",""]))),2==we.answers.length&&(we.numAns=2,"Short-Phrase"==p.cCategory.type?(we.isShortPhrase=!0,we.title1=we.answers[0].name,we.addinfo1=we.answers[0].addinfo,we.image1=we.title1+"##"+we.addinfo1,we.title2=we.answers[1].name,we.addinfo2=we.answers[1].addinfo,we.image2=we.title2+"##"+we.addinfo2,null!=p.cCategory.fimage&&void 0!=p.cCategory.fimage&&""!=p.cCategory.fimage?(we.hasfimage=!0,we.fimage=p.cCategory.fimage):we.hasfimage=!1):(we.isShortPhrase=!1,void 0!=we.answers[0].imageurl&&null!=we.answers[0].imageurl&&""!=we.answers[0].imageurl?(we.image1=we.answers[0].imageurl,we.image1ok=!0):we.image1ok=!1,void 0!=we.answers[1].imageurl&&null!=we.answers[1].imageurl&&""!=we.answers[1].imageurl?(we.image2=we.answers[1].imageurl,we.image2ok=!0):we.image2ok=!1),De||p.cCategory.isGhost||(p.isCustomRank?S.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,we.image2,""]):c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,we.image2,""]))),we.answers.length>2){if(we.numAns=3,"Short-Phrase"==p.cCategory.type)we.isShortPhrase=!0,we.title1=we.answers[0].name,we.addinfo1=we.answers[0].addinfo,we.image1=we.title1+"##"+we.addinfo1,we.title2=we.answers[1].name,we.addinfo2=we.answers[1].addinfo,we.image2=we.title2+"##"+we.addinfo2,we.title3=we.answers[2].name,we.addinfo3=we.answers[2].addinfo,we.image3=we.title3+"##"+we.addinfo3,null!=p.cCategory.fimage&&void 0!=p.cCategory.fimage&&""!=p.cCategory.fimage?(we.hasfimage=!0,we.fimage=p.cCategory.fimage):we.hasfimage=!1;else{we.isShortPhrase=!1,we.image1=p.EMPTY_IMAGE,we.image2=p.EMPTY_IMAGE,we.image3=p.EMPTY_IMAGE,we.image1ok=!0,we.image2ok=!0,we.image3ok=!0;for(var t=1,n=0;n<we.answers.length;n++)if(void 0!=we.answers[n].imageurl&&null!=we.answers[n].imageurl&&""!=we.answers[n].imageurl&&we.answers[n].imageurl!=p.EMPTY_IMAGE){if(3==t){we.image3=we.answers[n].imageurl;break}2==t&&(we.image2=we.answers[n].imageurl,t++),1==t&&(we.image1=we.answers[n].imageurl,t++)}}De||p.cCategory.isGhost||(p.isCustomRank?S.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,we.image2,""]):c.update(p.cCategory.id,["views","answers","image1url","image2url","image3url"],[p.cCategory.views+1,p.canswers.length,we.image1,we.image2,we.image3]))}if(void 0!=p.cCategory.fimage&&""!=p.cCategory.fimage&&p.cCategory.fimage!=we.image1&&(we.image3=we.image2,we.image2=we.image1,we.image1=p.cCategory.fimage),void 0!=p.cCategory.bc&&""!=p.cCategory.bc)we.bc=p.cCategory.bc,we.fc=p.cCategory.fc,we.shade=p.cCategory.shade;else{var s=o.defaultRankColor(p.cCategory);we.bc=s[0],we.fc=s[1],we.shade=-4}p.DEBUG_MODE&&console.log("foodNearMe, ",De),p.DEBUG_MODE&&console.log("rankIsNearMe, ",Ce),(De||Ce)&&q(),we.isE&&W(),De&&(we.showR=!1),De||we.isE||(we.showR=!0),p.modeIsImage=!0,p.DEBUG_MODE&&console.log("Rank Summary Loaded!"),window.prerenderReady=!0,p.isCustomRank=!1}function T(){p.canswers4rank=[];for(var e=0;e<p.cvotes.length;e++)if(1==p.cvotes[e].vote)for(var t=0;t<p.canswers.length;t++)if(p.cvotes[e].answer==p.canswers[t].id){var n=p.catansrecs.map(function(e){return e.id}).indexOf(p.cvotes[e].catans);n>-1&&p.catansrecs[n].category==p.cCategory.id&&p.canswers4rank.push(p.canswers[t])}p.canswers4rank.length>0?we.commentAllowed=!0:we.commentAllowed=!1,M()}function M(){p.canswers4rank.length>1?we.rankDisabled="":we.rankDisabled="disabled"}function L(){v.loadVotesByUser().then(function(e){p.cvotes=e,T()})}function N(){if(p.canswers4rank=[],p.isLoggedIn){L();for(var e=0;e<p.editvotes.length;e++)if(p.editvotes[e].category==p.cCategory.id){var t=p.editvotes[e];p.ceditvotes.push(t)}p.cmrecs_user=[];for(var e=0;e<p.cmrecs.length;e++)p.cmrecs[e].user==p.user.id&&p.cmrecs_user.push(p.cmrecs[e])}}function _(e){we.rankOwner&&e.slug==we.rankOwner.slug&&(p.cCategory=p.oCategory),n.go("answerDetail",{index:e.slug})}function $(){if(p.isLoggedIn){if(!(p.canswers4rank.length>1))return void e.getDialog("answersFew");n.go("match")}else e.getDialog("notLoggedIn")}function B(){if(!p.isLoggedIn)return void e.loginFacebook();if(Oe)return void e.getDialog("answersFull");if(p.cCategory.isGhost){var t={title:p.cCategory.title,type:p.cCategory.type,tags:p.cCategory.tags,keywords:p.cCategory.keywords,question:p.cCategory.question,fimage:p.cCategory.fimage,bc:p.cCategory.bc,fc:p.cCategory.fc,shade:p.cCategory.shade,introtext:p.cCategory.introtext,user:p.cCategory.user,views:0,answers:0,image1url:"../../../assets/images/noimage.jpg",image2url:"../../../assets/images/noimage.jpg",image3url:"../../../assets/images/noimage.jpg",answertags:"",isatomic:1,timestmp:new Date,cat:p.cCategory.cat,nh:p.cCategory.locationId};c.addTable(t).then(function(e){p.DEBUG_MODE&&console.log("table added --- ",e);var a=e.resource[0].id,s=t.title.toLowerCase();s=s.replace(/ /g,"-"),s=s.replace("/","at"),s=s+"-"+a,c.update(a,["slug"],[s]),"Event"==we.type?(p.eventmode="add",n.go("addEvent")):n.go("addAnswer")})}else"Event"==we.type?(p.eventmode="add",n.go("addEvent")):n.go("addAnswer")}function U(){if(p.cCategory.introtext){var e=p.cCategory.introtext.indexOf("++"),t=p.cCategory.introtext.indexOf("--");we.introtext=e>-1&&t>-1?p.cCategory.introtext.substring(e+2,t):p.cCategory.introtext}else we.introtext="This is the rank for "+p.cCategory.title+".  Help shape the ranking by endorsing your favorites!.";if(0!=p.cCategory.owner&&void 0!=p.cCategory.owner)if(we.isCustomRank=!0,11091==p.cCategory.id||11092==p.cCategory.id||11093==p.cCategory.id)we.rankOwner=p.oAnswer;else{var n=p.answers.map(function(e){return e.id}).indexOf(Number(p.cCategory.owner));we.rankOwner=p.answers[n]}var a=0;switch(p.cCategory.type){case"Place":a=0;break;case"Person":a=1;break;case"Event":a=2;break;case"Organization":a=3;break;case"Short-Phrase":a=4;break;case"Activity":a=5;break;case"Establishment":a=6;break;case"Thing":a=7;break;case"PersonCust":a=8;break;case"Simple":a=9}var o=p.typeSchema[a].fields;if(p.fields=o,we.fields=p.fields,we.type=p.cCategory.type,"Event"==we.type?we.isE=!0:we.isE=!1,p.NhImplied=!1,p.NhValue="","Establishment"==p.cCategory.type||"Place"==p.cCategory.type||"Event"==p.cCategory.type)for(var i=p.neighborhoods.concat(p.districts),r=0;r<i.length;r++)if(p.cCategory.title.indexOf(i[r])>-1){p.NhImplied=!0,p.NhValue=i[r];break}if(we.sm)for(var r=0;r<we.fields.length;r++)"cityarea"==we.fields[r].name&&(we.fields[r].isrequired=!1),"upV"==we.fields[r].name&&(we.fields[r].isrequired=!1),"email"==we.fields[r].name&&(we.fields[r].isrequired=!1);if(p.cCategory.isatomic&&p.NhImplied)for(var l=p.cCategory.title.replace(p.NhValue,"San Diego"),c=0;c<p.content.length;c++)p.content[c].title==l&&(we.hasParent=!0,we.parentRank=p.content[c],C.pulldata("ranks",[we.parentRank]));p.canswers=[];var d=[];p.ccatans=[],p.B=[];var u={},g={};if(De&&void 0==p.fanswers){for(var n=0,m=!1,h={},f=p.foodans.cats.split(":").map(Number),v=0;v<f.length;v++)if(n=p.answers.map(function(e){return e.id}).indexOf(f[v]),p.answers[n]){if(m=!1,d.length>0&&n>0)for(var c=0;c<d.length;c++)if(d[c].id==p.answers[n].id){m=!0;break}m||(h=p.answers[n],Math.abs(p.currentUserLatitude-p.answers[n].lat)<.0145&&Math.abs(p.currentUserLongitude-p.answers[n].lng)<.0145&&d.push(h))}p.canswers=d,p.fanswers=d}if(!De)for(var r=0;r<xe.length;r++){Ee=p.cCategory.catstr?p.cCategory.catstr.split(":").map(Number):[p.cCategory.id];for(var c=0;c<Ee.length;c++)if(xe[r].category==Ee[c])for(var b=0;b<ke.length;b++)if(xe[r].answer==ke[b].id&&1!=xe[r].isdup)if(g={},g=ke[b],g.catans=xe[r].id,g.catansrank=xe[r].rank,g.upV=xe[r].upV,g.upV=xe[r].upV,g.downV=xe[r].downV,g.catans=xe[r].id,g.rank=xe[r].rank,g.uservote={},g.upVi=xe[r].upV,g.downVi=xe[r].downV,ce(g),"Event"==we.type){if(u=JSON.parse(ke[b].eventstr)){if(se(ke[b],u),s.eventIsCurrent(g,ke[b])){p.canswers.push(g),p.ccatans.push(xe[r]);break}break}}else if(p.isCustomRank&&g.isprivate||!p.isCustomRank&&!g.isprivate){p.canswers.push(g),p.ccatans.push(xe[r]);break}}De&&p.fanswers&&(p.canswers=p.fanswers),we.answers=p.canswers,we.answers.length>we.limit?we.thereIsMore=!0:we.thereIsMore=!1,C.pulldata("answers",p.canswers),p.currentUserLatitude&&p.currentUserLongitude?(we.haveLocation=!0,X()):we.haveLocation=!1;for(var y=new Date,w=y.getDay(),k=!1,v=0;v<we.answers.length;v++){k=!1;for(var r=0;r<p.specials.length;r++)if(we.answers[v].id==p.specials[r].answer){if("weekly"==p.specials[r].freq&&(0==w&&p.specials[r].sun&&(k=!0),1==w&&p.specials[r].mon&&(k=!0),2==w&&p.specials[r].tue&&(k=!0),3==w&&p.specials[r].wed&&(k=!0),4==w&&p.specials[r].thu&&(k=!0),5==w&&p.specials[r].fri&&(k=!0),6==w&&p.specials[r].sat&&(k=!0),k)){we.answers[v].sp_bc=p.specials[r].bc,we.answers[v].sp_fc=p.specials[r].fc,we.answers[v].sp_title=p.specials[r].stitle;break}if("onetime"==p.specials[r].freq&&moment().isBetween(moment(p.specials[r].sdate),moment(p.specials[r].edate),"day","[]")){we.answers[v].sp_bc=p.specials[r].bc,we.answers[v].sp_fc=p.specials[r].fc,we.answers[v].sp_title=p.specials[r].stitle;break}}}p.cmrecs=[];for(var r=0;r<Ae.length;r++)Ae[r].category==p.cCategory.id&&p.cmrecs.push(Ae[r]);if(p.cuseractivity=[],1==p.cCategory.isatomic)for(var r=0;r<Re.length;r++)Re[r].category==p.cCategory.id&&p.cuseractivity.push(Re[r]);else for(var r=0;r<Re.length;r++)for(var v=0;v<Ee.length;v++)if(Re[r].category==Ee[v]){p.cuseractivity.push(Re[r]);break}we.numContributors=p.cuseractivity.length,we.isLoading=!1}function X(){for(var e=.017453292519943295,t=Math.cos,n=0,a=p.currentUserLatitude,s=p.currentUserLongitude,o=0,i=0,r=0,l=0;l<we.answers.length;l++)o=we.answers[l].lat,i=we.answers[l].lng,n=.5-t((o-a)*e)/2+t(a*e)*t(o*e)*(1-t((i-s)*e))/2,r=12742*Math.asin(Math.sqrt(n))/1.609,we.answers[l].dist=r<1?r.toPrecision(2):r.toPrecision(3)}function G(){Oe=!1}function V(){p.isLoggedIn?p.cmrecs_user.length>0?(we.selOverall="",we.selPersonal="active",we.numContributors=1,r.computeRanking(p.canswers,p.cmrecs_user)):e.getDialog("noPersonalRank"):e.getDialog("notLoggedIn")}function F(){we.selOverall="active",we.selPersonal="",we.numContributors=p.cuseractivity.length,r.computeRanking(p.canswers,p.cmrecs)}function Y(){function e(e,t){return e.Rank-t.Rank}we.answers=we.answers.sort(e),J(),p.canswers=we.answers,we.selRank="active",we.selDistance="",we.selUpV="",we.selDate="",we.selTrending="",we.sortByName="Rank",we.showR=!0}function q(){function t(e,t){return e.dist-t.dist}we.haveLocation?(we.answers=we.answers.sort(t),J(),p.canswers=we.answers,we.selRank="",we.selDistance="active",we.selUpV="",we.selDate="",we.selTrending="",De&&(we.answers=we.answers.slice(0,99)),we.sortByName="Distance"):(p.loadRankWhenCoordsRdy=!0,p.rankIsNearMe=!0,e.askPermissionToLocate(),we.sortByName="Distance")}function z(){function e(e,t){return t.upV-t.downV-(e.upV-e.downV)}we.answers=we.answers.sort(e),J(),p.canswers=we.answers,we.selRank="",we.selDistance="",we.selUpV="active",we.selDate="",we.selTrending="",we.sortByName="Popular",De||we.isE||(we.showR=!we.sm)}function j(){function e(e,t){return 0==e.trendUpV&&0==t.trendUpV?t.upV-e.upV:t.trendUpV-e.trendUpV}we.answers=we.answers.sort(e),J(),p.canswers=we.answers,we.selRank="",we.selDistance="",we.selUpV="",we.selDate="",we.selTrending="active",we.sortByName="Trending",De||we.isE||(we.showR=!we.sm)}function W(){function e(e,t){return s.date2number(e.date)-s.date2number(t.date)}we.answers=we.answers.sort(e),J(),p.canswers=we.answers,we.selRank="",we.selDistance="",we.selUpV="",we.selDate="active",we.selTrending="",we.sortByName="Date"}function H(){b.loadComments("category",Ie).then(function(){R.all(Ie.comments.map(function(e){return A.getFBUserById(e.user)})).then(function(e){for(var t=0;t<Ie.comments.length;t++)Ie.comments[t].picture=e[t]?e[t].picture.data.url:null})})}function K(){b.postComment("category",Ie)}function J(){we.image1="/assets/images/noimage.jpg",we.image2="/assets/images/noimage.jpg",we.image3="/assets/images/noimage.jpg",we.answers[0]&&(we.image1=we.answers[0].imageurl),we.answers[1]&&(we.image2=we.answers[1].imageurl),we.answers[2]&&(we.image3=we.answers[2].imageurl)}function Q(){p.cCategory.title.indexOf("@")>-1?n.go("answerDetail",{index:p.cCategory.owner}):n.go("cwrapper")}function Z(){p.addInfoMsgAck=!0,we.hideInfoBox=!0,we.addInfoMsgAck=!0}function ee(){e.getLocation(ne)}function te(){he(),n.go("rankSummary",{index:we.parentRank.id})}function ne(){console.log("emitGetLocation"),p.$emit("getLocation")}function ae(){if(0!=p.cCategory.owner&&void 0!=p.cCategory.owner&&(we.hasAnswerParent=!0),p.isLoggedIn&&we.hasAnswerParent){var e=p.answers.map(function(e){return e.id}).indexOf(Number(p.cCategory.owner)),t=p.answers[e].owner;p.user.id==t&&(we.userIsOwner=!0)}}function se(e,t){e.bc=t.bc,e.fc=t.fc,e.freq=t.freq,e.edate=t.edate,e.sdate=t.sdate,e.etime=t.etime,e.etime2=t.etime2,e.stime=t.stime,e.stime2=t.stime2,e.mon=t.mon,e.tue=t.tue,e.wed=t.wed,e.thu=t.thu,e.fri=t.fri,e.sat=t.sat,e.sun=t.sun}function oe(t){if(p.isLoggedIn)return p.DEBUG_MODE&&console.log("Comment Flagged"),y.flagAnswer("comment-rank",p.cCategory.id,t),void e.getDialog("commentFlagged");e.loginFacebook()}function ie(){we.linkurl=k+"rank"+p.cCategory.id+".html",we.tweet=p.cCategory.title+", endorse your favorite ones at: ";var t=p.cCategory.image1url;"Short-Phrase"==p.cCategory.type&&(t="https://rank-x.com/assets/images/rankxlogosd2_sm.png"),e.shareOptions(re,we.isMobile,we.linkurl,"Rank-X, "+we.ranking+", "+p.cCategory.question+"\n"+t,m)}function re(e){var t=p.cCategory.image1url;switch("Short-Phrase"==p.cCategory.type&&(t="https://rank-x.com/assets/images/rankxlogosd2_sm.png"),e){case"twitter":p.DEBUG_MODE&&console.log(e),w.share({provider:"twitter",attrs:{socialshareUrl:we.linkurl,socialshareText:we.tweet,socialshareHashtags:"rankxsandiego"}});break;case"facebook":p.DEBUG_MODE&&console.log(e),FB.ui({method:"feed",name:p.cCategory.title,link:we.linkurl,picture:t,caption:"Rank-X San Diego",description:p.cCategory.question,message:""});break;case"email":p.DEBUG_MODE&&console.log(e),w.share({provider:"email",attrs:{socialshareSubject:"Rank-X, "+we.ranking,socialshareBody:we.linkurl}});break;case"gplus":p.DEBUG_MODE&&console.log(e),w.share({provider:"google",attrs:{socialshareUrl:we.linkurl,socialshareText:we.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"pinterest":p.DEBUG_MODE&&console.log(e),w.share({provider:"pinterest",attrs:{socialshareUrl:we.linkurl,socialshareText:"Rank-X, "+we.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"tumblr":p.DEBUG_MODE&&console.log(e),w.share({provider:"tumblr",attrs:{socialshareUrl:we.linkurl,socialshareText:"Rank-X, "+we.ranking+", "+p.cCategory.question,socialshareMedia:t}});break;case"reddit":p.DEBUG_MODE&&console.log(e),w.share({provider:"reddit",attrs:{socialshareUrl:we.linkurl,socialshareText:"Rank-X, "+we.ranking,socialshareSubreddit:p.cCategory.question}})}}function le(e){we.mode=e}function ce(e){1==e.dV&&(e.thumbUp="#0070c0",e.thumbDn="#bfbfbf"),0==e.dV&&(e.thumbUp="#bfbfbf",e.thumbDn="#bfbfbf"),-1==e.dV&&(e.thumbUp="#bfbfbf",e.thumbDn="#0070c0")}function de(t,n){if(!p.isLoggedIn)return void e.loginFacebook();switch(t.dV){case-1:t.dV=1,t.upV++,t.downV--;break;case 0:t.dV=1,t.upV++;break;case 1:t.dV=0,t.upV--}1==t.dV&&ue(t),-1!=t.dV&&0!=t.dV||ge(t),ce(t),p.DEBUG_MODE&&console.log("UpVote")}function ue(e){p.canswers4rank.push(e),M()}function ge(e){var t=p.canswers4rank.map(function(e){return e.id}).indexOf(e.id);t>-1&&p.canswers4rank.splice(t,1),M()}function me(t,n){if(!p.isLoggedIn)return void e.loginFacebook();switch(t.dV){case-1:t.dV=0,t.downV--;break;case 0:t.dV=-1,t.downV++;break;case 1:t.dV=-1,t.upV--,t.downV++}-1!=t.dV&&0!=t.dV||ge(t),ce(t),p.DEBUG_MODE&&console.log("DownVote")}function pe(){for(var e=0;e<we.answers.length;e++){we.answers[e].voteRecordExists=!1;for(var t=0;t<p.cvotes.length;t++)if(p.cvotes[t].catans==we.answers[e].catans){we.answers[e].uservote=p.cvotes[t],we.answers[e].uservote.ansvidx=e,we.answers[e].voteRecordExists=!0;break}we.answers[e].voteRecordExists?we.answers[e].dV=we.answers[e].uservote.vote:we.answers[e].dV=0,ce(we.answers[e])}}function he(){if(p.DEBUG_MODE&&console.log("UpdateRecords @answerDetail"),we.answers)for(var e=0;e<we.answers.length;e++){var t=we.answers[e].voteRecordExists,n=!1,s={};try{var o=p.thisuseractivity.map(function(e){return e.category}).indexOf(p.cCategory.id)}catch(e){console.log("Error: ",e),console.log("$rootScope.cCategory - ",p.cCategory);var o=-1}o>=0?(n=!0,s=p.thisuseractivity[o]):n=!1,t&&we.answers[e].uservote.vote!=we.answers[e].dV&&0!=we.answers[e].dV&&(p.DEBUG_MODE&&console.log("UR-1"),v.patchRec(we.answers[e].uservote.id,we.answers[e].dV)),t&&we.answers[e].uservote.vote!=we.answers[e].dV&&0==we.answers[e].dV&&(p.DEBUG_MODE&&console.log("UR-2"),v.deleteRec(we.answers[e].uservote.id),s.votes<2?(p.DEBUG_MODE&&console.log("UR-3"),E.deleteRec(s.id)):(p.DEBUG_MODE&&console.log("UR-4"),E.patchRec(s.id,s.votes-1))),t||0==we.answers[e].dV||(p.DEBUG_MODE&&console.log("UR-5"),v.postRec(we.answers[e].catans,we.answers[e].id,p.cCategory.id,we.answers[e].dV),n?(p.DEBUG_MODE&&console.log("UR-6"),E.patchRec(s.id,s.votes+1)):(p.DEBUG_MODE&&console.log("UR-7"),E.postRec(p.cCategory.id))),we.answers[e].upV==we.answers[e].upVi&&we.answers[e].downV==we.answers[e].downVi||(p.DEBUG_MODE&&console.log("UR-8"),a.updateRec(we.answers[e].catans,["upV","downV"],[we.answers[e].upV,we.answers[e].downV]))}if(we.vrows)for(var e=0;e<we.vrows.length;e++){var i=we.vrows[e].voteExists;i&&we.vrows[e].dVi!=we.vrows[e].dV&&(p.DEBUG_MODE&&console.log("UR-9"),p.cvrowvotes[we.vrows[e].vidx].val=we.vrows[e].dV,d.patchRec(we.vrows[e].voteid,we.vrows[e].dV)),i||0==we.vrows[e].dV||(p.DEBUG_MODE&&console.log("UR-10"),d.postRec(we.vrows[e].id,we.vrows[e].dV)),we.vrows[e].upV==we.vrows[e].upVi&&we.vrows[e].downV==we.vrows[e].downVi||(p.DEBUG_MODE&&console.log("UR-11"),g.updateRec(we.vrows[e].id,["upV","downV"],[we.vrows[e].upV,we.vrows[e].downV]))}}function fe(){e.sortbyHelpDialog()}function ve(){"trends"==p.previousState?n.go("trends"):p.$emit("backToResults")}function be(){we.limit=we.limit+20,ye(we.limit),we.answers.length>we.limit?we.thereIsMore=!0:we.thereIsMore=!1}function ye(e){var t=we.answers.map(function(e){return e.id});t.length>0&&v.loadLastMonthVoting(t.slice(e,e+20)).then(function(e){e.forEach(function(e){var n=t.indexOf(e.answer);we.answers[n].trendUpV++})})}var we=this;we.title="rankSummary",we.addAnswerDisabled="",we.mode="specials",we.answerDetail=_,we.addAnswer=B,we.goRank=$,we.closeRank=Q,we.rankOverall=F,we.rankPersonal=V,we.closeAddInfoMsg=Z,we.whyNoDistance=ee,we.sortByRank=Y,we.sortByDistance=q,we.sortByUpV=z,we.sortByDate=W,we.sortByTrending=j,we.loadComments=H,we.postComment=K,we.cmFlag=oe,we.share=ie,we.changeMode=le,we.UpVote=de,we.DownVote=me,we.sortbyHelpDialog=fe,we.backToResults=ve,we.seeMore=be,we.gotoParentRank=te,we.selOverall="active",we.selPersonal="",we.selRank="active",we.selDistance="",we.commLoaded=!1,we.userIsOwner=!1,we.hasAnswerParent=!1,we.isCustomRank=!1,we.user=p.user,we.loadingAnswers=!1,we.sortByName="",we.searchActive=p.searchActive,we.limit=20;var ke=[],xe=[],Re=[],Ae=[],Ee=[],Oe=!1,Se=!1;we.foodNearMe=!1;var De=!1,Ce=!1;we.fnm=!1;var Ie={};Ie.commLoaded=!1,Ie.initials="",Ie.bc="",Ie.fc="",Ie.comments=[],Ie.newComment="",we.cm=Ie,we.isLoggedIn=void 0!=p.isLoggedIn&&p.isLoggedIn,p.userHasRank=!1,p.userActRecId=0;we.hideInfoBox=!1,p.addInfoMsgAck?we.addInfoMsgAck=p.addInfoMsgAck:we.addInfoMsgAck=!1;var Pe=p.$on("updateVoteTable",function(){Se||L(),Se=!0}),Te=p.$on("rankDataLoaded",function(){I()}),Me=p.$on("coordsRdy",function(){console.log("received coordsreadyrank"),we.haveLocation=!0,X(),O(function(){m.$apply()})}),Le=p.$on("$stateChangeStart",function(e,t,n,a,s){"rankSummary"==a.name&&"rankSummary"!=t.name&&p.isLoggedIn&&he()});m.$on("$destroy",Le),m.$on("$destroy",Pe),m.$on("$destroy",Te),m.$on("$destroy",Me),we.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(we.isMobile=!0),u.innerWidth<512?(we.sm=!0,we.nsm=!1):(we.sm=!1,we.nsm=!0),null!=document.getElementById("SearchInput")&&void 0!=document.getElementById("SearchInput")&&document.getElementById("SearchInput").blur(),window.prerenderReady=!1,p.DEBUG_MODE&&console.log("$rootScope.rankSummaryDataLoaded - ",p.rankSummaryDataLoaded),p.rankSummaryDataLoaded?I():we.dataReady=!1}angular.module("app").controller("rankSummary",e),e.$inject=["dialog","$stateParams","$state","catans","datetime","color","answer","rank","$filter","table","vrowvotes","$window","vrows","$scope","$rootScope","$modal","editvote","votes","commentops","flag","Socialshare","SERVER_URL","$location","$q","fbusers","useractivity","$timeout","table2","categories","dataloader"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l){function c(e){if(!s.isLoggedIn)return void t.loginFacebook();var n={};n.user=s.user.id,n.hs=y.answer1.id,n.ls=y.answer2.id,n.category=s.cCategory.id,n.timestmp=Date.now(),1==e&&(n.sel=y.answer1.id),2==e&&(n.sel=y.answer2.id),D.push(n),s.cmrecs_user.push(n),O++,O>=A&&(O=0),C=!0,g()}function d(){O++,O>=A&&(O=0),g()}function u(){x=s.canswers4rank,R=x.length,A=R*(R-1)/2}function g(){if(y.GP=s.cmrecs_user.length,s.DEBUG_MODE&&console.log("vm.GP - ",y.GP),y.Tot=A,s.cmrecs_user.length>=A)return C?t.getDialog("goodJobRankComplete"):t.getDialog("rankComplete"),void m();if(S)for(var e=w[E[O]],n=k[E[O]],a=!1,o=0;o<s.cmrecs_user.length;o++)if(s.cmrecs_user[o].hs==x[e].id&&s.cmrecs_user[o].ls==x[n].id){a=!0;break}a&&d(),y.answer1=x[w[E[O]]],y.answer2=x[k[E[O]]],v()}function m(){e.go("rankSummary",{index:y.table.id})}function p(t){1===t?e.go("answerDetail",{index:y.answer1.id}):e.go("answerDetail",{index:y.answer2.id})}function h(){w=[],k=[];for(var e=0;e<=R-1;e++)for(var t=e+1;t<=R-1;t++)w.push(e),k.push(t)}function f(){for(var e=0;e<A;e++)E[e]=e;E=function(e){var t,n,a=e.length;if(a)for(;--a;)n=Math.floor(Math.random()*(a+1)),t=e[n],e[n]=e[a],e[a]=t;return e}(E)}function v(){y.fields=s.fields}function b(){e.go("rankSummary",{index:s.cCategory.id})}var y=this;y.title="match",y.header="table"+s.cCategory.id+".header",y.body="table"+s.cCategory.id+".body",y.ranking=s.title;var w=[],k=[],x=[],R=0,A=0,E=[],O=0,S=s.cmrecs_user.length>0,D=[],C=!1;y.table=s.cCategory,y.type=s.cCategory.type,y.answer1,y.answer2,y.selectAnswer=c,y.rankSummary=m,y.skipMatch=d,y.answerDetail=p,y.closeRank=b,l.innerWidth<512?(y.sm=!0,y.nsm=!1):(y.sm=!1,y.nsm=!0),function(){s.$on("$stateChangeSuccess",function(e,t,n,a,o){s.previousState=a.name}),s.$on("$stateChangeStart",function(e,t,n,a,s){"match"==a.name&&D.length>0&&(o.postRec(D),D=[])}),u(),h(),f(),g()}()}angular.module("app").controller("match",e),e.$inject=["$state","dialog","$location","answer","$rootScope","matchrec","$modal","useractivity","$window"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f){function v(){L.rankTitle=t.cCategory.title,L.tags=t.cCategory.tags,L.keywords=t.cCategory.keywords,L.type=t.cCategory.type,L.question=t.cCategory.question,L.answertags=t.cCategory.answertags,L.isatomic=t.cCategory.isatomic,L.catstr=t.cCategory.catstr,L.ismp=t.cCategory.ismp,L.scope=t.cCategory.scope,L.image=t.cCategory.fimage,t.cCategory.bc&&(L.bc=t.cCategory.bc),t.cCategory.fc&&(L.fc=t.cCategory.fc),t.cCategory.shade&&(L.shade=t.cCategory.shade),t.cCategory.bc&&(L.bc2=d.shadeColor(L.bc,L.shade/10)),t.cCategory.fimage&&(L.image=t.cCategory.fimage)}function b(){n.go("cwrapper")}function y(e){1==e&&(L.pixabay=!0,L.pexels=!1),2==e&&(L.pixabay=!1,L.pexels=!0)}function w(){var e=[],n=[],a=[],s=[];if(N.title!=L.rankTitle){var o=t.categories.map(function(e){return e.id}).indexOf(N.cat),i=t.categories[o].category,l=L.rankTitle;if(i.indexOf("@Nh")>-1){var c=t.locations.map(function(e){return e.id}).indexOf(N.nh),d=t.locations[c].nh_name;l=L.rankTitle.replace(d,"@Nh")}a.push("category"),s.push(l),console.log("tablex - ",l),e.push("title"),n.push(l)}N.tags!=L.tags&&(a.push("tags"),s.push(L.tags)),N.keywords!=L.keywords&&(a.push("keywords"),s.push(L.keywords)),
N.type!=L.type&&(a.push("type"),s.push(L.type)),N.question!=L.question&&(a.push("question"),s.push(L.question)),N.catstr!=L.catstr&&(e.push("catstr"),n.push(L.catstr)),N.ismp!=L.ismp&&(a.push("ismp"),s.push(L.ismp)),N.bc!=L.bc&&(a.push("bc"),s.push(L.bc)),N.fc!=L.fc&&(a.push("fc"),s.push(L.fc)),N.shade!=L.shade&&(a.push("shade"),s.push(L.shade)),N.fimage!=L.image&&(a.push("fimage"),s.push(L.image)),N.scope!=L.scope&&(a.push("scope"),s.push(L.scope),e.push("scope"),n.push(L.scope),T(),T()),L.images&&I(),e&&(console.log("fields - ",e,n),r.update(N.id,e,n)),a&&(console.log("fieldsc - ",a,s),m.update(N.cat,a,s)),b()}function k(){l.deleteRank(t.cCategory,x)}function x(){L.image.indexOf("https://rankx.blob")>-1&&i.deleteBlob(L.image),1==t.cCategory.nh&&m.deleteRec(t.cCategory.cat),c.deletebyCategory(t.cCategory.id),r.deleteTable(t.cCategory.id),n.go("cwrapper")}function R(){var e=L.imageQuery.replace(" ","+");L.i=0,L.images=[],L.pixabay&&u.search(e).then(function(e){t.DEBUG_MODE&&console.log("Pixabay results - ",e),L.numResults=e.length;for(var n=0;n<L.numResults;n++)L.images.push(e[n]);L.image=L.images[L.i].previewURL}),L.pexels&&g.search(e).then(function(e){t.DEBUG_MODE&&console.log("Pexels results - ",e),L.numResults=e.length;for(var n=0;n<L.numResults;n++)L.images.push(e[n]);L.image=L.images[L.i].src.small})}function A(){L.i=L.i+1,L.i>L.images.length-1&&(L.i=L.images.length-1),L.pixabay&&(L.image=L.images[L.i].previewURL),L.pexels&&(L.image=L.images[L.i].src.small)}function E(){L.i=L.i-1,L.i<0&&(L.i=0),L.pixabay&&(L.image=L.images[L.i].previewURL),L.pexels&&(L.image=L.images[L.i].src.small)}function O(e){L.c1sel=!1,L.c2sel=!1,L.c3sel=!1,L.c4sel=!1,L.c5sel=!1,L.c6sel=!1,1==e&&(L.c1sel=!0),2==e&&(L.c2sel=!0),3==e&&(L.c3sel=!0),4==e&&(L.c4sel=!0),5==e&&(L.c5sel=!0),6==e&&(L.c6sel=!0),S(e)}function S(e){1==e&&(L.bc="brown",L.fc="#f8f8ff"),2==e&&(L.bc="#4682b4",L.fc="#f8f8ff"),3==e&&(L.bc="#008080",L.fc="#f8f8ff"),4==e&&(L.bc="gray",L.fc="#f8f8ff"),5==e&&(L.bc="#a3297a",L.fc="#f8f8ff"),6==e&&(L.bc="#c68c53",L.fc="#f8f8ff"),L.bc2=d.shadeColor(L.bc,L.shade)}function D(){L.shade=L.shade+1,L.shade>10&&(L.shade=10),L.bc2=d.shadeColor(L.bc,L.shade/10)}function C(){L.shade=L.shade-1,L.shade<-10&&(L.shade=-10),L.bc2=d.shadeColor(L.bc,L.shade/10)}function I(){var e="";if(t.DEBUG_MODE&&console.log("fimage changed"),L.pixabay&&(e=L.images[L.i].webformatURL),L.pexels&&(e=L.images[L.i].src.medium),N.fimage!=e){e.indexOf(".jpeg")>-1&&".jpeg",e.indexOf(".jpg")>-1&&".jpg",e.indexOf(".png")>-1&&".png";var n=t.cCategory.title.toLowerCase();if(n=n.replace(/ /g,"-"),n=n.replace("/","at"),n=n.replace("?",""),N.fimage&&N.fimage.indexOf("https://rankx.blob")>-1)try{i.deleteBlob(N.fimage)}catch(e){console.log("Error deleting existing image: ",e)}var a=t.cCategory.cat;t.DEBUG_MODE&&console.log("Process Image - ",a,e,n),P(e,n,a)}}function P(e,n,a){o({method:"POST",url:"https://server.rank-x.com/ImageServer/SaveImage",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{imageurl:e,filename:n,category:a}}).then(function(e){t.DEBUG_MODE&&console.log("Processing Image Success",e)},function(e){o.defaults.headers.common["X-Dreamfactory-API-Key"]=h,o.defaults.headers.common["X-DreamFactory-Session-Token"]=p.session_token,t.DEBUG_MODE&&console.log("Error Processing Image - ",e)})}function T(){console.log("change Scope of Answres");for(var e=0;e<t.catansrecs.length;e++)if(t.catansrecs[e].category==t.cCategory.id){var n=t.answers.map(function(e){return e.id}).indexOf(t.catansrecs[e].answer);n>-1&&f.updateAnswer(t.catansrecs[e].answer,["scope"],[L.scope])}}function M(){n.go("cwrapper")}var L=this;L.title="editRanking",L.closeRank=b,L.goEdit=w,L.goDelete=k,L.getImages=R,L.plusShade=D,L.minusShade=C,L.selImgBank=y,L.shade=0,L.nextImg=A,L.prevImg=E,L.csel=O,L.goBack=M;var N={};L.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],s.innerWidth<512?(L.sm=!0,L.nsm=!1):(L.sm=!1,L.nsm=!0),function(){t.cCategory={};for(var e=0;e<t.content.length;e++)if(t.content[e].id==a.index||t.content[e].slug==a.index){t.cCategory=t.content[e];break}N=JSON.parse(JSON.stringify(t.cCategory)),console.log("$rootScope.cCategory - ",t.cCategory),L.ranking=t.cCategory.title,t.rankIsActive=!0,t.objNumAct=t.objNum,v(),y(1),t.DEBUG_MODE&&console.log("editRanking page Loaded!")}()}angular.module("app").controller("editRanking",e),e.$inject=["$location","$rootScope","$state","$stateParams","$window","$http","imagelist","table","dialog","catans","color","pixabay","pexels","categories","$cookies","APP_API_KEY","answer"]}(),function(){"use strict";function e(e,t,n){function a(a){if(u()&&!a)return t.when(m);var s=h+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return m=e[0].data.resource,n.DEBUG_MODE&&console.log("No. promoters: ",m.length),m},g)}function s(t){function n(e){return p=e.data.resource}var a=h+"/"+t;return e.get(a).then(n,g)}function o(t){function n(e){return p=e.data.resource}var a=h+"/?filter=user="+t;return e.get(a).then(n,g)}function i(t){function n(e){return p=e.data.resource}var a=h+"/?filter=code="+t;return e.get(a).then(n,g)}function r(t){function n(e){var n=t;return n.id=e.data.resource[0].id,m.push(n),e.data}var a=h,s=[];return s.push(t),e.post(a,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,g)}function l(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating promoter succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)switch(a[l]){case"firstname":r.firstname=s[l];break;case"lastname":r.lastname=s[l];break;case"email":r.email=s[l];break;case"address":r.address=s[l];break;case"phone":r.phone=s[l];break;case"code":r.code=s[l];break;case"stripeid":r.stripeid=s[l]}i.resource.push(r);for(var c=h,d=p.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)switch(a[l]){case"firstname":p[d].firstname=s[l];break;case"lastname":p[d].lastname=s[l];break;case"email":p[d].email=s[l];break;case"address":p[d].address=s[l];break;case"phone":p[d].phone=s[l];break;case"code":p[d].code=s[l];break;case"stripeid":p[d].stripeid=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,g)}function c(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting promote was succesful"),e.data}var s={};s.resource=[];var o={};o.id=promote_id,s.resource.push(o);var i=h+"/"+t,r=m.map(function(e){return e.id}).indexOf(t);return r>-1&&m.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,g)}function d(t){function n(e){return p=e.data.resource}var a=h+"/?filter=code="+t;return e.get(a).then(n,g)}function u(){return m.length>0}function g(e){throw e}var m=[],p={},h="/api/v2/mysql/_table/promoters";return{getall:a,get:s,getbyUser:o,getbyCode:i,add:r,update:l,deletepromoter:c,getbycode:d}}angular.module("app").factory("promoter",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){u.promoter.code=u.code,l(),g&&a.add(u.promoter).then(function(){o.promoterCreated(u.promoter).then(function(){}),s.notificationWithCallback("Success","You have successfully registered as a Promoter. ",r)})}function r(){n.go("promoterconsole")}function l(){g=!0,t.DEBUG_MODE&&console.log("vm.promoter ",u.promoter),u.promoter.firstname.length<1?(s.getDialog("firstnameisinvalid"),g=!1):u.promoter.lastname.length<1?(s.getDialog("lastnameisinvalid"),g=!1):u.promoter.email.length<1||u.promoter.email.indexOf("@")<0?(s.getDialog("emailisinvalid"),g=!1):u.promoter.address.length<5?(s.getDialog("addressisinvalid"),g=!1):u.promoter.phone.length<9?(s.getDialog("phoneisinvalid"),g=!1):u.promoter.code.length<1&&(s.getDialog("missingcode"),g=!1)}function c(){for(var e="",t="",n="abcdefghijklmnopqrstuvwxyz",a="0123456789",s=0;s<5;s++)e+=n.charAt(Math.floor(Math.random()*n.length));for(var s=0;s<3;s++)t+=a.charAt(Math.floor(Math.random()*a.length));u.code=e+t}function d(){s.showTOSPromotersDlg()}var u=this;u.title="promote",u.getcode=c,u.submit=i;var g=!1;!function(){u.promoter={},u.promoter.firstname="",u.promoter.lastname="",u.promoter.phone="",u.promoter.address="",u.promoter.code="",u.promoter.email="",u.code="",t.user?(u.promoter.firstname=t.user.first_name,u.promoter.lastname=t.user.last_name,u.promoter.user=t.user.id):s.getDialog("nologinsignup"),console.log("promote page Loaded!")}(),u.showTOSPromotersDlg=d}angular.module("app").controller("promotersignup",e),e.$inject=["$location","$rootScope","$state","promoter","dialog","mailing"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d){function u(){window.open("https://connect.stripe.com/oauth/authorize?response_type=code&client_id="+l+"&scope=read_write&state="+k.promoter.id,"Stripe Connect","_self")}function g(){t.userpromoter&&1==t.userpromoter.length&&t.userpromoter[0].user==t.user.id?(E=!0,k.promoter=t.userpromoter[0],k.userIsPromoter=!0):(k.userIsPromoter=!1,k.dataReady=!0),k.dataReady||m(),console.log("Promoter console page Loaded!"),console.log("vm.dataReady - ",k.dataReady)}function m(){var e=0,n=0,a={};!k.dataReady&&E&&s.getaccntsbycode(t.userpromoter[0].code).then(function(s){console.log("resuls -",s);for(var o=0;o<s.length;o++){e=s[o].answer,a={},n=t.answers.map(function(e){return e.id}).indexOf(e),a=angular.copy(s[o]),a.name=t.answers[n].name,a.answerObj=t.answers[n],"Basic"==a.status&&(a.style="background-color:#bfbfbf"),a.istrial?(a.status="On Trial "+Math.ceil(moment.duration(moment(a.discountEndDate)-moment()).asDays())+" Days left",a.style="background-color:#b3b300"):(a.status="Active",a.style="background-color:#009900");for(var i=0;i<t.codeprices.length;i++)if(t.codeprices[i].code==a.bizcat){a.price=t.codeprices[i].price;break}a.totalCommission=0,a.ispremium&&(a.totalCommission+=a.price*k.STRIPE_COMMISSION_PERCENTAGE),a.hasranks&&(a.totalCommission+=a.ranksqty*k.CUSTOM_RANK_PRICE*k.STRIPE_COMMISSION_PERCENTAGE),k.myaccnts.push(a)}k.myaccnts.length>0?k.noAns=!1:k.noAns=!0,k.dataReady=!0,g()})}function p(e){n.go("answerDetail",{index:e.slug})}function h(){n.go("promote")}function f(e){k.manageview=!0,k.business=e,k.overview=!1}function v(){if(1==k.manageview)return k.overview=!0,void(k.manageview=!1);"rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.id}):"answerDetail"==t.previousState?n.go("answerDetail",{index:t.canswer.id}):"addAnswer"==t.previousState?n.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?n.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?n.go("about"):n.go("cwrapper")}function b(){x=["firstname","lastname","email","address","phone"],R=["First Name","Last Name","Email","Address","Phone"],A=[k.promoter.firstname,k.promoter.lastname,k.promoter.email,k.promoter.address,k.promoter.phone],o.editInfo(x,R,A,y)}function y(e){i.update(k.promoter.id,x,e).then(function(){m()})}function w(){n.go("promotersignup")}var k=this;if(k.notifications=[],-1!==a.location.href.indexOf("connectStripe")){"success"==a.location.href.slice(a.location.href.indexOf("connectStripe")).split("=")[1].split("&")[0]?k.notifications.push({message:"You are successfully connected to your Stripe Account",type:"success"}):a.alert(a.location.href.slice(a.location.href.indexOf("message")).split("=")[1].split("&")[0])}var x=[],R=[],A=[];k.title="promoterconsole",k.overview=!0,k.manageview=!0,k.gotoanswer=p,k.gotomanage=f,k.gotoPromotePage=h,k.goBack=v,k.goEdit=b,k.goSignup=w,k.connectStripe=u,k.myaccnts=[],k.noAns=!1,k.manageview=!1,k.dataReady=!1;var E=!1;!function(){d.all([i.getbyUser(t.user.id),c.getSetting()]).then(function(e){t.userpromoter=e[0],k.STRIPE_COMMISSION_PERCENTAGE=e[1].STRIPE_COMMISSION_PERCENTAGE,k.CUSTOM_RANK_PRICE=e[1].CUSTOM_RANK_PRICE,g()})}()}angular.module("app").controller("promoterconsole",e),e.$inject=["$location","$rootScope","$state","$window","useraccnt","dialog","promoter","$location","STRIPE_CLIENT_ID","setting","$q"]}(),function(){"use strict";function e(e,t,n,a){function s(e){1==e&&o.showOne?o.showOne=!1:2==e&&o.showTwo?o.showTwo=!1:3==e&&o.showThree?o.showThree=!1:4==e&&o.showFour?o.showFour=!1:5==e&&o.showFive?o.showFive=!1:6==e&&o.showSix?o.showSix=!1:(o.showOne=!1,o.showTwo=!1,o.showThree=!1,o.showFour=!1,o.showFive=!1,o.showSix=!1,1!=e||o.showOne||(o.showOne=!0),2!=e||o.showTwo||(o.showTwo=!0),3!=e||o.showThree||(o.showThree=!0),4!=e||o.showFour||(o.showFour=!0),5!=e||o.showFive||(o.showFive=!0),6!=e||o.showSix||(o.showSix=!0))}var o=this;o.title="promote",o.show=s,o.showOne=!1,o.showTwo=!1,o.showThree=!1,o.showFour=!1,o.showFive=!1,o.showSix=!1,function(){console.log("promote page Loaded!")}()}angular.module("app").controller("promote",e),e.$inject=["$location","$rootScope","$state","promoter"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f){function v(){if(e.isLoggedIn){e.DEBUG_MODE&&console.log("user is logged in, loading data");var s=t.loadVotesByUser(),o=n.loadEditVotesTable(),i=a.loadVrowVotes(),r=d.getActivitybyUser(),l=g.getbyUser(e.user.id),h=m.get(),f=p.get(),v=t.loadVotesByMyFriends();return u.all([s,o,i,r,l,h,f,v]).then(function(t){e.cvotes=t[0],e.editvotes=t[1],e.cvrowvotes=t[2],e.thisuseractivity=t[3],e.userpromoter=t[4],e.catcodes=t[5],e.codeprices=t[6],e.friends_votes=t[7],w(),c.getDemoData(),e.DEBUG_MODE&&console.log("user promoter - ",e.userpromoter),e.userDataLoaded=!0,e.$emit("userDataLoaded")})}e.DEBUG_MODE&&console.log("user is not logged in, no need to load data"),e.cvotes=[],e.editvotes=[],e.cvrowvotes=[],e.thisuseractivity=[],e.userpromoter=[],e.catcodes=[],e.codeprices=[],e.userDataLoaded=!0,e.$emit("userDataLoaded")}function b(){e.isLoggedIn&&(e.DEBUG_MODE&&console.log("user is logged in, loading loading user accounts data"),s.getuseraccnt().then(function(t){function n(e){i.customer=e.data,y()}if(e.showWarning=!1,e.useraccnts.length>0){for(var a=!0,s="",o=0;o<e.useraccnts.length;o++)if(""!=e.useraccnts[o].email&&(a=!1),void 0!=e.useraccnts[o].stripeid&&""!=e.useraccnts[o].stripeid&&0!=e.useraccnts[o].stripeid){s=f+"dreamfactory-stripe-user/"+e.useraccnts[o].stripeid+"/"+e.useraccnts[o].id;var i=e.useraccnts[o],r={method:"GET",url:s,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}};h(r).then(n,function(e){console.log("Error updating Stripe Invoices - ",e)}),e.DEBUG_MODE&&console.log("Retrieving latest invoice info from Stripe")}e.$emit("userAccountsLoaded"),a?(e.showWarning=!0,e.$emit("showWarning")):e.showWarning=!1}}))}function y(){if(e.isLoggedIn&&e.rankSummaryDataLoaded){e.DEBUG_MODE&&console.log("Syncing useraccnt data to answers");for(var t=0,n=0;n<e.useraccnts.length;n++){var a=[],s=[];t=e.answers.map(function(e){return e.id}).indexOf(e.useraccnts[n].answer),e.answers[t].ispremium!=e.useraccnts[n].ispremium&&(a.push("ispremium"),s.push(e.useraccnts[n].ispremium)),e.answers[t].hasranks!=e.useraccnts[n].hasranks&&(a.push("hasranks"),s.push(e.useraccnts[n].hasranks)),e.answers[t].ranksqty!=e.useraccnts[n].ranksqty&&(a.push("ranksqty"),s.push(e.useraccnts[n].ranksqty)),a.length>0&&o.updateAnswer(e.answers[t].id,a,s)}}}function w(){for(var t=[],n={},a=0;a<e.cvotes.length;a++)n={},n.id=e.cvotes[a].answer,n.answer=e.cvotes[a].answer,t.push(n);c.pulldata("answers",t),e.friendsVotes=!0;for(var s=[],a=0;a<e.friends_votes.length;a++)n={},n.id=e.friends_votes[a].answer,n.answer=e.friends_votes[a].answer,s.push(n);c.pulldata("answers",s)}return{loadUserData:v,loadUserAccount:b}}angular.module("app").service("userdata",e),e.$inject=["$rootScope","votes","editvote","vrowvotes","useraccnt","answer","table2","catans","special","dataloader","useractivity","$q","promoter","categorycode","codeprice","$http","SERVER_URL"]}(),function(){"use strict";function e(e,t,n,a,s){function o(t,n){var a=s+"stripeServer/payPromoter",o={method:"POST",url:a,data:{stripeId:t.stripeid,promoterId:t.id,amount:t.balance*n},headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}};return e(o).then(function(e){return e})}function i(t,n,a){function s(e){var t=v.map(function(e){return e.id}).indexOf(e.data.resource.id);return v.splice(t,1),e}var o=y+"/"+n;return e.delete(o).then(s,f)}function r(t){return e({method:"GET",url:s+"stripeServer/"+t+"/invoices",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return e.data})}function l(){function t(e){return v=e.data.resource}var n=y;return e.get(n).then(t,f)}function c(){function t(e){return h(e.data.resource),v}var a=y+"?filter=(user="+n.user.id+")";return e.get(a).then(t,f)}function d(t){function a(e){return e.data.resource}var s=y+"?filter=(user="+n.user.id+") AND (answer="+t+")";return e.get(s).then(a,f)}function u(t){function n(e){return b=e.data.resource}var a=y+"?filter=(promocode="+t+")";return e.get(a).then(n,f)}function g(t){function a(e){var t=s;return t.id=e.data.resource[0].id,v.push(t),t}var s={};s.user=n.user.id,s.answer=t.id,s.bizcat=p(t.id),s.status="Basic",s.stripeid="0",s.email=n.user.email,s.username=n.user.name;var o={};o.resource=[],o.resource.push(s);var i=y;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,f)}function m(t,a,s){function o(e){return n.$emit("clear-notification-warning"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)switch(a[l]){case"bizcat":r.bizcat=s[l];break;case"email":r.email=s[l];break;case"status":r.status=s[l];break;case"stripeid":r.stripeid=s[l];break;case"ispremium":r.ispremium=s[l];break;case"hasranks":r.hasranks=s[l];break;case"ranksqty":r.ranksqty=s[l];break;case"name":r.name=s[l]}i.resource.push(r);for(var c=y,d=v.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)switch(a[l]){case"bizcat":v[d].bizcat=s[l];break;case"email":v[d].email=s[l];break;case"status":v[d].status=s[l];break;case"stripeid":v[d].stripeid=s[l];break;case"ispremium":v[d].ispremium=s[l];break;case"hasranks":v[d].hasranks=s[l];break;case"ranksqty":v[d].ranksqty=s[l];break;case"name":v[d].name=s[l]}return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,f)}function p(e){for(var t=0,a={},s="",o=0,i=0,r=0;r<n.catansrecs.length;r++)if(n.catansrecs[r].answer==e){t=n.catansrecs[r].category;var l=n.content.map(function(e){return e.id}).indexOf(t);if(l>-1){a=n.content[l];for(var c=0;c<n.catcodes.length;c++)if(a.title.indexOf(n.catcodes[c].category)>-1)if(""==s)s=n.catcodes[c].code;else{for(var d=0;d<n.codeprices.length;d++)n.codeprices[d].code==s&&(o=n.codeprices[d].scale),n.codeprices[d].code==n.catcodes[c].code&&(i=n.codeprices[d].scale);i>o&&(s=n.catcodes[c].code)}}else console.log("Couldnt find rank: ",t)}return s}function h(e){v.length=0,e.forEach(function(e){v.push(e)})}function f(e){throw e}var v=[];n.useraccnts=v;var b=[],y="/api/v2/mysql/_table/useraccnts";return{getuseraccnt:c,getaccntsbycode:u,getuseraccntans:d,getallaccnts:l,adduseraccnt:g,updateuseraccnt:m,getuseraccntInvoicesAndCustomer:r,deleteAccount:i,payPromoter:o,getBizCat:p}}angular.module("app").factory("useraccnt",e),e.$inject=["$http","$q","$rootScope","login","SERVER_URL"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c){function d(){return b.loginWithFacebook().then(function(e){return l.login("public_profile,email,user_friends").then(function(e){if("connected"===e.status)return l.api("/me?fields=id,name,picture,first_name,last_name,gender,age_range,locale,email")}).then(function(e){return a.DEBUG_MODE&&console.log("My info: ",e),a.user=e,l.api("me/friends?fields=first_name,gender,locale,last_name,email,picture")}).then(function(e){a.DEBUG_MODE&&console.log("Got friends: ",e),a.user.friends=e,a.isLoggedIn=!0,c.addFBUser(a.user);try{window.localStorage.user=JSON.stringify(a.user)}catch(e){}a.DEBUG_MODE&&console.log("oauthWithFacebook succesful"),a.$emit("redirectAfterLogin")}).catch(function(e){console.log(e)})})}function u(t){return console.log("login/services/login.svc.js:initiate"),e.post("/api/v2/user/session",t).then(function(t){e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,n.session_token=t.data.session_token,a.user=t.data;try{window.localStorage.user=JSON.stringify(t.data)}catch(e){}})}function g(){a.DEBUG_MODE&&console.log("@loginWithFacebook");var e="",i=0,r=0;e=void 0==a.stateName?o.current.name:a.stateName,void 0==a.stateName?("rankSummary"==e&&(i=a.cCategory.id),"answerDetail"==e&&(i=a.canswer.id)):i=a.stateNum,r=void 0!=a.cCategory?a.cCategory.id:void 0,n.put("statename",e),n.put("statenum",i),n.put("ccategory",r);var l=t.defer(),c=s+"/api/v2/user/session?service=facebook";return l.resolve({url:c}),l.promise}function m(t){function s(t){console.log("oauth results",t),e.defaults.headers.common["X-DreamFactory-Session-Token"]=t.data.session_token,n.session_token=t.data.session_token,a.user=t.data,a.isLoggedIn=!0;try{window.localStorage.user=JSON.stringify(t.data)}catch(e){}a.DEBUG_MODE&&console.log("oauthWithFacebook succesful"),a.$emit("redirectAfterLogin")}return a.DEBUG_MODE&&console.log("@oauthWithFacebook - ",t),e.post("/api/v2/user/session?oauth_callback=true&service=facebook&"+t).then(s,h)}function p(){return e.delete("/api/v2/user/session").then(function(t){delete e.defaults.headers.common["X-DreamFactory-Session-Token"],n.remove("session_token"),delete a.user,a.isLoggedIn=!1,a.isAdmin=!1,a.dataAdmin=!1,a.$emit("adminCredentials");try{window.localStorage.removeItem("user")}catch(e){}})}function h(e){throw console.log("error",e),e}function f(t){return console.log("options",t),e.post("/api/v2/user/register?login=true",t).then(function(e){console.log("register result",e)},function(e){console.log("error",e)})}function v(){a.isLoggedIn=!0;var e=new Object;e.age_range={min:21},e.first_name="Test",e.friends={data:[{first_name:"John",gender:"male",id:"362411340826490",last_name:"Carter",locale:"en_US",picture:{data:{is_silhouette:!1,url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/18034179_362408994160058_2814191765613662934_n.jpg?oh=03f00905624bc37bc3f57b76148a44aa&oe=59BC08B8"}}},{first_name:"John",gender:"male",id:"398314100568945",last_name:"Will",locale:"en_US",picture:{data:{is_silhouette:!1,url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/14915696_288291968237826_1651783963192855784_n.jpg?oh=18bee38eafb63165ac9ecf37d649d8ee&oe=597C137F"}}}],summary:{}},e.gender="male",e.id="187959328383879",e.email="roy.smith0820@gmail.com",e.last_name="User",e.locale="us_EN",e.name="Test User",e.picture={data:{url:"https://scontent.xx.fbcdn.net/v/t1.0-1/p50x50/18057110_194133167766495_4123816583005617544_n.jpg?oh=7dc367a88a4d28f4f84137f9007f847e&oe=59836C25"}},a.isAdmin=!0,e.is_sys_admin=!0,n.session_token=e.session_token,a.user=e;try{return window.localStorage.user=JSON.stringify(e),{email:e.email,first_name:e.first_name,host:e.host,id:e.id,is_sys_admin:e.is_sys_admin,last_login_date:e.last_login_date,last_name:e.last_name,name:e.name,role:e.role,role_id:e.role_id,session_id:e.session_id,session_token:e.session_token}}catch(e){}}var b={initiate:u,loginWithFacebook:g,oauthWithFacebook:m,register:f,logout:p,setFakeLocalUser:v,facebookSDKLogin:d};return b}angular.module("app").factory("login",e),e.$inject=["$http","$q","$cookies","$rootScope","INSTANCE_URL","$state","$location","$window","$facebook","fbusers"]}(),function(){"use strict";angular.module("login",["ngResource","ngCookies","ui.router"]).run(["$rootScope",function(e){try{e.user=JSON.parse(window.localStorage.user),e.user&&(e.isLoggedIn=!0),e.user.is_sys_admin&&(e.isAdmin=!0)}catch(e){}}]).config(function(){})}(),function(){"use strict";function e(e,t,n,a){function s(e){return e.url.indexOf("/api/v2")>-1&&(e.url=a+e.url),e.url.indexOf("api.instagram.com")>-1&&(e.headers.useXDomain=!0,e.headers.common="Content-Type: application/json",delete e.headers.common["X-Requested-With"],delete e.headers["X-DreamFactory-Session-Token"],delete e.headers["X-Dreamfactory-API-Key"]),"post"===e.method.toLowerCase()&&e.url.indexOf("/api/v2/user/session")>-1&&delete e.headers["X-DreamFactory-Session-Token"],e}function o(n){return 302==n.status?(e.path("/login"),t.reject(n)):((401===n.status||403===n.status&&n.data.error.message.indexOf("token")>-1)&&e.path("/login"),t.reject(n))}return{request:s,responseError:o}}angular.module("login").factory("httpInterceptor",e),e.$inject=["$location","$q","$injector","INSTANCE_URL"]}(),function(){"use strict";function e(e,t,n){function a(){console.log("register",a),n.register({email:o.username,password:o.password,first_name:o.firstName||"Address",last_name:o.lastName||"Book"}).then(function(){e.path("/bizlogin")},function(e){o.message=e.Message,console.log("Error: ",e)})}function s(){e.path("/bizlogin")}var o=this;o.title="register",o.username="",o.password="",o.confirm="",o.firstName="",o.lastName="",o.message="",o.register=a,o.signIn=s,function(){t.isLoggedIn=!1}()}angular.module("login").controller("register",e),e.$inject=["$location","$rootScope","login"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d){function u(){a.facebookSDKLogin()}function g(){console.log("submit"),a.initiate({email:b.username,password:b.password}).then(function(){n.isLoggedIn=!0,console.log("isLoggedIn",n.isLoggedIn),e.path("/")})}function m(){var e=i.get("statename"),t=i.get("statenum");"rankSummary"==e||"answerDetail"==e?o.go(e,{index:t}):o.go("cwrapper")}function p(){a.loginWithFacebook().then(function(e){console.log("result @loginWithFacebook - ",e),t.location=e.url})}function h(){e.path("/register")}function f(){o.go("cwrapper")}function v(){s.getDialog("whyFacebook")}var b=this;b.title="login",b.username="",b.password="",b.code="",b.isProgressing=!1,b.submit=g,b.register=h,b.redirectForFacebook=p,b.whyFacebookDialog=v,b.facebookLogin=u,b.goBack=f,n.$on("redirectAfterLogin",function(){m()}),n.isLoggedIn&&o.go("cwrapper")}angular.module("login").controller("login",e),e.$inject=["$location","$window","$rootScope","login","dialog","$state","$cookies","$http","$facebook","fbusers","InstagramService"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(){console.log("bizlogin - submit"),a.initiate({email:l.username,password:l.password}).then(function(){n.isLoggedIn=!0,console.log("isLoggedIn",n.isLoggedIn),i.go("cwrapper",{},{location:"replace"})})}var l=this;l.title="bizlogin",l.username="",l.password="",l.code="",l.isProgressing=!1,l.submit=r,function(){var e=location.search,t=e.lastIndexOf("?");t>=0&&(e=e.substr(t+1)),e&&(l.isProgressing=!0,a.oauthWithFacebook(e).then(function(e){n.isLoggedIn=!0,console.log("isLoggedIn",n.isLoggedIn),i.go("cwrapper",{},{location:"replace"})},function(){l.isProgressing=!1})),console.log("vm.code bizlogin --",l.code),n.isLoggedIn=!1}()}angular.module("login").controller("bizlogin",e),e.$inject=["$location","$window","$rootScope","login","dialog","userDetail","$state"]}(),angular.module("app").directive("userDetailModal",["$rootScope","userDetail","dialog",function(e,t,n){"use strict";return{restrict:"E",templateUrl:"app/login/partials/add-user-detail.html",link:function(a,s,o,i){a.maxDate=moment().format("YYYY-MM-DD"),e.openUserDetailModal=function(){e.user&&(e.user.gender="Male",e.user.birth_date=""),openModal("#addUserDetailModal")},e.addUserDetail=function(){t.addUserDetail().then(function(n){t.getUserDetail().then(function(t){if(0==Object.keys(t).length)e.openUserDetailModal();else{e.user.age=calculateAge(new Date(t[0].birth_date)),e.user.gender=t[0].gender,e.user.birth_date=t[0].birth_date;try{window.localStorage.user=JSON.stringify(e.user)}catch(e){}}}),closeModal("#addUserDetailModal")})},e.whyThisInfoDialog=function(){n.getDialog("whyUserData")},e.user&&(e.user.birth_date&&e.user.gender||e.openUserDetailModal())}}}]),function(){"use strict";function e(e,t,n){function a(e,t){"#"!=e.charAt(0)&&("red"==e?e="#ff0000":"black"==e?e="#000000":"grey"==e||"gray"==e?e="#808080":"lightgrey"==e||"lightgray"==e?e="#d3d3d3":"darkgrey"==e||"darkgray"==e?e="#a9a9a9":"green"==e?e="#008000":"brown"==e?e="#a52a2a":"blue"==e?e="#0000ff":"white"==e?e="#ffffff":console.log("Dont know what color is ",e));var n=parseInt(e.slice(1),16),a=t<0?0:255,s=t<0?-1*t:t,o=n>>16,i=n>>8&255,r=255&n;return"#"+(16777216+65536*(Math.round((a-o)*s)+o)+256*(Math.round((a-i)*s)+i)+(Math.round((a-r)*s)+r)).toString(16).slice(1)}function s(e){var t,n,a,s,i,r,l,c,d;return c=e.match(/hsla?\((.+?)\)/)[1].split(",").map(function(e){return e.trim(),parseFloat(e)}),a=c[0],d=c[1],s=c[2],c[3],a/=360,d/=100,s/=100,0===d?l=n=t=s:(r=s<.5?s*(1+d):s+d-s*d,i=2*s-r,l=o(i,r,a+1/3),n=o(i,r,a),t=o(i,r,a-1/3)),"#"+Math.round(255*l).toString(16)+Math.round(255*n).toString(16)+Math.round(255*t).toString(16)}function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function i(e){var t="",n="";return void 0!=e.tags&&null!=e.tags||(e.tags=""),e.tags.indexOf("food")>-1?(t="brown",n="#f8f8ff"):e.tags.indexOf("lifestyle")>-1?(t="#008080",n="#f8f8ff"):e.tags.indexOf("social")>-1?(t="#4682b4",n="#f8f8ff"):e.tags.indexOf("city")>-1?(t="gray",n="#f8f8ff"):e.tags.indexOf("neighborhood")>-1?(t="gray",n="#f8f8ff"):e.tags.indexOf("politics")>-1?(t="#595959",n="#f8f8ff"):e.tags.indexOf("sports")>-1?(t="#4682b4",n="#f8f8ff"):e.tags.indexOf("beauty")>-1?(t="#a3297a",n="#f8f8ff"):e.tags.indexOf("health")>-1?(t="green",n="#f8f8ff"):e.tags.indexOf("services")>-1?(t="#c68c53",n="#f8f8ff"):e.tags.indexOf("technology")>-1?(t="gray",n="#f8f8ff"):e.tags.indexOf("dating")>-1?(t="#b22222",n="#f8f8ff"):e.tags.indexOf("personalities")>-1?(t="#c68c53",n="#f8f8ff"):(t="gray",n="#f8f8ff"),[t,n]}return{shadeColor:a,hsl2rgb:s,hue2rgb:o,defaultRankColor:i}}angular.module("app").factory("color",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(n){function a(e){return i=e.data.resource}if(s()&&!n)return t.when(i);var l=r;return e.get(l).then(a,o)}function s(){return i.length>0}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/cities";return{getCities:a}}angular.module("app").factory("city",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("citySelectionModal",["$rootScope",function(e){"use strict";return{restrict:"E",templateUrl:"app/layout/Partials/city-selection.html",link:function(t,n,a,s){e.selectedCity=JSON.parse(window.localStorage.selectedCity)}}}]),function(){"use strict";function e(e,t,n,a){}angular.module("app").controller("trends",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t){function n(){"rankSummary"==t.previousState?e.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?e.go("answerDetail",{index:t.canswer.slug}):"addAnswer"==t.previousState?e.go("addAnswer",{index:t.canswer.slug}):"editAnswer"==t.previousState?e.go("editAnswer",{index:t.canswer.slug}):"about"==t.previousState?e.go("about"):e.go("cwrapper")}var a=this;a.title="Promoter Terms of Service",a.goBack=n,function(){console.log("Promoter Terms of Service page Loaded!")}()}angular.module("app").controller("promotertos",e),e.$inject=["$state","$rootScope"]}(),function(){"use strict";function e(e,t){function n(){"rankSummary"==t.previousState?e.go("rankSummary",{index:t.cCategory.id}):"answerDetail"==t.previousState?e.go("answerDetail",{index:t.canswer.id}):"addAnswer"==t.previousState?e.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?e.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?e.go("about"):(t.$emit("backToResults"),e.go("cwrapper"))}var a=this;a.title="privacypolicy",a.goBack=n,function(){console.log("privacypolicy page Loaded!")}()}angular.module("app").controller("privacypolicy",e),e.$inject=["$state","$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g){function m(){n.$emit("hideBar"),$(".navbar-collapse").collapse("hide"),s.go("mybusiness"),$(".navbar-collapse").collapse("hide")}function p(){n.$emit("hideBar"),$(".navbar-collapse").collapse("hide"),s.go("favs")}function h(){n.$emit("hideBar"),$(".navbar-collapse").collapse("hide"),
s.go("promoterconsole"),$(".navbar-collapse").collapse("hide")}function f(){n.$emit("hideBar"),$(".navbar-collapse").collapse("hide"),s.go("about")}function v(){s.go("fileuploadtest")}function b(){n.$emit("hideBar"),$(".navbar-collapse").collapse("hide"),s.go("admin")}function y(){n.fbmode=!0,s.go("cwrapper",{},{reload:!0})}function w(){d.tour(),$(".navbar-collapse").collapse("hide")}function k(){d.getDialog("onlySanDiego")}function x(){n.$emit("backToResults")}function R(){s.go("customer")}function A(){n.stateName=s.current.name,"rankSummary"==n.stateName?n.stateNum=n.cCategory.id:"answerDetail"==n.stateName?n.stateNum=n.canswer.id:n.stateNum=void 0,s.go("login")}function E(){a.logout().then(function(){N.user="",N.isLoggedIn=!1,N.hasBusiness=!1,N.isPromoter=!1,localStorage.clear(),n.$emit("backToResults"),n.$emit("userLoggedOut")})}function O(){openModal("#selectCityModal")}function S(e){n.DEBUG_MODE&&console.log("position.coords.latitude - ",e.coords.latitude),n.DEBUG_MODE&&console.log("position.coords.longitude - ",e.coords.longitude),n.currentUserLatitude=e.coords.latitude,n.currentUserLongitude=e.coords.longitude,r.put("currentUserLatitude",n.currentUserLatitude),r.put("currentUserLongitude",n.currentUserLongitude),n.coordsRdy=!0,T(),n.loadFbnWhenCoordsRdy&&s.go("rankSummary",{index:11942}),n.isLoggedIn&&(n.user.latitude=n.currentUserLatitude,n.user.longitude=n.currentUserLongitude,n.DEBUG_MODE&&console.log("Geo Location is set for logged in user.")),n.DEBUG_MODE&&console.log("Geo Location is set for user."),"rankSummary"==s.current.name&&n.$emit("coordsRdy")}function D(){n.DEBUG_MODE&&console.log("@autoDetectCity"),geolocator.locate(_,function(e,t){e?(n.DEBUG_MODE&&console.log("Error getting geolocation - ERROR("+e.code+"): "+e.message),d.getDialog("errorGettingGeolocation")):(n.DEBUG_MODE&&console.log(t),S(t))})}function C(){geolocator.config({language:"en",google:{version:"3",key:c}}),_={enableHighAccuracy:!0,timeout:1e4,maximumWait:1e4,maximumAge:0,desiredAccuracy:30,fallbackToIP:!0}}function I(){N.warning=!0}function P(){N.warning=!1}function T(){N.coordsRdy=!0}function M(){var e=n.answers.map(function(e){return e.id}).indexOf(n.useraccnts[0].answer);d.askEmail(n.answers[e].name)}function L(){d.askPermissionToLocate()}var N=this;N.title="navbar",N.user=n.user,N.isLoggedIn=!!n.isLoggedIn&&n.isLoggedIn,N.logout=E,N.goToLogin=A,N.gotoAbout=f,N.gotomybusiness=m,N.gotofavs=p,N.gotoFeedback=y,N.gotoTour=w,N.gotoHome=x,N.selCity=k,N.gotoAdmin=b,N.goPromoterConsole=h,N.gotoFileUpload=v,N.gotoCustomer=R,N.openCitySelection=O,N.goWarning=M,N.goCoords=L,N.isAdmin=n.isAdmin||n.dataAdmin,void 0==n.coordsRdy&&(n.coordsRdy=!1),n.loadFbnWhenCoordsRdy=!1;var _={};N.warning=!1;var B=n.$on("getLocation",function(e){D()}),U=n.$on("coordsRdy",function(e){T()}),X=n.$on("adminCredentials",function(e){N.isAdmin=n.isAdmin||n.dataAdmin}),G=n.$on("showWarning",function(e){n.DEBUG_MODE&&console.log("rx showWarning"),I()}),V=n.$on("hideWarning",function(e){n.DEBUG_MODE&&console.log("rx clearWarning"),P()}),F=n.$on("useAddress",function(e,t){var a={};a.location=t.address,a.lat=0,a.lng=0,n.coordForUSer=!0,u.getLocationGPS(a)}),Y=n.$on("userDataLoaded",function(e){n.isLoggedIn?(N.isPromoter=!0,n.isPromoter=!0,n.DEBUG_MODE&&console.log("User is promoter")):(n.isPromoter=!1,N.isPromoter=!1)}),q=n.$on("userAccountsLoaded",function(e){n.isLoggedIn&&n.useraccnts.length>0?(N.hasBusiness=!0,n.hasBusiness=!0,n.DEBUG_MODE&&console.log("User has business")):(n.hasBusiness=!1,N.hasBusiness=!1)});o.$on("$destroy",B),o.$on("$destroy",U),o.$on("$destroy",X),o.$on("$destroy",G),o.$on("$destroy",V),o.$on("$destroy",F),o.$on("$destroy",Y),o.$on("$destroy",q),function(){void 0==n.hasBusiness?N.hasBusiness=!1:N.hasBusiness=n.hasBusiness,void 0==n.isPromoter?N.isPromoter=!1:N.isPromoter=n.isPromoter,n.showWarning&&I(),C(),N.coordsRdy=n.coordsRdy,n.DEBUG_MODE&&console.log("Navbar Loaded!")}(),n.getCurrentPositionOfUser=function(){geolocator.locate(_,function(e,t){e?(n.DEBUG_MODE&&console.log("Error getting geolocation - ERROR("+e.code+"): "+e.message),d.getDialog("errorGettingGeolocation")):(n.DEBUG_MODE&&console.log(t),S(t))})}}angular.module("app").controller("navbar",e),e.$inject=["$location","$translate","$rootScope","login","$state","$scope","city","$cookies","$http","GOOGLE_API_KEY","dialog","getgps","useraccnt"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(e,t){i.showAllFriendsListDlg(e,t)}function l(){for(var e=0;e<t.headlines.length;e++)if("food"==t.headlines[e].type){v.bgc1=t.headlines[e].bc,v.fc1=t.headlines[e].fc,v.headline1=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("lifestyle"==t.headlines[e].type){v.bgc2=t.headlines[e].bc,v.fc2=t.headlines[e].fc,v.headline2=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("services"==t.headlines[e].type){v.bgc3=t.headlines[e].bc,v.fc3=t.headlines[e].fc,v.headline3=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("health"==t.headlines[e].type){v.bgc4=t.headlines[e].bc,v.fc4=t.headlines[e].fc,v.headline4=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("beauty"==t.headlines[e].type){v.bgc5=t.headlines[e].bc,v.fc5=t.headlines[e].fc,v.headline5=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("social"==t.headlines[e].type){v.bgc6=t.headlines[e].bc,v.fc6=t.headlines[e].fc,v.headline6=t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("family"==t.headlines[e].type){v.bgc7=t.headlines[e].bc,v.fc7=t.headlines[e].fc,v.headline7=t.headlines[e].title;break}}function c(){var e={},n={};v.foodans=[],v.lifestyleans=[],v.servicesans=[],v.healthans=[],v.beautyans=[],v.socialans=[],v.familyans=[];for(var a=0;a<t.friends_votes.length;a++)if(1==t.friends_votes[a].vote){var s=t.answers.map(function(e){return e.id}).indexOf(t.friends_votes[a].answer);if(e=t.answers[s],s>-1&&"Establishment"==e.type)for(var o=0;o<t.catansrecs.length;o++)if(t.catansrecs[o].answer==e.id){var i=t.content.map(function(e){return e.id}).indexOf(t.catansrecs[o].category);if(!(n=t.content[i]))continue;(n.title.indexOf("food")>-1||n.tags.indexOf("food")>-1)&&g(v.foodans,e,a),(n.title.indexOf("lifestyle")>-1||n.tags.indexOf("lifestyle")>-1)&&g(v.lifestyleans,e,a),(n.title.indexOf("services")>-1||n.tags.indexOf("services")>-1)&&g(v.servicesans,e,a),(n.title.indexOf("health")>-1||n.tags.indexOf("health")>-1)&&g(v.healthans,e,a),(n.title.indexOf("beauty")>-1||n.tags.indexOf("beauty")>-1)&&g(v.beautyans,e,a),(n.title.indexOf("social")>-1||n.tags.indexOf("social")>-1)&&g(v.socialans,e,a),(n.title.indexOf("family")>-1||n.tags.indexOf("family")>-1)&&g(v.familyans,e,a)}}v.foodans.length>5&&(v.cb1gt5=!0),v.lifestyleans.length>5&&(v.cb2gt5=!0),v.servicesans.length>5&&(v.cb3gt5=!0),v.healthans.length>5&&(v.cb4gt5=!0),v.beautyans.length>5&&(v.cb5gt5=!0),v.socialans.length>5&&(v.cb6gt5=!0),v.familyans.length>5&&(v.cb7gt5=!0),v.foodans.length>0?v.answerExist1=!0:v.answerExist1=!1,v.lifestyleans.length>0?v.answerExist2=!0:v.answerExist2=!1,v.servicesans.length>0?v.answerExist3=!0:v.answerExist3=!1,v.healthans.length>0?v.answerExist4=!0:v.answerExist4=!1,v.beautyans.length>0?v.answerExist5=!0:v.answerExist5=!1,v.socialans.length>0?v.answerExist6=!0:v.answerExist6=!1,v.familyans.length>0?v.answerExist7=!0:v.answerExist7=!1,0==v.foodans.length&&0==v.servicesans.length&&0==v.lifestyleans.length&&0==v.healthans.length&&0==v.beautyans.length&&0==v.socialans.length&&0==v.familyans.length&&(v.noAns=!0)}function d(e){for(var n=0;n<t.specials.length;n++)if(e.id==t.specials[n].answer&&"weekly"==t.specials[n].freq&&(0==y&&t.specials[n].sun&&(w=!0),1==y&&t.specials[n].mon&&(w=!0),2==y&&t.specials[n].tue&&(w=!0),3==y&&t.specials[n].wed&&(w=!0),4==y&&t.specials[n].thu&&(w=!0),5==y&&t.specials[n].fri&&(w=!0),6==y&&t.specials[n].sat&&(w=!0),w)){e.sp_bc=t.specials[n].bc,e.sp_fc=t.specials[n].fc,e.sp_title=t.specials[n].stitle;break}}function u(e,n){for(var a=0;a<t.user.friends.data.length;a++)if(n.user==t.user.friends.data[a].id)return t.user.friends.data[a]}function g(e,n,a){var s=e.map(function(e){return e.id});if(-1==s.indexOf(n.id)){var o=angular.copy(n);d(o),o.trackID=o.id+""+t.friends_votes[a].id,o.userObjs=[];var i=u(o,t.friends_votes[a]);o.userObjs.push(i),e.push(o)}else{var o=e[s.indexOf(n.id)],i=u(o,t.friends_votes[a]);m(o,i)}}function m(e,t){-1==e.userObjs.map(function(e){return e.id}).indexOf(t.id)&&e.userObjs.push(t)}function p(e,a){switch(t.myfavs={},e){case 1:t.canswers=v.foodans,t.myfavs.title="My Food";break;case 2:t.canswers=v.lifestyleans,t.myfavs.title="My Lifestyle";break;case 3:t.canswers=v.servicesans,t.myfavs.title="My Services";break;case 4:t.canswers=v.healthans,t.myfavs.title="My Health";break;case 5:t.canswers=v.beautyans,t.myfavs.title="My Beauty";break;case 6:t.canswers=v.socialans,t.myfavs.title="My Social";break;case 7:t.canswers=v.familyans,t.myfavs.title="My Family"}n.go("answerDetail",{index:a.slug})}function h(e){1==e&&(5==v.maxRes1?(v.btext1="See less",v.maxRes1=100):(v.btext1="See more",v.maxRes1=5)),2==e&&(5==v.maxRes2?(v.btext2="See less",v.maxRes2=100):(v.btext2="See more",v.maxRes2=5)),3==e&&(5==v.maxRes3?(v.btext3="See less",v.maxRes3=100):(v.btext3="See more",v.maxRes3=5)),4==e&&(5==v.maxRes4?(v.btext4="See less",v.maxRes4=100):(v.btext4="See more",v.maxRes4=5)),5==e&&(5==v.maxRes5?(v.btext5="See less",v.maxRes5=100):(v.btext5="See more",v.maxRes5=5)),6==e&&(5==v.maxRes6?(v.btext6="See less",v.maxRes6=100):(v.btext6="See more",v.maxRes6=5)),7==e&&(5==v.maxRes7?(v.btext7="See less",v.maxRes7=100):(v.btext7="See more",v.maxRes7=5))}function f(){"rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.slug}):n.go("cwrapper")}var v=this;v.title="myfriends",v.goBack=f,v.answerDetail=p,v.seeMore=h,v.showAllFriendsList=r,o.$parent.$parent.$parent.seo={pageTitle:"My Friends' Favourite",metaDescription:"RankX lets you see your friends' favorite food, lifestyle, health, beauty and services."};var b=new Date,y=b.getDay(),w=!1;v.noAns=!1,v.friendsDataLoading=!0,v.maxRes1=5,v.btext1="See more",v.maxRes2=5,v.btext2="See more",v.maxRes3=5,v.btext3="See more",v.maxRes4=5,v.btext4="See more",v.maxRes5=5,v.btext5="See more",v.maxRes6=5,v.btext6="See more",v.maxRes7=5,v.btext7="See more",v.cb1gt5=!1,v.cb2gt5=!1,v.cb3gt5=!1,v.cb4gt5=!1,v.cb5gt5=!1,v.cb6gt5=!1,v.cb7gt5=!1,function(){l(),t.friendsVotes?c():s.loadVotesByMyFriends().then(function(e){t.friends_votes=e,c()})}()}angular.module("app").controller("myfriends",e),e.$inject=["$location","$rootScope","$state","$window","votes","$scope","dialog"]}(),function(){"use strict";function e(e,t,n,a,s){function o(){for(var e=0;e<t.headlines.length;e++)if("food"==t.headlines[e].type){u.bgc1=t.headlines[e].bc,u.fc1=t.headlines[e].fc,u.headline1="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("lifestyle"==t.headlines[e].type){u.bgc2=t.headlines[e].bc,u.fc2=t.headlines[e].fc,u.headline2="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("services"==t.headlines[e].type){u.bgc3=t.headlines[e].bc,u.fc3=t.headlines[e].fc,u.headline3="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("health"==t.headlines[e].type){u.bgc4=t.headlines[e].bc,u.fc4=t.headlines[e].fc,u.headline4="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("beauty"==t.headlines[e].type){u.bgc5=t.headlines[e].bc,u.fc5=t.headlines[e].fc,u.headline5="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("social"==t.headlines[e].type){u.bgc6=t.headlines[e].bc,u.fc6=t.headlines[e].fc,u.headline6="My "+t.headlines[e].title;break}for(var e=0;e<t.headlines.length;e++)if("family"==t.headlines[e].type){u.bgc7=t.headlines[e].bc,u.fc7=t.headlines[e].fc,u.headline7="My "+t.headlines[e].title;break}}function i(){var e={},n={};u.myfoodans=[],u.mylifestyleans=[],u.myservicesans=[],u.myhealthans=[],u.mybeautyans=[],u.mysocialans=[],u.myfamilyans=[];for(var a=[],s=0;s<t.cvotes.length;s++)if(1==t.cvotes[s].vote){var o=t.answers.map(function(e){return e.id}).indexOf(t.cvotes[s].answer);if(o>-1&&(e=t.answers[o],"Establishment"==e.type))for(var i=0;i<t.catansrecs.length;i++)if(t.catansrecs[i].answer==e.id){var l=t.content.map(function(e){return e.id}).indexOf(t.catansrecs[i].category);if(!(n=t.content[l]))continue;(n.title.indexOf("food")>-1||n.tags.indexOf("food")>-1)&&(a=u.myfoodans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.myfoodans.push(e))),(n.title.indexOf("lifestyle")>-1||n.tags.indexOf("lifestyle")>-1)&&(a=u.mylifestyleans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.mylifestyleans.push(e))),(n.title.indexOf("services")>-1||n.tags.indexOf("services")>-1)&&(a=u.myservicesans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.myservicesans.push(e))),(n.title.indexOf("health")>-1||n.tags.indexOf("health")>-1)&&(a=u.myhealthans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.myhealthans.push(e))),(n.title.indexOf("beauty")>-1||n.tags.indexOf("beauty")>-1)&&(a=u.mybeautyans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.mybeautyans.push(e))),(n.title.indexOf("social")>-1||n.tags.indexOf("social")>-1)&&(a=u.mysocialans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.mysocialans.push(e))),(n.title.indexOf("family")>-1||n.tags.indexOf("family")>-1)&&(a=u.myfamilyans.map(function(e){return e.id}),a.indexOf(e.id)<0&&(r(e),u.myfamilyans.push(e)))}}u.myfoodans.length>5&&(u.cb1gt5=!0),u.mylifestyleans.length>5&&(u.cb2gt5=!0),u.myservicesans.length>5&&(u.cb3gt5=!0),u.myhealthans.length>5&&(u.cb4gt5=!0),u.mybeautyans.length>5&&(u.cb5gt5=!0),u.mysocialans.length>5&&(u.cb6gt5=!0),u.myfamilyans.length>5&&(u.cb7gt5=!0),u.myfoodans.length>0?u.answerExist1=!0:u.answerExist1=!1,u.mylifestyleans.length>0?u.answerExist2=!0:u.answerExist2=!1,u.myservicesans.length>0?u.answerExist3=!0:u.answerExist3=!1,u.myhealthans.length>0?u.answerExist4=!0:u.answerExist4=!1,u.mybeautyans.length>0?u.answerExist5=!0:u.answerExist5=!1,u.mysocialans.length>0?u.answerExist6=!0:u.answerExist6=!1,u.myfamilyans.length>0?u.answerExist7=!0:u.answerExist7=!1,0==u.myfoodans.length&&0==u.myservicesans.length&&0==u.mylifestyleans.length&&0==u.myhealthans.length&&0==u.mybeautyans.length&&0==u.mysocialans.length&&0==u.myfamilyans.length&&(u.noAns=!0)}function r(e){for(var n=0;n<t.specials.length;n++)if(e.id==t.specials[n].answer&&"weekly"==t.specials[n].freq&&(0==m&&t.specials[n].sun&&(p=!0),1==m&&t.specials[n].mon&&(p=!0),2==m&&t.specials[n].tue&&(p=!0),3==m&&t.specials[n].wed&&(p=!0),4==m&&t.specials[n].thu&&(p=!0),5==m&&t.specials[n].fri&&(p=!0),6==m&&t.specials[n].sat&&(p=!0),p)){e.sp_bc=t.specials[n].bc,e.sp_fc=t.specials[n].fc,e.sp_title=t.specials[n].stitle;break}}function l(e,a){switch(t.myfavs={},e){case 1:t.canswers=u.myfoodans,t.myfavs.title="My Food";break;case 2:t.canswers=u.mylifestyleans,t.myfavs.title="My Lifestyle";break;case 3:t.canswers=u.myservicesans,t.myfavs.title="My Services";break;case 4:t.canswers=u.myhealthans,t.myfavs.title="My Health";break;case 5:t.canswers=u.mybeautyans,t.myfavs.title="My Beauty";break;case 6:t.canswers=u.mysocialans,t.myfavs.title="My Social";break;case 7:t.canswers=u.myfamilyans,t.myfavs.title="My Family"}n.go("answerDetail",{index:a.id})}function c(e){1==e&&(5==u.maxRes1?(u.btext1="See less",u.maxRes1=100):(u.btext1="See more",u.maxRes1=5)),2==e&&(5==u.maxRes2?(u.btext2="See less",u.maxRes2=100):(u.btext2="See more",u.maxRes2=5)),3==e&&(5==u.maxRes3?(u.btext3="See less",u.maxRes3=100):(u.btext3="See more",u.maxRes3=5)),4==e&&(5==u.maxRes4?(u.btext4="See less",u.maxRes4=100):(u.btext4="See more",u.maxRes4=5)),5==e&&(5==u.maxRes5?(u.btext5="See less",u.maxRes5=100):(u.btext5="See more",u.maxRes5=5)),6==e&&(5==u.maxRes6?(u.btext6="See less",u.maxRes6=100):(u.btext6="See more",u.maxRes6=5)),7==e&&(5==u.maxRes7?(u.btext7="See less",u.maxRes7=100):(u.btext7="See more",u.maxRes7=5))}function d(){"rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.slug}):t.$emit("backToResults")}var u=this;u.title="myfavs",u.goBack=d,u.answerDetail=l,u.seeMore=c;var g=new Date,m=g.getDay(),p=!1;u.noAns=!1,u.maxRes1=5,u.btext1="See more",u.maxRes2=5,u.btext2="See more",u.maxRes3=5,u.btext3="See more",u.maxRes4=5,u.btext4="See more",u.maxRes5=5,u.btext5="See more",u.maxRes6=5,u.btext6="See more",u.maxRes7=5,u.btext7="See more",u.cb1gt5=!1,u.cb2gt5=!1,u.cb3gt5=!1,u.cb4gt5=!1,u.cb5gt5=!1,u.cb6gt5=!1,u.cb7gt5=!1,function(){t.inFavMode=!0,o(),i(),t.DEBUG_MODE&&console.log("myfavs page Loaded!")}()}angular.module("app").controller("myfavs",e),e.$inject=["$location","$rootScope","$state","$window","dataloader"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g){function m(){n.go("mybusiness",{},{reload:!0})}function p(){G.mybizs=[];for(var e=!1,n={},a=0;a<t.answers.length;a++)if(t.answers[a].owner==t.user.id&&("Establishment"==t.answers[a].type||"PersonCust"==t.answers[a].type)){e=!1,n={},n=t.answers[a];for(var o=0;o<t.useraccnts.length;o++)if(t.useraccnts[o].answer==t.answers[a].id){e=!0,n.status=t.useraccnts[o].status,n.bizcat=t.useraccnts[o].bizcat,n.email=t.useraccnts[o].email,n.accountid=t.useraccnts[o].id,n.stripeid=t.useraccnts[o].stripeid,n.lastPaymentMade=t.useraccnts[o].lastPaymentMade,n.nextPaymentDue=t.useraccnts[o].nextPaymentDue,n.monthlyCost=t.useraccnts[o].monthlyCost,n.isPremium=t.useraccnts[o].ispremium,n.hasRanks=t.useraccnts[o].hasranks,n.ranksQty=t.useraccnts[o].ranksqty,n.stripesub=t.useraccnts[o].stripesub,n.stripesipremium=t.useraccnts[o].stripesipremium,n.stripesiranks=t.useraccnts[o].stripesiranks,n.user=t.useraccnts[o].user,n.firstname=t.user.first_name,n.lastname=t.user.last_name,n.promocode=t.useraccnts[o].promocode,n.isPremium?(n.status="Premium",n.style="background-color:#47d147"):(n.status="Basic",n.style="background-color:#ffffff"),n.hasRanks?(n.status2=n.ranksQty+" Custom Ranks",n.style2="background-color:#47d147"):(n.status2="No Custom Ranks",n.style2="background-color:#ffffff");for(var i=0;i<t.codeprices.length;i++)if(t.codeprices[i].code==n.bizcat){n.price=t.codeprices[i].price;break}break}e||s.adduseraccnt(t.answers[a]),n.loadingInvoices=!0,n.invoices=[],w(n),y(n),G.mybizs.push(n)}0==G.mybizs.length&&(G.noAns=!0)}function h(){G.showInvoices=!G.showInvoices}function f(){G.showInvoices=!1}function v(){G.showPaymentInfo=!G.showPaymentInfo}function b(e){return format(e.getMonth()+1)+"/"+format(e.getDate())+"/"+format(e.getFullYear())}function y(e){e.promocode?l.getbyCode(e.promocode).then(function(t){t.length>=1&&(e.promoterObj=t[0])}):e.promoterObj=void 0}function w(e){-1===[void 0,"","0"].indexOf(e.stripeid)&&s.getuseraccntInvoicesAndCustomer(e.stripeid).then(function(t){var n=angular.copy(t.invoices);e.invoices=n.data.map(function(e){return e.period_end=new Date(1e3*e.period_end),e.date=moment(1e3*e.date).format("YYYY-MM-DD"),e.period_start=new Date(1e3*e.period_start),e.discount?Date.now()>1e3*e.discount.end?e.discountMsg="Trial Ended":e.discountMsg="Trial "+Math.ceil(moment.duration(1e3*e.discount.end-Date.now()).asDays())+" Days left":e.discountMsg="No Discount",e}),e.customer=t.customer,e.loadingInvoices=!1}).catch(function(t){e.invoices=[],console.log("Error getting Stripe Invoices - ",t)})}function k(e){n.go("answerDetail",{index:e.slug})}function x(e){G.showInvoices=!1,G.showPaymentInfo=!1,G.codeMsg="Enter a code and validate it using the 'Check code' button",G.promocode="",G.business=e,G.getRanks=!1,G.getPremium=!1,G.ranksQty=1,G.overview=!1,G.manageview=!0,e.isPremium&&e.hasRanks?G.sell=!1:G.sell=!0,t.DEBUG_MODE&&console.log("vm.business",e)}function R(){return 1==G.manageview?(G.overview=!0,G.manageview=!1,void(G.checkout=!1)):1==G.checkout?(G.manageview=!0,G.checkout=!1,void(G.overview=!1)):void("rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?n.go("answerDetail",{index:t.canswer.slug}):"addAnswer"==t.previousState?n.go("addAnswer",{index:t.canswer.id}):"editAnswer"==t.previousState?n.go("editAnswer",{index:t.canswer.id}):"about"==t.previousState?n.go("about"):(t.$emit("backToResults"),n.go("cwrapper")))}function A(e){o.unbindAccount(G.business,E)}function E(){i.updateAnswer(G.business.id,["owner"],[0]),s.deleteAccount(G.business.stripeid,G.business.accountid,G.business.answer).then(function(e){G.mybizs=[],p(),G.overview=!0,G.manageview=!1}).catch(function(e){console.log(e)})}function O(){G.ranksQty=G.ranksQty+1}function S(){G.ranksQty=G.ranksQty-1,G.ranksQty<1&&(G.ranksQty=1)}function D(){8==G.promocode.length?(G.codeMsg="Validating code ...",l.getbyCode(G.promocode).then(function(e){console.log("code exists - ",e.length,e),e.length>0?(G.codeOk=!0,G.codeMsg="This code gets you 60 days free on all your subscriptions!"):(G.codeOk=!1,G.codeMsg="Sorry, this is not a valid code.")})):(G.codeOk=!1,G.codeMsg="Sorry, this is not a valid code.")}function C(){G.acceptTOS=!1,0==G.contactInfoOk?o.getDialog("contactInfoIncomplete"):0==G.getRanks&&0==G.getPremium?o.getDialog("nothingSelectedForPurchase"):(G.total=G.getRanks*G.ranksQty*G.CUSTOM_RANK_PRICE+G.getPremium*G.business.price,G.manageview=!1,G.checkout=!0,_("purchase"))}function I(){G.business.hasRanks?(M=!1,I=!0,V=!1,F=0,o.confirmCancel(G.business,"Premium",P)):(M=!0,I=!1,V=!1,F=0,o.confirmCancel(G.business,"Premium",P))}function P(){var e=c+"StripeServer/cancel",t={method:"POST",url:e,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{cancelAll:M,cancelPremium:I,cancelRanks:V,cancelNumRanks:F,stripeId:G.business.stripeid,useraccntId:G.business.accountid,stripesub:G.business.stripesub,stripesipremium:G.business.stripesipremium,stripesiranks:G.business.stripesiranks,answerId:G.business.id}};r(t).then(function(e){console.log("Cancelling Premium Membership Success",e)},function(e){console.log("Error Cancelling Premium Membership - ",e)}),_("cancel")}function T(){G.business.isPremium?(M=!1,I=!1,V=!0,F=0,o.confirmCancel(G.business,"Ranks",P)):(M=!0,I=!1,V=!1,F=0,o.confirmCancel(G.business,"Ranks",P))}function M(){M=!0,I=!1,V=!1,F=0,o.confirmCancel(G.business,"All",P)}function L(){o.editNumRanks(G.business,N)}function N(e,t){if("cancel"==e&&t==G.business.ranksQty)T();else{var n=0;"purchase"==e&&(n=G.business.ranksQty+t),"cancel"==e&&(n=G.business.ranksQty-t);var a=c+"StripeServer/edit",s={method:"POST",url:a,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{action:e,numRanks:n,stripeId:G.business.stripeid,useraccntId:G.business.accountid,stripesub:G.business.stripesub,stripesiranks:G.business.stripesiranks,answerId:G.business.id}};r(s).then(function(e){console.log("Updating Quantity of Custom Ranks Success",e)},function(e){console.log("Error Updating Quantity of Custom Ranks - ",e)}),_("edit",n)}console.log("Execute Edit Num Ranks")}function _(e,n){setTimeout(function(){function a(e){return console.log(JSON.stringify(e)),e}function o(a){var s=!0;console.log("i'm in, will check every 3 seconds for signup success"),console.log("full result:"),console.log(a);var o=!1;try{if("purchase"==e&&(G.getPremium&&a[0].ispremium&&!G.getRanks||!G.getPremium&&G.getRanks&&a[0].hasranks&&G.ranksQty==a[0].ranksqty||G.getPremium&&a[0].ispremium&&G.getRanks&&a[0].hasranks&&G.ranksQty==a[0].ranksqty)&&(o=!0),"cancel"==e&&(I&&!a[0].ispremium&&""==a[0].stripesipremium||V&&!a[0].hasranks&&""==a[0].stripesiranks||M&&""==a[0].stripesub)&&(o=!0),"edit"==e&&a[0].ranksqty==n&&(o=!0),o){var i=t.useraccnts.map(function(e){return e.id}).indexOf(a[0].id);return t.useraccnts[i]=a[0],i=t.content.map(function(e){return e.id}).indexOf(a[0].answer),t.content[i].ispremium=a[0].ispremium,t.content[i].hasranks=a[0].hasranks,t.content[i].ranksqty=a[0].ranksqty,p(),console.log(G.mybiz),G.overview=!0,G.manageview=!1,G.checkout=!1,!0}console.log("havent accomplished mission yet")}catch(e){return console.log("error while looking up subscription info from DF: "+JSON.stringify(e)),s=!1,e}1==s&&(G.checkout||G.manage)&&_(e)}console.log("loopCheck -- ",e),s.getuseraccntans(G.business.id).then(o,a)},3e3)}function $(){Y=["name","email"],q=["Name","Email"],z=[G.business.firstname+" "+G.business.lastname,G.business.email],o.editInfo(Y,q,z,B)}function B(e){s.updateuseraccnt(G.business.accountid,Y,e).then(function(){p()})}function U(){o.showTOSCustomersDlg()}function X(e){var t="";1==e&&(t="https://www.youtube.com/embed/IpUNM4Okb0U"),2==e&&(t="https://www.youtube.com/embed/pjxmggRM37o"),o.showLearnMore(t)}if(-1!==a.location.href.indexOf("cardUpdate")){"success"==a.location.href.slice(a.location.href.indexOf("cardUpdate")).split("=")[1].split("&")[0]?a.alert("Successfully changed card details."):a.alert(a.location.href.slice(a.location.href.indexOf("messgage")).split("=")[1].split("&")[0])}var G=this;G.title="mybusiness",G.overview=!0,G.manageview=!1,G.codeOk=!1,G.getRanks=!1,G.getPremium=!1,G.dataReady=!1,G.showInvoices=!1,G.showPaymentInfo=!1,G.SERVER_URL=c,G.gotoanswer=k,G.gotomanage=x,G.goCheckout=C,G.unbind=A,G.goBack=R,G.ranksQty=1,G.plusQty=O,G.minusQty=S,G.checkcode=D,G.cancelPremium=I,G.cancelAllRanks=T,G.editRanks=L,G.cancelAll=M,G.editContact=$,G.showInvoicsClicked=h,G.showPaymentInfoEditClicked=v,G.changeCardNumber=m,G.GetFormattedDate=b,G.hideInvoices=f,G.showTOSCustomersDlg=U,G.showLearnMore=X,G.mybizs=[],function(){d.all([s.getuseraccnt(),u.getSetting(),g.get()]).then(function(e){t.useraccnts=e[0],G.CUSTOM_RANK_PRICE=e[1].CUSTOM_RANK_PRICE,t.codeprices=e[2],G.dataReady=!0,p()}),t.DEBUG_MODE&&console.log("mybusiness page Loaded!")}(),G.noAns=!1;var M=!1,I=!1,V=!1,F=0,Y=[],q=[],z=[]}angular.module("app").controller("mybusiness",e),e.$inject=["$location","$rootScope","$state","$window","useraccnt","dialog","answer","$http","promoter","SERVER_URL","$q","setting","codeprice"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b,y,w,k,x,R,A,E,O,S,D){function C(){s.get("../../../assets/fields.json").then(function(e){t.typeSchema=e.data,I()});s.get("../../../assets/dialogs.json").then(function(e){t.dialogs=e.data}),s.get("../../../assets/foodans.json").then(function(e){t.foodans=e.data})}function I(){t.neighborhoods=["Downtown","La Jolla","Pacific Beach","Hillcrest","University Heights","Old Town","Del Mar","Ocean Beach","North Park","Mission Hills","Barrio Logan","City Heights","Clairemont","La Mesa","Point Loma","South Park","Scripps Ranch","Mission Beach","Mission Valley","Kensington","Cardiff by the Sea","Coronado","Leucadia","Oceanside","National City","Rancho Santa Fe","Solana Beach","Poway","El Cajon","Escondido","Carlsbad","San Ysidro","Otay Mesa","Linda Vista","Chula Vista","Encinitas","Golden Hill","Spring Valley","Rancho San Diego","Mira Mesa","Torrey Pines","Carmel Valley","Miramar","Kearny Mesa","Rancho Penasquitos","Sorrento Valley","Tierra Santa","Logan Heights","Serra Mesa","Normal Heights","Talmadge","Bird Rock","South San Diego","North City","San Carlos","Del Cerro","Grantville"],t.districts=["Columbia","Core","Cortez Hill","East Village","Gaslamp Quarter","Horton Plaza","Little Italy","Marina","Bankers Hill","Balboa Park"],W.nhs=[],W.nhs=W.nhs.concat(t.neighborhoods,t.districts),W.allTopics=["LifeStyle","Social","Sports","Food","Beauty & Fashion","Family","Technology","Dating","City","Services","Health","Celebrities"],t.allnh=t.neighborhoods.concat(t.districts),O.getInitialData(),z(),O.getpagevisitdata(),S.getSetting()}function P(){void 0==t.pageDataLoaded&&(t.pageDataLoaded=!1),void 0==t.userDataLoaded&&(t.userDataLoaded=!1),window.location.href.indexOf("rankSummary")>-1?t.dataIsLoaded=t.rankSummaryDataLoaded&&t.userDataLoaded:window.location.href.indexOf("answerDetail")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.userDataLoaded:window.location.href.indexOf("favs")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("mybusiness")>-1?t.dataIsLoaded=t.answerDetailLoaded:window.location.href.indexOf("promoteconsole")>-1?t.dataIsLoaded=t.answerDetailLoaded&&t.rankSummaryDataLoaded&&t.pageDataLoaded&&t.userDataLoaded:window.location.href.indexOf("home")>-1?t.dataIsLoaded=t.initalHomeDataLoaded:t.dataIsLoaded=t.pageDataLoaded&&t.userDataLoaded,W.isLoading=!t.dataIsLoaded,t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.dataIsLoaded -",t.dataIsLoaded),t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.pageDataLoaded -",t.pageDataLoaded),t.DEBUG_MODE&&console.log("@loadingDone - $rootScope.userDataLoaded -",t.userDataLoaded)}function T(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1}function M(){W.childActive=!0,W.barIsActive=!1,E.go("privacypolicy")}function L(){W.childActive=!0,W.barIsActive=!1,E.go("rodconsole")}function N(){t.inputVal=W.val,t.searchActive=!0,W.searchActive=t.searchActive,W.childActive=!t.searchActive}function _(){W.searchActive=!1,W.childActive=!0,W.barIsActive=!1}function $(){W.searchActive=!0,W.childActive=!1,W.barIsActive=!0,"cwrapper"==E.current.name&&(t.inputVal="",W.val="")}function B(){"cwrapper"==E.current.name&&(t.inputVal="",W.val=""),E.go("cwrapper"),void 0!=t.inputVal&&""!=t.inputVal&&(t.searchActive=!0,W.searchActive=!0,W.childActive=!1)}function U(){t.isLoggedIn?(W.childActive=!0,E.go("addCustomRank")):v.loginFacebook()}function X(){t.editMode=!0,W.selEditRank="active",W.selViewRank="",t.DEBUG_MODE&&console.log("$rootScope.editMode -- ",t.editMode)}function G(){t.editMode=!1,W.selEditRank="",W.selViewRank="active"}function V(){t.$emit("applyRule")}function F(){W.scopeIsGeneral=!1,W.scopeIsCity=!0,W.initready=!1,W.dataready=!1,W.childActive=!1,t.inputVal="",W.val="",O.gethomedataX(t.SCOPE),E.go("cwrapper"),n.scrollTo(0,0)}function Y(){return W.selCityActive?void(W.selCityActive=!1):void(W.selCityActive=!0)}function q(){t.DEBUG_MODE&&console.log("@prepareNewCatansOptions - $rootScope.content.length ",t.content.length),t.ctsOptions=[];for(var e=0;e<t.categories.length;e++)t.ctsOptions.push(t.categories[e].category)}function z(){if(window.location.href.indexOf("rankSummary")>-1){var e=window.location.href.indexOf("rankSummary/"),n=window.location.href.substring(e+12);O.landRanking(n),W.childActive=!0,W.barIsActive=!1}else if(window.location.href.indexOf("answerDetail")>-1){var e=window.location.href.indexOf("answerDetail/"),n=window.location.href.substring(e+13);O.landAnswer(n),W.childActive=!0,W.barIsActive=!1}else t.childActive=!1,F()}function j(){W.childActive=!0,W.barIsActive=!1,E.go("trends")}var W=this;W.title="layout",W.header="",r.$parent.seo={pageTitle:"Rank-X",metaDescription:"Rank-X creates collective rankings on everything in your city."},W.veilMsg="Just a moment, loading the best information about San Diego",W.hidelogo=!1,W.getResults=N,W.hideSearch=_,W.gotoHome=$,W.goAddRank=U,W.foodNearMe=!1,-1!=n.location.href.indexOf("rankSummary/food-near-me-9521")&&(W.foodNearMe=!0,W.veilMsg="Just a moment, finding some delicious food..."),W.dataready=!1,W.initready=!1,W.barIsActive=!0,W.childActive=!1,W.rodready=!1,W.editRank=X,W.viewRank=G,W.applyRule=V,W.selCityActive=!1,W.toggleSelCity=Y,W.showTrends=j,W.goPrivacyPolicy=M,W.goRankofDayConsole=L,jQuery(document).ready(function(){jQuery(window).scroll(function(){jQuery(this).scrollTop()>250?jQuery(".back-to-top").fadeIn(300):jQuery(".back-to-top").fadeOut(300)}),jQuery(".back-to-top").click(function(e){return e.preventDefault(),jQuery("html, body").animate({scrollTop:0},300),!1})}),W.showFilters=!1,W.toggleFilterBox=function(){W.showFilters=!W.showFilters},W.hideFilterBox=function(){W.showFilters=!1},W.selectNh=function(e,t){W.filterOptions.isCity=!1,W.filterOptions.isNh=!0},W.selectTopic=function(e){if("All"==e)0==W.filterOptions.isAllTopics?(W.filterOptions.isAllTopics=!0,W.filterOptions.ctopics=angular.copy(W.allTopics)):(W.filterOptions.isAllTopics=!1,W.filterOptions.ctopics=[]);else if(-1!==W.filterOptions.ctopics.indexOf(e))W.filterOptions.isAllTopics=!1,
W.filterOptions.ctopics.splice(W.filterOptions.ctopics.indexOf(e),1);else{W.filterOptions.ctopics.push(e);var t=W.allTopics.filter(function(e){return-1==W.filterOptions.ctopics.indexOf(e)});0==t.length&&(W.filterOptions.isAllTopics=!0)}},W.switchLocationScope=function(e){"city"==e?(W.filterOptions.isCity=!0,W.filterOptions.isNh=!1):(W.filterOptions.isCity=!1,W.filterOptions.isNh=!0)},W.applyFilters=function(){if(0==W.filterOptions.ctopics.length)return void alert("Please select at least 1 topic.");D.saveFilterOptions(W.filterOptions),t.$emit("filterOptionChanged"),W.showFilters=!W.showFilters};var H=t.$on("refreshRanks",function(){"cwrapper"==E.current.name&&(W.hidelogo=t.hidelogo)}),K=t.$on("showLogo",function(){"rankSummary"==E.current.name||E.current.name}),J=t.$on("userDataLoaded",function(){t.DEBUG_MODE&&console.log("RX - userDataLoaded"),P()}),Q=t.$on("homeDataLoaded",function(){t.DEBUG_MODE&&console.log("RX - homeDataLoaded"),P(),W.dataready=!0,q()}),Z=t.$on("rankDataLoaded",function(){t.DEBUG_MODE&&console.log("RX - rankDataLoaded"),P()}),ee=t.$on("answerDataLoaded",function(){t.DEBUG_MODE&&console.log("RX - answerDataLoaded"),P()}),te=t.$on("initalHomeDataLoaded",function(){t.DEBUG_MODE&&console.log("RX - initialHomeLoaded"),t.initalHomeDataLoaded=!0,W.initready=!0,P()}),ne=t.$on("mainView",function(e){W.childActive=!1,$()}),ae=t.$on("hideBar",function(e){W.childActive=!0,W.barIsActive=!1}),se=t.$on("backToResults",function(e){W.childActive=!1,W.barIsActive=!0,B()}),oe=t.$on("userLoggedOut",function(e){W.isAdmin=!1}),ie=t.$on("rodReady",function(e){W.rodready=!0,O.pulldata("ranks",t.rankofday)}),re=t.$on("setScope",function(){1==t.SCOPE&&(W.scopeIsGeneral=!0,W.scopeIsCity=!1),2==t.SCOPE&&(W.scopeIsGeneral=!1,W.scopeIsCity=!0)});r.$on("$destroy",re),r.$on("$destroy",oe),r.$on("$destroy",se),r.$on("$destroy",ae),r.$on("$destroy",ne),r.$on("$destroy",te),r.$on("$destroy",ee),r.$on("$destroy",Z),r.$on("$destroy",Q),r.$on("$destroy",J),r.$on("$destroy",K),r.$on("$destroy",H),r.$on("$destroy",ie),n.innerWidth<512?(W.logoimage="/assets/images/rankxlogosd2_sm.png",t.sm=!0,W.sm=!0,t.DISPLAY_XSMALL=!0,t.numInitItems=12):(W.logoimage="/assets/images/rankxlogosd2_sm.png",t.sm=!1,W.sm=!1),n.innerWidth>=512&&n.innerWidth<768&&(t.DISPLAY_SMALL=!0,t.numInitItems=12),t.md=!1,n.innerWidth>=768&&n.innerWidth<991&&(t.md=!0,t.DISPLAY_MEDIUM=!0,t.numInitItems=16),n.innerWidth>991&&(t.DISPLAY_LARGE=!0,t.numInitItems=24),t.$on("$stateChangeSuccess",function(e,n,a,s,o){W.hideFilterBox(),t.previousState=s.name});var le=i.get("tourviewed");void 0==le&&(le=!1),function(){t.isAdmin=!1,t.dataAdmin=!1,t.isLoggedIn&&("1599427743409374"==t.user.id&&(t.dataAdmin=!0),"10104518570729893"==t.user.id&&(t.isAdmin=!0),"10214255239240099"==t.user.id&&(t.contentAdmin=!0),"1638806919478345"==t.user.id&&(t.modAdmin=!0)),W.isAdmin=t.isAdmin||t.contentAdmin,t.$emit("adminCredentials"),t.DEBUG_MODE=l,t.EMPTY_IMAGE=c,t.SCOPE=2,t.facebookAppId="",t.facebookUrl="https://www.facebook.com/Rank-X-San-Diego-582174448644554",void 0==t.dataIsLoaded?(W.isLoading=!0,C()):I(),f.loadUserData(),f.loadUserAccount(),t.isFacebookApp=T(),t.DEBUG_MODE&&console.log("Layout Loaded!")}()}angular.module("app").controller("layout",e),e.$inject=["$location","$rootScope","$window","$q","$http","pvisits","$cookies","$scope","DEBUG_MODE","EMPTY_IMAGE","rankofday","answer","table","special","datetime","uaf","userdata","dialog","matchrec","edit","useractivity","vrows","headline","cblock","catans","$state","dataloader","setting","filter"]}(),function(){"use strict";function e(e,t,n,a){}angular.module("app").controller("feeds",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t,n){function a(){n.go("cwrapper")}var s=this;s.title="feedback",s.goBack=a,function(){console.log("feedback page Loaded!")}()}angular.module("app").controller("feedback",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,n,a){}angular.module("app").controller("favs",e),e.$inject=["$location","$rootScope","$state","$window"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b){function y(){C.scrollDataLoading=!0,h(function(){C.currentIndex+C.loadingCountOneScroll>C.scrollingData.length-1&&(C.current=C.scrollingData.length,C.endReached=!0),C.currentIndex+=C.loadingCountOneScroll,C.currentIndex-C.startIndex>C.scrollingItemsOnePage&&(C.startIndex=C.currentIndex-C.scrollingItemsOnePage),C.scrollDataLoading=!1},500)}function w(){C.startIndex>=3&&(C.startIndex-=3,C.currentIndex-=3)}function k(t){1==t&&(C.isNh=!1,C.isCity=!0,e.isNh=!1,e.isCity=!0,e.$emit("loadNh"),C.searchScope="all San Diego",C.ranks=e.cityranks,C.querybc="white"),2==t&&(C.isNh=!0,C.isCity=!1,e.isNh=!0,e.isCity=!1,C.val="",e.inputVal="",e.searchActive=!1,e.isNhRdy&&e.$emit("loadNh"),C.searchScope="Neighborhood",C.ranks=e.nhranks,C.querybc="#428bca"),C.searchActive=e.searchActive}function x(t){e.cnh=t,C.cnh=t,C.isNhRdy=!0,e.isNhRdy=C.isNhRdy,C.inputVal="",C.searchActive=!1,e.$emit("loadNh"),C.searchScope=t,C.val="",e.inputVal="",$("#nhdropdown").dropdown("toggle")}function R(){e.coordsRdy?t.go("rankSummary",{index:9521}):(e.loadFbnWhenCoordsRdy=!0,r.askPermissionToLocate())}function A(){for(var n=!1,a=0,s=e.content.length-1;!n;)a=Math.floor(Math.random()*(s-0+1))+0,e.content[a].ismp&&(n=!0);t.go("rankSummary",{index:e.content[a].id})}function E(){t.go("rankSummary",{index:6949})}function O(){e.inputVal="",C.val=""}function S(e){t.go("answerDetail",{index:e.answer})}function D(e){t.go("rankSummary",{index:e.category})}var C=this;s.$parent.$parent.$parent.seo={pageTitle:"",metaDescription:"Rank-X creates collective rankings on everything in your city. Find the best restaurants, services, activities, events, places, events and more."};var I={};I.get=function(e,t,n){h(function(){for(var a=[],s=e;s<=e+t-1;s++)a.push("item #"+s);n(a)},100)},C.sm=e.sm,C.md=e.md,C.datasource=I,h(function(){var e=$("#facebook-container").width();$("#facebook-display").html(""),$("#facebook-display").html('<div class="fb-page"                 ng-if="vm.pageDataLoaded"                           data-href="https://www.facebook.com/rankxsandiego/"                  data-tabs="timeline"                  data-height="70"                 data-width="'+e+'"                 data-small-header="false"                  data-adapt-container-width="true"                  data-hide-cover="false"                 data-show-facepile="true">                     <blockquote cite="https://www.facebook.com/rankxsandiego/" class="fb-xfbml-parse-ignore">                    <a href="https://www.facebook.com/rankxsandiego/">Rank-X San Diego</a></blockquote>            </div>'),FB.XFBML.parse()},2e3),C.title="cwrapper",C.switchScope=k,void 0==e.hidelogo?C.hidelogo=!1:C.hidelogo=e.hidelogo,C.foodNearMe=R,C.events=E,C.selfimprove=A,C.selnh=x,C.goHome=O,C.gotoAnswer=S,C.gotoRank=D,e.editMode=!1,C.content=[],C.emptyspace="",C.fbm=!!e.fbmode;var P=e.$on("mainView",function(e){"cwrapper"==t.current.name&&O()});C.loadMore=y,C.showLess=w,e.$on("filterOptionChanged",function(){}),e.$on("initalHomeDataLoaded",function(){}),e.$on("homeDataLoaded",function(){}),s.$on("$destroy",P),window.prerenderReady=!1}angular.module("app").controller("cwrapper",e),e.$inject=["$rootScope","$state","$http","$stateParams","$scope","query","table","dialog","uaf","$window","userdata","$location","color","fbusers","$q","$timeout","filter","search","mailing"]}(),function(){"use strict";function e(e,t){function n(){"rankSummary"==t.previousState?e.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?e.go("answerDetail",{index:t.canswer.slug}):"addAnswer"==t.previousState?e.go("addAnswer",{index:t.canswer.slug}):"editAnswer"==t.previousState?e.go("editAnswer",{index:t.canswer.slug}):"about"==t.previousState?e.go("about"):e.go("cwrapper")}var a=this;a.title="Customer Terms of Service",a.goBack=n,function(){console.log("Customer Terms of Service page Loaded!")}()}angular.module("app").controller("customertos",e),e.$inject=["$state","$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s){function o(){"rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?n.go("answerDetail",{index:t.canswer.slug}):t.$emit("backToResults")}var i=this;i.title="about",i.goBack=o,a.innerWidth<512?(i.logoimage="/assets/images/rankxlogo_noheadline.png",i.sm=!0):(i.logoimage="/assets/images/rankxlogo_noheadline.png",i.sm=!1),s.$parent.seo={pageTitle:"About",metaDescription:"Rank-X creates collective rankings on everything in your city."},function(){console.log("About page Loaded!")}()}angular.module("app").controller("about",e),e.$inject=["$location","$rootScope","$state","$window","$scope"]}(),function(){"use strict";function e(e,t,n,a){function s(n){function a(e){return d(e.data.resource),m}if(u()&&!n)return t.when(m);var s=f;return e.get(s).then(a,g)}function o(a){function s(e){n.DEBUG_MODE&&console.log("specialsX data loaded");var t=e.data.resource,a=m.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&m.push(e)}),t}var o=[];if(a.forEach(function(e){p.indexOf(e.answer)<0&&(o.push(e),p.push(e.answer))}),0==o.length)return t.when(!1);for(var i="?filter=(",r=0;r<o.length;r++)i=i+"answer="+o[r].answer+")OR(";i=i.substring(0,i.length-3);var l=f+i;return e.get(l).then(s,g)}function i(t){function a(e){var t=e.data.resource,a=m.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&m.push(e)}),h=t,n.DEBUG_MODE&&console.log("gotSpecial for answer! ",h),t}var s=f+"/?filter=answer="+t;return e.get(s).then(a,g)}function r(t){function a(e){var a=t;return a.id=e.data.resource[0].id,m.length>0&&m.push(a),h.length>0&&h.push(a),n.DEBUG_MODE&&console.log("result",e),e.data}var s=f,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,g)}function l(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating special succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var c=f,d=m.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)m[d][a[l]]=s[l];for(var u=h.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)h[u][a[l]]=s[l];return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,g)}function c(t){function n(e){return-1!=i.indexOf("https://rankx.blob")&&a.deleteBlob(i),console.log("Deleting special was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i,r=f+"/"+t;if(m.length>0){var l=m.map(function(e){return e.id}).indexOf(t);i=m[l].image,l>-1&&m.splice(l,1)}if(h.length>0){var l=h.map(function(e){return e.id}).indexOf(t);l>-1&&h.splice(l,1)}return e.delete(r,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,g)}function d(e){m.length=0,e.forEach(function(e){m.push(e)})}function u(){return m.length>0}function g(e){throw e}var m=[],p=[];n.specials=m;var h=[],f="/api/v2/mysql/_table/specials";return{getSpecials:s,getSpecialsX:o,addSpecial:r,updateSpecial:l,deleteSpecial:c,getSpecialsbyAnswer:i}}angular.module("app").factory("special",e),e.$inject=["$http","$q","$rootScope","imagelist"]}(),function(){"use strict";function e(e){function t(e){if("onetime"==e.freq){n(e,"stime"),n(e,"etime");var t=new Date(e.sdate),a=t.toString();e.sdate=a.substring(0,15),t=new Date(e.edate),a=t.toString(),e.edate=a.substring(0,15)}"weekly"==e.freq&&(n(e,"stime2"),n(e,"etime2"))}function n(e,t){var n="";switch(t){case"stime":n=e.stime;break;case"etime":n=e.etime;break;case"stime2":n=e.stime2;break;case"etime2":n=e.etime2}if(null!=n&&void 0!=n&&(n.indexOf("00:00")>-1||n.indexOf("30:00")>-1)){n=n.replace("00:00","00"),n=n.replace("30:00","30");var a=parseInt(n.substring(0,2))<12;if(n+=a?" AM":" PM",!a){var s=parseInt(n.substring(0,2))-12,o="";o=s<10?"0"+s.toString():s.toString(),n=n.replace(n.substring(0,2),o)}}switch(t){case"stime":e.stime=n;break;case"etime":e.etime=n;break;case"stime2":e.stime2=n;break;case"etime2":e.etime2=n}}function a(e){var t=new Date(e),n=t.getFullYear().toString()+(t.getMonth()+1<10?"0"+(t.getMonth()+1).toString():(t.getMonth()+1).toString())+(t.getDate()<10?"0"+t.getDate().toString():t.getDate().toString());return Number(n)}function s(t){return a(t)-e.dateTodayNum>=0}function o(t,n){var s=0,o=!1,i=0,r=!1;if(void 0!=n.edate&&""!=n.edate&&(s=a(n.edate.slice(4)),o=!0),i=a(n.sdate.slice(4)),o)if(s>=e.dateTodayNum)if(r=!0,i>=e.dateTodayNum)t.date=n.sdate.slice(4);else{var l=new Date(e.dateToday),c=l.toString();t.date=c.substring(0,15).slice(4)}else r=!1,t.date=n.edate.slice(4);else i>=e.dateTodayNum?(r=!0,t.date=n.sdate.slice(4)):(r=!1,t.date=n.sdate.slice(4));return r}return{formatdatetime:t,formatTime:n,date2number:a,dateIsCurrent:s,eventIsCurrent:o}}angular.module("app").service("datetime",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s){function o(){u.specialsList=[];for(var e={},n=0;n<7;n++)e={},n<t.specials.length?(e=t.specials[n],e.used=!0):(e.stitle="Empty",e.used=!1),u.specialsList.push(e)}function i(){t.specialmode="add",n.go("editspecial")}function r(e){t.cspecial=e,t.specialmode="edit",n.go("editspecial")}function l(e){r=e,a.deleteRank(e,c,!0)}function c(){s.deleteSpecial(r.id).then(function(){o()})}function d(){n.go("answerDetail",{index:t.canswer.id})}var u=this;u.title="specials",u.addSpecial=i,u.selSpecial=r,u.deleteSpecial=l,u.goBack=d,u.specialsList=[],u.dataReady=!1;var r={};!function(){s.getSpecialsbyAnswer(t.canswer.id).then(function(e){t.specials=e,u.dataReady=!0,o()}),console.log("Specials Page loaded!")}()}angular.module("app").controller("specials",e),e.$inject=["$location","$rootScope","$state","dialog","special"]}(),function(){"use strict";function e(e,t,n){this.title="photogallery",function(){console.log("photogallery page Loaded!")}()}angular.module("app").controller("photogallery",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,n){this.title="mainphoto",function(){console.log("mainphoto page Loaded!")}()}angular.module("app").controller("mainphoto",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){function e(e,t){return e.gnum-t.gnum}if(y.vrows=[],t.cansvrows.length>0){y.vrows=t.cansvrows.sort(e),y.vrows[0].shdr=!0;for(var n=1;n<y.vrows.length;n++)y.vrows[n].gnum==y.vrows[n-1].gnum?y.vrows[n].shdr=!1:y.vrows[n].shdr=!0;y.vrows[y.vrows.length-1].saddr=!0;for(var n=0;n<y.vrows.length-1;n++)y.vrows[n].gnum!=y.vrows[n+1].gnum?y.vrows[n].saddr=!0:y.vrows[n].saddr=!1}}function r(){n.go("answerDetail",{index:t.canswer.id})}function l(e){t.cansvrows=[];for(var n=0;n<t.cvrows.length;n++)t.cvrows[n].answer==e&&t.cansvrows.push(t.cvrows[n]);i()}function c(e){a.addVRow(e,d)}function d(e,n){var a=!1;"-"==e.title&&(a=!0);var o=JSON.parse(JSON.stringify(e));if(o.id=void 0,o.$$hashKey=void 0,o.upV=0,o.downV=0,o.title=n,a){s.updateRec(e.id,["title"],[n]).then(function(){l(t.canswer.id)})}else{s.postRec(o).then(function(){l(t.canswer.id)})}}function u(e){a.deleteVRow(e,g)}function g(e){var n=s.deleteVrow(e.id);o.deleteVrowVotesbyVrow(e.id),n.then(function(){l(t.canswer.id)})}function m(){var e=y.vrows[y.vrows.length-1];a.addVRowGroup(e,p)}function p(e,n){if(y.vrows.length>0){var a=JSON.parse(JSON.stringify(e));a.id=void 0,a.$$hashKey=void 0,a.upV=0,a.downV=0,a.title="-",a.gnum=y.vrows[y.vrows.length-1].gnum+1,a.gtitle=n}else a={},a.answer=t.canswer.id,a.gnum=0,a.gtitle=n,a.title="-",a.upV=0,a.downV=0;s.postRec(a).then(function(){l(t.canswer.id)})}function h(e){a.editVRowGroup(e,f,v)}function f(e,n){var a=!1;if(e.gtitle!=n&&(a=!0),a){for(var o=0;o<t.cansvrows.length;o++)t.cansvrows[o].gnum==e.gnum&&(t.cansvrows[o].gtitle=n,s.updateRec(t.cansvrows[o].id,["gtitle"],[n]));l(t.canswer.id)}}function v(e){a.deleteVRowGroup(e,b)}function b(e){s.deleteVrowByGroup(e.gnum,e.answer).then(function(){console.log("$rootScope.cvrows - ",t.cvrows),l(t.canswer.id)})}var y=this;y.title="editvrows";y.header="Edit Vote Rows for "+t.canswer.name,y.editvrowsList=[],y.vrows=[],y.addVRowDiag=c,y.addVRowGroupDiag=m,y.deleteVRowDiag=u,y.editVRowGroupDiag=h,y.closeRank=r,function(){y.vrows=t.cansvrows,i(),console.log("editvrows Page loaded!")}()}angular.module("app").controller("editvrows",e),e.$inject=["$location","$rootScope","$state","dialog","vrows","vrowvotes"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(){h.char=25-h.sp.stitle.length}function l(e){1==e&&(h.weekly=!1,h.onetime=!0,h.sp.freq="onetime"),2==e&&(h.weekly=!0,h.onetime=!1,h.sp.freq="weekly")}function c(){v=h.sp,v.name=t.canswer.name,v.answer=t.canswer.id,v.image=h.imageURL,v.freq=h.onetime?"onetime":"weekly",a.createSpecialPreview(v,d)}function d(){if("onetime"==h.sp.freq&&(v.stime2=null,v.etime2=null),"weekly"==h.sp.freq&&(v.stime=null,v.sdate=null,v.etime=null,v.edate=null),0==h.isEdit)s.addSpecial(v).then(function(){n.go("specials")});else{var e=[],t=[];console.log("spx, vm.sp",f,h.sp),f.bc!=h.sp.bc&&(e.push("bc"),t.push(h.sp.bc)),f.fc!=h.sp.fc&&(e.push("fc"),t.push(h.sp.fc)),f.edate!=h.sp.edate&&(e.push("edate"),t.push(h.sp.edate)),f.etime!=h.sp.etime&&(e.push("etime"),t.push(h.sp.etime)),f.etime2!=h.sp.etime2&&(e.push("etime2"),t.push(h.sp.etime2)),f.sdate!=h.sp.sdate&&(e.push("sdate"),t.push(h.sp.sdate)),f.stime!=h.sp.stime&&(e.push("stime"),t.push(h.sp.stime)),f.stime2!=h.sp.stime2&&(e.push("stime2"),t.push(h.sp.stime2)),f.stitle!=h.sp.stitle&&(e.push("stitle"),t.push(h.sp.stitle)),f.image!=h.imageURL&&(e.push("image"),t.push(h.imageURL)),f.name!=h.sp.name&&(e.push("name"),t.push(h.sp.name)),f.details!=h.sp.details&&(e.push("details"),t.push(h.sp.details)),f.freq!=h.sp.freq&&(e.push("freq"),t.push(h.sp.freq)),f.mon!=h.sp.mon&&(e.push("mon"),t.push(h.sp.mon)),f.tue!=h.sp.tue&&(e.push("tue"),t.push(h.sp.tue)),f.wed!=h.sp.wed&&(e.push("wed"),t.push(h.sp.wed)),f.thu!=h.sp.thu&&(e.push("thu"),t.push(h.sp.thu)),f.fri!=h.sp.fri&&(e.push("fri"),t.push(h.sp.fri)),f.sat!=h.sp.sat&&(e.push("sat"),t.push(h.sp.sat)),f.sun!=h.sp.sun&&(e.push("sun"),t.push(h.sp.sun)),console.log("fields, vals",e,t),s.updateSpecial(v.id,e,t).then(function(){n.go("specials")})}}function u(){s.deleteSpecial(h.sp.id),n.go("specials")}function g(){n.go("specials")}function m(){h.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"]}function p(){n.go("answerDetail",{index:t.canswer.id})}var h=this;h.title="editspecial",h.sp={};var f={},v={};h.displayCharLength=r,h.frequencySel=l,h.showPreview=c,h.deleteSpecial=u,h.goBack=g,h.closeRank=p,h.header=t.canswer.name,h.isEdit=!1,h.userIsOwner=t.userIsOwner;var b=t.$on("fileUploaded",function(e,t){console.log("Received fileUploaded",t),console.log("$state.current.name - ",n.current.name),"editspecial"==n.current.name&&(console.log("loaded date to vm.imageURL"),h.imageURL=t)});i.$on("$destroy",b),function(){"edit"==t.specialmode&&(h.sp=JSON.parse(JSON.stringify(t.cspecial)),f=JSON.parse(JSON.stringify(t.cspecial)),o.formatdatetime(h.sp),h.isEdit=!0,"onetime"==h.sp.freq&&l(1),"weekly"==h.sp.freq&&l(2),h.sp.bc=h.sp.bc,h.sp.fc=h.sp.fc,void 0!=h.sp.image?h.imageURL=h.sp.image:h.imageURL=t.EMPTY_IMAGE),"add"==t.specialmode&&(h.char=25,h.sp.fc="hsl(0, 100%, 0%)",h.sp.bc="hsl(0, 0%, 100%)",l(1),h.imageURL=t.EMPTY_IMAGE),m(),console.log("editspecial page Loaded!")}()}angular.module("app").controller("editspecial",e),e.$inject=["$location","$rootScope","$state","dialog","special","datetime","$scope"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){g.answers=t.custans}function r(e){t.cust.canswer=e.id,console.log("current answer ",e.id,e.name)}function l(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):n.go("mainphoto")}function c(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):n.go("specials")}function d(){void 0==t.cust.canswer?s.getDialog("selectBusiness"):n.go("photogallery")}function u(){n.go("content")}var g=this;g.title="customer",g.selMainPhoto="active",g.selSpecials="",g.selPhotoGallery="",g.goBack=u,g.loadMainPhoto=l,g.loadSpecials=c,g.loadPhotoGallery=d,g.selAnswer=r,t.cust={},t.cust.id=1,function(){a.getAnswerbyCustomer(t.cust.id).then(function(e){t.custans=e.resource,console.log("Customer-Answer records: ",t.custans),i()}),console.log("customer page Loaded!")}()}angular.module("app").controller("customer",e),e.$inject=["$location","$rootScope","$state","answer","dialog","special"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){return e.get(b+"?order=views DESC&offset=0&limit=8&filter=ismp=1").then(function(e){n.initalHomeData=e.data.resource,o.saveInitalHomeData(n.initalHomeData),n.$emit("initalHomeDataLoaded")}),!0}function r(a){var s=b+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return p(e[0].data.resource),n.DEBUG_MODE&&console.log("tables length: ",f.length),f},h)}function l(a){var s=[];if(a.forEach(function(e){v.indexOf(e.answer)<0&&(s.push(e),v.push(e.answer))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)o=o+"owner="+s[i].answer+")OR(";o=o.substring(0,o.length-3);var r=b+o,l=e.get(r);return t.all([l]).then(function(e){var t=e[0].data.resource,a=f.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&f.push(e)}),n.DEBUG_MODE&&console.log("getTablesX 'custom ranks' ",f.length),f},h)}function c(a){var s=[];if(a.forEach(function(e){v.indexOf(e.category)<0&&(s.push(e),v.push(e.category))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)o=o+"id="+s[i].category+")OR(";o=o.substring(0,o.length-3);var r=b+o,l=e.get(r);return t.all([l]).then(function(e){var t=e[0].data.resource,a=f.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&f.push(e)}),n.DEBUG_MODE&&console.log("getTablesD 'custom ranks' ",f.length),f},h)}function d(t){function a(e){var a=t;a.id=e.data.resource[0].id,f.push(a);var s=a.tags+" "+a.title;n.searchStr.push(s);var o=a.title.toLowerCase();return o=o.replace(/ /g,"-"),o=o.replace("/","at"),o=o.replace("?",""),o=o+"-"+e.data.resource[0].id,m(e.data.resource[0].id,["slug"],[o]),n.DEBUG_MODE&&console.log("result",e),e.data}t.isatomic=!0;var s=b,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,h)}function u(t,s,o){function i(e){var i=t;i.id=e.data.resource[0].id,f.push(i);var r=i.tags+" "+i.title;n.searchStr.push(r);var l=i.title.toLowerCase();l=l.replace(/ /g,"-"),l=l.replace("/","at"),l=l+"-"+e.data.resource[0].id,m(e.data.resource[0].id,["slug"],[l]);var c={};c.id=e.data.resource[0].id,c.bc=s[0],c.fc=s[1];var d="",u=[];return void 0!=n.canswer.ranks&&null!=n.canswer.ranks&&""!=n.canswer.ranks?(d=n.canswer.ranks,u=JSON.parse(d),u.push(c),d=JSON.stringify(u),a.updateAnswer(o,["ranks"],[d])):(d="["+JSON.stringify(c)+"]",a.updateAnswer(o,["ranks"],[d])),n.DEBUG_MODE&&console.log("result",e),e.data}t.isatomic=!0;var r=b,l=[];return l.push(t),e.post(r,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(i,h)}function g(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting table was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=b+"/"+t,r=f.map(function(e){return e.id}).indexOf(t);return r>-1&&f.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,h)}function m(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating ranking record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var c=b,d=f.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)f[d][a[l]]=s[l];return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,h)}function p(e){f.length=0,e.forEach(function(e){f.push(e)})}function h(e){throw e}var f=[],v=[];n.customranks=f;var b="/api/v2/mysql/_table/customranks";return{getTables:r,getTablesX:l,getTablesD:c,update:m,addTable:d,addTableforAnswer:u,deleteTable:g,getMostPopularData:i}}angular.module("app").factory("table2",e),e.$inject=["$http","$q","$rootScope","answer","$state","filter"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c){function d(a){var s=r.localStorage.getItem("Ranks-HomeData");if(s)return w(JSON.parse(s)),t.when(!0);for(var o="?filter=(",i=0;i<a.length;i++)o=o+"id="+a[i]+")OR(";o=o.substring(0,o.length-3);var l=R+o,c=e.get(l);return t.all([c]).then(function(e){var t=e[0].data.resource;return 0==x.length&&w(t),n.DEBUG_MODE&&console.log("tables L length: ",x.length),r.localStorage.setItem("Ranks-HomeData",JSON.stringify(t)),x},k)}function u(a){var s=R+"?offset=0&filter=scope="+a,o=R+"?offset=1000&filter=scope="+a,i=R+"?offset=2000&filter=scope="+a,r=R+"?offset=3000&filter=scope="+a,l=e.get(s),c=e.get(o),d=e.get(i),u=e.get(r);return t.all([l,c,d,u]).then(function(e){return w(e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource)),n.DEBUG_MODE&&console.log("tables length: ",x.length),x},k)}function g(a){for(var s="?filter=(",o=0;o<a.length;o++)s=s+"id="+a[o].category+")OR(";s=s.substring(0,s.length-3);var i=R+s,r=e.get(i);return t.all([r]).then(function(e){return w(e[0].data.resource),n.DEBUG_MODE&&console.log("tables L length: ",x.length),x},k)}function m(a){var s=R+"?offset=0",o=R+"?offset=1000",i=R+"?offset=2000",r=R+"?offset=3000",l=e.get(s),c=e.get(o),d=e.get(i),u=e.get(r);return t.all([l,c,d,u]).then(function(e){return w(e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource)),n.DEBUG_MODE&&console.log("tables length: ",x.length),x},k)}function p(a){var s=R+"/?filter=id="+a,o=e.get(s);return t.all([o]).then(function(e){var t=e[0].data.resource;return w(t),n.DEBUG_MODE&&console.log("single table loaded: ",t),x},k)}function h(t){function a(e){var a=t;a.id=e.data.resource[0].id;var s=n.categories.map(function(e){return e.id}).indexOf(a.cat),o=n.categories[s],r=n.locations.map(function(e){return e.id}).indexOf(a.nh),l=n.locations[r],d=o.category.replace("@Nh",l.nh_name);a.title=d,a.fimage=o.fimage,a.tags=o.tags,a.keywords=o.keywords,a.fc=o.fc,a.bc=o.bc,a.shade=o.shade,a.type=o.type,a.user=n.user.id,a.introtext=o.introtext;var u=a.tags+" "+a.title;n.searchStr.push(u);var g=a.title.toLowerCase();return g=g.replace(/ /g,"-"),g=g.replace("/","at"),g=g.replace("?",""),g=g+"-"+e.data.resource[0].id,a.slug=g,x.push(a),y(e.data.resource[0].id,["slug"],[g]),c.createPageRank(a),i.post("addedRank",["category"],[a.id]),n.DEBUG_MODE&&console.log("result",e),e.data.resource[0].id}t.scope=n.SCOPE;var s=R,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,k)}function f(e,n){console.log("addGhostTableWithAnswer ",e,n);var s=[],o=[],i=[],r=[];return o.push(a.addAnswer(n,[])),e.forEach(function(e){e.isghost?(i.push(e),o.push(h(e))):s.push(e.id)}),t.all(o).then(function(e){var t=e[0].resource[0].id;console.log("answer id - ",t);for(var n=1;n<e.length;n++)s.push(e[n]),r.push(e[n]);return v(i,r),console.log("tids - ",s),s.forEach(function(e){l.postRec2(t,e)}),e})}function v(e,t){console.log("@ _updateCatstr ",e,t);for(var n=[],a="",s=0;s<e.length;s++)n=[],a="",x.forEach(function(o){if(o.cat==e[s].cat&&1==o.nh){console.log("Found parent rank"),n=o.catstr.split(":").map(Number),n.push(t[s]),a="";for(var i=0;i<n.length;i++)a=a+":"+n[i];a=a.substring(1),console.log("updated catstr for table - ",o.id),y(o.id,["catstr"],[a])}})}function b(t){function a(e){var a="rank"+t+".html",s={};return s.filename=a,c.removeFile(s),n.DEBUG_MODE&&console.log("Deleting table was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=R+"/"+t,r=x.map(function(e){return e.id}).indexOf(t);return r>-1&&x.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,k)}function y(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating ranking record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var d=R,u=x.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)x[u][a[l]]=s[l];for(var g=!1,l=0;l<a.length;l++)if("title"==a[l]||"slug"==a[l]&&a.length>1||"fimage"==a[l]||"introtext"==a[l]){g=!0;break}return g&&c.createPageRank(x[u]),e.patch(d,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,k)}function w(e){x.length=0,e.forEach(function(e){x.push(e)})}function k(e){throw e}var x=[];n.content=x;var R="/api/v2/mysql/_table/ranking";return{getTables:m,getSingleTable:p,update:y,addTable:h,deleteTable:b,getTablesX:u,getTablesL:g,getInitialHomeData:d,ghostTablesWithAnswer:f}}angular.module("app").factory("table",e),e.$inject=["$http","$q","$rootScope","answer","$state","filter","uaf","$window","catans","staticpages"]}(),function(){"use strict";function e(e){function t(t){var n="",a="",s=[],o=t,i=!1,r="";if(o&&o.length>=3)for(var l=o,c=l.split(" "),d=0;d<e.answers.length;d++){r=e.answers[d].name,i=!0;for(var u=0;u<c.length;u++){n=c[u].charAt(0).toUpperCase()+c[u].slice(1),a=c[u].charAt(0).toLowerCase()+c[u].slice(1);var g=!1,m=r.toLowerCase().split(" ").filter(function(e){return e==c[u].toLowerCase()});m.length>=1&&(g=!0),i=i&&(r.indexOf(c[u])>-1||r.indexOf(c[u].toUpperCase())>-1||r.indexOf(n)>-1||r.indexOf(a)>-1||g)}i&&(e.isNh?e.answers[d].cityarea==e.cnh&&s.push(e.answers[d]):s.push(e.answers[d]))}return s}function n(t,n){var a="",s="",o=[],i="",r=n;if(r){for(var l=r,c=[],d=!0,u=l.split(" "),g=0;g<e.searchStrContent.length;g++){i=e.searchStrContent[g],e.content[g],d=!0;for(var m=0;m<u.length;m++)a=u[m].charAt(0).toUpperCase()+u[m].slice(1),s=u[m].charAt(0).toLowerCase()+u[m].slice(1),i||console.log(g),d=d&&(i.indexOf(u[m])>-1||i.indexOf(u[m].toUpperCase())>-1||i.indexOf(a)>-1||i.indexOf(s)>-1);d&&t?e.content[g].mp&&c.push(e.content[g]):d&&c.push(e.content[g])}o=c}return o}function a(t,n){function a(e,t){return t.ctr-e.ctr}var s=[],o=[],i=[],r=!1,l="",c=0,d={};t.isatomic?i.push(t.id):i=t.catstr.split(":").map(Number);for(var u=0,g=0;g<e.catansrecs.length;g++)for(var m=0;m<i.length;m++)if(e.catansrecs[g].category==i[m]){for(var p=0;p<e.catansrecs.length;p++)if(e.catansrecs[p].answer==e.catansrecs[g].answer&&(u=e.content.map(function(e){return e.id}).indexOf(e.catansrecs[p].category))>-1){r=!1;for(var h=0;h<s.length;h++)s[h].title.substr(0,6)==e.content[u].title.substr(0,6)&&(s[h].ctr++,r=!0);r||(d=e.content[u],d.ctr=1,s.push(d))}if(++c>=50)break}for(var g=0;g<s.length;g++)if(s[g].isatomic&&s[g].ismp)o.push(s[g]);else if(s[g].isatomic&&!s[g].ismp)for(var p=0;p<e.locations.length;p++)if(s[g].title.indexOf(e.locations[p].nh_name)>-1){l=s[g].title.replace(e.locations[p].nh_name,n);for(var f=!1,h=0;h<e.content.length;h++)if(e.content[h].title==l){console.log("found and added - ",l),d=e.content[h],d.ctr=s[g].ctr,d.isghost=!1,o.push(d),f=!0;break}if(!f){console.log("Couldnt find: ",l," made it ghost :)");var v={};v.title=l,v.cat=s[g].cat;var b=e.locations.map(function(e){return e.nh_name}).indexOf(n);v.nh=e.locations[b].id,v.isghost=!0,v.isatomic=!0,console.log("ghost - ",v),o.push(v)}}return o=o.sort(a),o.length>8?o.slice(0,8):o}function s(t){var n="",a="",s="",o="",r=[],l=["pb","ob","dt","mb"],c=["Pacific Beach","Ocean Beach","Downtown","Mission Beach"];if(!e.locations)return[];for(var d=e.locations.map(function(e){return e.nh_name}),u=0;u<c.length;u++){var g=d.indexOf(c[u]);if(-1!=g){var m=angular.copy(e.locations[g]);m.nh_short_name=l[u],r.push(m)}}var p=!1,h=[],f=t;if(f)if(f.indexOf("best")>-1&&(f=f.replace("best","")),
f.indexOf("Best")>-1&&(f=f.replace("Best","")),f.indexOf("top")>-1&&(f=f.replace("top","")),f.indexOf("Top")>-1&&(f=f.replace("Top","")),f.indexOf("great")>-1&&(f=f.replace("great","")),f.indexOf("Great")>-1&&(f=f.replace("Great","")),f.indexOf("awesome")>-1&&(f=f.replace("awesome","")),f.indexOf("Awesome")>-1&&(f=f.replace("Awesome","")),f.indexOf("amazing")>-1&&(f=f.replace("amazing","")),f.indexOf("Amazing")>-1&&(f=f.replace("Amazing","")),f.indexOf("most")>-1&&(f=f.replace("most","")),f.indexOf("Most")>-1&&(f=f.replace("Most","")),f.indexOf("the ")>-1&&(f=f.replace("the ","")),f.indexOf("The ")>-1&&(f=f.replace("The ","")),f.indexOf("shops")>-1&&(f=f.replace("shops","")),f.indexOf("Shops")>-1&&(f=f.replace("Shops","")),f.indexOf("places")>-1&&(f=f.replace("places","")),f.indexOf("Places")>-1&&(f=f.replace("Places","")),f.indexOf("delicious")>-1&&(f=f.replace("delicious","")),f.indexOf("Delicious")>-1&&(f=f.replace("Delicious","")),f.length>=3){var v=f;v.indexOf("near me")>-1||v.indexOf("near")>-1||v.indexOf("close")>-1||v.indexOf("close to")>-1||v.indexOf("close to me")>-1?(!0,v=v.replace("near me","in San Diego"),v=v.replace("near","in San Diego"),v=v.replace("close to me","in San Diego"),v=v.replace("close to","in San Diego"),v=v.replace("close","in San Diego")):!1,"Food"==v&&(v=v.replace("Food","Food Near Me")),"food"==v&&(v=v.replace("food","Food Near Me")),"pho"!=v&&"Pho"!=v||(v="vietnamese"),e.isNh&&(v=v+" "+e.cnh);for(var b=[],y=[],w={},k=[],x=!0,R=!0,A=!1,E=[],O=v.toLowerCase().split(" "),S=0;S<O.length;S++){if(s=O[S].charAt(0).toUpperCase()+O[S].slice(1),o=O[S].charAt(0).toLowerCase()+O[S].slice(1),O[S].length>=3&&"car"!=O[S]&&"del"!=O[S]&&"bar"!=O[S])for(var D=0;D<e.locations.length;D++)(e.locations[D].nh_name.toLowerCase().indexOf(O[S])>-1||e.locations[D].nh_name.toLowerCase().indexOf(O[S].toUpperCase())>-1||e.locations[D].nh_name.indexOf(s)>-1||e.locations[D].nh_name.indexOf(o)>-1)&&(i(e.locations[D],E),A=!0,k.push(S));if(2==O[S].length)for(var D=0;D<r.length;D++)(r[D].nh_short_name.toLowerCase().indexOf(O[S])>-1||r[D].nh_short_name.toLowerCase().indexOf(O[S].toUpperCase())>-1||r[D].nh_short_name.indexOf(s)>-1||r[D].nh_short_name.indexOf(o)>-1)&&(i(r[D],E),A=!0,k.push(S))}k.push(O.indexOf("la"));for(var C=0;C<e.categories.length;C++)if(e.categories[C].category.indexOf("@Nh")>-1){a=e.searchStr[C],n=e.categories[C].category,e.categories[C],x=!0,R=!0;for(var S=0;S<O.length;S++)k.indexOf(S)<0&&(s=O[S].charAt(0).toUpperCase()+O[S].slice(1),o=O[S].charAt(0).toLowerCase()+O[S].slice(1),a||console.log(C),x=x&&(a.indexOf(O[S])>-1||a.indexOf(O[S].toUpperCase())>-1||a.indexOf(s)>-1||a.indexOf(o)>-1),R=R&&(n.indexOf(O[S])>-1||n.indexOf(O[S].toUpperCase())>-1||n.indexOf(s)>-1||n.indexOf(o)>-1));if(R){if(w={},w=JSON.parse(JSON.stringify(e.categories[C])),A)for(var I=0;I<E.length;I++)w={},w=JSON.parse(JSON.stringify(e.categories[C])),w.title=w.category.replace("@Nh",E[I].nh_name),w.locationId=E[I].id,w.useTemp=!0,y.push(w);else w.title=w.category.replace("@Nh","San Diego"),w.locationId=1,w.useTemp=!0,y.push(w);p=!0}else if(x)if(w={},w=JSON.parse(JSON.stringify(e.categories[C])),A)for(var I=0;I<E.length;I++)w={},w=JSON.parse(JSON.stringify(e.categories[C])),w.title=w.category.replace("@Nh",E[I].nh_name),w.locationId=E[I].id,w.useTemp=!0,b.push(w);else w.title=w.category.replace("@Nh","San Diego"),w.locationId=1,w.useTemp=!0,b.push(w)}p&&(h=h.concat(y)),h=h.concat(b)}else h=[];return h}function o(t){var n="",a="",s="",o="",i=["pb","ob","dt","mb"],r=["Pacific Beach","Ocean Beach","Downtown","Mission Beach"],l=!1,c=[],d=t;if(d)if(d.indexOf("best")>-1&&(d=d.replace("best","")),d.indexOf("Best")>-1&&(d=d.replace("Best","")),d.indexOf("top")>-1&&(d=d.replace("top","")),d.indexOf("Top")>-1&&(d=d.replace("Top","")),d.indexOf("great")>-1&&(d=d.replace("great","")),d.indexOf("Great")>-1&&(d=d.replace("Great","")),d.indexOf("awesome")>-1&&(d=d.replace("awesome","")),d.indexOf("Awesome")>-1&&(d=d.replace("Awesome","")),d.indexOf("amazing")>-1&&(d=d.replace("amazing","")),d.indexOf("Amazing")>-1&&(d=d.replace("Amazing","")),d.indexOf("most")>-1&&(d=d.replace("most","")),d.indexOf("Most")>-1&&(d=d.replace("Most","")),d.indexOf("the ")>-1&&(d=d.replace("the ","")),d.indexOf("The ")>-1&&(d=d.replace("The ","")),d.indexOf("shops")>-1&&(d=d.replace("shops","")),d.indexOf("Shops")>-1&&(d=d.replace("Shops","")),d.indexOf("places")>-1&&(d=d.replace("places","")),d.indexOf("Places")>-1&&(d=d.replace("Places","")),d.indexOf("delicious")>-1&&(d=d.replace("delicious","")),d.indexOf("Delicious")>-1&&(d=d.replace("Delicious","")),d.length>=3){var u=d;"pho"!=u&&"Pho"!=u||(u="vietnamese"),e.isNh&&(u=u+" "+e.cnh);for(var g=[],m=[],p={},h=!0,f=!0,v=!1,b=u.toLowerCase().split(" "),y=0;y<b.length;y++){if(s=b[y].charAt(0).toUpperCase()+b[y].slice(1),o=b[y].charAt(0).toLowerCase()+b[y].slice(1),b[y].length>=3&&"car"!=b[y]&&"del"!=b[y]&&"bar"!=b[y])for(var w=0;w<e.locations.length;w++)(e.locations[w].nh_name.toLowerCase().indexOf(b[y])>-1||e.locations[w].nh_name.toLowerCase().indexOf(b[y].toUpperCase())>-1||e.locations[w].nh_name.indexOf(s)>-1||e.locations[w].nh_name.indexOf(o)>-1)&&(v=!0);if(2==b[y].length)for(var w=0;w<i.length;w++)i[w]!=b[y]&&i[w]!=b[y].toUpperCase()&&i[w]!=s&&i[w]!=o||(v=!0,b[y]=r[w])}for(var k=0;k<e.content.length;k++)if(a=e.searchStrContent[k],n=e.content[k].title,e.content[k],n&&a){h=!0,f=!0;for(var y=0;y<b.length;y++)s=b[y].charAt(0).toUpperCase()+b[y].slice(1),o=b[y].charAt(0).toLowerCase()+b[y].slice(1),a||console.log(k),h=h&&(a.indexOf(b[y])>-1||a.indexOf(b[y].toUpperCase())>-1||a.indexOf(s)>-1||a.indexOf(o)>-1),f=f&&(n.indexOf(b[y])>-1||n.indexOf(b[y].toUpperCase())>-1||n.indexOf(s)>-1||n.indexOf(o)>-1);f?(p={},p=JSON.parse(JSON.stringify(e.content[k])),p.useTemp=!1,v?m.push(p):p.ismp&&m.push(p),l=!0):h&&(p={},p=JSON.parse(JSON.stringify(e.content[k])),p.useTemp=!1,v?g.push(p):p.ismp&&g.push(p))}else console.log("this has issues - content.id - ",e.content[k]);l&&(c=c.concat(m)),c=c.concat(g)}else c=[];return c}function i(e,t){for(var n=!1,a=0;a<t.length;a++)if(e.nh_name==t[a].nh_name){n=!0;break}n||t.push(e)}return{searchRanks:s,searchRanks2:o,searchAnswers:t,searchRanksMainPage:n,sibblingRanks:a}}angular.module("app").service("search",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(a){function s(e){return e}function o(a){if(0!=a.data.resource.length){var s=a.data.resource[0],o="/api/v2/mysql/_table/categories/?filter=id="+s.category,i="/api/v2/mysql/_table/ranking/?filter=(cat="+s.category+") AND (nh=1)",l=e.get(o),c=e.get(i);return t.all([l,c]).then(function(e){var t=e[1].data.resource[0],a=e[0].data.resource[0];return t.title=a.category.replace("@Nh","San Diego"),t.fimage=a.fimage,t.introtext=a.introtext,t.tags=a.tags,t.question=a.question,t.type=a.type,t.fc=a.fc,t.bc=a.bc,t.shade=a.shade,r.push(t),n.$emit("rodReady"),r},function(e){console.log("Error getting rank of day data: ",e)})}}var l=new Date,d=l.getTimezoneOffset();l.setMinutes(l.getMinutes()-d);var u=s(l.getMonth()+1)+"/"+s(l.getDate())+"/"+l.getFullYear(),g=c+"/?filter=date="+u;return e.get(g).then(o,i)}function s(){function t(e){return l=e.data.resource}var n=c;return e.get(n).then(t,i)}function o(t,n,a){function s(e){return console.log("updating rank of day succesful"),e.data}var o={};o.resource=[];var r={};r.id=t;for(var d=0;d<n.length;d++)r[n[d]]=a[d];o.resource.push(r);for(var u=c,g=l.map(function(e){return e.id}).indexOf(t),d=0;d<n.length;d++)l[g][n[d]]=a[d];return e.patch(u,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,i)}function i(e){throw e}var r=[];n.rankofday=r;var l=[],c="/api/v2/mysql/_table/rankofday";return{getrankofday:a,getall:s,update:o}}angular.module("app").factory("rankofday",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(n){function a(e){return c=e.data.resource}if(r()&&!n)return t.when(c);var s=d;return e.get(s).then(a,l)}function s(t){function a(e){var t=e.data.resource[0].id;return c[c.length-1].id=t,n.DEBUG_MODE&&console.log("creating pvisits record was succesful"),e.data}var s={};s.date=t,s.nvisits=1;var o={};o.resource=[],o.resource.push(s),c.push(s);var i=d;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,l)}function o(t,a){function s(e){return n.DEBUG_MODE&&console.log("Updating pvisits record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.nvisits=a,o.resource.push(i);var r=d;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,l)}function i(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting user activity record was succesful"),e.data}for(var s=0;s<c.length;s++)c[s].id==t&&c.splice(s,1);var o=d+"/"+t;return e.delete(o).then(a,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/pvisits";return{getpvisits:a,postRec:s,patchRec:o,deleteRec:i}}angular.module("app").factory("pvisits",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(a){if(c.length>0&&!a)return t.when(c);var s=d+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return r(e[0].data.resource),n.DEBUG_MODE&&console.log("No. Categories ",c.length),c},l)}function s(t){function n(e){var n=t;return n.id=e.data.resource[0].id,c.push(n),console.log("adding locationx succesful",e),e.data}var a=d,s=[];return s.push(t),e.post(a,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,l)}function o(t,n,a){function s(e){return console.log("updating locationx succesful"),e.data}var o={};o.resource=[];var i={};i.id=t;for(var r=0;r<n.length;r++)i[n[r]]=a[r];o.resource.push(i);for(var u=d,g=c.map(function(e){return e.id}).indexOf(t),r=0;r<n.length;r++)c[g][n[r]]=a[r];return e.patch(u,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,l)}function i(t){function n(e){return console.log("Deleting location was succesful"),e.data}var a={};a.resource=[];var s={};s.id=t,a.resource.push(s);var o=d+"/"+t,i=c.map(function(e){return e.id}).indexOf(t);return i>-1&&c.splice(i,1),e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:a}).then(n,l)}function r(e){c.length=0,e.forEach(function(e){c.push(e)})}function l(e){throw e}var c=[];n.locations=c;var d="/api/v2/mysql/_table/locations";return{getAllLocations:a,addLocation:s,update:o,deleteRec:i}}angular.module("app").factory("locations",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(n){if(r()&&!n)return t.when(c);var a=d+"?offset=0",s=e.get(a);return t.all([s]).then(function(e){return i(e[0].data.resource),c},l)}function s(t){function a(e){var a=t;return a.id=e.data.resource[0].id,c.push(a),n.DEBUG_MODE&&console.log("result",e),e.data}var s=d,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,l)}function o(t,a,s){function o(e){return console.log("updating headlines succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var u=0;u<a.length;u++)switch(a[u]){case"city":r.city=s[u];break;case"nh":r.nh=s[u];break;case"title":r.title=s[u];break;case"filter":r.filter=s[u];break;case"bc":r.bc=s[u];break;case"fc":r.fc=s[u]}i.resource.push(r);for(var g=d,m=c.map(function(e){return e.id}).indexOf(t),u=0;u<a.length;u++)switch(a[u]){case"city":n.content[m].city=s[u];break;case"nh":n.content[m].nh=s[u];break;case"title":n.content[m].title=s[u];break;case"filter":n.content[m].filter=s[u];break;case"bc":n.content[m].bc=s[u];break;case"fc":n.content[m].fc=s[u]}return e.patch(g,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,l)}function i(e){c.length=0,e.forEach(function(e){c.push(e)})}function r(){return c.length>0}function l(e){throw e}var c=[];n.headlines=c;var d="/api/v2/mysql/_table/headlines";return{getheadlines:a,addheadline:s,update:o}}angular.module("app").factory("headline",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b,y){function w(){n.DEBUG_MODE&&console.log("get initial data called");var e=[1733,11619,11285,11288,11673,9734,468,9822,11271,11927,11241,7674],a=[1164,1130,1403,1407,1313,1275,1149,1276,1390,1475,1367,1241],s=r.getInitialHomeData(e),i=b.getInitialHomeData(a);t.all([s,i]).then(function(){A(),n.$emit("initalHomeDataLoaded")});o.getrankofday()}function k(){}function x(e){n.DEBUG_MODE&&console.log("gethomedataX called"),n.pageDataLoaded=!1;var a=r.getTablesX(e),s=b.getAllCategoriesX(e),o=y.getAllLocations(),l=i.getAnswersX(e);return t.all([a,s,o,l]).then(function(e){A(),I(),C(),n.isLoggedIn&&E(),n.pageDataLoaded=!0,N(),R(),n.DEBUG_MODE&&console.log("cwrapper data ready!"),n.$emit("homeDataLoaded")})}function R(){d.getactions(),h.getheadlines()}function A(){n.DEBUG_MODE&&console.log("dataloader.unwrap");for(var e={},t={},a=-1,s=-1,a=0,o=0;o<n.content.length;o++)a=n.locations.map(function(e){return e.id}).indexOf(n.content[o].nh),e=n.locations[a],s=n.categories.map(function(e){return e.id}).indexOf(n.content[o].cat),t=n.categories[s],void 0==e&&(e={},e.nh_name="San Diego",e.id=1,e.sub_areas=""),t?(n.content[o].title=t.category.replace("@Nh",e.nh_name),n.content[o].fimage=t.fimage,n.content[o].bc=t.bc,n.content[o].fc=t.fc,n.content[o].tags=t.tags,n.content[o].keywords=t.keywords,n.content[o].type=t.type,n.content[o].question=t.question,n.content[o].shade=t.shade,1==n.content[o].nh?n.content[o].introtext=t.introtext:n.content[o].introtext="",n.content[o].user=t.user,e.sub_areas&&t.category.indexOf("@Nh")>-1?n.content[o].isatomic=!1:n.content[o].isatomic=!0,null!=t.ismp&&void 0!=t.ismp?n.content[o].ismp=t.ismp:1==e.id?n.content[o].ismp=!0:n.content[o].ismp=!1):console.log("Couldnt find this category --- ",n.content[o].cat)}function E(){var e=[{category:11091,id:11091},{category:11092,id:11092},{category:11093,id:11093}];s.getTablesD(e).then(function(){B=!0,O()}),v.getAllcatansX(e).then(function(e){0!=e?i.getAnswersL(e).then(function(){U=!0,O()}):(U=!0,O())}),l.getSpecialsbyAnswer(1).then(function(){X=!0,O()})}function O(){G=B&&U&&X,L()}function S(){var e=a.getpvisits();return t.all([e]).then(function(e){n.pvisits=e[0],D(),n.DEBUG_MODE&&console.log("page visits data ready!")})}function D(){function e(e){return e}var t=new Date,s=t.getTimezoneOffset();t.setMinutes(t.getMinutes()-s);for(var o=e(t.getMonth()+1)+"/"+e(t.getDate())+"/"+t.getFullYear(),i=!0,r={},l=0;l<n.pvisits.length;l++)if(n.pvisits[l].date==o){i=!1,r=n.pvisits[l];break}i?a.postRec(o):a.patchRec(r.id,r.nvisits+1),n.dateToday=o,n.dateTodayNum=c.date2number(o)}function C(){n.estAnswers=[],n.estNames=[],n.pplAnswers=[],n.pplNames=[],n.plaAnswers=[],n.plaNames=[],n.freAnswers=[],n.freNames=[],n.orgNames=[],n.orgAnswers=[],n.orgNames=[];for(var e=0;e<n.answers.length;e++)"Establishment"==n.answers[e].type&&(n.estNames.push(n.answers[e].name),n.estAnswers.push(n.answers[e])),"Person"==n.answers[e].type&&(n.pplNames.push(n.answers[e].name),n.pplAnswers.push(n.answers[e])),"Place"==n.answers[e].type&&(n.plaNames.push(n.answers[e].name),n.plaAnswers.push(n.answers[e])),"Organization"==n.answers[e].type&&(n.orgNames.push(n.answers[e].name),n.orgAnswers.push(n.answers[e])),"PersonCust"==n.answers[e].type&&(n.freNames.push(n.answers[e].name),n.freAnswers.push(n.answers[e]))}function I(){n.searchStr=[];for(var e=0;e<n.categories.length;e++)n.searchStr[e]=(n.categories[e].tags?n.categories[e].tags:"")+" "+(n.categories[e].title?n.categories[e].title:"");n.searchStrContent=[];for(var e=0;e<n.content.length;e++)n.searchStrContent[e]=(n.content[e].tags?n.content[e].tags:"")+" "+(n.content[e].title?n.content[e].title:"")}function P(e,t){"ranks"==e&&v.getAllcatansX(t).then(function(e){if(e){$=!0,0!=n.rankSummaryDataLoaded&&void 0!=n.rankSummaryDataLoaded||N();for(var t=0,a=e.length>200?200:e.length;t<e.length;)i.getAnswersL(e.slice(t,a)),l.getSpecialsX(e.slice(t,a)),p.getVrowsX(e.slice(t,a)),u.GetMatchTableX(e.slice(t,a)),m.getAllUserActivityX(e.slice(t,a)),g.getEditsX(e.slice(t,a)),s.getTablesX(e.slice(t,a)),t=a,(a+=200)>e.length&&(a=e.length)}}),"answers"==e&&v.getAllcatansY(t).then(function(e){if(e){for(var n=0,a=e.length>200?200:e.length;n<e.length;)l.getSpecialsX(e),p.getVrowsX(e),u.GetMatchTableX(e),m.getAllUserActivityX(e),g.getEditsX(e),s.getTablesX(e).then(function(e){0!=e&&P("ranks",e)}),n=a,(a+=200)>e.length&&(a=e.length);var o=[],i={};t.forEach(function(e){if(null!=e.ranks&&e.ranks.length>2){i=JSON.parse(e.ranks);for(var t=0;t<i.length;t++)o.push(i[t])}}),P("ranks",o)}})}function T(e){z=!0,$=!1;var t=e.split("-").map(Number),a=t[t.length-1];r.getSingleTable(a).then(function(e){v.getAllcatansX(e).then(function(e){$=!0,N(),0!=e&&i.getAnswersL(e).then(function(e){n.answerDetailLoaded=!0,P("answers",e)})}),1==e[0].scope?(n.SCOPE=1,w(),x(1)):(n.SCOPE=2,w(),x(2)),n.$emit("setScope")})}function M(e){q=!0;var a=e.split("-").map(Number),o=a[a.length-1];i.getAnswer(o).then(function(e){V=!0,L(),1==e.scope?(n.SCOPE=1,w(),x(1)):(n.SCOPE=2,w(),x(2)),n.$emit("setScope")});var c={};c.id=o,v.getAllcatansY([c]).then(function(e){var n=r.getTablesL(e),a=m.getAllUserActivityX(e);return t.all([n,a]).then(function(e){Y=!0,L()})}),c.answer=o;var d=l.getSpecialsX([c]),h=u.GetMatchTableX([c]),f=g.getEditsX([c]),b=s.getTablesX([c]),y=p.getVrowsX([c]);return t.all([d,h,f,b,y]).then(function(e){F=!0,L()})}function L(){V&&Y&&F&&(n.isLoggedIn?G&&(n.rankSummaryDataLoaded=!0,n.answerDetailLoaded=!0,n.$emit("answerDataLoaded")):(n.rankSummaryDataLoaded=!0,n.answerDetailLoaded=!0,n.$emit("answerDataLoaded")))}function N(){n.pageDataLoaded&&$&&!q&&(n.rankSummaryDataLoaded=!0,n.answerDetailLoaded=!0,n.$emit("rankDataLoaded"))}var _={gethomedata:k,gethomedataX:x,landRanking:T,landAnswer:M,getpagevisitdata:S,getInitialData:w,unwrap:A,createSearchStrings:I,pulldata:P,getDemoData:E},$=!1,B=!1,U=!1,X=!1,G=!1,V=!1,F=!1,Y=!1,q=!1,z=!1;return _}angular.module("app").factory("dataloader",e),e.$inject=["$http","$q","$rootScope","pvisits","table2","rankofday","answer","table","special","datetime","uaf","matchrec","edit","useractivity","vrows","headline","cblock","catans","categories","locations"]}(),function(){"use strict";function e(e,t,n){function a(a){if(c()&&!a)return t.when(u);var s=g+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return u=e[0].data.resource,n.DEBUG_MODE&&console.log("No. C-Blocks: ",u.length),u},d)}function s(){var a=g+"/?filter=ismp=true",s=e.get(a);return t.all([s]).then(function(e){return u=e[0].data.resource,n.DEBUG_MODE&&console.log("No. C-Blocks: ",u.length),u},d)}function o(){var a=g+"/?filter=ismp=false",s=e.get(a);return t.all([s]).then(function(e){return u=u.concat(e[0].data.resource),n.DEBUG_MODE&&console.log("No. C-Blocks: ",u.length),u},d)}function i(t){function n(e){var n=t;return n.id=e.data.resource[0].id,u.push(n),console.log("adding cblock succesful",e),e.data}var a=g,s=[];return s.push(t),e.post(a,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,d)}function r(t,n,a){function s(e){return console.log("updating cblocks succesful"),e.data}var o={};o.resource=[];var i={};i.id=t;for(var r=0;r<n.length;r++)switch(n[r]){case"catstr":i.catstr=a[r];break;case"ismp":i.ismp=a[r]}o.resource.push(i);for(var l=g,c=u.map(function(e){return e.id}).indexOf(t),r=0;r<n.length;r++)switch(n[r]){case"catstr":u[c].catstr=a[r];break;case"ismp":u[c].ismp=a[r]}return e.patch(l,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function l(t){function n(e){return console.log("Deleting cblock was succesful"),e.data}var a={};a.resource=[];var s={};s.id=t,a.resource.push(s);var o=g+"/"+t,i=u.map(function(e){return e.id}).indexOf(t);return i>-1&&u.splice(i,1),e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:a}).then(n,d)}function c(){return u.length>0}function d(e){throw e}var u=[],g="/api/v2/mysql/_table/cblocks";return{getcblocks:a,getcblocksmain:s,getcblocksall:o,addcblock:i,update:r,deleteRec:l}}angular.module("app").factory("cblock",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n,a){function s(s){var o=a.localStorage.getItem("Categories-HomeData");if(o)return u(JSON.parse(o)),t.when(!0);for(var i="?filter=(",r=0;r<s.length;r++)i=i+"id="+s[r]+")OR(";i=i.substring(0,i.length-3);var l=p+i,c=e.get(l);return t.all([c]).then(function(e){var t=e[0].data.resource;return 0==m.length&&u(t),n.DEBUG_MODE&&console.log("categories length: ",m.length),a.localStorage.setItem("Categories-HomeData",JSON.stringify(t)),m},g)}function o(a){var s=p+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return u(e[0].data.resource),n.DEBUG_MODE&&console.log("No. Categories ",m.length),m},g)}function i(a){var s=p+"?offset=0&filter=scope="+a,o=e.get(s);return t.all([o]).then(function(e){return u(e[0].data.resource),n.DEBUG_MODE&&console.log("No. Categories ",m.length),m},g)}function r(a){for(var s="?filter=(",o=0;o<a.length;o++)s=s+"id="+a[o].cat+")OR(";s=s.substring(0,s.length-3);var i=p+s,r=e.get(i);return t.all([r]).then(function(e){return u(e[0].data.resource),n.categories=e[0].data.resource,n.DEBUG_MODE&&console.log("No. Categories ",m.length),m},g)}function l(t){function a(e){var n=t;return n.id=e.data.resource[0].id,m.push(n),console.log("adding categoryx succesful",e),e.data}t.scope=n.SCOPE;var s=p,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,g)}function c(t,a,s){function o(e){for(var o=m.map(function(e){return e.id}).indexOf(t),i=0;i<a.length;i++)m[o][a[i]]=s[i];for(var i=0;i<n.content.length;i++)if(n.content[i].cat==m[o].id)for(var r=0;r<a.length;r++)n.content[i][a[r]]=s[r];return console.log("updating categoryx succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);var c=p;return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,g)}function d(t){function n(e){return console.log("Deleting category was succesful"),e.data}var a={};a.resource=[];var s={};s.id=t,a.resource.push(s);var o=p+"/"+t,i=m.map(function(e){return e.id}).indexOf(t);return i>-1&&m.splice(i,1),e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:a}).then(n,g)}function u(e){m.length=0,e.forEach(function(e){m.push(e)})}function g(e){throw e}var m=[];n.categories=m;var p="/api/v2/mysql/_table/categories";return{getAllCategories:o,getAllCategoriesX:i,getAllCategoriesG:r,addCategory:l,update:c,deleteRec:d,getInitialHomeData:s}}angular.module("app").factory("categories",e),e.$inject=["$http","$q","$rootScope","$window"]}(),angular.module("app").directive("userfeedBlock",["$rootScope","$state","fbusers","$q","uaf","color","dataloader",function(e,t,n,a,s,o,i){"use strict";return{templateUrl:"app/content/partials/userfeed-block.html",transclude:!0,scope:{showAll:"@",showQty:"@"},controller:["$scope","$window","uaf",function(t,n,a){var s=t;s.title="mycontent",s.sm=e.sm,n.innerWidth<768&&(s.thumbheight="80px"),n.innerWidth>=768&&n.innerWidth<992&&(s.thumbheight="100px"),n.innerWidth>=992&&n.innerWidth<1200&&(s.thumbheight="80px"),n.innerWidth>1200&&(s.thumbheight="100px")}],link:function(r){function l(){c(),0==r.feeds.length&&(r.feeds=e.uafs),r.fres=r.showQty}function c(){r.feeds=[],a.all(e.uafs.map(function(e){return n.getFBUserById(e.userid)})).then(function(t){r.feeds=[];for(var n=0;n<e.uafs.length;n++){var a=angular.copy(e.uafs[n]);a.picture=t[n]?t[n].picture.data.url:null,r.feeds[n]=a}})}function d(e){for(var t=[],n=[],a={},s=0;s<e.length;s++)a={},"addedCustomRank"==e[s].action&&(a.id=e[s].answer,n.push(a)),"addedRank"==e[s].action&&(a.id=e[s].category,t.push(a)),"binded"==e[s].action&&(a.id=e[s].answer,n.push(a)),"downVotedVrow"==e[s].action&&(a.id=e[s].answer,n.push(a)),"upVotedVrow"==e[s].action&&(a.id=e[s].answer,n.push(a)),"editA"==e[s].action&&(a.id=e[s].answer,n.push(a)),"commentA"==e[s].action&&(a.id=e[s].answer,n.push(a)),"commentR"==e[s].action&&(a.id=e[s].category,t.push(a)),"downVoted"==e[s].action&&(a.id=e[s].category,t.push(a),a={},a.id=e[s].answer,n.push(a)),"upVoted"==e[s].action&&(a.id=e[s].category,t.push(a),a={},a.id=e[s].answer,n.push(a)),"addedAnswer"==e[s].action&&(a.id=e[s].category,t.push(a),a={},a.id=e[s].answer,n.push(a));n.length>0&&i.pulldata("answers",n),t.length>0&&i.pulldata("ranks",t)}var u=0;d(e.uafs.slice(u,r.showQty)),void 0==r.isDestroyed&&l();var g="#595959",m=o.shadeColor(g,.5);r.headerStyle="color:#f8f8ff;width:100%;border-style:none;background:#595959;background: -webkit-linear-gradient(left,#595959,"+m+");background: -o-linear-gradient(right,"+g+","+m+");background: -moz-linear-gradient(right,"+g+", "+m+");background: linear-gradient(to right,"+g+", "+m+");",r.$watch("showQty",function(){u=r.fres,r.fres=r.showQty,d(e.uafs.slice(u,r.showQty))}),r.refreshFeed=function(){console.log("refreshFeed"),s.getactions().then(function(t){e.uafs=t,l()})},r.gotoAnswer=function(e){t.go("answerDetail",{index:e.answer})},r.gotoRank=function(e){t.go("rankSummary",{index:e.category})},r.$on("$destroy",function(){r.isDestroyed=!0})}}}]),angular.module("app").directive("trendBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search","dataloader",function(e,t,n,a,s,o,i,r,l,c,d,u){"use strict";return{templateUrl:"app/content/partials/trend-block.html",transclude:!0,scope:{showAll:"@"},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,n,a,s,o,i,r,l,c,d,u,g){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(n){n.isDestroyed,n.popularLimit=10;var a=0;n.newestLimit=10;var s=0;n.userfeedLimit=10,n.seeTab=function(e){1==e&&(n.popular=!0,n.newest=!1),2==e&&(n.newest=!0,n.popular=!1)},n.seeTab(1),function(){var t=angular.copy(e.content.filter(function(e){return 1==e.ismp}));t.sort(function(e,t){var n=e.views?e.views:0,a=t.views?t.views:0;return e.id==t.id?0:n<a?1:-1}),t.forEach(function(e){e.fimage&&""!=e.fimage?e.realimage=e.fimage:e.image1url&&""!=e.image1url?e.realimage=e.image1url:e.realimage="../../../assets/images/noimage.jpg",e.humanized=moment(e.timestmp).fromNow()}),n.popularOrder=t,u.pulldata("ranks",n.popularOrder.slice(a,n.popularLimit)),t=angular.copy(e.content.filter(function(e){return 1==e.ismp})),t.sort(function(e,t){var n=e.timestmp?e.timestmp:0,a=t.timestmp?t.timestmp:0;return e.id==t.id?0:n<a?1:-1}),t.forEach(function(e){e.fimage&&""!=e.fimage?e.realimage=e.fimage:e.image1url&&""!=e.image1url?e.realimage=e.image1url:e.realimage="../../../assets/images/noimage.jpg",e.humanized=moment(e.timestmp).fromNow()}),n.newestOrder=t,u.pulldata("ranks",n.newestOrder.slice(s,n.newestLimit))}(),n.seeMore=function(e){"newest"==e&&(s=n.newestLimit,n.newestLimit+=8,u.pulldata("ranks",n.newestOrder.slice(s,n.newestLimit))),"popular"==e&&(a=n.popularLimit,n.popularLimit+=8,u.pulldata("ranks",n.popularOrder.slice(a,n.popularLimit))),"userfeed"==e&&(n.userfeedLimit+=8)},n.goBack=function(){e.$emit("backToResults")},n.rankSel=function(n,a){e.rankIsNearMe=!!a,e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},n.$on("$destroy",function(){n.isDestroyed=!0}),n.getHumanized=function(e){return moment(e).fromNow()}}}}]),angular.module("app").directive("searchBlock",["$rootScope","$state","search","$timeout","$window","dataloader",function(e,t,n,a,s,o){"use strict";return{templateUrl:"app/content/partials/search-block.html",transclude:!0,scope:{query:"@",ans:"=",ranks:"=",length:"=",init:"=",data:"=",rod:"=",scrollactive:"="},controller:["$scope",function(e){s.innerWidth<768&&(e.itemWidth=(s.innerWidth-8)/2),s.innerWidth>=768&&s.innerWidth<992&&(e.itemWidth=(s.innerWidth-8)/3),s.innerWidth>=992&&s.innerWidth<1200&&(e.itemWidth=(s.innerWidth-8)/4),s.innerWidth>1200&&(e.itemWidth=(s.innerWidth-8)/6)}],link:function(s){function i(){a.cancel(g),g=a(function(){s.query.length>=2&&(s.endReached=!1,s.getResults()),0==s.query.length&&(s.searchResults=d,s.endReached=!1,s.displayResults=s.searchResults.slice(0,s.scrollingItemsOnePage))},300)}function r(e,t){o.pulldata(e,t)}function l(e){for(var t,n,a=e.length;0!==a;)n=Math.floor(Math.random()*a),a-=1,t=e[a],e[a]=e[n],e[n]=t;return e}var c=[],d=[],u=!1;s.contentLoaded=!1,s.rankSel=function(n,a){if(n.useTemp){e.rankIsNearMe=!!a;for(var s={},o=0;o<e.content.length;o++)n.id==e.content[o].cat&&n.locationId==e.content[o].nh&&(s=e.content[o]);if(void 0==s.id){console.log("rank is ghost");var i=0;e.content.forEach(function(e){e.id>i&&(i=e.id)}),i++;var r=n.title.toLowerCase();r=r.replace(/ /g,"-"),r=r.replace("/","at"),r=r+"-"+i;var l={id:i,catstr:""+i,slug:r,isGhost:!0,title:n.title,type:n.type,tags:n.tags,keywords:n.keywords,question:n.question,fimage:n.fimage,bc:n.bc,fc:n.fc,shade:n.shade,introtext:n.introtext,user:n.user,views:0,answers:0,image1url:"../../../assets/images/noimage.jpg",image2url:"../../../assets/images/noimage.jpg",image3url:"../../../assets/images/noimage.jpg",answertags:"",isatomic:1,timestmp:new Date,cat:n.id,nh:n.locationId};e.content.push(l),e.searchStrContent.push(l.tags?l.tags:""),t.go("rankSummary",{index:r})}else e.editMode?t.go("editRanking",{index:s.slug}):t.go("rankSummary",{index:s.slug})}else e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},s.ansSel=function(n){e.PAGEYOFFSET=window.pageYOffset,e.cCategory=void 0,t.go("answerDetail",{index:n.slug})},s.resRanks=[],s.resAnswers=[],s.searchResults=[],s.displayResults=[],s.maxRes=4e3;var g;s.$watch("query",function(){u?i():s.contentLoaded=!1}),s.getResults=function(){s.useTemp=!1,s.resRanks=[];var e=[];s.resRanks=n.searchRanks2(s.query),e=n.searchRanks(s.query);for(var t=s.resRanks.map(function(e){return e.cat}),a=0;a<e.length;a++)t.indexOf(e[a].id)<0&&s.resRanks.push(e[a]);s.resRanks.length>0&&(s.disableScrolling=!1,s.currentIndex=s.intialDataCount,s.startIndex=0,s.endReached=!1),s.resAnswers=[],s.ans&&(s.resAnswers=n.searchAnswers(s.query));for(var a=0;a<s.resAnswers.length;a++)s.resAnswers[a].isAnswer=!0,"Establishment"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Establishment",s.resAnswers[a].icon="fa fa-building-o"),"Person"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Public Figure",s.resAnswers[a].icon="fa fa-male"),"PersonCust"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Contractor",s.resAnswers[a].icon="fa fa-male"),"Short-Phrase"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Opinion",s.resAnswers[a].icon="fa fa-comment-o"),"Event"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Event",s.resAnswers[a].icon="fa fa-calendar-o"),"Organization"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Brand",s.resAnswers[a].icon="fa fa-trademark"),"Place"==s.resAnswers[a].type&&(s.resAnswers[a].itext="Place",s.resAnswers[a].icon="fa fa-map-marker");s.length=s.resRanks.length+s.resAnswers.length,s.searchResults=s.resRanks.concat(s.resAnswers),s.displayResults=s.searchResults.slice(0,s.scrollingItemsOnePage),c=s.displayResults;for(var o=[],i=[],a=0;a<s.displayResults.length;a++)s.displayResults[a].isAnswer?i.push(s.displayResults[a]):o.push(s.displayResults[a]);o.length>0&&r("ranks",o),i.length>0&&r("answers",i)};var m;s.$watch("init",function(){a.cancel(m),m=a(function(){s.init&&s.getContent()},50)}),s.getContent=function(){d=[],e.content.length<50?d=JSON.parse(JSON.stringify(e.content)):e.content.forEach(function(e){e.ismp&&d.push(e)}),d.length>0&&(l(d),s.disableScrolling=!1,s.currentIndex=s.intialDataCount,s.startIndex=0,s.endReached=!1),u=!1,s.searchResults=d,s.displayResults=s.searchResults.slice(0,s.scrollingItemsOnePage),c=s.searchResults.slice(0,s.scrollingItemsOnePage),r("ranks",c),s.contentLoaded=!0};var p;s.$watch("data",function(){a.cancel(p),p=a(function(){s.data&&s.addContent()},50)}),s.addContent=function(){var t=d.map(function(e){return e.id})
;e.content.forEach(function(e){t.indexOf(e.id)<0&&e.ismp&&d.push(e)}),s.searchResults=JSON.parse(JSON.stringify(d)),u=!0,s.contentLoaded=!0,i()};var h;s.$watch("rod",function(){a.cancel(h),h=a(function(){if(1==s.rod&&e.rankofday){var t=e.rankofday;t[0].isrod=!0,d[0]=t[0],s.displayResults[0]=t[0]}},50)}),s.$watch("scrollactive",function(){s.disableScrolling=!s.scrollactive}),e.sm?(s.scrollingItemsOnePage=6,s.loadingCountOneScroll=3):(s.loadingCountOneScroll=6,s.scrollingItemsOnePage=12),s.scrollingItemsOnePage=12,s.scrollingData=[],s.scrollDataLoading=!1,s.content=[],s.intialDataCount=e.numInitItems,s.endReached=!1,s.disableScrolling=!0,s.scrollingData=[],s.uniqueResult=[],function(e){s.currentIndex=12,s.startIndex=0,s.loadingCountOneScroll=6,s.scrollingData=[],s.scrollDataLoading=!1,s.content=[],s.endReached=!1,s.scrollingData=[]}(),s.loadMore=function(){s.scrollactive&&(s.scrollDataLoading=!0,a(function(){var e=s.displayResults.length;c=[];for(var t=e;t<e+s.scrollingItemsOnePage;t++)s.searchResults[t]&&(s.displayResults.push(s.searchResults[t]),c.push(s.searchResults[t]));c.length>0&&r("ranks",c),s.scrollDataLoading=!1,s.displayResults.length==s.searchResults.length&&u&&(s.endReached=!0)},500))}}}}]),angular.module("app").directive("resultItem",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/result-block.html",transclude:!0,scope:{resultObject:"="},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,n,a,s,o,i,r,l,c,d,u,g){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(n,a,s){void 0==n.isDestroyed&&function(){var t=r.innerWidth-20;n.w2=Math.round(t/2),n.w4=Math.round(t/4)-5,n.w8=Math.round(t/8);var a={};if(a={},a=JSON.parse(JSON.stringify(n.resultObject)),n.rank=a,n.title=a.title,n.imageurl=a.fimage,n.type=a.type,n.stats={},n.stats.views=a.views,n.stats.answers=a.answers,n.stats.numcom=a.numcom,void 0!=n.stats.numcom&&null!=n.stats.numcom||(n.stats.numcom=0),void 0!=a.fimage&&""!=a.fimage)if(n.image4=a.image3url,n.image3=a.image2url,n.image2=a.image1url,n.image1=a.fimage,void 0!=a.bc&&""!=a.bc)n.bc=a.bc,n.fc=a.fc,n.shade=a.shade;else{var s=c.defaultRankColor(a);n.bc=s[0],n.fc=s[1],n.shade=-4}"Short-Phrase"==a.type&&(n.image1=e.EMPTY_IMAGE)}(),n.rankSel=function(n,a){e.rankIsNearMe=!!a,e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("rankOfDay",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/rank-of-day.html",transclude:!0,scope:{part:"="},controller:["$scope","$rootScope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search","rankofday",function(e,t,n,a,s,o,i,r,l,c,d,u,g,m){function p(){var t=c.innerWidth-20;e.w2=Math.round(t/2),e.w4=Math.round(t/4)-5,e.w8=Math.round(t/8);var n={};if(n={},n=JSON.parse(JSON.stringify(e.rankObject)),h(n),f(n),e.rank=n,e.title=n.title,e.stats={},e.stats.views=n.views,e.stats.answers=n.answers,e.stats.numcom=n.numcom,void 0!=e.stats.numcom&&null!=e.stats.numcom||(e.stats.numcom=0),e.isBasic=!0,void 0!=n.fimage&&""!=n.fimage)e.image4=n.image3url,e.image3=n.image2url,e.image2=n.image1url,e.image1=n.fimage,e.bc=n.bc,e.fc=n.fc,e.shade=n.shade;else{var a=u.defaultRankColor(n);e.bc=a[0],e.fc=a[1],e.shade=-4,e.image3=n.image3url,e.image2=n.image2url,e.image1=n.image1url}}function h(e){e.titlex=e.title.replace(" in San Diego",""),0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}function f(t){if("Short-Phrase"==t.type){if(t.isShortPhrase=!0,void 0!=t.image1url){var n=t.image1url.split("##");e.title1=n[0],e.addinfo1=n[1]}if(void 0!=t.image2url){var a=t.image2url.split("##");e.title2=a[0],e.addinfo2=a[1]}if(void 0!=t.image3url){var s=t.image3url.split("##");e.title3=s[0],e.addinfo3=s[1]}e.isShortPhrase=!0,e.bcp="#2952a3",e.bc2p="#5c85d6",e.fcp="#e6e6e6"}}var v=e;v.title="mycontent",t.rankofday?(e.rankObject=t.rankofday,p()):m.getrankofday().then(function(n){e.rankObject=t.rankofday=n,p()}),v.sm=t.DISPLAY_XSMALL,v.maxRes=2,c.innerWidth<768&&(v.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(v.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(v.thumbheight="80px"),c.innerWidth>1200&&(v.thumbheight="100px")}],link:function(n){n.rankSel=function(n,a){a?$rootscope.rankIsNearMe=!0:e.rankIsNearMe=!1,e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("rankItem",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/rank-block.html",transclude:!0,scope:{rankObject:"="},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,n,a,s,o,i,r,l,c,d,u,g){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(n){function a(e){0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}void 0==n.isDestroyed&&function(){var e=r.innerWidth-20;n.w2=Math.round(e/2),n.w4=Math.round(e/4)-5,n.w8=Math.round(e/8);var t={};if(t={},t=n.rankObject,n.rank=t,a(n.rankObject),n.title=t.title,n.rod=t.isrod,n.stats={},n.stats.views=t.views,n.stats.answers=t.answers,n.stats.numcom=t.numcom,void 0!=n.stats.numcom&&null!=n.stats.numcom||(n.stats.numcom=0),void 0!=t.fimage&&""!=t.fimage)if(n.image4=t.image3url,n.image3=t.image2url,n.image2=t.image1url,n.image1=t.fimage,void 0!=t.bc&&""!=t.bc)n.bc=t.bc,n.fc=t.fc,n.shade=t.shade;else{var s=c.defaultRankColor(t);n.bc=s[0],n.fc=s[1],n.shade=-4}else{var s=c.defaultRankColor(t);n.bc=s[0],n.fc=s[1],n.shade=-4,n.image3=t.image3url,n.image2=t.image2url,n.image1=t.image1url}}(),n.rankSel=function(n,a){e.rankIsNearMe=!!a,e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("rankBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/rank-block.html",transclude:!0,scope:{theme:"@",type:"@"},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,n,a,s,o,i,r,l,c,d,u,g){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(n){function a(e){for(var t,n,a=e.length;0!==a;)n=Math.floor(Math.random()*a),a-=1,t=e[a],e[a]=e[n],e[n]=t;return e}function s(e){e.titlex=e.title.replace(" in San Diego",""),0==e.answers&&"Short-Phrase"!=e.type&&(e.image1url="../../../assets/images/noimage.jpg")}function o(e){if("Short-Phrase"==e.type){if(e.isShortPhrase=!0,void 0!=e.image1url){var t=e.image1url.split("##");e.title1=t[0],e.addinfo1=t[1]}if(void 0!=e.image2url){var n=e.image2url.split("##");e.title2=n[0],e.addinfo2=n[1]}if(void 0!=e.image3url){var a=e.image3url.split("##");e.title3=a[0],e.addinfo3=a[1]}}}void 0==n.isDestroyed&&function(){var t="",i=[],l=0;n.results=[];var d=r.innerWidth-20;n.w2=Math.round(d/2),n.w4=Math.round(d/4)-5,n.w8=Math.round(d/8);for(var u=0;u<e.cblocks.length;u++)if("city"==e.cblocks[u].scope&&e.isCity&&e.cblocks[u].type==n.theme){t=e.cblocks[u].catstr,i=t.split(":"),a(i);for(var g=0;g<i.length;g++)l=e.content.map(function(e){return e.id}).indexOf(Number(i[g])),n.results.push(e.content[l]);break}n.resultsTop=[];var m={},p=n.results.length;if(p>0)for(var h=0;h<p;h++)m={},m=JSON.parse(JSON.stringify(n.results[h])),n.results[h].image1url!=e.EMPTY_IMAGE&&void 0!=n.results[h].image1url&&""!=n.results[h].image1url&&(s(m),o(m),"Short-Phrase"==m.type&&void 0==m.fimage||n.resultsTop.push(m));var f=n.resultsTop[0];if(n.title=f.title,n.stats={},n.stats.views=f.views,n.stats.answers=f.answers,n.stats.numcom=f.numcom,void 0!=n.stats.numcom&&null!=n.stats.numcom||(n.stats.numcom=0),"basic"==n.type&&(n.isBasic=!0),"grid4"==n.type&&(n.isGrid4=!0),void 0!=f.fimage&&""!=f.fimage)n.image4=f.image3url,n.image3=f.image2url,n.image2=f.image1url,n.image1=f.fimage,n.bc=f.bc,n.fc=f.fc,n.shade=f.shade;else{var v=c.defaultRankColor(f);n.bc=v[0],n.fc=v[1],n.shade=-4,n.image3=f.image3url,n.image2=f.image2url,n.image1=f.image1url}}(),n.rankSel=function(n,a){e.rankIsNearMe=!!a,e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("facebookFollow",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/facebook-follow.html",transclude:!0,scope:{theme:"@",type:"@"},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d,u){}],link:function(e){}}}]),angular.module("app").directive("contentBlock",["$rootScope","$state","search","$timeout","$window",function(e,t,n,a,s){"use strict";return{templateUrl:"app/content/partials/content-block.html",transclude:!0,scope:{query:"@",ans:"=",ranks:"=",length:"="},controller:["$scope",function(e){s.innerWidth<768&&(e.itemWidth=(s.innerWidth-8)/2),s.innerWidth>=768&&s.innerWidth<992&&(e.itemWidth=(s.innerWidth-8)/3),s.innerWidth>=992&&s.innerWidth<1200&&(e.itemWidth=(s.innerWidth-8)/4),s.innerWidth>1200&&(e.itemWidth=(s.innerWidth-8)/6)}],link:function(s){s.rankSel=function(n,a){if(s.disableScrolling=!0,n.useTemp){e.rankIsNearMe=!!a;for(var o={},i=0;i<e.content.length;i++)n.id==e.content[i].cat&&n.locationId==e.content[i].nh&&(o=e.content[i]);if(void 0==o.id){var r=0;e.content.forEach(function(e){e.id>r&&(r=e.id)}),r++;var l=n.title.toLowerCase();l=l.replace(/ /g,"-"),l=l.replace("/","at"),l=l+"-"+r;var c={id:r,catstr:""+r,slug:l,isGhost:!0,title:n.title,type:n.type,tags:n.tags,keywords:n.keywords,question:n.question,fimage:n.fimage,bc:n.bc,fc:n.fc,shade:n.shade,introtext:n.introtext,user:n.user,views:0,answers:0,image1url:"../../../assets/images/noimage.jpg",image2url:"../../../assets/images/noimage.jpg",image3url:"../../../assets/images/noimage.jpg",answertags:"",isatomic:1,timestmp:new Date,cat:n.id,nh:n.locationId};e.content.push(c),e.searchStrContent.push(c.tags?c.tags:""),t.go("rankSummary",{index:l})}else e.editMode?t.go("editRanking",{index:o.slug}):t.go("rankSummary",{index:o.slug})}else e.editMode?t.go("editRanking",{index:n.slug}):t.go("rankSummary",{index:n.slug})},s.ansSel=function(n){e.cCategory=void 0,s.disableScrolling=!0,t.go("answerDetail",{index:n.slug})},s.resRanks=[],s.resAnswers=[],s.searchResults=[],s.maxRes=4e3;var o;s.$watch("query",function(){a.cancel(o),o=a(function(){s.getResults()},300)}),s.getResults=function(){s.useTemp=!1,s.resRanks=[];var e=[];if(s.ranks){e=[],s.resRanks=n.searchRanks2(s.query),e=n.searchRanks(s.query);for(var t=s.resRanks.map(function(e){return e.cat}),a=0;a<e.length;a++)t.indexOf(e[a].id)<0&&s.resRanks.push(e[a]);s.resRanks.length>0&&(s.disableScrolling=!1,s.currentIndex=s.intialDataCount,s.startIndex=0,s.endReached=!1)}s.length=s.resRanks.length+s.resAnswers.length,s.searchResults=s.resRanks},s.currentIndex=0,s.startIndex=0,e.sm?(s.scrollingItemsOnePage=6,s.loadingCountOneScroll=3):(s.loadingCountOneScroll=6,s.scrollingItemsOnePage=6),s.scrollingItemsOnePage=1e3,s.scrollingData=[],s.scrollDataLoading=!1,s.content=[],s.intialDataCount=12,s.endReached=!1,s.disableScrolling=!0,s.scrollingData=[],s.uniqueResult=[],function(e){s.currentIndex=12,s.startIndex=0,s.loadingCountOneScroll=6,s.scrollingData=[],s.scrollDataLoading=!1,s.content=[],s.endReached=!1,s.scrollingData=[]}(),s.loadMore=function(){s.scrollDataLoading=!0,a(function(){s.currentIndex=s.currentIndex+12,s.currentIndex>=s.searchResults.length&&(s.endReached=!0),s.currentIndex-s.startIndex>s.scrollingItemsOnePage&&(s.startIndex=s.currentIndex-s.scrollingItemsOnePage),s.scrollDataLoading=!1},500)}}}}]),angular.module("app").directive("answerItem",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/content/partials/answer-block.html",transclude:!0,scope:{answerObject:"="},controller:["$scope","query","$http","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(t,n,a,s,o,i,r,l,c,d,u,g){var m=t;m.title="mycontent",m.sm=e.sm,c.innerWidth<768&&(m.thumbheight="80px"),c.innerWidth>=768&&c.innerWidth<992&&(m.thumbheight="100px"),c.innerWidth>=992&&c.innerWidth<1200&&(m.thumbheight="80px"),c.innerWidth>1200&&(m.thumbheight="100px")}],link:function(n){function a(e){if("Short-Phrase"==e.type){if(e.isShortPhrase=!0,void 0!=e.image1url){var t=e.image1url.split("##");e.title1=t[0],e.addinfo1=t[1]}if(void 0!=e.image2url){var n=e.image2url.split("##");e.title2=n[0],e.addinfo2=n[1]}if(void 0!=e.image3url){var a=e.image3url.split("##");e.title3=a[0],e.addinfo3=a[1]}}}void 0==n.isDestroyed&&function(){var t=r.innerWidth-20;n.w2=Math.round(t/2),n.w4=Math.round(t/4)-5,n.w8=Math.round(t/8);var s={};s={},s=JSON.parse(JSON.stringify(n.answerObject)),n.answer=s,"Short-Phrase"==s.type&&a(s),n.stats={},n.stats.views=s.views,n.stats.answers=s.answers,n.stats.numcom=s.numcom,void 0!=n.stats.numcom&&null!=n.stats.numcom||(n.stats.numcom=0);var o=Math.floor(5*Math.random())+1;1==o&&(n.bc="brown",n.fc="#f8f8ff"),2==o&&(n.bc="#4682b4",n.fc="#f8f8ff"),3==o&&(n.bc="#008080",n.fc="#f8f8ff"),4==o&&(n.bc="gray",n.fc="#f8f8ff"),5==o&&(n.bc="#c68c53",n.fc="#f8f8ff"),n.shade=-4,void 0!=s.imageurl&&""!=s.imageurl&&null!=s.imageurl?n.image1=s.imageurl:n.image1=e.EMPTY_IMAGE,"Short-Phrase"==s.type&&(n.image1=e.EMPTY_IMAGE)}(),n.ansSel=function(e){t.go("answerDetail",{index:e.slug})},n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),function(){"use strict";function e(e,t,n,a){function s(t){return e({method:"POST",data:t,url:a+"staticpages/createPageRank",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function o(t){return e({method:"POST",data:t,url:a+"staticpages/createPageAnswer",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function i(){return e({method:"POST",data:{},url:a+"staticpages/getFileList",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function r(t){return e({method:"POST",data:t,url:a+"staticpages/removeFile",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}return{createPageRank:s,createPageAnswer:o,removeFile:r,getFileList:i}}angular.module("app").factory("staticpages",e),e.$inject=["$http","$q","$rootScope","SERVER_URL"]}(),function(){"use strict";function e(e,t,n,a){function s(){return e({method:"GET",url:a+"settings/",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return n.setting=e.data.settings,e.data.settings})}function o(t){return e({method:"POST",url:a+"settings/",data:t,headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}}).then(function(e){return n.setting=e.data.settings,e.data.settings})}function i(t,n){return e({method:"POST",url:a+"codeprice/",data:{codeprice:t,newPrice:n},headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}return{getSetting:s,setSetting:o,setCodePrice:i}}angular.module("app").factory("setting",e),e.$inject=["$http","$q","$rootScope","SERVER_URL"]}(),function(){"use strict";function e(e,t,n,a){function s(t){return e({method:"POST",data:t,url:a+"mailing/newBizCreated",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function o(t){return e({method:"POST",data:t,url:a+"mailing/newImageUploaded",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function i(t){return e({method:"POST",data:t,url:a+"mailing/promoterCreated",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function r(t){return e({method:"POST",data:t,url:a+"mailing/planPurchased",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}function l(t,n){return e({method:"POST",data:{email:t,username:n},url:a+"mailing/userSubscribed",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}return{promoterCreated:i,newBizCreated:s,planPurchased:r,subscribed:l,newImageUploaded:o}}angular.module("app").factory("mailing",e),e.$inject=["$http","$q","$rootScope","SERVER_URL"]}(),angular.module("app").factory("InstagramService",["$rootScope","$location","$http","INSTAGRAM_CLIENT_ID",function(e,t,n,a){var s,o=a,i=[],r=!1,l={_access_token:null,access_token:function(e){return angular.isDefined(e)&&(this._access_token=e),this._access_token},login:function(){var e=t.absUrl().split(t.path())[0]+"/";window.open("https://api.instagram.com/oauth/authorize/?client_id="+o+"&redirect_uri="+e+"&response_type=token&scope=likes+relationships+public_content+follower_list","Instagram Auth","width=400, height=600, centerscreen=true, chrome=yes")},getMyRecentImages:function(){return n.jsonp("https://api.instagram.com/v1/users/self/media/recent?access_token="+l.access_token()).then(function(e){return e.data.pagination.next_max_id?(r=!0,i=[e.data.pagination.next_max_id],s=0):r=!1,e.data.data})},getNextPage:function(){return n.jsonp("https://api.instagram.com/v1/users/self/media/recent?access_token="+l.access_token()+"&max_id="+i[s]).then(function(e){return e.data.pagination.next_max_id?(-1==i.indexOf(e.data.pagination.next_max_id)&&i.push(e.data.pagination.next_max_id),r=!0):r=!1,s++,e.data.data}).catch(function(e){console.log(e)})},getPreviousPage:function(){return n.jsonp("https://api.instagram.com/v1/users/self/media/recent?access_token="+l.access_token()+"&max_id="+i[s-1]).then(function(e){return s--,r=!0,e.data.data}).catch(function(e){console.log(e)})},getUserprofile:function(){return n.jsonp("https://api.instagram.com/v1/users/self/?access_token="+l.access_token()).then(function(e){return console.log(e),e}).catch(function(e){console.log(e)})},isPreviousAvailable:function(){return(1!=i.length||0!=s)&&s>=0},isNextAvailable:function(){return r}};return e.$on("igAccessTokenObtained",function(t,n){l.access_token(n.access_token.replace("#","").replace("!","")),e.$broadcast("instagramLoggedIn",{access_token:l._access_token})}),l}]),function(){"use strict";function e(e,t,n,a){function s(){return n.filterOptions?n.filterOptions=JSON.parse(n.filterOptions):n.filterOptions=l,n.filterOptions}function o(e){n.filterOptions=e,a.localStorage.setItem("Rank-X-Filters",JSON.stringify(e))}function i(){return!!n.initalHomeData&&(n.$emit("initalHomeDataLoaded"),!0)}function r(e){}var l={isNh:!1,isCity:!0,isNhRdy:"",cnh:"",isAllTopics:!0,ctopics:["LifeStyle","Social","Sports","Food","Beauty & Fashion","Family","Technology","Dating","City","Services","Health","Celebrities"]};return{loadFilterOptions:s,saveFilterOptions:o,saveInitalHomeData:r,loadInitalHomeData:i}}angular.module("app").factory("filter",e),e.$inject=["$http","$q","$rootScope","$window"]}(),function(){"use strict";function e(e,t,n,a){function s(e){l.push(e)}function o(e){var n=i(e);return n?t.when(n):a.api("/"+e+"?fields=first_name,gender,locale,picture,last_name,email","GET").then(function(e){return c.addFBUser(e),e},function(e){return null})}function i(e){return l.find(function(t){return t.id==e})}function r(e,t){for(var n=0;n<e.length;n++){var a=angular.copy(user[n]);c.getFBUserById(a[t]).then(function(e){})}return e}var l=[],c={findFBUserById:i,getFBUserById:o,addFBUser:s,loadProfilePicture:r};return c}angular.module("app").factory("fbusers",e),e.$inject=["$http","$q","$rootScope","$facebook"]}(),function(){"use strict";function e(e){function t(n,a){var s=e.locations.map(function(e){return e.id}).indexOf(n),o=e.locations[s].sub_areas.split(",").map(Number);if(e.locations[s].sub_areas){a.push(n);for(var i=0;i<o.length;i++)t(o[i],a)}else a.push(n)}return{getInclusiveAreas:t}}angular.module("app").service("common",e),e.$inject=["$rootScope"]}(),function(){"use strict";angular.module("app").filter("orderObjectBy",function(){return function(e,t,n){var a=[];return angular.forEach(e,function(e){a.push(e)}),a.sort(function(e,n){return e[t]>n[t]?1:-1}),n&&a.reverse(),a}}).filter("objectLength",function(){return function(e){return e?Object.keys(e).length:0}}).filter("searchObject",function(){return function(e,t,n){function a(e,t){return e=(""+e).toLowerCase(),t=(""+t).toLowerCase(),-1!==e.indexOf(t)}if(!e)return null;var s=[];if(!t){for(var o=Object.keys(e),i=0,r=o.length;i<r;i++)s.push(e[o[i]]);return s}return angular.forEach(e,function(e){if(n&&""!=n)e[n]&&a(e[n],t)&&s.push(e);else for(var o=Object.keys(e),i=0,r=o.length;i<r;i++)if(a(e[o[i]],t)){s.push(e);break}}),s}})}(),angular.module("app").directive("fileModel",["$parse",function(e){"use strict";return{restrict:"A",link:function(t,n,a){var s=e(a.fileModel),o=s.assign;n.bind("change",function(){t.$apply(function(){o(t,n[0].files[0])})})}}}]),angular.module("app").directive("bgBox3",["color","$timeout",function(e,t){"use strict";return{templateUrl:"app/common/partials/bgbox3.html",transclude:!0,scope:{bc:"@",bc2:"@",fc:"@",shade:"@",text:"@",dir:"@",stats:"@",w:"@",h:"@",question:"@",imageurl:"@",type:"@",isRankOfDay:"@"},link:function(n){t(function(){var t=JSON.parse(n.stats);n.views=t.views,n.answers=t.answers,n.comments=t.numcom,"horizontal"==n.dir&&(n.dirHor=!0,n.dirVer=!1),"vertical"==n.dir&&(n.dirHor=!1,n.dirVer=!0),void 0==n.bc2&&(n.bc2=e.shadeColor(n.bc,n.shade/10))}),n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("bgBox2",["color","$timeout",function(e,t){"use strict";return{templateUrl:"app/common/partials/bgbox2.html",transclude:!0,scope:{bc:"@",bc2:"@",fc:"@",shade:"@",text:"@",dir:"@",stats:"@",w:"@",h:"@",question:"@",isRankOfDay:"@"},link:function(n,a,s){t(function(){var t=JSON.parse(n.stats);n.views=t.views,n.answers=t.answers,n.comments=t.numcom,"horizontal"==n.dir&&(n.dirHor=!0,n.dirVer=!1),"vertical"==n.dir&&(n.dirHor=!1,n.dirVer=!0),void 0==n.bc2&&(n.bc2=e.shadeColor(n.bc,n.shade/10))}),n.$on("$destroy",function(){n.isDestroyed=!0})}}}]),angular.module("app").directive("bgBox",["color",function(e){"use strict";return{templateUrl:"app/common/partials/bgbox.html",transclude:!0,scope:{bc:"@",bc2:"@",fc:"@",shade:"@",text:"@",dir:"@",w:"@",h:"@"},link:function(t){"horizontal"==t.dir&&(t.dirHor=!0,t.dirVer=!1),"vertical"==t.dir&&(t.dirHor=!1,t.dirVer=!0),void 0==t.bc2&&(t.bc2=e.shadeColor(t.bc,t.shade/10))}}}]),function(){"use strict";function e(e,t,n,a){function s(a){function s(e){return d=e.data.resource}if(l()&&!a)return t.when(d);var o=u+"?filter=user="+n.user.id;return e.get(o).then(s,c)}function o(t,s){function o(e){var t=r;return t.id=e.data.resource[0].id,d.push(t),n.cvrowvotes.push(t),1==r.val&&a.post("upVotedVrow",["answer","vrow"],[r.answer,t.vrow]),-1==r.val&&a.post("downVotedVrow",["answer","vrow"],[r.answer,t.vrow]),n.DEBUG_MODE&&console.log("Creating new vrowvoting record was succesful"),e.data}var i={};i.resource=[];var r={};r.user=n.user.id,r.answer=n.canswer.id,r.vrow=t,r.val=s,r.timestmp=Date.now(),i.resource.push(r);var l=u;return e.post(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,c)}function i(t,a){function s(e){return n.DEBUG_MODE&&console.log("Updating vrow vote record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.val=a,i.timestmp=Date.now(),o.resource.push(i);var r=u,l=d.map(function(e){return e.id}).indexOf(t);return d[l].vote=a,d[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,c)}function r(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting vrow votes records was succesful"),e.data}for(var s=0;s<d.length;s++)d[s].vrow==t&&d.splice(s,1);var o=u+"?filter=vrow="+t;return e.delete(o).then(a,c)}function l(e){return d.length>0}function c(e){throw e}var d=[],u="/api/v2/mysql/_table/vrowvotes";return{loadVrowVotes:s,patchRec:i,postRec:o,deleteVrowVotesbyVrow:r}}angular.module("app").factory("vrowvotes",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n,a){function s(a){var s=f+"?offset=0",o=e.get(s);return t.all([o]).then(function(e){return g(e[0].data.resource),n.DEBUG_MODE&&console.log("No. Vrows: ",p.length),p},m)}function o(a){var s=[];if(a.forEach(function(e){h.indexOf(e.answer)<0&&(s.push(e),h.push(e.answer))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)o=o+"answer="+s[i].answer+")OR(";o=o.substring(0,o.length-3);var r=f+o,l=e.get(r);return t.all([l]).then(function(e){var t=e[0].data.resource,a=p.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&p.push(e)}),n.DEBUG_MODE&&console.log("No. Vrows: ",p.length),t},m)}function i(t){function a(e){var t=s;return t.id=e.data.resource[0].id,p.push(t),e.data}var s={};s.title=t,s.answer=n.canswer.id,s.gtitle="",s.user=n.user.id,s.gnum=0,s.upV=0,s.downV=0,s.timestmp=Date.now();var o={};o.resource=[],o.resource.push(s);var i=f;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,m)}function r(t){function n(e){for(var t=p.length-1,n=e.data.resource.length-1;n>=0;n--)p[t].id=e.data.resource[n].id,t--;return e.data}var a={};a.resource=[],a.resource.push(t),p.push.apply(p,t);var s=f;return e.post(s,t,{headers:{"Content-Type":"multipart/form-data"},body:a}).then(n,m)}function l(t){function s(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVrowVotesbyVrow(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting vrows records for answer was succesful"),e.data}for(var o=0;o<p.length;o++)p[o].answer==t&&p.splice(o,1);var i=f+"?filter=answer="+t;return e.delete(i).then(s,m)}function c(t,s){function o(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVrowVotesbyVrow(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting vrows records for group was succesful"),e.data}for(var i=p.length-1;i>=0;i--)p[i].gnum==t&&p.splice(i,1);var r=f+"?filter=(gnum="+t+") AND (answer="+s+")";return e.delete(r).then(o,m)}function d(t){function s(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVrowVotesbyVrow(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting vrow was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,o.resource.push(i);var r=f+"/"+t,l=p.map(function(e){return e.id}).indexOf(t);return l>-1&&p.splice(l,1),e.delete(r,i,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,m)}function u(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating vrows record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var c=f,d=p.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)p[d][a[l]]=s[l];return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,m)}function g(e){p.length=0,e.forEach(function(e){p.push(e)})}function m(e){throw e}var p=[],h=[];n.cvrows=p;var f="/api/v2/mysql/_table/vrows";return{getAllvrows:s,getVrowsX:o,postRec:i,postRec2:r,deleteVrowByAnswer:l,deleteVrow:d,updateRec:u,deleteVrowByGroup:c}}angular.module("app").factory("vrows",e),e.$inject=["$http","$q","$rootScope","vrowvotes"]}(),function(){"use strict";function e(e,t,n,a){function s(a){function s(e){return p=e.data.resource}if(u()&&!a)return t.when(p);var o=h+"/?filter=user="+n.user.id;return e.get(o).then(s,g)}function o(t){function a(e){return e.data.resource}for(var s="",o=0;o<n.user.friends.data.length;o++)s+="(user=",s+=n.user.friends.data[o].id,s+=")",o!=n.user.friends.data.length-1&&(s+=" or ");var i=h+"/?filter="+s;return e.get(i).then(a,g)}function i(t){function n(e){return p=e.data.resource}var a=h;return e.get(a).then(n,g)}function r(t,s,o,i){function r(e){var t=c;return t.id=e.data.resource[0].id,p.push(t),1==c.vote&&a.post("upVoted",["answer","category"],[s,o]),-1==c.vote&&a.post("downVoted",["answer","category"],[s,o]),n.$emit("updateVoteTable"),console.log("Creating new voting record was succesful"),e.data}var l={};l.resource=[];var c={};c.user=n.user.id,c.catans=t,c.answer=s,c.vote=i,c.timestmp=Date.now(),l.resource.push(c);var d=h;return e.post(d,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(r,g)}function l(t,a){function s(e){return n.DEBUG_MODE&&console.log("Updating vote record was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.vote=a,i.timestmp=Date.now(),o.resource.push(i);var r=h,l=p.map(function(e){return e.id}).indexOf(t);return p[l].vote=a,p[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,g)}function c(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting vote records by Catans was succesful"),e.data}for(var s=0;s<p.length;s++)p[s].catans==t&&p.splice(s,1);var o=h+"/?filter=catans="+t;return e.delete(o).then(a,g)}function d(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting vote record was succesful"),e.data}for(var s=0;s<p.length;s++)p[s].id==t&&p.splice(s,1);var o=h+"/"+t;return e.delete(o).then(a,g)}function u(e){return p.length>0}function g(e){throw e}function m(t){function n(e){return e.data.resource}for(var a="(",s=0;s<t.length;s++)a+="(answer=",a+=t[s],a+=")",s!=t.length-1&&(a+=" or ");a+=" and (timestmp > "+moment().subtract(1,"month").startOf("month").format("YYYY-MM-DD")+")",a+=" and (vote = 1))";var o=h+"/?filter="+a;return e.get(o).then(n,g)}var p=[],h="/api/v2/mysql/_table/votetable";return{loadVotesByUser:s,loadAllVotes:i,patchRec:l,postRec:r,deleteVotesbyCatans:c,deleteRec:d,loadVotesByMyFriends:o,loadLastMonthVoting:m}}angular.module("app").factory("votes",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n){function a(t){function n(e){return c(e.data.resource),u}var a=p;return e.get(a).then(n,d)}function s(a){function s(e){var t=e.data.resource,a=u.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&u.push(e)}),n.DEBUG_MODE&&console.log("useractivityX loaded"),u}var o=[];if(a.forEach(function(e){g.indexOf(e.category)<0&&(o.push(e),g.push(e.category))}),0==o.length)return t.when(!1);for(var i="?filter=(",r=0;r<o.length;r++)i=i+"category="+o[r].category+")OR(";i=i.substring(0,i.length-3);var l=p+i;return e.get(l).then(s,d)}function o(){function t(e){return m=e.data.resource}var a=p+"/?filter=user="+n.user.id;return e.get(a).then(t,d)}function i(t){function a(e){var t=s;return t.id=e.data.resource[0].id,u.push(t),n.thisuseractivity.push(t),n.DEBUG_MODE&&console.log("creating useractivity record was succesful"),e.data}var s={};s.user=n.user.id,s.category=t,s.votes=1,s.timestmp=Date.now();var o={};o.resource=[],o.resource.push(s);var i=p;return e.post(i,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,d)}function r(t,a){function s(e){return n.DEBUG_MODE&&console.log("Updating useractivity record was succesful"),e.data}var o={};o.resource=[]
;var i={};i.id=t,i.user=n.user.id,i.votes=a,i.timestmp=Date.now(),o.resource.push(i);var r=p,l=u.map(function(e){return e.id}).indexOf(t);return u[l].votes=a,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function l(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting user activity record was succesful"),e.data}var s=u.map(function(e){return e.id}).indexOf(t);s>-1&&u.splice(s,1);var o=p+"/"+t;return e.delete(o).then(a,d)}function c(e){u.length=0,e.forEach(function(e){u.push(e)})}function d(e){throw e}var u=[],g=[];n.alluseractivity=u;var m=[],p="/api/v2/mysql/_table/useractivity";return{getAllUserActivity:a,getAllUserActivityX:s,getActivitybyUser:o,postRec:i,patchRec:r,deleteRec:l}}angular.module("app").factory("useractivity",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(a){var s=u+"?limit=200&order=id%20DESC",o=e.get(s);return t.all([o]).then(function(e){return l(e[0].data.resource),n.DEBUG_MODE&&console.log("No. user actions: ",d.length),d},c)}function s(a){var s=u+"?limit=20&order=id%20DESC&offset="+n.uafs.length,o=e.get(s);return t.all([o]).then(function(e){var t=e[0].data.resource,a=d.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&d.push(e)}),n.DEBUG_MODE&&console.log("No. user actions: ",d.length),d},c)}function o(t,a,s){function o(e){var t=g;return t.id=e.data.resource[0].id,d.push(t),n.DEBUG_MODE&&console.log("Posted user activity feed"),e.data}var i=u,l={};l.bc="",l.fc="";var g={},m=0;g.userid=n.user.id,g.action=t,g.initials=n.user.name.replace(/[^A-Z]/g,""),r(n.user.id,l),g.fc=l.fc,g.bc=l.bc,g.date=moment().format("YYYY-MM-DD"),g.actorusername=n.user.first_name;for(var p=0;p<a.length;p++)switch(a[p]){case"answer":g.answer=s[p],m=n.answers.map(function(e){return e.id}).indexOf(g.answer),g.text1=n.answers[m].name;break;case"category":g.category=s[p],m=n.content.map(function(e){return e.id}).indexOf(g.category),g.text2=n.content[m].title;break;case"comment":g.comment=s[p];break;case"edit":g.edit=s[p],m=n.edits.map(function(e){return e.id}).indexOf(g.edit),g.text2=n.edits[m].field;break;case"vrow":g.vrow=s[p],m=n.cvrows.map(function(e){return e.id}).indexOf(g.vrow),g.text2=n.cvrows[m].title;break;case"text1":g.text1=s[p];break;case"text2":g.text2=s[p]}var h=[];return h.push(g),e.post(i,h,{headers:{"Content-Type":"multipart/form-data"},body:h}).then(o,c)}function i(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting user activity feed was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=u+"/"+t,r=d.map(function(e){return e.id}).indexOf(t);return r>-1&&d.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,c)}function r(e,t){switch(e%10){case 0:t.bc="#b3b3b3",t.fc="black";break;case 1:t.bc="#666666",t.fc="white";break;case 2:t.bc="#006bb3",t.fc="white";break;case 3:t.bc="#009933",t.fc="white";break;case 4:t.bc="#cc0000",t.fc="white";break;case 5:t.bc="#538cc6",t.fc="black";break;case 6:t.bc="#b36b00",t.fc="white";break;case 7:t.bc="#999966",t.fc="black";break;case 8:t.bc="#4d0099",t.fc="white";break;case 9:t.bc="#009999",t.fc="black"}}function l(e){d.length=0,e.forEach(function(e){d.push(e)})}function c(e){throw e}var d=[];n.uafs=d;var u="/api/v2/mysql/_table/useractivityfeed";return{getactions:a,post:o,deletebyId:i,getnext10actions:s}}angular.module("app").factory("uaf",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t){function n(n){function a(e){return r=e.data.resource}if(s()&&!n)return t.when(r);var i=l;return e.get(i).then(a,o)}function a(t,n){function a(e){return i=e.data}var s=l+"/?fields=field&filter=tableid="+t;return e.get(s).then(a,o)}function s(){return r.length>0}function o(e){throw e}var i,r=[],l="/api/v2/mysql/_table/tablefield";return{getAllTableFields:n,getTableFields:a}}angular.module("app").factory("tablefield",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t,n,a){function s(s){delete e.defaults.headers.common["X-Dreamfactory-API-Key"],delete e.defaults.headers.common["X-DreamFactory-Session-Token"];var l=i+"?key="+r+"&q="+s+"&image_type=photo";return e.get(l).then(function(s){return o=[],o=s.data.hits,t.DEBUG_MODE&&console.log("pixabay results success! - ",s),e.defaults.headers.common["X-Dreamfactory-API-Key"]=n,e.defaults.headers.common["X-DreamFactory-Session-Token"]=a.session_token,o},function(){e.defaults.headers.common["X-Dreamfactory-API-Key"]=n,e.defaults.headers.common["X-DreamFactory-Session-Token"]=a.session_token,t.DEBUG_MODE&&console.log("Problem getting Pixabay Images")})}var o=[],i="https://pixabay.com/api/",r="5296312-7285c9a61e74685606fe28209";return{search:s}}angular.module("app").factory("pixabay",e),e.$inject=["$http","$rootScope","APP_API_KEY","$cookies"]}(),function(){"use strict";function e(e,t,n,a,s){function o(s){delete e.defaults.headers.common["X-Dreamfactory-API-Key"],delete e.defaults.headers.common["X-DreamFactory-Session-Token"],e.defaults.headers.common.Authorization=c,console.log("$http.defaults ",e.defaults);var o=l+"/v1/search?query="+s;return e.get(o).then(function(s){return r=[],r=s.data.photos,t.DEBUG_MODE&&console.log("pexels results success! - ",results),delete e.defaults.headers.common.Authorization,e.defaults.headers.common["X-Dreamfactory-API-Key"]=n,e.defaults.headers.common["X-DreamFactory-Session-Token"]=a.session_token,r},function(){delete e.defaults.headers.common.Authorization,e.defaults.headers.common["X-Dreamfactory-API-Key"]=n,e.defaults.headers.common["X-DreamFactory-Session-Token"]=a.session_token,t.DEBUG_MODE&&console.log("Problem getting pexels Images")})}function i(t){var n={};return n.query=t,e({method:"POST",data:n,url:s+"ImageServer/requestPexels",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0}})}var r=[],l="http://api.pexels.com",c="563492ad6f9170000100000116ed76e3fd2b47bb574fb0174737aaf8";return{search:o,reqFromServer:i}}angular.module("app").factory("pexels",e),e.$inject=["$http","$rootScope","APP_API_KEY","$cookies","SERVER_URL"]}(),function(){"use strict";function e(e,t){function n(){t.igimages=[];var n=(t.canswer.name.replace(" ",""),"https://api.instagram.com/v1/tags/rankxdemo/media/recent?access_token=4368719989.c46745e.407288e972a64c119093166b8ba280c0&callback=JSON_CALLBACK");return t.DEBUG_MODE&&console.log(n),e.jsonp(n).success(function(e){var n={};t.DEBUG_MODE&&console.log(e);for(var a=0;a<e.data.length;a++)n={},n.url=e.data[a].images.standard_resolution.url,n.caption=e.data[a].caption?e.data[a].caption.text:void 0,n.from=e.data[a].user.username,t.igimages.push(n),t.DEBUG_MODE&&console.log(e.data[a].images.standard_resolution.url)})}return{getImages:n}}angular.module("app").factory("instagram",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e,t){function n(){function n(e){var t=new X2JS,n=t.xml_str2json(e.data),a={},s=[],o=n.EnumerationResults.Blobs.Blob;if(o&&o.constructor===Array)for(var i=0;i<o.length;i++)a={},a.url="https://rankx.blob.core.windows.net/sandiego/"+o[i].Name,a.type="azure-uploaded",s.push(a);else o&&o.constructor===Object&&(a={},a.url="https://rankx.blob.core.windows.net/sandiego/"+o.Name,a.type="Uploaded",s.push(a));return s}function a(e){t.DEBUG_MODE&&console.log("image query failed")}return e.get("https://rankx.blob.core.windows.net/sandiego?restype=container&comp=list&prefix=featuredImages/&sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D").then(n,a)}function a(){function n(e){var n=new X2JS,a=n.xml_str2json(e.data),s={},o=a.EnumerationResults.Blobs.Blob;if(o&&o.constructor===Array)for(var i=0;i<o.length;i++)s={},s.url="https://rankx.blob.core.windows.net/sandiego/"+o[i].Name,s.type="azure-uploaded",t.blobs.push(s);else o&&o.constructor===Object&&(s={},s.url="https://rankx.blob.core.windows.net/sandiego/"+o.Name,s.type="Uploaded",t.blobs.push(s));t.DEBUG_MODE&&console.log("query succeded")}function a(e){t.DEBUG_MODE&&console.log("image query failed")}var s="https://rankx.blob.core.windows.net/sandiego?restype=container&comp=list&prefix="+t.canswer.id+"/&sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D";return e.get(s).then(n,a)}function s(n){function a(e){t.$emit("refreshImages"),t.DEBUG_MODE&&console.log("Blob image deleted succesfully")}function s(e){t.DEBUG_MODE&&console.log("Blob image delete failed")}t.DEBUG_MODE&&console.log("blobname, ",n);var o=n+"?sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D";return e.delete(o).then(a,s)}return{getImageList:a,deleteBlob:s,getFeatureImageList:n}}angular.module("app").factory("imagelist",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e,t){function n(e,n,i){function r(e){return t.DEBUG_MODE&&console.log("query succeded"),o=e,s(o)}function l(e){t.DEBUG_MODE&&console.log("image query failed")}return a(e,n,i).then(r,l)}function a(n,a,s){var o="",i="",r="",l="";t.cCategory&&(l=t.cCategory.keywords);for(var c=[],d=0;d<n.length;d++)"edit"==s?c[d]=n[d].cval:"add"==s&&(c[d]=n[d].val);switch(1==n.length&&c[0]&&(i=c[0]),2==n.length&&(c[0]&&(i=c[0]),c[1]&&(r=c[1])),3==n.length&&(c[0]&&(i=c[0]),c[1]&&(r=c[1]),c[2]&&c[2]),n.length>3&&(c[0]&&(i=c[0]),c[1]&&(r=c[1]),c[2]&&c[2],c[3]&&c[3]),a){case 1:o="q="+i+" "+r+" "+l;break;case 2:case 3:o="q="+i+" "+l;break;case 4:o="q="+i+" "+r+" "+l}var u="https://www.googleapis.com/customsearch/v1?"+o+"&cx=000139851817949790257%3Aqwkdgi2q2ew&num=10&searchType=image&fileType=jpg%2C+png%2C+bmp&imgType=photo&imgSize=large&filter=1&key=AIzaSyBr143lDEROCrUWdKvqPQmhQ5BoFo13oSE";return e.get(u)}function s(e){for(var t=[],n=!1,a=!1,s=0,o=0,r=0,l=0;l<i;l++)if(n=!1,a=!1,o=e.data.items[l].image.height,r=e.data.items[l].image.width,r>o&&r/o<1.8&&(n=!0),s=e.data.items[l].link.length,("g"==e.data.items[l].link[s-1]||"p"==e.data.items[l].link[s-1])&&e.data.items[l].link.indexOf("https")>-1&&(a=!0),n&&a){var c=e.data.items[l].link;t.push(c)}return t}var o=[],i=10;return{imageSearch:a,getImageLinks:n,filterImageResults:s}}angular.module("app").factory("image",e),e.$inject=["$http","$rootScope"]}(),function(){"use strict";function e(e){function t(e){var t="";if("weekly"==e.freq){t=a("Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":""))+"<br>From: "+e.stime2+" to "+e.etime2}if("onetime"==e.freq){t=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:"Starts: "+e.sdate+" at "+e.stime+"<br>Ends: "+e.edate+" at "+e.etime}var n=a(e.details);return'<div style="background-color:'+e.bc+";color:"+e.fc+';"><div class="text-center"><h3>'+e.stitle+"</h3><p>"+t+"</p><p>"+n+"</p></div></div>"}function n(e){var t="",n="";if("weekly"==e.freq&&(n=e.sdate+" to "+e.edate+"<br>"+a("Every: "+(e.mon?" - Monday":"")+(e.tue?" - Tuesday":"")+(e.wed?" - Wednesday":"")+(e.thu?" - Thursday":"")+(e.fri?" - Friday":"")+(e.sat?" - Saturday":"")+(e.sun?" - Sunday":""))+"<br>"+(void 0==e.stime2?"":"From: "+e.stime2)+(void 0==e.etime2?"":" to "+e.etime2)),"onetime"==e.freq){n=e.sdate==e.edate?e.sdate+" from "+e.stime+" to "+e.etime:(void 0==e.edate?"":"Starts: ")+e.sdate+(void 0==e.stime?"":" at "+e.stime)+(void 0==e.edate?"":"<br>Ends: "+e.edate)+(void 0==e.etime?"":" at "+e.etime)}return t='<div style="background-color:'+e.bc+";color:"+e.fc+';"><p>'+n+"</p>"+(void 0!=e.addinfo?"<p>"+a(e.addinfo)+"</p>":"")+"</div>",t}function a(t){var n=0;e.DISPLAY_XSMALL&&(n=45),e.DISPLAY_SMALL&&(n=60),e.DISPLAY_MEDIUM&&(n=90),e.DISPLAY_LARGE&&(n=150);var a=0,s="";if(void 0==t)return"";if(t.length>n)for(var o=0;o<t.length;o++)a>n-5&&" "==t[o]&&(s+="<br>",a=0),s+=t[o],a++;else s=t;return s}return{specialHtml:t,eventHtml:n}}angular.module("app").service("htmlops",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,n,a,s){function o(a){delete t.defaults.headers.common["X-Dreamfactory-API-Key"],delete t.defaults.headers.common["X-DreamFactory-Session-Token"];var o="https://en.wikipedia.org/w/api.php?action=query&format=json&origin=*&prop=extracts&list=&meta=&continue=&titles="+a;return t.post(o,{},{headers:{"Content-Type":"multipart/form-data"}}).then(function(a){var o=JSON.stringify(a.data.query.pages),i=o.slice(o.indexOf("<p><b>"),o.indexOf("<h2>"));i=i.replace(/<p>/g,""),i=i.replace(/<\/p>/g,""),i=i.replace(/<i>/g,""),i=i.replace(/<\/i>/g,""),i=i.replace(/<small>/g,""),i=i.replace(/<\/small>/g,""),i=i.replace(/<span title\=\\"Representation in the International Phonetic Alphabet \(IPA\)\\">/g,""),i=i.replace(/<\/span>/g,""),i=i.replace(/<b>/g,""),i=i.replace(/<\/b>/g,""),i=i.replace(/.\\n\\n/g,"."),i=i.replace(/.\\n/g,"."),i=i.replace(/<(?:.|\n)*?>/gm,""),e.DEBUG_MODE&&console.log("1. wiki results res - ",i),t.defaults.headers.common["X-Dreamfactory-API-Key"]=n,t.defaults.headers.common["X-DreamFactory-Session-Token"]=s.session_token,e.$emit("wikiReady",i)})}return{getWiki:o}}angular.module("app").service("getwiki",e),e.$inject=["$rootScope","$http","APP_API_KEY","GOOGLE_API_KEY","$cookies"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(o){delete t.defaults.headers.common["X-Dreamfactory-API-Key"],delete t.defaults.headers.common["X-DreamFactory-Session-Token"];for(var i="",r=e.neighborhoods.concat(e.districts),l=!1,c=0;c<r.length;c++)if(o.location.indexOf(r[c])>-1){l=!0;break}i=!l&&o.location.indexOf("San Diego")<0?o.location+" San Diego, CA":o.location,i=i.replace("#","");var d="https://maps.googleapis.com/maps/api/geocode/json?address="+i+"&key="+a;return t.get(d,{},{headers:{"Content-Type":"multipart/form-data"}}).then(function(a){o.location=a.data.results[0].formatted_address,o.lat=a.data.results[0].geometry.location.lat,o.lng=a.data.results[0].geometry.location.lng,t.defaults.headers.common["X-Dreamfactory-API-Key"]=n,t.defaults.headers.common["X-DreamFactory-Session-Token"]=s.session_token,void 0!=o.location&&null!=o.location&&void 0!=o.lat&&null!=o.lat&&void 0!=o.lng&&null!=o.lng&&(e.coordForUSer?(e.currentUserLatitude=o.lat,e.currentUserLongitude=o.lng,e.coordForUSer=!1,e.coordsRdy=!0,e.$emit("coordsRdy"),console.log("@gps - 71")):e.$emit("answerGPSready"))})}return{getLocationGPS:i}}angular.module("app").service("getgps",e),e.$inject=["$rootScope","$http","APP_API_KEY","GOOGLE_API_KEY","$cookies","$state"]}(),function(){"use strict";function e(e,t,n){function a(t,a,s){function o(e){return console.log("creating flag answer record was succesful"),e.data}var r={};r.user=n.user.id,r.number=a,r.type=t,r.flag=s,r.timestmp=Date.now();var c={};c.resource=[],c.resource.push(r);var d=l;return e.post(d,c,{headers:{"Content-Type":"multipart/form-data"},body:c}).then(o,i)}function s(){function t(e){return r=e.data.resource}var n=l;return e.get(n).then(t,i)}function o(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting flag was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var r=l+"/"+t;return e.delete(r,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,i)}function i(e){throw e}var r=[],l="/api/v2/mysql/_table/flagtable";return{flagAnswer:a,getFlags:s,deleteFlag:o}}angular.module("app").factory("flag",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){this.uploadFileToUrl=function(t,n){delete e.defaults.headers.common["X-Dreamfactory-API-Key"],delete e.defaults.headers.common["X-DreamFactory-Session-Token"],delete e.defaults.headers.common.Accept,delete e.defaults.headers.common["Accept-Language"],delete e.defaults.headers.common["Accept-Encoding"],delete e.defaults.headers.common.Referer,delete e.defaults.headers.common.origin,delete e.defaults.headers.common.Connection;var a="https://rankx.file.core.windows.net/sandiego/est/"+t.name,s=(new Date).toUTCString();console.log("date in UTC format --- ",s);var o="x-ms-date:"+s+"\nx-ms-version:2015-02-21",i="/sandiego/est/"+t.name,r="PUT\n\nmultipart/form-data\n\n"+o+i;console.log("StringToSign",r);var l=CryptoJS.enc.Base64.parse("XvsnVKjNv25OVh37Z6UviHjw0DCfo0V5XTXpxqktR9PxHBw=="),c=CryptoJS.enc.Utf8.stringify(l.words),d=CryptoJS.enc.Utf8.parse(r),u=CryptoJS.HmacSHA256(d.sigBytes,c),g=CryptoJS.enc.Base64.stringify(u);return console.log("signature---",g),e.put(a,t,{headers:{"Content-Type":"multipart/form-data","x-ms-date":s,"x-ms-version":"2015-02-21",Authorization:"SharedKey rankx:"+g}}).success(function(e){console.log("Uploading file was succesful")}).error(function(e){console.log("There was a problem uploading your file")})}}angular.module("app").service("fileupload",e),e.$inject=["$http","$cookies","APP_API_KEY"]}(),function(){"use strict";function e(e,t){function n(t){function n(e){return $rootScope.DEBUG_MODE&&console.log("result",e),e.data}console.log("file",t);var a=o+"/"+t.name;return e.post(a,t,{headers:{"Content-Type":"multipart/form-data"}}).then(n,s)}function a(n){function a(e){return e.data}var i=o+"/"+encodeURIComponent(n);return e.get(i,{params:{api_key:t}}).then(a,s)}function s(e){throw console.log("Error: ",e),e}var o="/api/v2/files/images";return{uploadFile:n,getFile:a}}angular.module("app").factory("file",e),e.$inject=["$http","APP_API_KEY"]}(),function(){"use strict";function e(e,t,n,a,s){function o(a){if(u()&&!a)return t.when(h);var s=f+"?offset=0",o=f+"?offset=1000",i=e.get(s),r=e.get(o);return t.all([i,r]).then(function(e){return h=e[0].data.resource.concat(e[1].data.resource),n.DEBUG_MODE&&console.log("No. events: ",h.length),h},m)}function i(n,a){function s(e){return p=e.data}if(g(n)&&!a)return t.when(p);var o=f+"/"+n;return e.get(o).then(s,m)}function r(t){function n(e){var n=t;return n.id=e.data.resource[0].id,h.push(n),e.data}var a=f,s=[];return s.push(t),e.post(a,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(n,m)}function l(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating event succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var c=f,d=h.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)h[d][a[l]]=s[l];return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,m)}function c(t,a){function s(e){return n.DEBUG_MODE&&console.log(" event flagged succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.flag=a,o.resource.push(i);var r=f;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,m)}function d(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting event was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=f+"/"+t,r=h.map(function(e){return e.id}).indexOf(t);return r>-1&&h.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,m)}function u(){return h.length>0}function g(e){return p&&p.id==e}function m(e){throw e}var p,h=[],f="/api/v2/mysql/_table/events";return{getevents:o,getevent:i,addevent:r,update:l,deleteEvent:d,flagEvent:c}}angular.module("app").factory("event",e),e.$inject=["$http","$q","$rootScope","catans","vrows"]}(),function(){"use strict";function e(e,t,n,a){function s(a){function s(e){return u=e.data.resource}if(c()&&!a)return t.when(u);var o=g+"/_table/editvotetable/?filter=user="+n.user.id;return e.get(o).then(s,d)}function o(t){function s(e){for(var s={},o=0;o<e.data.resource.length;o++)s=t[o],s.id=e.data.resource[o].id,u.push(s),n.ceditvotes.push(s),1==s.vote&&a.post("upVotedEdit",["answer","edit"],[s.answer,s.edit]),-1==s.vote&&a.post("downVotedEdit",["answer","edit"],[s.answer,s.edit]);return n.DEBUG_MODE&&console.log("Creating new voting record for edit was succesful"),e.data}var o={};o.resource=[],o.resource.push(t);var i=g+"/_table/editvotetable";return e.post(i,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(s,d)}function i(t,a){function s(e){return n.DEBUG_MODE&&console.log("Updating vote record for edit was succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.vote=a,i.timestmp=Date.now(),o.resource.push(i);var r=g+"/_table/editvotetable",l=u.map(function(e){return e.id}).indexOf(t);return u[l].vote=a,u[l].timestmp=i.timestmp,e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,d)}function r(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting edit vote records for answer was succesful"),e.data}for(var s=0;s<u.length;s++)u[s].answer==t&&u.splice(s,1);var o=g+"/_table/editvotetable?filter=answer="+t;return e.delete(o).then(a,d)}function l(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting edit vote records for answer was succesful"),e.data}for(var s=0;s<u.length;s++)u[s].edit==t&&u.splice(s,1);var o=g+"/_table/editvotetable?filter=edit="+t;return e.delete(o).then(a,d)}function c(e){return u.length>0}function d(e){throw e}var u=[],g="/api/v2/mysql";return{loadEditVotesTable:s,patchEditVoteRec:i,postEditVoteRec:o,deleteEditVotes:l,deleteEditVotesbyAnswer:r}}angular.module("app").factory("editvote",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n,a){function s(t){function a(e){return d(e.data.resource),n.DEBUG_MODE&&console.log("Edits Loaded"),g}var s=m;return e.get(s).then(a,u)}function o(t){function a(e){var t=e.data.resource,a=n.edits.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&g.push(e)}),n.DEBUG_MODE&&console.log("editsX data loaded - ",t),t}for(var s="?filter=(",o=0;o<t.length;o++)s=s+"answer="+t[o].answer+")OR(";s=s.substring(0,s.length-3);var i=m+s;return e.get(i).then(a,u)}function i(t){function s(e){var s=t;return s.id=e.data.resource[0].id,g.push(s),console.log("newEditx - ",s),console.log("_edits - ",g),console.log("$rootScope.edits - ",n.edits),a.post("editA",["answer","edit"],[s.answer,s.id]),n.DEBUG_MODE&&console.log("Adding new Edit succesful",e),e.data}var o=m,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,u)}function r(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating edit vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=a,r.downV=s,i.resource.push(r);var l=m;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,u)}function l(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting edit was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=m+"/"+t,r=g.map(function(e){return e.id}).indexOf(t);return r>-1&&g.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,u)}function c(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting edits for answer was succesful"),e.data}for(var s=0;s<g.length;s++)g[s].answer==t&&g.splice(s,1);var o=m+"?filter=answer="+t;return e.delete(o).then(a,u)}function d(e){g.length=0,e.forEach(function(e){g.push(e)})}function u(e){throw e}var g=[];n.edits=g;var m="/api/v2/mysql/_table/edittable";return{getEdits:s,getEditsX:o,addEdit:i,updateEdit:r,deleteEdit:l,deleteEditbyAnswer:c}}angular.module("app").factory("edit",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g){function m(e,t){BootstrapDialog.TYPE_PRIMARY,BootstrapDialog.show({title:e,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function p(e){m(t.dialogs["dialog."+e+".title"],t.dialogs["dialog."+e+".text"])}function h(e,t,n){var a="",s="",o="",i="";a="Please Confirm",o="Cancel",i="Confirm","image"==t&&(s="You want to change the image of <strong><em>"+e.name+"</em></strong> to this one: </br><img src="+e.imageURL+' class="thumbnail" style="width:60%; max-height:150px">'),"field"==t&&"addinfo"!=e.field&&(s='You want to change the <strong class="capitalize"><em>'+e.field+"</em></strong> of <strong><em>"+e.name+"</em></strong> to <strong><em>"+e.nval+"</em></strong>."),"field"==t&&"addinfo"==e.field&&(s="You want to change the information of <strong><em>"+e.name+"</em></strong> to: <br><br>"+e.nval+"</br>."),BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&n(e)}})}function f(e,n,a,s){for(var o="",i="",r="",l=(t.cCategory.id,0);l<t.fields.length;l++){switch(t.fields[l].name){case"name":r='<strong class="capitalize">Name</strong>: '+e.name+"</br>";break;case"location":r=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":r='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>";break;case"addinfo":r=e.addinfo?'<strong class="capitalize">Additional Info</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"phone":r=e.phone?'<strong class="capitalize">Phone</strong>: '+e.phone+"</br>":"<strong>Phone</strong>: </br>";break;case"website":r=e.website?'<strong class="capitalize">Website</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>";break;case"email":r=e.email?'<strong class="capitalize">Email</strong>: '+e.email+"</br>":"<strong>Email</strong>: </br>"}o+=r}for(var c=0;c<n.length;c++)n[c].sel&&(i=i+"<em>"+n[c].title+"</em></br>");v(e,i,o,a,s)}function v(e,t,n,a,s){var o="",i="",r="",l="";o="Please Confirm",r="Cancel",l="Confirm",i="You want to add the following: </br></br>"+n+'</br>With the following image:<div class="text-center"><img src='+a+' class="thumbnail" style="width:60%; max-height:150px"></div>to the rankings:<br><div class="text-center" style="padding-top:10px">'+t+"</div>",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:o,message:i,closable:!0,draggable:!0,btnCancelLabel:r,btnOKLabel:l,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&s(e)}})}function b(e,t,n,a){var s="",o="";"approve"==n&&"addinfo"!=e.field&&(s="Changed Approved",o="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> gets approved."),"approve"==n&&"addinfo"==e.field&&(s="Changed Approved",o="Congrats! With your vote, the information of <strong>"+e.name+"</strong> to <br><br>"+e.nval+"</br> gets approved."),"reject"==n&&(s="Changed Rejected",o="Congrats! With your vote, the change of <strong>"+e.field+"</strong> of <strong>"+e.name+"</strong> to <strong>"+e.nval+"</strong> has been rejected."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:s,message:o,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,s){a(t,n),e.close()}}]})}function y(e){var t="",n="";"editAnswer"==e&&(n="Information Edits",t="Use edits to correct, add or update information in a profile. All edits need to be accepted by other users before they are approved. </br></br>An edit or change becomes approved when the number of people that agree exceeds the number of people that disagree by 3. </br></br>An edit or change gets rejected when the number of people that disagree exceeds those that agree by 3. </br></br> Only one edit per field at a time is allowed. Make sure you vote on the edits you agree or disagree."),"addAnswer"==e&&(n="Add a new answer",t="1. Fill out the form. The fields marked with ** are required. All other fields are not required but recommended. <br/><br/>2. Click the 'Get Images' button. <br/><br/>3. Use '>>' and '<<' buttons to browse through the images. You can 'Get More Images' button to load more images.<br/><br/>4. When the image you want shows in the image box, click the button 'Add' to add the new answer to the list.<br/><br/>NOTE: Not all images will correspond to your answer. Entering all fields will help with the image results."),"shortPhrase"==e&&(n="Add an Answer",t="Fill out the form. The fields marked with ** are required. <br/><br/> - The <strong>Title</strong> is the main idea of your answer. <br/><br/> - In the <strong>Details</strong> box, write additional details about your answer. You can also write arguments on why it should be included in this list.<br/><br/>For example: <br/><br/>In the rank <strong><em>Reasons why dogs are awesome</em></strong> you can add following answer: <br/><br/><strong>Title:</strong> They enjoy the simple things in life <br/><br/><strong>Details:</strong> Dogs dont need much to be happy, they are happy with simple things like a belly rub, a walk around the block, playing in the snow or going for a drive."),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function w(e){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Image URL",message:e,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function k(e,n,a,s){for(var o="",i="",r="",l="",c=0;c<t.fields.length;c++){switch(t.fields[c].name){case"name":r='<strong class="capitalize">Name</strong>: '+e.name+"</br>",l='<strong class="capitalize">Name</strong>: '+n.name+"</br>";break;case"location":r=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>",l=n.location?'<strong class="capitalize">Location</strong>: '+n.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":r='<strong class="capitalize">City Area</strong>: '+e.cityarea+"</br>",l='<strong class="capitalize">City Area</strong>: '+n.cityarea+"</br>";break;case"addinfo":r=e.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>",l=n.addinfo?'<strong class="capitalize">Additional Infob</strong>: '+n.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"phone":r=e.phone?'<strong class="capitalize">Phoneb</strong>: '+e.phone+"</br>":"<strong>Phone</strong>: </br>",l=n.phone?'<strong class="capitalize">Phoneb</strong>: '+n.phone+"</br>":"<strong>Phone</strong>: </br>";break;case"website":r=e.website?'<strong class="capitalize">Websiteb</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>",l=n.website?'<strong class="capitalize">Websiteb</strong>: '+n.website+"</br>":"<strong>Website</strong>: </br>";break;case"email":r=e.email?'<strong class="capitalize">Emailb</strong>: '+e.email+"</br>":"<strong>Email</strong>: </br>",l=n.email?'<strong class="capitalize">Emailb</strong>: '+n.email+"</br>":"<strong>Email</strong>: </br>"}o+=r,i+=l}x(e,o,n,i,a,s)}function x(e,n,a,s,o,i){var r="",l="",c="",d="";r="Just checking",c="No, they are different",d="Yeah, same",l="Are these the same "+t.cCategory.type+'? </br></br><div class="row"><div class="col-sm-6">'+n+"</br><img src="+e.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div><div class="col-sm-6">'+s+"</br><img src="+a.imageurl+' class="thumbnail" style="width:60%; max-height:150px"></div></div>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:r,message:l,closable:!0,draggable:!0,btnCancelLabel:c,btnOKLabel:d,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t?i():o(e)}})}function R(e,n){var a="",s="",o="",i="";a="Scope of Delete",o="Just in the category: "+t.cCategory.title,i="Everywhere",s="Choose scope to delete:",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t?n():e()}})}function A(e,t,n){var a="",s="",o="",i="";a="Confirm Delete",o="Cancel",i="Delete",s="This will delete the CatAns record for <strong>"+e+"</strong> in the category of <strong>"+t+"</strong>.",
BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&n()}})}function E(e,t){var n="",a="",s="",o="";n="Special Preview",s="Back",o="Save Special";var i=d.specialHtml(e);a='This is how this special will look: </br></br>In the ranking summary:<br><table class="table table-hover cursor "><thead><tr><th>Rank</th><th>Name</th><th>Distance</th><th>Specials</th></tr></thead><tbody><tr><td>1</td><td>'+e.name+'</td><td>1.5</td><td style="background-color:'+e.bc+";color:"+e.fc+';">'+e.stitle+"<td></tr></tbody></table><br>Inside your business profile:<br>"+i+"</br>With the following image:<img src="+e.image+' class="thumbnail" style="width:70%; max-height:150px">',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:a,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function O(e,t,n){var a="",s="",o="",i="";a="Yes, Delete",o="Cancel",i="Delete",s=n?"Just confirming, do you want to delete the special <strong>"+e.stitle+"</strong>?":"Just confirming, do you want to delete the ranking <strong>"+e.title+"</strong>?",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function S(e){var t="",n="",a="",s="";t="Share Location",a="Not Now",s="Ok",n="Please allow browser share location so we can calculate distance to the best places.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:t,message:n,closable:!0,draggable:!0,btnCancelLabel:a,btnOKLabel:s,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&e()}})}function D(e){var t="",n="",a="",s="";t="Do you own this business?",a="Cancel",s="Bind",n="If you own or represent this business, please bind to your account so only you can change or edit its information.<br><br><strong>* Name of Business</strong><br><strong>* Address</strong><br><strong>* Phone Number</strong><br><strong>* Main Photo</strong><br><strong>* Hours</strong><br><br>Binding this business to your account is free.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:t,message:n,closable:!0,draggable:!0,btnCancelLabel:a,btnOKLabel:s,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&e()}})}function C(e,t,n){var a="",s="",o="",i="";a="Confirmation",o="Cancel",i="Yes, bind this business to my account",s="<br><strong>Note:</strong> Claiming to have false authority over a business is against the law.<br><br>Please confirm:<br><br>You, <strong>"+e+"</strong>, have the authority to represent <strong>"+t+"</strong>.",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&n()}})}function I(e,t){var n="",a="";n="Enter Data",a="<br> Enter new vote row to be added in Group: <strong>"+e.gtitle+'</strong><br><br>Vote Row Name:<input class="form-control" type="text" placeholder="Enter Vote Row Name"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:a,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"OK",action:function(n,a){var s=n.getModalBody().find("input").val();a&&t(e,s),n.close()}}]})}function P(e,t){var n="",a="",s="",o="";n="Please Confirm",s="Cancel",o="Yes, Delete",a="<br>Please confirm, you want to delete vote row <strong>"+e.title+"</strong> from <strong>"+e.gtitle+"</strong>.<br><br><strong>Note:</strong> All vote records will be lost",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:a,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(n){n&&t(e)}})}function T(e,t){var n="",a="";n="Enter Data",a='<br>Enter name of Vote Group you want to create: <br><br>Group Name:<input class="form-control" type="text" placeholder="Enter Vote Row Group Name"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:a,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"OK",action:function(n,a){var s=n.getModalBody().find("input").val();a&&t(e,s),n.close()}}]})}function M(e,t,n){var a="",s="";a="Enter Data",s='<br>Enter new name of Vote Group: <br><br>Group Name:<input class="form-control" type="text" placeholder="'+e.gtitle+'"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,buttons:[{label:"Cancel",action:function(e){e.close()}},{label:"Edit",action:function(n,a){var s=n.getModalBody().find("input").val();a&&t(e,s),n.close()}},{label:"Delete",action:function(t,a){a&&n(e),t.close()}}]})}function L(e,t){var n="",a="",s="",o="";n="Please Confirm",s="Cancel",o="Yes, Delete",a="<br>Please confirm, you want to delete the vote group <strong>"+e.gtitle+"</strong> and all the items within it.<br><br><strong>Note:</strong> All vote records for all items will be lost",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:a,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(n){n&&t(e)}})}function N(e,t,n){var a="",s='<p style="text-align:left">';e.name&&(s=s+'<strong class="capitalize">Name</strong>: '+e.name+"</br>"),e.eventloc&&(s=s+'<strong class="capitalize">Venue</strong>: '+e.eventloc+"</br>"),e.location&&(s=s+'<strong class="capitalize">Address</strong>: '+e.location+"</br>"),e.cityarea&&(s=s+'<strong class="capitalize">Neighborhood</strong>: '+e.cityarea+"</br>"),e.phone&&(s=s+'<strong class="capitalize">Phone Number</strong>: '+e.phone+"</br>"),e.website&&(s=s+'<strong class="capitalize">Website</strong>: '+e.website+"</br>"),a=s+"</p>",console.log("answerhtml - ",a),_(e,a,d.eventHtml(e),e.imageurl,t,n)}function _(e,n,a,s,o,i){var r="",l="",c="",d="";console.log("answerhtml - ",n),"add"==o?l="You want to add the following event to <strong>"+t.cCategory.title+"</strong>. </br><p></p>"+n+a+"</br>With the following image:<img src="+s+' class="thumbnail" style="width:60%; max-height:150px">':"edit"==o&&(l="Please confirm the new information. </br><p></p>"+n+a+"</br>With the following image:<img src="+s+' class="thumbnail" style="width:60%; max-height:150px">'),r="Please Confirm",c="Cancel",d="Confirm",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:r,message:l,closable:!0,draggable:!0,btnCancelLabel:c,btnOKLabel:d,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(t){t&&i(e)}})}function B(){var e="",n="",a="";e="Please Confirm",n='<div class="text-left">Is it ok if we locate your position?</div><br><div class="row"><div class="container col-xs-12"><div class="text-left" style="color:blue">Option 1</div><div class="text-center" style="border:2px"><button class="btn btn-success" id="useGeo">Yes, locate me using geolocation</button></div><br><div class="text-left" style="color:blue">Option 2 <small>(recommended for accuracy)</small></div><br><p>Yes, use this address as my current location</p><div class="input-group"><input id="address" type="text" class="form-control" placeholder="Enter address"><span class="input-group-btn text-right"><button class="btn btn-success" type="button" id="gobutton">Go</button></span></div><br><br></div><div class="container col-xs-12"><div class="text-center" style="border:2px"><button class="btn btn-default" id="noapprove">No, I don\'t approve</button></div></div></div>',a='<div style="height:80px;position:relative"><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px;position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"/></div><p>Just a moment, finding your location...</p>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:function(e){var s=$(n);return s.find("#useGeo").click({},function(){if(t.isFacebookApp)p("FacebookAppNotSupported");else{var n=e;t.$emit("getLocation"),n.enableButtons(!1),n.setClosable(!1),n.getModalBody().html(a),n.setTitle("Please wait"),setTimeout(function(){n.close()},1e4)}}),s.find("#gobutton").click({},function(){var n=s.find("input").val(),a=e;t.$emit("useAddress",{address:n}),a.close()}),s.find("#noapprove").click({},function(){e.close()}),s},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function U(e){var a="",s="";a="Missing info",s='<div class="text-left">Let\'s stay in touch. Please provide us an email address where we can keep you updated on everything related to the <strong>'+e+'</strong> account.</div><br><div class="input-group"><input id="email" type="text" class="form-control" placeholder="Enter email address"><span class="input-group-btn text-right"><button class="btn btn-primary" type="button" id="gobutton">Submit</button></span></div><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:function(e){var a=$(s);return a.find("#gobutton").click({},function(){var s=a.find("input").val(),o=e;t.showWarning=!1,n.updateuseraccnt(t.useraccnts[0].id,["email"],[s]),o.close(),t.$emit("hideWarning")}),a},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function X(e,n,a,s){var o="",i="",r=n,l=e.length,c="";c=(t.sm,"width:100%;height:auto"),o="Photos - "+a.name;var d="",u="",g="",m="",p="";s?(d='<div class="row"><div class="text-left col-xs-3 col-md-4"><button class="btn btn-default pull-left" id="prevbutton">&lt;&lt</button></div><div class="text-middle col-xs-5 col-md-4"><button class="btn btn-default" id="makeprimary">Make Main Photo</button></div><div class="text-right col-xs-4 col-md-4"><button class="btn btn-default pull-right" id="nextbutton">&gt;&gt</button></div></div>',m='<div class="text-right"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" id="trashbutton"><span class="glyphicon glyphicon-trash" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></div><br/>'):(d='<div class="row"><div class="text-left col-xs-6"><button class="btn btn-default pull-left" id="prevbutton">&lt;&lt</button></div><div class="text-right col-xs-6"><button class="btn btn-default pull-right" id="nextbutton">&gt;&gt</button></div></div>',m="<br/>"),u='<br><div class="text-center"><img id="image" class="displayed" src="',g='" style="'+c+'"></div><p>Photo from &nbsp<strong id="source">'+e[r].type+"</strong></p></br><br/>",p=void 0!=e[r].from?'<p id="credit">Photo by:&nbsp<strong>@'+e[r].from+'</strong></p></br><p id="caption">'+(e[r].caption?e[r].caption:"")+"</p>":'<p id="credit"></p><p id="caption"></p>';i=d+u+e[r].url+g+m+p,BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:o,message:function(t){var n=$(i),s=t;return n.find("#prevbutton").click({},function(){r-=1,r<0&&(r=l-1),n.find("#image").attr("src",e[r].url),n.find("#source").html(e[r].type),void 0!=e[r].from?$("#credit").html("Photo by:&nbsp<strong>@"+e[r].from+"</strong></br>"):$("#credit").html(""),void 0!=e[r].caption?$("#caption").html(e[r].caption):$("#caption").html("")}),n.find("#nextbutton").click({},function(){r+=1,r>=l&&(r=0),n.find("#image").attr("src",e[r].url),n.find("#source").html(e[r].type),void 0!=e[r].from?$("#credit").html("Photo by:&nbsp<strong>@"+e[r].from+"</strong></br>"):$("#credit").html(""),void 0!=e[r].caption?$("#caption").html(e[r].caption):$("#caption").html("")}),n.find("#trashbutton").click({},function(){G(e,r,a),s.close()}),n.find("#makeprimary").click({},function(){V(e,r,a),s.close()}),n},closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function G(e,n,s){var o="",i="",r="",l="";o="Please Confirm",r="Cancel",l="Yes, Delete",i='<br>Please confirm, you want to delete this photo: <br/><img id="image" class="displayed" src="'+e[n].url+'" style="width:100%;height:auto"><br><br>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:o,message:i,closable:!0,draggable:!0,btnCancelLabel:r,btnOKLabel:l,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(o){if(o)if(t.DEBUG_MODE&&console.log(e),"Instagram"==e[n].type){var i=s.ig_image_urls.indexOf(e[n].url);-1!=i&&(s.ig_image_urls=s.ig_image_urls.substr(0,i-1)+s.ig_image_urls.substr(i+e[n].url.length),Z(s.id,s.ig_image_urls).then(function(e){t.$emit("refreshImages")}))}else a.deleteBlob(e[n].url)}})}function V(e,t,n){var a="",o="",i="",r="";a="Please Confirm",i="Cancel",r="Yes, make primary",o='<br>Please confirm, you want to make this the primary photo: <br/><img id="image" class="displayed" src="'+e[t].url+'" style="width:100%;height:auto"><br><br>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:o,closable:!0,draggable:!0,btnCancelLabel:i,btnOKLabel:r,btnOKClass:"btn-default",btnCancelAction:function(e){e.close()},callback:function(a){if(a){var o=e[t].url;s.updateAnswer(n.id,["imageurl"],[o])}}})}function F(){var e="",n="";e="Login required",n="You must be logged in to add rankings, answers, opinions, endorse establishments and participate in the rankings.</br></br>Do you want to log in?",BootstrapDialog.show({title:e,message:n,buttons:[{label:"Not now",action:function(e){e.close()}},{icon:"fa fa-facebook",label:"Login",cssClass:"btn-primary",action:function(e){t.stateName=l.current.name,"rankSummary"==t.stateName?t.stateNum=t.cCategory.id:"answerDetail"==t.stateName?t.stateNum=t.canswer.id:t.stateNum=void 0,o.facebookSDKLogin().then(function(){e.close(),l.go(l.current,{},{reload:!0})})}}]})}function Y(e,t,n,a,s){var o="",i="";o="Share Options",i='<div class="row"><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485385043_mail.png" id="email" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485384809_2_-_Facebook.png" id="facebook" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485384868_1_-_Twitter.png" id="twitter" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485384841_13_-_Pintrest.png" id="pinterest" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485384824_6_-_Google_Plus.png" id="gplus" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485384853_5_-_Tumbler.png" id="tumblr" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center" style="cursor: pointer"><img src="/assets/images/1485425301_reddit.png" id="reddit" style="width:50px;margin-bottom:20px"></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center style="cursor: pointer""><a href="#" socialshare socialshare-provider="whatsapp" socialshare-text="'+a+'" socialshare-url="'+n+'"><img src="/assets/images/1485384832_16_-_Whatsapp.png" id="whatsapp" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center style="cursor: pointer""><a href="#" socialshare socialshare-provider="facebook-messenger" socialshare-url="'+n+'"><img src="/assets/images/1485385110_Facebook_Messenger.png" id="messenger" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div><div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-center style="cursor: pointer""><a href="#" socialshare socialshare-provider="sms" socialshare-text="'+a+'" socialshare-url="'+n+'"><img src="/assets/images/1485385026_sms.png" id="sms" style="width:50px;margin-bottom:20px;display:'+(t?"inline":"none")+'"> </a></div></div>';var r=c(i)(s);BootstrapDialog.show({title:o,message:function(t){var n=$(r),a=t;return n.find("#twitter").click({},function(){e("twitter"),a.close()}),n.find("#facebook").click({},function(){e("facebook"),a.close()}),n.find("#email").click({},function(){e("email"),a.close()}),n.find("#pinterest").click({},function(){e("pinterest"),a.close()}),n.find("#gplus").click({},function(){e("gplus"),a.close()}),n.find("#reddit").click({},function(){e("reddit"),a.close()}),n.find("#tumblr").click({},function(){e("tumblr"),a.close()}),n.find("#whatsapp").click({},function(){a.close()}),n.find("#messenger").click({},function(){a.close()}),n.find("#sms").click({},function(){a.close()}),n},buttons:[{label:"Cancel",action:function(e){e.close()}}]})}function q(){var e="",t="",n=1,a="";a="width:100%;max-width:450px;height:auto;margin-left:auto;margin-right:auto;",e="Rank-X Intro Tour";var s="";s='<img id="image" class="displayed" src="/assets/images/rxtour1.png" style="'+a+'">',t=s,BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:t,closable:!0,draggable:!0,buttons:[{id:"btn1",label:"No, thanks",action:function(e,t){1==n?(r.put("tourviewed",!0),e.close()):(n-=1,1==n?($("#btn1").text("No, thanks"),$("#btn2").text("Yes, take tour")):12==n?($("#btn1").text("Back"),$("#btn2").text("Close"),r.put("tourviewed",!0)):($("#btn1").text("Back"),$("#btn2").text("Next")),s='<img id="image" class="displayed" src="/assets/images/rxtour'+n+'.png" style="'+a+'">',e.setMessage(s))}},{id:"btn2",label:"Yes, take tour",action:function(e,t){12==n?(r.put("tourviewed",!0),e.close()):(12==n?e.getButton(this.id).label="Close":(n+=1,1==n?($("#btn1").text("No, thanks"),$("#btn2").text("Yes, take tour")):12==n?($("#btn1").text("Back"),$("#btn2").text("Close"),r.put("tourviewed",!0)):($("#btn1").text("Back"),$("#btn2").text("Next"))),s='<img id="image" class="displayed" src="/assets/images/rxtour'+n+'.png" style="'+a+'">',e.setMessage(s))}}]})}function z(e,t){var n="",a="",s="",o="";n="Confirm Unbind",s="Cancel",o="Yes, Unbind",a="Just confirming, do you want to unbind <strong>"+e.name+"</strong> from your account?",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:n,message:a,closable:!0,draggable:!0,btnCancelLabel:s,btnOKLabel:o,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function j(e,t,n){var a="",s="",o="",i="";"Premium"==t&&(i="Cancel Premium Membership",s="Do you want to cancel your Premium Membership for <strong>"+e.name+"</strong>?"),"Ranks"==t&&(i="Cancel All Custom Ranks",s="Do you want to cancel all of your Custom Ranks for <strong>"+e.name+"</strong>?"),"All"==t&&(i="Cancel All Subscriptions",s="Do you want to cancel all of your Subscriptions for <strong>"+e.name+"</strong>?"),a="Please confirm",o="Back",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_DANGER,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"default",btnCancelAction:function(e){e.close()},callback:function(e){e&&n()}})}function W(e,t){var n="Buy or Cancel Custom Ranks",a="",s=1,o=e.ranksQty,i="purchase",r="You have selected to <strong>purchase "+s+"</strong> Custom Ranks.<br><br>If purchasing Custom Ranks you will be ask for your payment info after clicking the Purchase button.",a="<p>You are currently subscribed to <strong>"+o+'</strong> Custom Ranks.</p><br><p class="text-left">Select what you want to do.</p><br><div class="radio"><label><input type="radio" value="0" checked name="radiogrp">PURCHASE CUSTOM RANKINGS</label></div><div class="radio"><label><input type="radio" value="1" name="radiogrp">CANCEL CUSTOM RANKINGS</label></div><br><div class="row"><div class="col-xs-7"><p class="text-right">Select quantity:</p></div><div class="col-xs-5"><div class="input-group"><span class="input-group-btn"><button class="btn btn-primary" id="btn_minus"><i class="fa fa-minus"></i></button></span><input style="text-align:center" id="numRanks" class="form-control" type="text" placeholder="'+s+'"><span class="input-group-btn"><button class="btn btn-primary" id="btn_plus"><i class="fa fa-plus"></i></button></span></div></div></div><br><p class="text-left" id="mytext">'+r+"</p>";n="Please confirm",BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:function(e){var t=$(a),n="",r="<br><br>If purchasing Custom Ranks you will be ask for your payment info after clicking the Purchase button.",l="<br><br>Your Custom Ranks will be active until last day of your subscription.";return t.find("#btn_minus").click({},function(){s-=1,s<1&&(s=1),t.find("#numRanks").val(s),"purchase"==i?(n="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r,$("#btn2").text("Purchase "+s+" Custom Rankings")):(n="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l,$("#btn2").text("Cancel "+s+" Custom Rankings")),$("#mytext").html(n)}),t.find("#btn_plus").click({},function(){s+=1,s>10&&(s=10),"cancel"==i&&s>=o&&(s=o),t.find("#numRanks").val(s),"purchase"==i?(n="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r,$("#btn2").text("Purchase "+s+" Custom Rankings")):(n="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l,$("#btn2").text("Cancel "+s+" Custom Rankings")),$("#mytext").html(n)}),t.find("input[type=radio][name=radiogrp]").change(function(){s=1,0==this.value?(i="purchase",$("#btn2").text("Purchase "+s+" Custom Rankings"),n="You have selected to <strong>purchase "+s+"</strong> Custom Ranks. "+r):1==this.value&&(i="cancel",$("#btn2").text("Cancel "+s+" Custom Rankings"),n="You have selected to <strong>cancel "+s+"</strong> Custom Ranks. "+l),t.find("#numRanks").val(s),$("#mytext").html(n)}),t},closable:!0,draggable:!0,buttons:[{id:"btn1",label:"Back",action:function(e){e.close()}},{id:"btn2",label:"Purchase "+s+" Custom Rankings",action:function(e,n){t(i,s),e.close()}}]})}function H(e,t,n,a){var s="",o="";s="Edit Information",o="<p>Please verify the information is correct.</p>";for(var i=0;i<e.length;i++)o=o+'<div class="input-group"><label class="input-group-addon">'+t[i]+':</label><input type="text" class="form-control" id="'+e[i]+'" value="'+n[i]+'"></div>';BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:s,message:function(e){return $(o)},closable:!0,draggable:!0,btnCancelLabel:"Cancel",btnOKLabel:"Save",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()},buttons:[{id:"btn1",label:"Cancel",action:function(e){e.close()}},{id:"btn2",label:"Save",action:function(t,n){for(var s=[],o="",i=0;i<e.length;i++)o=t.getModalBody().find("#"+e[i])[0].value,s.push(o);a(s),t.close()}}]})}function K(e,t,n){var e=e,t=t;BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:e,message:t,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){n(),e.close()}}]})}function J(e){var t="";"Establishment"==e&&(t="establishment"),"Person"==e&&(t="person"),"Place"==e&&(t="place"),"Organization"==e&&(t="organization"),"PersonCust"==e&&(t="person"),"Event"==e&&(t="event"),"Thing"==e&&(t="item"),"Short-Phrase"==e&&(t="answer");var n="Switch to Vote Mode to Vote! <br><br>Your endorsements make the rankings! <br><br>Give a <strong>thumb up</strong> if you <strong>endorse</strong> this "+t+" in each ranking; a <strong>thumb down</strong> if you <strong>do not endorse</strong>.";BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Endorse!",message:n,buttons:[{id:"btn-ok",label:"Got it",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function Q(e,t){var n="",a="";n="Password Required",a='<br> Please enter access password:<br><br><input class="form-control" type="text" placeholder="Enter password"><br><br>',BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:n,message:a,closable:!1,draggable:!0,buttons:[{id:"btn1",label:"Cancel",action:function(e){t(),e.close()}},{id:"btn2",label:"Go",action:function(n){"S@nDieg0"==n.getModalBody().find("input").val()?e():(t(),p("wrongPassword")),n.close()}}]})}function Z(e,t){return s.updateAnswer(e,["ig_image_urls"],[t])}function ee(e,n,a,s){var o="",i="",r=(e.length,"");r=(t.sm,"width:100%;height:auto"),o="My Instagram Photos";var l="",c="",d="",u="";l='<div class="row"><div class="col-xs-12">',g.isPreviousAvailable()&&(l+='<button class="btn btn-default pull-left" id="previgpage">Previous</button>'),g.isNextAvailable()&&(l+='<button class="btn btn-default pull-right" id="nextigpage">Next</button>'),l+="</div>",u='<div class="text-right"></div><br/>';var m="";c='<img id="image" class="displayed col-xs-3 thumbnail" src="',d='" style="'+r+'">',m='<div class="row">';for(var p=0;p<e.length;p++)if("image"==e[p].type){m+='<div class="col-xs-6 col-md-4" style="position:relative">',m+=c+e[p].images.low_resolution.url+d;var h=0;-1!=n.ig_image_urls.indexOf(e[p].images.low_resolution.url)&&(h=.7),m+='<div id="add_photo" style="background-color: grey;opacity:'+h+';position: absolute;left: 19px;right: 19px;top: 4px;bottom: 24px;border-radius: 5px;display: flex;align-items: center;">',m+='<i class="fa fa-check-circle-o" aria-hidden="true" style="color: #2d6c38;font-size: 100px;margin: auto" ></i>',m+="</div>",m+="</div>"}m+="</div>",i=l+m+u,BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"instagram-image-dialog",title:o,message:function(e){var a=$(i);return a.find("#previgpage").click({},function(){e.close(),s("previous")}),a.find("#nextigpage").click({},function(){e.close(),s("next")}),a.find("#add_photo").click({},function(){console.log(n.ig_image_urls);var e=$(this).parent().children("#image").attr("src");if(-1!=n.ig_image_urls.indexOf(e)){var a=this,s=n.ig_image_urls.indexOf(e);-1!=s&&(n.ig_image_urls=n.ig_image_urls.substr(0,s-1)+n.ig_image_urls.substr(s+e.length),Z(n.id,n.ig_image_urls).then(function(e){t.$emit("refreshImages"),$(a).css("opacity",0)}))}else{var a=this;n.ig_image_urls+=";"+e,Z(n.id,n.ig_image_urls).then(function(e){t.$emit("refreshImages"),$(a).css("opacity",.7)})}}),a},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"No, I don't approve",btnOKLabel:"Yes, locate me",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function te(){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Ranking Question",message:'The <strong>Ranking Question</strong> is what you ask users when comparing two items in the rank. It is the question to determine which item deserves the higher ranking.<br><br>For example, if ranking the "Hamburgers in Pacific Beach", the <strong>Ranking Question</strong> would be "Who makes the better burgers?".<br><br>The Ranking Question is shown in the Rank Console, when users rank their endorsements.<br><br><img style="width:100%;height:auto" src="/assets/images/whatisrankquestion.png">',buttons:[{id:"btn-ok",label:"Got it",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function ne(e,t){for(var n="<div class='row'>",a=0;a<e.length;a++)n+='<div class="col-xs-3 col-md-3 text-center">',n+='<img src="'+e[a].picture.data.url+'" class="img-responsive img-circle profile-avatar" style="width: 100%;height: 100%;"/>',n+="<span>"+e[a].first_name+" "+e[a].last_name+"</span>",n+="</div>";n+="</div>",BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"fav-list-user-image-dialog",title:"My Friends that like "+t,message:function(e){var t=$(n);return t},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function ae(e,t,n){var a='<div class="row"> <div class="col-xs-12"> <tr ng-repeat-end> <td colspan=3> <table class="table" > <thead style="border-style:none;"> <tr>    <th style="width:45%" text-align="center">Subscription</th>    <th style="width:15%" text-align="center">Commission</th> </tr> </thead> <tbody> ';e.ispremium&&(a+='<tr style="cursor:pointer;">   <td style="width:45%">Premium Membership</td>    <td style="width:15%">'+e.price*t+"</td></tr>"),e.hasranks&&(a+='<tr style="cursor:pointer;"><td style="width:45%">'+e.ranksqty+' Custom Ranks</td><td style="width:15%">$'+e.ranksqty*n*t+"</td></tr>"),a+='                <tr>                    <td style="width:45%">Total</td>                    <td style="width:15%; background-color: darkgray;">$'+e.totalCommission+"</td>                </tr>            </tbody>        </table>    </td></tr></div></div>",BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"admin-payment-business-detail-dialog",title:e.answerObj.name+" Details",message:function(e){var t=$(a);return t},buttons:[{label:"Close",action:function(e){e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function se(e,t){var n='<div class="row"> <div class="col-xs-12"> <div class="form-group">    <label for="commission-percent">Please Type Commission Percentage.</label>     <div class="col-xs-11"><input type="commission-percent" class="form-control" id="commission-percent" value="'+100*e+'"> </div>    <div class="col-xs-1" style="padding: 10px;padding-left: 0px;"><span>%</span></div></div>';BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"change-commission-percentage-dialog",title:"Change Commmission",message:function(e){var t=$(n);return t},buttons:[{label:"Close",action:function(e){e.close()}},{label:"OK",action:function(e,n){var a=e.getModalBody().find("input").val();n&&t(a),e.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function oe(e,t){var n='<div class="row"> <div class="col-xs-12"> <div class="form-group">    <label for="commission-percent">Please Enter '+e.code+' plan price.</label>     <div class="col-xs-11"><input type="commission-percent" class="form-control" id="commission-percent" value="'+e.price+'"> </div>    <div class="col-xs-1" style="padding: 10px;padding-left: 0px;"><span>$</span></div></div>';BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"change-commission-percentage-dialog",title:"Change "+e.code+" Price",message:function(e){var t=$(n);return t},buttons:[{label:"Close",action:function(e){e.close()}},{label:"Change",action:function(n,a){var s=n.getModalBody().find("input").val();a&&t(e,s),n.close()}}],closable:!0,draggable:!0,btnCancelLabel:"OK",btnOKLabel:"Close",btnOKClass:"btn-success",btnCancelClass:"btn-warning",btnCancelAction:function(e){e.close()}})}function ie(e){
var n='<div class="row"> <div class="col-xs-12"> <div class="form-group">    <p>Hey there, enjoying <strong>Rank-X</strong>? <br><br> Let\'s stay in touch!<br><br> Enter your email address below to subscribe to our newsletter to get <strong>updates</strong> about new and popular rankings and <strong>stay informed</strong> of local deals and events!</p><br>    <div class="col-xs-11"><input type="text" id="subscribe-email" class="form-control"      value="'+(t.user?t.user.email:"")+'" placeholder="Enter your email here"> </div></div>';BootstrapDialog.show({size:BootstrapDialog.SIZE_SM,type:BootstrapDialog.TYPE_PRIMARY,cssClass:"subscription-dialog",title:"Sign up for our newsletter!",message:function(e){var t=$(n);return t},buttons:[{label:"Not Now",action:function(e){e.close()}},{label:"Subscribe",cssClass:"btn-success",action:function(t,n){var a=t.getModalBody().find("input").val();n&&e(a),t.close()}}],closable:!0,draggable:!0})}function re(e,t){var n=le(e),a="",s="",o="",i="";a="Just checking",o="No, different one",i="Yes, that's it",s="Do you mean this <strong>"+e.name+"</strong>? </br></br>"+n+'</br><div class="row"><div class="col-xs-2 col-sm-3 col-md-3"></div><div class="col-xs-8 col-sm-6 col-md-6"><img src='+e.imageurl+' class="thumbnail" style="width:100%; max-height:200px;" id="ansimage"></div><div class="col-xs-2 col-sm-3 col-md-3"></div></div>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&t()}})}function le(e){for(var n="",a="",s=0;s<t.fields.length;s++){switch(t.fields[s].name){case"name":a='<strong class="capitalize">Name</strong>: '+e.name+"</br>";break;case"location":a=e.location?'<strong class="capitalize">Location</strong>: '+e.location+"</br>":"<strong>Location</strong>: </br>";break;case"cityarea":a='<strong class="capitalize">Neighborhood</strong>: '+e.cityarea+"</br>";break;case"addinfo":a=e.addinfo?'<strong class="capitalize">Additional Info</strong>: '+e.addinfo+"</br>":"<strong>Additional Info</strong>: </br>";break;case"phone":a=e.phone?'<strong class="capitalize">Phone</strong>: '+e.phone+"</br>":"<strong>Phone</strong>: </br>";break;case"website":a=e.website?'<strong class="capitalize">Website</strong>: '+e.website+"</br>":"<strong>Website</strong>: </br>";break;case"email":a=e.email?'<strong class="capitalize">Email</strong>: '+e.email+"</br>":"<strong>Email</strong>: </br>"}n+=a}return n}function ce(e,n){var a="",s="",o="",i="",r=le(e[0]),l=0;a="Just checking",o="None of the options",i="Yes, that's it",s="<p>We have "+e.length+" records for <strong>"+e[0].name+"</strong>. Please browse these records to see if the one wish to add to the ranking <strong><i>"+t.cCategory.title+'</i></strong> already exists.</p></br><div class="text-center"><div class="row"><button class="btn btn-default" id="nextbutton">Next</button><p id="number">&nbsp&nbsp'+(l+1)+'</p></div></div><br><p id="answerinfo">'+r+'</p></br><div class="row"><div class="col-xs-2 col-sm-3 col-md-3"></div><div class="col-xs-8 col-sm-6 col-md-6"><img src='+e[0].imageurl+' class="thumbnail" style="width:100%; max-height:200px;" id="ansimage"></div><div class="col-xs-2 col-sm-3 col-md-3"></div></div>',BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:function(t){var n=$(s);return n.find("#nextbutton").click({},function(){l+=1,l>e.length-1&&(l=0),r=le(e[l]),$("#number").html(l+1),$("#answerinfo").html(r),n.find("#ansimage").attr("src",e[l].imageurl)}),n},closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&n(l)}})}function de(){BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:"Terms of Service",message:$("<div></div>").load("/assets/partials/tospromoter.tem"),closable:!0,draggable:!0,btnOKLabel:"Back",btnOKClass:"btn-primary",size:BootstrapDialog.SIZE_WIDE})}function ue(e){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Sorting Options",message:"<p style='text-align:left'><strong>Rank</strong>. Sorts list by rank points, which are a mix of endorsements and rank matches.</p><p style='text-align:left'><strong>Popular</strong>. Sorts list by votes (endorsements) in this ranking.</p><p style='text-align:left'><strong>Distance</strong>. Sorts list by distance closest to you. </p><p style='text-align:left'><strong>Trending</strong>. Sorts list by votes (endorsements) in the last month.</p>",buttons:[{id:"btn-ok",label:"Got it",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}function ge(e,t,n){var a="",s="",o="",i="";a="Just checking",o="Cancel",i="My opinion is different, add it",s='Your opinion:<br><p class="text-center"><i>'+e+'</i></p>might be similar to these already existing opinions: <br><br><p class="text-center">';for(var r=0;r<t.length;r++)s=s+"<i>"+t[r].title+"</i><br>";s+="</p>Double check you are not adding an opinion that is essentially same as one already there.<br>",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"btn-primary",btnCancelAction:function(e){e.close()},callback:function(e){e&&n()}})}function me(e){var n="",a="";u.formatdatetime(e);var s=d.specialHtml(e),o="background-color:"+e.bc+";color:"+e.fc+";white-space:pre;";e.style=o,void 0!=e.image&&e.image!=t.EMPTY_IMAGE?e.hasimage=!0:e.hasimage=!1,t.DISPLAY_XSMALL&&(a="width:100%;height:auto;"),t.DISPLAY_SMALL&&(a="width:100%;height:auto;max-height:300px;"),t.DISPLAY_MEDIUM&&(a="width:100%;height:auto;max-height:350px;"),t.DISPLAY_LARGE&&(a="width:100%;height:auto;max-height:400px;"),n='<div ng-attr-style="'+e.style+'">'+s+"</div>"+(e.hasimage?'<div class="text-middle"><img class="displayed" src='+e.image+' style="'+a+'margin-left:auto;margin-right:auto;"></div><br>':"<br>"),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Special Details",message:n,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,t){e.close()}}]})}function pe(e,t){var n="";n="Can not add an answer of type <em>"+("Establishment"==t||"Place"==t||"Organization"==t?"Establishment or Place":"")+("PersonCust"==t?"Freelancer":"")+("Short-Phrase"==t?"Opinion":"")+("Event"==t?"Event":"")+("Thing"==t?"Item":"")+("Simple"==t?"Private Item":"")+"</em> to a ranking of type <em>"+("Establishment"==e||"Place"==e||"Organization"==e?"Establishment or Place":"")+("PersonCust"==e?"Freelancer":"")+("Short-Phrase"==e?"Opinion":"")+("Event"==e?"Event":"")+("Thing"==e?"Item":"")+("Simple"==e?"Private Item":"")+"</em>.",BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Type MisMatch",message:n,buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,t){e.close()}}]})}function he(e,t,n){var a="",s="",o="",i="";a="Please Confirm",s="This will add "+t.name+" to <em>"+e.title+"</em>.",o="Cancel",i="Ok",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"default",btnCancelAction:function(e){e.close()},callback:function(a){a&&n(e,t)}})}function fe(e,t,n){var a="",s="",o="",i="";a="Please Confirm",s="This will remove "+t.name+" from <em>"+e.title+"</em>.",o="Cancel",i="Yes, delete",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"default",btnCancelAction:function(e){e.close()},callback:function(a){a&&n(e,t)}})}function ve(e,n){for(var a="",s="",o="",i="",r='<div class="text-center">',l=0,c=0;c<e.ansLocs.length;c++)l=t.answers.map(function(e){return e.id}).indexOf(e.ansLocs[c]),r=r+t.answers[l].name+"</br>";r+="</div>",a="Please Confirm",s="This will add the following sibling Establishments: <br>"+r+"<br> to <strong>"+e.name+"</strong>.",o="Cancel",i="Ok",BootstrapDialog.confirm({type:BootstrapDialog.TYPE_PRIMARY,title:a,message:s,closable:!0,draggable:!0,btnCancelLabel:o,btnOKLabel:i,btnOKClass:"default",btnCancelAction:function(e){e.close()},callback:function(e){e&&n()}})}function be(e){var t="",n="";n='<ul class="list-group">';for(var a=0;a<e.length;a++)n=n+'<li id="item'+a+'"class="list-group-item" style="cursor:pointer;"><strong>'+e[a].name+"</strong>,&nbsp"+e[a].location+",&nbsp"+e[a].cityarea+"</li>";n+="</ul>",t=n,console.log("@dialog showLocations"),BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Additional Locations",message:function(n){var a=$(t);return console.log("inside dialog locs---\x3e",e),a.find("#item0").click({},function(){console.log("click, 0"),i.scrollTo(0,0),l.go("answerDetail",{index:e[0].id}),n.close()}),a.find("#item1").click({},function(){console.log("click, 1"),i.scrollTo(0,0),l.go("answerDetail",{index:e[1].id}),n.close()}),a.find("#item2").click({},function(){console.log("click, 2"),i.scrollTo(0,0),l.go("answerDetail",{index:e[2].id}),n.close()}),a.find("#item3").click({},function(){console.log("click, 3"),i.scrollTo(0,0),l.go("answerDetail",{index:e[3].id}),n.close()}),a.find("#item4").click({},function(){console.log("click, 4"),i.scrollTo(0,0),l.go("answerDetail",{index:e[4].id}),n.close()}),a},buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e,t){e.close()}}]})}function ye(e){var n='<div class="text-center"><iframe width="'+(t.sm?"300":"500")+'" height="'+(t.sm?"200":"350")+'" src="'+e+'?autoplay=1" frameborder="0" allowfullscreen></iframe></div>';BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,type:BootstrapDialog.TYPE_PRIMARY,title:"Learn More",message:function(e){return $(n)},buttons:[{id:"btn-ok",label:"I got it.",cssClass:"btn-primary",autospin:!1,action:function(e,t){e.close()}}]})}function we(){BootstrapDialog.show({type:BootstrapDialog.TYPE_PRIMARY,title:"Image Banks",message:'<strong>Pixabay</strong> and <strong>Pexels</strong> are databases of royalty free images. We encourage you to visit their websites to learn more about the services they offer. <br><br><div class="row"><div class="col-xs-12 col-sm-6"><img src="../../../assets/images/pixabay-logo.png" alt="Pixabay"style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;"><div class="text-center"><a href="https://www.pixabay.com/">Visit Pixabay</a></div></div><div class="col-xs-12 col-sm-6"><img src="../../../assets/images/pexels-logo.png" alt="Pexels"style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;"><div class="text-center"><a href="https://www.pexels.com/">Visit Pexels</a></div></div></div>',buttons:[{id:"btn-ok",label:"OK",cssClass:"btn-primary",autospin:!1,action:function(e){e.close()}}]})}return{editConfirm:h,getDialog:p,showDialog:m,howItWorks:y,addAnswer:f,showAddAnswer:v,editChangeEffective:b,checkSameAnswer:k,showSameAnswer:x,confirmSameAnswer:re,deleteType:R,deleteThisCatans:A,deleteRank:O,getLocation:S,url:w,createSpecialPreview:E,bizRegistration:D,bindAccount:C,addVRow:I,deleteVRow:P,addVRowGroup:T,editVRowGroup:M,deleteVRowGroup:L,showAddEvent:_,createEventPreview:N,askPermissionToLocate:B,askEmail:U,seePhotos:X,loginFacebook:F,shareOptions:Y,tour:q,unbindAccount:z,confirmCancel:j,editNumRanks:W,editInfo:H,notificationWithCallback:K,enterPassword:Q,endorse:J,chooseImgFromIgDlg:ee,showAllFriendsListDlg:ne,showBusinessDetailDlg:ae,whatisrankquestion:te,changeCommissionDlg:se,changeCodePriceDlg:oe,openSubscriptionDlg:ie,generateAnswerHtml:le,confirmSameAnswerMultiple:ce,showTOSPromotersDlg:de,showTOSCustomersDlg:de,sortbyHelpDialog:ue,maybeRepeatVrows:ge,showSpecial:me,typemismatch:pe,confirmAddRank:he,confirmRemoveRank:fe,confirmSiblings:ve,showLocations:be,showLearnMore:ye,imageBank:we}}angular.module("app").factory("dialog",e),e.$inject=["$q","$rootScope","useraccnt","imagelist","answer","login","$window","$cookies","$state","$compile","htmlops","datetime","InstagramService"]}(),function(){"use strict";function e(e,t,n,a,s){function o(t,n){if(!n.commLoaded){if(n.commLoaded=!0,e.isLoggedIn&&(n.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),n.bc=c.bc,n.fc=c.fc),"answer"==t)return s.getcomments().then(function(e){function t(e){return e<10?"0"+e:e}n.comments=e;for(var a=0;a<n.comments.length;a++){n.comments[a].initials=n.comments[a].username.replace(/[^A-Z]/g,"");var s=new Date,o=s.getTimezoneOffset(),i=n.comments[a].timestmp.split(/[- :]/),l=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]);l.setMinutes(l.getMinutes()-o);var d=l.getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear(),u=l.getHours(),g=u>12?u%12+":"+t(l.getMinutes())+" PM":u+":"+t(l.getMinutes())+" AM";n.comments[a].date=d+" "+g,r(n.comments[a].user,c),n.comments[a].bc=c.bc,n.comments[a].fc=c.fc}});if("category"==t)return a.getcomments().then(function(e){function t(e){return e<10?"0"+e:e}n.comments=e;for(var a=0;a<n.comments.length;a++){n.comments[a].initials=n.comments[a].username.replace(/[^A-Z]/g,"");var s=new Date,o=s.getTimezoneOffset(),i=n.comments[a].timestmp.split(/[- :]/),l=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]);l.setMinutes(l.getMinutes()-o);var d=l.getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear(),u=l.getHours(),g=u>12?u%12+":"+t(l.getMinutes())+" PM":u+":"+t(l.getMinutes())+" AM";n.comments[a].date=d+" "+g,r(n.comments[a].user,c),n.comments[a].bc=c.bc,n.comments[a].fc=c.fc}})}}function i(o,i){var l={};l.body=i.newComment,l.username=e.user.name,l.user=e.user.id,l.picture=e.user.picture.data.url,l.timestmp=Date.now(),i.newComment="","category"==o&&(l.category=e.cCategory.id,a.addcomment(l).then(function(){l.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),l.fc=c.fc,l.bc=c.bc,l.date="Just now",i.comments.push(l),t.update(e.cCategory.id,["numcom"],[i.comments.length])})),"answer"==o&&(l.answer=e.canswer.id,s.addcomment(l).then(function(){l.initials=e.user.name.replace(/[^A-Z]/g,""),r(e.user.id,c),l.fc=c.fc,l.bc=c.bc,l.date="Just now",i.comments.push(l),n.updateAnswer(e.canswer.id,["numcom"],[i.comments.length])}))}function r(e,t){switch(e%10){case 0:t.bc="#b3b3b3",t.fc="black";break;case 1:t.bc="#666666",t.fc="white";break;case 2:t.bc="#006bb3",t.fc="white";break;case 3:t.bc="#009933",t.fc="white";break;case 4:t.bc="#cc0000",t.fc="white";break;case 5:t.bc="#538cc6",t.fc="black";break;case 6:t.bc="#b36b00",t.fc="white";break;case 7:t.bc="#999966",t.fc="black";break;case 8:t.bc="#4d0099",t.fc="white";break;case 9:t.bc="#009999",t.fc="black"}}var l={loadComments:o,postComment:i,getIconColors:r},c={};return c.bc="",c.fc="",l}angular.module("app").service("commentops",e),e.$inject=["$rootScope","table","answer","comment","comment2"]}(),function(){"use strict";function e(e,t,n,a){function s(t){function a(e){return u=e.data.resource}var s=g+"/?filter=answer="+n.canswer.id;return e.get(s).then(a,d)}function o(t){function n(e){return u=e.data.resource}var a=g+"/?filter=answer="+t;return e.get(a).then(n,d)}function i(t){function s(e){return t.id=e.data.resource[0].id,a.post("commentA",["answer","comment"],[t.answer,t.body]),n.DEBUG_MODE&&console.log("Adding new comment succesful",e),e.data}var o=g,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,d)}function r(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating comment vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=a,r.downV=s,i.resource.push(r);var l=g;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,d)}function l(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting comment was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=g+"/"+t,r=u.map(function(e){return e.id}).indexOf(t);return r>-1&&u.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,d)}function c(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting comments for answer was succesful"),e.data}for(var s=0;s<u.length;s++)u[s].user==t&&u.splice(s,1);var o=g+"?filter=user="+t;return e.delete(o).then(a,d)}function d(e){throw e}var u=[],g="/api/v2/mysql/_table/comments2";return{getcomments:s,getcommentsbyanswer:o,addcomment:i,updatecomment:r,deletecomment:l,deletecommentsbyuser:c}}angular.module("app").factory("comment2",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n,a){function s(t){function a(e){return u=e.data.resource}var s=g+"/?filter=category="+n.cCategory.id;return e.get(s).then(a,d)}function o(t){function n(e){return u=e.data.resource}var a=g+"/?filter=category="+t;return e.get(a).then(n,d)}function i(t){function s(e){return t.id=e.data.resource[0].id,a.post("commentR",["category"],[t.category]),n.DEBUG_MODE&&console.log("Adding new comment succesful",e),e.data}var o=g,i=[];return i.push(t),e.post(o,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(s,d)}function r(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating comment vote counts succesful"),e.data}var i={};i.resource=[];var r={};r.id=t,r.upV=a,r.downV=s,i.resource.push(r);var l=g;return e.patch(l,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,d)}function l(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting comment was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=g+"/"+t,r=u.map(function(e){return e.id}).indexOf(t);return r>-1&&u.splice(r,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,d)}function c(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting comments for answer was succesful"),e.data}for(var s=0;s<u.length;s++)u[s].user==t&&u.splice(s,1);var o=g+"?filter=user="+t;return e.delete(o).then(a,d)}function d(e){throw e}var u=[],g="/api/v2/mysql/_table/comments";return{getcomments:s,getcommentsbyrank:o,addcomment:i,updatecomment:r,deletecomment:l,deletecommentsbyuser:c}}angular.module("app").factory("comment",e),e.$inject=["$http","$q","$rootScope","uaf"]}(),function(){"use strict";function e(e,t,n,a,s){function o(t){function n(e){return e.data}var a=k+"/"+t;return e.get(a).then(n,v)}function i(a){var s=k+"?offset=0",o=k+"?offset=1000",i=k+"?offset=2000",r=k+"?offset=3000",l=k+"?offset=4000",c=k+"?offset=5000",d=k+"?offset=6000",u=k+"?offset=7000",g=k+"?offset=8000",m=k+"?offset=9000",p=e.get(s),h=e.get(o),y=e.get(i),w=e.get(r),x=e.get(l),R=e.get(c),A=e.get(d),E=e.get(u),O=e.get(g),S=e.get(m);return t.all([p,h,y,w,x,R,A,E,O,S]).then(function(e){return f(e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource,e[8].data.resource,e[9].data.resource)),n.DEBUG_MODE&&console.log("No. Cat-Ans: ",b.length),b},v)}function r(a){var s=[];if(a.forEach(function(e){w.indexOf(e.id)<0&&(s.push(e),w.push(e.id))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)if(s[i].catstr)for(var r=s[i].catstr.split(":").map(Number),l=0;l<r.length;l++)o=o+"category="+r[l]+")OR(";else o=o+"category="+s[i].id+")OR(";o=o.substring(0,o.length-3);var c=k+o,d=e.get(c);return t.all([d]).then(function(e){var t=e[0].data.resource,a=b.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&b.push(e)}),n.DEBUG_MODE&&console.log("getAllCatansX loaded: ",t.length),t},v)}function l(a){var s=[];if(a.forEach(function(e){y.indexOf(e.id)<0&&(s.push(e),y.push(e.id))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)o=o+"answer="+s[i].id+")OR(";o=o.substring(0,o.length-3);var r=k+o,l=e.get(r);return t.all([l]).then(function(e){var t=e[0].data.resource,a=b.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&b.push(e)}),n.DEBUG_MODE&&console.log("getAllCatansY loaded: ",t.length),t},v)}function c(t){function s(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVotesbyCatans(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting catans records was succesful"),e.data}for(var o=0;o<b.length;o++)if(b[o].id==t){b.splice(o,1);break}var i=k+"?filter=id="+t;return e.delete(i).then(s,v)}function d(t){function a(e){return b.forEach(function(t){t.category==o.category&&t.answer==o.answer&&(t.id=e.data.resource[0].id)}),s.post("addedAnswer",["answer","category"],[o.answer,o.category]),n.DEBUG_MODE&&console.log("creating catans record was succesful"),e.data}var o={};o.answer=t,o.category=n.cCategory.id,o.upV=0,o.downV=0,o.user=n.user.id,o.timestmp=Date.now();var i={};i.resource=[],b.push(o),i.resource.push(o);var r=k;return e.post(r,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(a,v)}function u(t,a){function o(e){return b.forEach(function(t){t.category==i.category&&t.answer==i.answer&&(t.id=e.data.resource[0].id)}),s.post("addedAnswer",["answer","category"],[t,a]),console.log("@postRec2 creating catans record was succesful"),e.data}var i={};i.answer=t,i.category=a,i.upV=0,i.downV=0,i.user=n.user.id,i.timestmp=Date.now();var r={};r.resource=[],b.push(i),r.resource.push(i);var l=k;return e.post(l,r,{headers:{"Content-Type":"multipart/form-data"},body:r}).then(o,v)}function g(t){function s(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVotesbyCatans(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting catans records was succesful"),e.data}for(var o=0;o<b.length;o++)b[o].answer==t&&b.splice(o,1);var i=k+"?filter=answer="+t;return e.delete(i).then(s,v)}function m(t,s){function o(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVotesbyCatans(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting catans records by answer and category was succesful"),e.data}for(var i=0;i<b.length;i++)b[i].answer==t&&b[i].category==s&&b.splice(i,1);var r=k+"?filter=(answer="+t+") AND (category="+s+")";return e.delete(r).then(o,v)}function p(t){function s(e){for(var t=0;t<e.data.resource.length;t++)a.deleteVotesbyCatans(e.data.resource[t].id);return n.DEBUG_MODE&&console.log("Deleting catans records by category was succesful"),e.data}for(var o=0;o<b.length;o++)b[o].category==t&&b.splice(o,1);var i=k+"?filter=category="+t;return e.delete(i).then(s,v)}function h(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating catans record succesful"),e.data}var i={};i.resource=[];var r={};r.id=t;for(var l=0;l<a.length;l++)r[a[l]]=s[l];i.resource.push(r);for(var c=k,d=b.map(function(e){return e.id}).indexOf(t),l=0;l<a.length;l++)b[d][a[l]]=s[l];return e.patch(c,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,v)}function f(e){b.length=0,e.forEach(function(e){b.push(e)})}function v(e){throw e}var b=[],y=[],w=[];n.catansrecs=b;var k="/api/v2/mysql/_table/catans";return{getAllcatans:i,getAllcatansX:r,getAllcatansY:l,postRec:d,postRec2:u,deleteRec:m,deleteAnswer:g,updateRec:h,deletebyCategory:p,getCatan:o,deleteCatan:c}}angular.module("app").factory("catans",e),e.$inject=["$http","$q","$rootScope","votes","uaf"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(a){var s=k+"?offset=0",o=k+"?offset=1000",i=k+"?offset=2000",r=k+"?offset=3000",l=k+"?offset=4000",c=k+"?offset=5000",d=k+"?offset=6000",u=k+"?offset=7000",g=e.get(s),m=e.get(o),p=e.get(i),h=e.get(r),f=e.get(l),w=e.get(c),x=e.get(d),R=e.get(u);return t.all([g,m,p,h,f,w,x,R]).then(function(e){return v(e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource)),n.DEBUG_MODE&&console.log("No. Answers: ",y.length),y},b)}function l(a){var s=k+"?offset=0&filter=scope="+a,o=k+"?offset=1000&filter=scope="+a,i=k+"?offset=2000&filter=scope="+a,r=k+"?offset=3000&filter=scope="+a,l=k+"?offset=4000&filter=scope="+a,c=k+"?offset=5000&filter=scope="+a,d=k+"?offset=6000&filter=scope="+a,u=k+"?offset=7000&filter=scope="+a,g=e.get(s),m=e.get(o),p=e.get(i),h=e.get(r),f=e.get(l),w=e.get(c),x=e.get(d),R=e.get(u);return t.all([g,m,p,h,f,w,x,R]).then(function(e){return v(e[0].data.resource.concat(e[1].data.resource,e[2].data.resource,e[3].data.resource,e[4].data.resource,e[5].data.resource,e[6].data.resource,e[7].data.resource)),n.DEBUG_MODE&&console.log("No. Answers: ",y.length),y},b)}function c(a){var s=[];if(a.forEach(function(e){w.indexOf(e.answer)<0&&(s.push(e),w.push(e.answer))}),0==s.length)return t.when(!1);for(var o="?filter=(",i=0;i<s.length;i++)o=o+"id="+s[i].answer+")OR(";o=o.substring(0,o.length-3);var r=k+o,l=e.get(r);return t.all([l]).then(function(e){var t=e[0].data.resource,a=y.map(function(e){return e.id});return t.forEach(function(e){a.indexOf(e.id)<0&&y.push(e)}),n.DEBUG_MODE&&console.log("answers L loaded ",t),y},b)}function d(a){var s=k+"/?filter=id="+a,o=e.get(s);return t.all([o]).then(function(e){var t=e[0].data.resource[0];return y.map(function(e){return e.id}).indexOf(t.id)<0&&y.push(t),n.DEBUG_MODE&&console.log("single answer loaded: ",t),t})}function u(t){function n(e){return e.data}var a=k+"/?filter=customer="+t;return e.get(a).then(n,b)}function g(t,s){function o(e){var o=t;o.id=e.data.resource[0].id;var r=o.name.toLowerCase();r=r.replace(/ /g,"-"),r=r.replace("/","at"),r=r+"-"+e.data.resource[0].id,o.slug=r,y.push(o),p(e.data.resource[0].id,["slug"],[r]),i.createPageAnswer(o),"Establishment"==o.type&&(n.estNames.push(o.name),n.estAnswers.push(o)),"Person"==o.type&&(n.pplNames.push(o.name),n.pplAnswers.push(o)),"Place"==o.type&&(n.plaNames.push(o.name),n.plaAnswers.push(o));for(var l=0;l<s.length;l++)a.postRec2(o.id,s[l].id);return n.DEBUG_MODE&&console.log("created catans for a new answer"),n.DEBUG_MODE&&console.log("result",e),e.data}t.scope=n.SCOPE;var r=k,l=[];return void 0!=n.cCategory.owner&&0!=n.cCategory.owner?t.isprivate=!0:t.isprivate=!1,l.push(t),e.post(r,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(o,b)}function m(t,s){function o(e){var o=t;o.id=e.data.resource[0].id;var r=o.name.toLowerCase();r=r.replace(/ /g,"-"),r=r.replace("/","at"),r=r+"-"+e.data.resource[0].id,o.slug=r,y.push(o),p(e.data.resource[0].id,["slug"],[r]),i.createPageAnswer(o),"Establishment"==o.type&&(n.estNames.push(o.name),n.estAnswers.push(o)),"Person"==o.type&&(n.pplNames.push(o.name),n.pplAnswers.push(o)),"Place"==o.type&&(n.plaNames.push(o.name),n.plaAnswers.push(o));for(var l=0;l<s.length;l++)a.postRec2(o.id,s[l]);return n.DEBUG_MODE&&console.log("created "+s.length+"catans records for the new answer"),n.DEBUG_MODE&&console.log("result",e),e.data}t.scope=n.SCOPE;var r=k,l=[];return t.user=n.user.id,void 0!=s.owner&&0!=s.owner?t.isprivate=!0:t.isprivate=!1,l.push(t),e.post(r,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(o,b)}function p(t,a,s){function r(e){return"owner"==a[0]&&o.post("binded",["answer"],[t]),n.DEBUG_MODE&&console.log("updating answer succesful"),e.data}var l={};l.resource=[];var c={};c.id=t;for(var d=0;d<a.length;d++)c[a[d]]=s[d];l.resource.push(c);for(var u=k,g=y.map(function(e){return e.id}).indexOf(t),d=0;d<a.length;d++)y[g][a[d]]=s[d];for(var m=!1,d=0;d<a.length;d++)if("name"==a[d]||"slug"==a[d]&&a.length>1||"imageurl"==a[d]||"addinfo"==a[d]){m=!0;break}return m&&i.createPageAnswer(y[g]),e.patch(u,l,{headers:{"Content-Type":"multipart/form-data"},body:l}).then(r,b)}function h(t,a){function s(e){return n.DEBUG_MODE&&console.log(" answer flagged succesful"),e.data}var o={};o.resource=[];var i={};i.id=t,i.flag=a,o.resource.push(i);var r=k;return e.patch(r,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(s,b)}function f(t){function a(e){var a="answer"+t+".html",s={};return s.filename=a,i.removeFile(s),n.DEBUG_MODE&&console.log("Deleting answer was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var r=k+"/"+t,l=y.map(function(e){return e.id}).indexOf(t);return l>-1&&y.splice(l,1),e.delete(r,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,b)}function v(e){y.length=0,w.length=0,e.forEach(function(e){y.push(e),w.push(e.id)})}function b(e){throw e}var y=[],w=[];n.answers=y;var k="/api/v2/mysql/_table/answers";return{getAnswers:r,getAnswersX:l,getAnswersL:c,getAnswer:d,addAnswer:g,addAnswer2:m,updateAnswer:p,deleteAnswer:f,flagAnswer:h,getAnswerbyCustomer:u}}angular.module("app").factory("answer",e),e.$inject=["$http","$q","$rootScope","catans","vrows","uaf","staticpages"]}(),angular.module("app").directive("catBar",["color","$window","$rootScope","$state",function(e,t,n,a){"use strict";return{templateUrl:"app/answer/Partials/catbar.html",transclude:!0,scope:{text:"@",leftFn:"&leftFn",rightFn:"&rightFn",closeRank:"&closeRank"},link:function(n){n.bc="#006dcc",n.bc2=e.shadeColor(n.bc,-.3),n.fc="white",t.innerWidth<769?(n.ht=50,n.text.length>50&&(n.ht=90)):t.innerWidth<870?(n.ht=50,n.text.length>50&&(n.ht=75)):n.ht=50,n.goPrev=function(){n.leftFn()},n.goNext=function(){n.rightFn()},n.selRank=function(){n.closeRank()}}}}]),angular.module("app").directive("blobUpload",["$rootScope","$state",function(e,t){"use strict";return{templateUrl:"app/answer/Partials/blobupload.html",transclude:!0,scope:{},controller:["$scope","Upload","$timeout","$http","$rootScope","useruploadedimages","mailing",function(e,t,n,a,s,o,i){function r(t){e.errorMsg=t}function l(e){var t={};console.log("$rootScope.user - ",s.user),t.user=s.user.id,t.username=s.user.name,t.imageurl=e,t.answer=s.canswer.id,t.answername=s.canswer.name,o.postRecord(t),i.newImageUploaded(t).then(function(e){console.log("Send mail request for image notification")})}r(""),e.uploadFiles=function(n,a){if(e.f=n,e.errFile=a&&a[0],null==n)if(console.log("file is null"),void 0!=e.errFile){var o="Uploading failed for "+e.errFile.name+", "+e.errFile.$error+" exceeds "+e.errFile.$errorParam;r(o)}else r("");else{var i="https://rankx.blob.core.windows.net/sandiego/"+s.canswer.id+"/"+n.name+"?sv=2015-04-05&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-08-30T01:15:12Z&st=2016-08-29T17:15:12Z&spr=https,http&sig=PpyWE0X%2Fpz9SuRje5GtHh44WaWIii0GBU9PbIcDIka8%3D",c=new FileReader;c.readAsArrayBuffer(n),c.onload=function(a){t.http({url:i,method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","x-ms-blob-content-type":n.type},data:a.target.result}).then(function(t){t.status>0&&(e.errorMsg=t.status+": "+t.data);var a="https://rankx.blob.core.windows.net/sandiego/"+s.canswer.id+"/"+n.name;console.log("emitted fileUploaded!!"),l(a),s.$emit("fileUploaded",a)},null,function(e){n.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}}}]}}]),angular.module("app").directive("answerHeader",["color","$window","$rootScope","$state","dialog",function(e,t,n,a,s){"use strict";return{templateUrl:"app/answer/Partials/answerheader.html",transclude:!0,scope:{ans:"@",idx:"@"},link:function(o){function i(){o.imgmode="Show Map",o.imgmodeicon="fa fa-globe",o.modeIsImage=!0,n.modeIsImage=!0}function r(){o.imgmode="Show Image",o.imgmodeicon="fa fa-picture-o",o.modeIsImage=!1,n.modeIsImage=!1}o.isMobile=!1,
(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(o.isMobile=!0),o.answer=JSON.parse(o.ans),"Short-Phrase"==o.answer.type?o.isShortPhrase=!0:o.isShortPhrase=!1,"Event"==o.answer.type?o.isEvent=!0:o.isEvent=!1,n.isLoggedIn&&n.user.id==o.answer.owner?o.userIsOwner=!0:o.userIsOwner=!1,o.modeIsImage=!0,o.imgmode="Show Map",o.imgmodeicon="fa fa-globe",o.hasMap=void 0!=o.answer.location&&""!=o.answer.location;for(var l=[0,401,474,769,971,996,1173,1201,1635,1960,3500],c=[.86,.86,.88,.96,.75,.96,.68,.96,.64,.6,.6],d=t.innerWidth,u=0,g=0;g<l.length-1;g++)if(d>l[g]&&d<l[g+1]){var m=(c[g+1]-c[g])/(l[g+1]-l[g]),p=c[g]-l[g]*m;u=d*m+p}if(t.innerWidth<763){if(o.sp1="width:5%;padding:0px;",o.sp2="width:25%;max-height:50px",o.sp3="width:20%",o.sm=!0,o.nsm=!1,o.width=Math.round(d*u),o.mxheight=Math.round(o.width/1.25),o.mxheight>300&&(o.mxheight=300),n.cCategory){var h=e.defaultRankColor(n.cCategory);o.bc=h[0],o.fc=h[1]}else o.bc="gray",o.fc="black";o.bc2=e.shadeColor(o.bc,.4)}else{if(o.mxheight="300",o.sp1="width:15%",o.sp2="width:22.5%;max-height:50px;",o.sp3="width:20%",o.sm=!1,o.nsm=!0,o.width=Math.round(d*u),o.width2=Math.round(d*u/2),o.width3=Math.round(d*u/3),n.cCategory){var h=e.defaultRankColor(n.cCategory);o.bc=h[0],o.fc=h[1]}else o.bc="gray",o.fc="black";o.bc2="#d8d8d8"}void 0!=o.answer.addinfo&&(o.answer.addinfo_teaser=o.answer.addinfo.slice(0,300),o.answer.addinfo_complete=o.answer.addinfo.slice(300)),o.moretext=" more ",o.completeinfo=!1,function(){if(o.hrset=!1,void 0!=o.answer.strhours&&null!=o.answer.strhours){o.hrset=!0;var e=new Date,t=e.getDay(),n=t-1;n<0&&(n=6);var a=JSON.parse(o.answer.strhours);"CLOSED"==a[n].opn?o.hourstr="Closed today":o.hourstr="Open today from: "+a[n].st+" to "+a[n].ct}}(),o.toggleimgmode=function(){o.modeIsImage?r():i()},o.editAnswer=function(){n.isLoggedIn?"Event"==o.answer.type?(n.eventmode="edit",a.go("addEvent",{index:o.answer.id})):a.go("editAnswer",{index:o.answer.id}):s.loginFacebook()},o.showcomplete=function(){return" more "==o.moretext?(o.moretext=" less ",void(o.completeinfo=!0)):" less "==o.moretext?(o.moretext=" more ",void(o.completeinfo=!1)):void 0},o.gotoLocationAnswer=function(){console.log("eventlocid - ",o.answer.eventlocid),a.go("answerDetail",{index:o.answer.eventlocid})}}}}]),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h){function f(){ee.imageURL=ee.answer.imageurl;for(var e=0;e<a.fields.length;e++){switch(ne={},ne.field=a.fields[e].name,ne.onlybyowner=a.fields[e].onlybyowner,a.fields[e].name){case"name":ne.cval=ee.answer.name;break;case"cityarea":ne.cval=ee.answer.cityarea;break;case"location":ne.cval=ee.answer.location;break;case"addinfo":ne.cval=ee.answer.addinfo;break;case"phone":ne.cval=ee.answer.phone;break;case"website":ne.cval=ee.answer.website;break;case"email":ne.cval=ee.answer.email}ne.val="",ne.label=a.fields[e].label,"cityarea"==ne.field?ne.opts="c for c in vm.neighborhoods":ne.opts="c for c in vm.emptyarray",ee.fields.push(ne)}for(var e=0;e<ee.fields.length;e++)ee.fields[e].val=ee.fields[e].cval}function v(){ee.answerRanks=[];for(var e=0,t=0;t<a.catansrecs.length;t++)a.catansrecs[t].answer==ee.answer.id&&(e=a.content.map(function(e){return e.id}).indexOf(a.catansrecs[t].category),ee.answerRanks.push(a.content[e]))}function b(){a.DEBUG_MODE&&console.log("prepareCatansOptions"),ee.addctsopts=[];for(var e="",t=0;t<a.ctsOptions.length;t++)a.ctsOptions[t].indexOf("@neighborhood")>-1?ee.answer.cityarea&&(e=a.ctsOptions[t].replace("@neighborhood",ee.answer.cityarea),ee.addctsopts.push(e)):ee.addctsopts.push(a.ctsOptions[t])}function y(){ee.addctsactive=!0}function w(){var t=!1,n=a.content.map(function(e){return e.title}).indexOf(ee.addctsval);"Person"==ee.answer.type&&"Person"!=a.content[n].type&&(t=!0),"Event"==ee.answer.type&&"Event"!=a.content[n].type&&(t=!0),"Thing"==ee.answer.type&&"Thing"!=a.content[n].type&&(t=!0),"PersonCust"==ee.answer.type&&"PersonCust"!=a.content[n].type&&(t=!0),"Place"!=ee.answer.type&&"Establishment"!=ee.answer.type&&"Organization"!=ee.answer.type||"Place"==a.content[n].type||"Establishment"==a.content[n].type||"Organization"==a.content[n].type||(t=!0),t?e.typemismatch(a.content[n].type,ee.answer.type):e.confirmAddRank(a.content[n],ee.answer,k)}function k(e,t){s.postRec2(t.id,e.id).then(v),ee.addctsval="",ee.addctsactive=!1}function x(t){e.confirmRemoveRank(t,ee.answer,R)}function R(e,t){for(var n=0;n<a.catansrecs.length;n++)a.catansrecs[n].answer==t.id&&a.catansrecs[n].category==e.id&&s.deleteRec(t.id,e.id).then(v)}function A(e){ee.edits=[],ae=[],se=[];for(var t={},n=0;n<a.edits.length;n++)if(a.edits[n].answer==e){switch(t=a.edits[n],t.vote=0,t.idx=n,t.agree="",t.disagree="",a.fields[0].name){case"name":t.name=ee.answer.name}ee.edits.push(t),ae.push(a.edits[n].upV),se.push(a.edits[n].downV)}D(ee.answer.id)}function E(t){if(!a.isLoggedIn)return void e.loginFacebook();for(var n=!1,s=0;s<ee.edits.length;s++)if(ee.edits[s].field==t.field){n=!0;break}if(n)return void e.getDialog("editFieldExists");var o={};switch(o.field=t.field,o.nval=t.val,o.cval||(o.cval=""),o.answer=ee.answer.id,o.upV=0,o.downV=0,o.imageURL="",o.display="none",a.fields[0].name){case"name":o.name=ee.answer.name}o.user=a.user.id,o.username=a.user.name,o.timestmp=Date.now(),a.userIsOwner?e.editConfirm(o,"field",Q):e.editConfirm(o,"field",U)}function O(){if(console.log("@editImage"),!a.isLoggedIn)return void e.loginFacebook();for(var t=!1,n=0;n<ee.edits.length;n++)if("imageurl"==ee.edits[n].field){t=!0;break}if(t)return void e.getDialog("editFieldExists");d.getImageLinks(ee.fields,he,"edit").then(V,F)}function S(){a.DEBUG_MODE&&console.log("@selectImage");var t={};switch(t.field="imageurl",t.cval=ee.answer.imageurl,t.nval="",a.userIsOwner?t.imageURL=a.blobimage:t.imageURL=ee.imageURL,t.display="inline",t.answer=ee.answer.id,t.upV=0,t.downV=0,a.fields[0].name){case"name":t.name=ee.answer.name}t.user=a.user.id,t.username=a.user.name,t.timestmp=Date.now(),a.userIsOwner?e.editConfirm(t,"image",Q):e.editConfirm(t,"image",X),console.log("$rootScope.userIsOwner - ",a.userIsOwner)}function D(e){for(var t={},n=0;n<a.editvotes.length;n++)a.editvotes[n].answer==e&&(t=a.editvotes[n],oe.push(t));for(n=0;n<ee.edits.length;n++)for(var s=0;s<oe.length;s++)ee.edits[n].id==oe[s].edit&&(ee.edits[n].vote=oe[s].vote);P()}function C(t,n){if(a.isAdmin)return void e.editChangeEffective(ee.edits[n],n,"approve",L);if(!a.isLoggedIn)return void e.loginFacebook();switch(t.vote){case 1:ee.edits[n].vote=0,ee.edits[n].upV--;break;case 0:ee.edits[n].vote=1,ee.edits[n].upV++;break;case-1:ee.edits[n].vote=1,ee.edits[n].upV++,ee.edits[n].downV--}T(n),P()}function I(t,n){if(a.isAdmin)return void e.editChangeEffective(ee.edits[n],n,"reject",L);if(!a.isLoggedIn)return void e.loginFacebook();switch(t.vote){case 1:ee.edits[n].vote=-1,ee.edits[n].upV--,ee.edits[n].downV++;break;case 0:ee.edits[n].vote=-1,ee.edits[n].downV++;break;case-1:ee.edits[n].vote=0,ee.edits[n].downV--}T(n),P()}function P(){for(var e=0;e<ee.edits.length;e++)switch(ee.edits[e].vote){case 1:ee.edits[e].agree="active",ee.edits[e].disagree="";break;case 0:ee.edits[e].agree="",ee.edits[e].disagree="";break;case-1:ee.edits[e].agree="",ee.edits[e].disagree="active"}}function T(t){if(ee.edits[t].upV>ee.edits[t].downV){if(ee.edits[t].upV-ee.edits[t].downV>=re)return void e.editChangeEffective(ee.edits[t],t,"approve",L)}else if(ee.edits[t].downV>ee.edits[t].upV&&ee.edits[t].downV-ee.edits[t].upV>=le)return void e.editChangeEffective(ee.edits[t],t,"reject",L)}function M(){a.DEBUG_MODE&&console.log("updateRecords @ editAnswer");for(var e=!1,t=[],n={},s=0;s<ee.edits.length;s++){e=!1;for(var o=0;o<oe.length;o++)if(ee.edits[s].id==oe[o].edit){e=!0;break}e?l.patchEditVoteRec(oe[o].id,ee.edits[s].vote):0!=ee.edits[s].vote&&(n={},n.edit=ee.edits[s].id,n.user=a.user.id,n.category=a.cCategory.id,n.answer=ee.edits[s].answer,n.vote=ee.edits[s].vote,n.timestmp=Date.now(),t.push(n)),ee.edits[s].upV==ae[s]&&ee.edits[s].downV==se[s]||r.updateEdit(ee.edits[s].id,ee.edits[s].upV,ee.edits[s].downV)}t.length>0&&(l.postEditVoteRec(t),t=[]),ie=!0}function L(e,t){"approve"==t&&(N(e),ue||me||G()),"reject"==t&&$(e)}function N(e){if(a.DEBUG_MODE&&console.log("Edit has been approved"),"imageurl"==ee.edits[e].field)a.DEBUG_MODE&&console.log("EA-3"),c.updateAnswer(ee.edits[e].answer,[ee.edits[e].field],[ee.edits[e].imageURL]).then(function(){console.log("vm.answer - ",ee.answer),f()});else if("location"==ee.edits[e].field){if(void 0!=ee.edits[e].nval&&""!=ee.edits[e].nval&&null!=ee.edits[e].nval){ue=!0,ee.answer.location=ee.edits[e].nval;var t=u.getLocationGPS(ee.answer);t.then(function(){})}}else if("cityarea"==ee.edits[e].field){for(var n=0,o={},i="",r=0,l=0,d=!1,m=0;m<a.catansrecs.length;m++)if(a.catansrecs[m].answer==ee.answer.id&&(d=!1,n=a.content.map(function(e){return e.id}).indexOf(a.catansrecs[m].category),o=a.content[n],console.log("change nh- ",n,o),o.title.indexOf(ee.answer.cityarea)>-1)){i=o.title.replace(ee.answer.cityarea,ee.edits[e].nval);for(var p=0;p<a.content.length;p++)if(a.content[p].title==i){r=a.catansrecs[m].id,l=a.content[p].id,d=!0;break}if(d)console.log("Changed catans"),s.updateRec(r,["category"],[l]);else{console.log("dang, have to create table");var h=a.categories.map(function(e){return e.id}).indexOf(o.cat),v=a.locations.map(function(e){return e.nh_name}).indexOf(ee.edits[e].nval),b={};b.cat=a.categories[h].id,b.nh=a.locations[v].id,b.isatomic=!0,b.scope=a.SCOPE,me=!0,g.addTable(b).then(function(e){console.log("Had to create table, the id is: ",e),s.updateRec(r,["category"],[e]),G()})}}a.DEBUG_MODE&&console.log("EA-4"),c.updateAnswer(ee.edits[e].answer,[ee.edits[e].field],[ee.edits[e].nval])}else a.DEBUG_MODE&&console.log("EA-2"),c.updateAnswer(ee.edits[e].answer,[ee.edits[e].field],[ee.edits[e].nval]);ce=!0,de=e}function _(){ge||(ge=!0,a.DEBUG_MODE&&console.log("EA-1"),c.updateAnswer(ee.answer.id,["location","lat","lng"],[ee.answer.location,ee.answer.lat,ee.answer.lng]).then(G))}function $(e){a.DEBUG_MODE&&console.log("Edit has been discarded"),r.deleteEdit(ee.edits[e].id),l.deleteEditVotes(ee.edits[e].id),a.edits.splice(ee.edits[e].idx,1),ee.edits.splice(e,1)}function B(){e.howItWorks("editAnswer")}function U(e){M(),ie=!1;var t=r.addEdit(e);a.DEBUG_MODE&&console.log("creating edit"),t.then(function(){A(ee.answer.id)})}function X(e){M(),ie=!1,r.addEdit(e).then(function(){A(ee.answer.id),ee.imageURL=ee.answer.imageurl,ee.imagefunctions="none"})}function G(){ce&&(r.deleteEdit(ee.edits[de].id),l.deleteEditVotes(ee.edits[de].id),a.edits.splice(ee.edits[de].idx,1),ee.edits.splice(de,1)),n.go("answerDetail",{index:ee.answer.id})}function V(e){for(var t=!1,n=0;n<e.length;n++){for(var a=0;a<pe.length;a++)if(0==e[n].localeCompare(pe[a])){t=!0;break}t||pe.push(e[n])}ee.numLinks=pe.length,he++,(ee.numLinks>10||he>4)&&(ee.searchDisabled="disabled"),he>1&&(ee.imageCommand="Load More Images"),ee.linkIdx=0,ee.imageURL=pe[ee.linkIdx],ee.numLinks>0&&(ee.imagefunctions="inline")}function F(){a.DEBUG_MODE&&console.log("query failed, dont give up")}function Y(){ee.linkIdx++,ee.linkIdx>=ee.numLinks&&(ee.linkIdx=0),ee.imageURL=pe[ee.linkIdx]}function q(){ee.linkIdx--,ee.linkIdx<0&&(ee.linkIdx=ee.numLinks-1),ee.imageURL=pe[ee.linkIdx]}function z(){G()}function j(){if(ee.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"],ee.openOptions=["OPEN","CLOSED"],void 0==ee.answer.strhours||null==ee.answer.strhours||0==ee.answer.strhours.length){ee.openhours=JSON.parse('[{"day":"MON","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"TUE","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"WED","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"THU","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"FRI","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"SAT","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"},{"day":"SUN","opn":"OPEN","st":"8:00 AM","ct":"5:00 PM"}]')}else ee.openhours=JSON.parse(ee.answer.strhours)}function W(){ee.updateHoursEn=""}function H(){for(var e=[],t={},n=0;n<ee.openhours.length;n++)t={},t.day=ee.openhours[n].day,t.opn=ee.openhours[n].opn,t.st=ee.openhours[n].st,t.ct=ee.openhours[n].ct,e.push(t);var s=JSON.stringify(e);a.DEBUG_MODE&&console.log("EA-4"),c.updateAnswer(ee.answer.id,["strhours"],[s]),ee.updateHoursEn="disabled"}function K(){for(var e="",t=0;t<ee.fields.length;t++)"name"==ee.fields[t].field&&(e=ee.fields[t].val);e.length>0&&p.getWiki(e)}function J(e){console.log("Load Wiki!!",e);for(var t=0;t<ee.fields.length;t++)"addinfo"==ee.fields[t].field&&(ee.fields[t].val=e)}function Q(e){if(a.DEBUG_MODE&&console.log("Direct Edit Executed"),a.DEBUG_MODE&&console.log("edit - ",e),"imageurl"==e.field)a.DEBUG_MODE&&console.log("R1"),ee.imageURL=a.blobimage,c.updateAnswer(e.answer,["imageurl"],[e.imageURL]),n.go("editAnswer",{index:ee.answer.id});else if("location"==e.field){if(a.DEBUG_MODE&&console.log("R2"),void 0!=e.nval&&""!=e.nval&&null!=e.nval){ee.answer.location=e.nval;var t=u.getLocationGPS(ee.answer);t.then(function(){})}}else a.DEBUG_MODE&&console.log("R3"),c.updateAnswer(e.answer,[e.field],[e.nval]);a.cmd1exe=!1}function Z(e){e?(ee.imageURL=a.EMPTY_IMAGE,S()):ee.imageURL=pe[ee.linkIdx]}var ee=this;if(ee.title="editAnswer",ee.answer={},ee.showHowItWorksDialog=B,ee.editField=E,ee.editAgree=C,ee.editImage=O,ee.selectImage=S,ee.viewPrev=q,ee.viewNext=Y,ee.closeRank=z,ee.editDisagree=I,ee.answerDetail=G,ee.hoursChanged=W,ee.updateHours=H,ee.onNoGoodImages=Z,ee.getWiki=K,ee.remRank=x,ee.addCatans=y,ee.addcts=w,ee.ranking=a.title,ee.userIsOwner=a.userIsOwner,t.index){if(/^\d+$/.test(t.index)){var te=a.answers.map(function(e){return e.id}).indexOf(+t.index);ee.answer=a.answers[te]}else{var te=a.answers.map(function(e){return e.slug}).indexOf(t.index);ee.answer=a.answers[te]}}ee.type=ee.answer.type,ee.fields=[];var ne={};ee.edits=[];var ae=[],se=[],oe=[],ie=!1,re=1,le=1,ce=!1,de=0,ue=!1,ge=!1,me=!1,pe=[];ee.linkIdx=0,ee.numLinks=0,ee.imageCommand="Change Image";var he=3;ee.imagefunctions="none",ee.emptyarray=[],ee.updateHoursEn="disabled",ee.neighborhoods=a.neighborhoods.concat(a.districts),a.$on("$stateChangeSuccess",function(e,t,n,s,o){a.previousState=s.name}),a.$on("$stateChangeStart",function(e,t,n,a,s){"editAnswer"==a.name&&(ie||M())});var fe=a.$on("fileUploaded",function(e,t){a.cmd1exe=!!a.cmd1exe&&a.cmd1exe,"editAnswer"!=n.current.name||a.cmd1exe||(a.cmd1exe=!0,a.blobimage=t,S())}),ve=a.$on("answerGPSready",function(){"editAnswer"!=n.current.name||ge||_()}),be=a.$on("wikiReady",function(e,t){"editAnswer"==n.current.name&&J(t)});o.$on("$destroy",fe),o.$on("$destroy",ve),o.$on("$destroy",be),m.innerWidth<512?(ee.sm=!0,ee.nsm=!1):(ee.sm=!1,ee.nsm=!0),function(){void 0!=a.cCategory.owner&&0!=a.cCategory.owner?a.isCustomRank=!0:a.isCustomRank=!1,m.scrollTo(0,0),f(),v(),b(),ee.userIsOwner&&"Establishment"==ee.type&&j(),ee.access=ee.userIsOwner&&ee.answer.isactive,A(ee.answer.id),a.DEBUG_MODE&&console.log("Edit Answer Activated!")}()}angular.module("app").controller("editAnswer",e),e.$inject=["dialog","$stateParams","$state","$rootScope","catans","$scope","$modal","edit","editvote","answer","image","getgps","table","$window","getwiki","$http"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d){function u(){v.ranksqty=a.canswer.ranksqty,void 0==a.canswer&&n.go("cwrapper");var e=0;v.ranks=JSON.parse(a.canswer.ranks),void 0==v.ranks&&(v.ranks=[]);for(var t=0;t<v.ranks.length;t++)e=a.customranks.map(function(e){return e.id}).indexOf(v.ranks[t].id),v.ranks[t].title=a.customranks[e].title.replace(" @ "+a.canswer.name,""),v.ranks[t].used=!0;if(v.ranks.length<a.canswer.ranksqty)for(var s=v.ranks.length;s<a.canswer.ranksqty;s++){var o={};o.title="Empty",o.used=!1,v.ranks.push(o)}a.DEBUG_MODE&&console.log("vm.ranks - ",v.ranks),a.DEBUG_MODE&&console.log("Answer rankings manager activated!")}function g(e){a.rankIdx=e,a.rankforAnswerMode="edit",n.go("addRankforAnswer")}function m(){a.rankforAnswerMode="add",n.go("addRankforAnswer")}function p(t){var n=a.customranks.map(function(e){return e.id}).indexOf(v.ranks[t].id);b=t,e.deleteRank(a.customranks[n],h)}function h(){c.deleteTable(v.ranks[b].id),v.ranks.splice(b,1);for(var e=[],t={},n=0;n<v.ranks.length;n++)v.ranks[n].used&&(t={},t.id=v.ranks[n].id,t.bc=v.ranks[n].bc,t.fc=v.ranks[n].fc,e.push(t));var s=JSON.stringify(e);l.updateAnswer(a.canswer.id,["ranks"],[s]),u()}function f(){n.go("answerDetail",{index:a.canswer.id})}var v=this;v.title="answerRanksManager",v.editRank=g,v.addRank=m,v.deleteRank=p,v.goBack=f;var b=0;u()}angular.module("app").controller("answerRanksManager",e),e.$inject=["dialog","$stateParams","$state","$rootScope","catans","$modal","edit","editvote","answer","table2","$window"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,l,c,d,u,g,m,p,h,f,v,b,y,w,k,x,R,E,O,S,D,C,I,P,T,M,L,N){function _(){if(t.index){if(/^\d+$/.test(t.index)){var e=o.answers.map(function(e){return e.id}).indexOf(+t.index);Ze.answer=o.answers[e]}else{var e=o.answers.map(function(e){return e.slug}).indexOf(t.index);Ze.answer=o.answers[e]}}void 0==Ze.answer?(ct=!1,s.notificationWithCallback("Oops","Couldnt find this answer. This answer probably got deleted and its no longer in the database.",K)):(ct=!0,$())}function $(){if(at=o.canswers,Ze.fields=o.fields,Ze.isAdmin=o.isAdmin||o.dataAdmin,Ze.isAdmin&&(Ze.bizcat=b.getBizCat(Ze.answer.id)),o.isLoggedIn=!!o.isLoggedIn&&o.isLoggedIn,Ze.isLoggedIn=o.isLoggedIn,o.cansvrows=void 0,S.$parent.$parent.$parent.seo={pageTitle:Ze.answer.name,metaDescription:Ze.answer.addinfo},void 0==Ze.answer.isprivate&&(Ze.answer.isprivate=!1),o.canswer=Ze.answer,Ze.type=Ze.answer.type,Ze.i=-1,(o.DISPLAY_XSMALL||o.DISPLAY_SMALL)&&(rt=4),o.DISPLAY_MEDIUM&&(rt=6),o.DISPLAY_LARGE&&(rt=12),we(),o.inFavMode?Ze.ranking=o.myfavs.title:o.cCategory?Ze.ranking=o.cCategory.title:Ze.ranking="",void 0==at&&(at=[Ze.answer]),Ze.idx=at.map(function(e){return e.id}).indexOf(Ze.answer.id)+1,void 0==o.cCategory&&(Ze.idx=0),2225==Ze.answer.id?Ze.igdemo=!0:Ze.igdemo=!1,B(),Ze.modeIsImage=void 0==o.modeIsImage||o.modeIsImage,void 0==Ze.answer.location&&(Ze.modeIsImage=!0),"answerDetail"!=o.previousState&&i.scrollTo(0,0),o.$emit("showLogo"),U(),z(Ze.answer.id),Ze.access=!1,o.isLoggedIn?(o.user.id==Ze.answer.owner?(Ze.userIsOwner=!0,Ze.answer.isactive&&(Ze.access=!0)):Ze.userIsOwner=!1,o.isAdmin&&(Ze.userIsOwner=!0)):Ze.userIsOwner=!1,o.userIsOwner=Ze.userIsOwner,ce(),"Establishment"!=Ze.type&&Ze.type,"Establishment"==Ze.type&&ae(Ze.answer.id),ie(Ze.answer.id),ne(),y.pulldata("ranks",Ze.answerRanks),"Event"==Ze.type){var e=JSON.parse(Ze.answer.eventstr);Le(Ze.answer,e),Ze.ehtml=c.eventHtml(Ze.answer),Ze.estyle="background-color:"+Ze.answer.bc+";color:"+Ze.answer.fc+";white-space:pre;"}if(Ze.answer.hasranks){var t=0;if(Ze.myranks=JSON.parse(Ze.answer.ranks),void 0!=Ze.myranks&&Ze.myranks.length>0)for(var n=0;n<Ze.myranks.length;n++)t=o.customranks.map(function(e){return e.id}).indexOf(Ze.myranks[n].id),Ze.myranks[n].title=o.customranks[t].title.replace(" @ "+Ze.answer.name,""),Ze.myranks[n].image=o.customranks[t].image1url,void 0!=Ze.myranks[n].image&&""!=Ze.myranks[n].image||(Ze.myranks[n].image=o.EMPTY_IMAGE)}else if(Ze.userIsOwner){Ze.myranks=[];var s={};s.id=11091,s.bc="#027fa8",s.fc="white",Ze.myranks.push(s),s={},s.id=11092,s.bc="#027fa8",s.fc="white",Ze.myranks.push(s),s={},s.id=11093,s.bc="#027fa8",s.fc="white",Ze.myranks.push(s);for(var n=0;n<Ze.myranks.length;n++)t=o.customranks.map(function(e){return e.id}).indexOf(Ze.myranks[n].id),Ze.myranks[n].title=o.customranks[t].title.replace(" @ Demo",""),Ze.myranks[n].image=o.customranks[t].image1url,void 0!=Ze.myranks[n].image&&""!=Ze.myranks[n].image||(Ze.myranks[n].image=o.EMPTY_IMAGE);o.rankOwner={},o.rankOwner.name=Ze.answer.name,o.rankOwner.slug=Ze.answer.slug}void 0==Ze.answer.numcom?Ze.numcom=0:Ze.numcom=Ze.vrows.length,Ze.answer.numcom!=Ze.vrows.length&&a.updateAnswer(Ze.answer.id,["numcom"],[Ze.numcom]),Ze.ranking?Ze.showNextnPrev=!0:Ze.showNextnPrev=!1;var r=Ze.answer.views+1;a.updateAnswer(Ze.answer.id,["views"],[r]),Ue(),o.DEBUG_MODE&&console.log("Answer details loaded"),window.prerenderReady=!0}function B(){if(!o.fields){var e=0;switch(Ze.answer.type){case"Place":e=0;break;case"Person":e=1;break;case"Event":e=2;break;case"Organization":e=3;break;case"Short-Phrase":e=4;break;case"Activity":e=5;break;case"Establishment":e=6;break;case"Thing":e=7;break;case"PersonCust":e=8;break;case"Simple":e=9}var t=o.typeSchema[e].fields;o.fields=t}}function U(){void 0==Ze.answer.owner||null==Ze.answer.owner||0==Ze.answer.owner?Ze.answer.hasOwner=!1:Ze.answer.hasOwner=!0,Ze.bindtxt="","Establishment"==Ze.type&&(Ze.bindtxt="I represent this business"),"PersonCust"==Ze.type&&(Ze.bindtxt="I am this person"),"Event"==Ze.type&&(Ze.bindtxt="I organize this event")}function X(e){var t=0,n=0,a="";Ze.relativetable=[];for(var s=o.R,i=o.GP,r=o.answersR,l=A.indexOf(+e),c=0,d=o.fields[0].name,u=!1,g=0;g<r.length;g++)if(A[g]!=e){switch(c=s[l][g],d){case"name":a=r[g].name;break;case"nickname":a=r[g].nickname;break;case"country":a=r[g].country,u=!0;break;case"club":a=r[g].club}i[l][g]?(t=Math.round(c/i[l][g]*100),n=100-t):(t=0,n=0),Ze.relativetable.push({id:r[g].id,Rank:r[g].Rank,PctF:t,vsName:a,PctC:n,GP:i[l][g],isC:u})}}function G(e){V(),st=!1,et=!1,Ze.answer=at[A.indexOf(+e)],o.canswer=Ze.answer,z(Ze.answer.id),tt=Ze.catans.upV,nt=Ze.catans.downV,U(),ne(),F(),X(e),ae(Ze.answer.id),ie(Ze.answer.id)}function V(){if(o.isLoggedIn&&ct){o.DEBUG_MODE&&console.log("UpdateRecords @answerDetail");for(var e=0;e<Ze.answerRanks.length;e++){var t=Ze.answerRanks[e].voteRecordExists,n=!1,a={};try{var s=o.thisuseractivity.map(function(e){return e.category}).indexOf(Ze.answerRanks[e].id)}catch(e){console.log("Error: ",e),console.log("$rootScope.thisuseractivity - ",o.thisuseractivity);var s=-1}s>=0?(n=!0,a=o.thisuseractivity[s]):n=!1,t&&Ze.answerRanks[e].uservote.vote!=Ze.answerRanks[e].dV&&0!=Ze.answerRanks[e].dV&&(o.DEBUG_MODE&&console.log("UR-1"),d.patchRec(Ze.answerRanks[e].uservote.id,Ze.answerRanks[e].dV)),t&&Ze.answerRanks[e].uservote.vote!=Ze.answerRanks[e].dV&&0==Ze.answerRanks[e].dV&&(o.DEBUG_MODE&&console.log("UR-2"),d.deleteRec(Ze.answerRanks[e].uservote.id),a.votes<2?(o.DEBUG_MODE&&console.log("UR-3"),l.deleteRec(a.id)):(o.DEBUG_MODE&&console.log("UR-4"),l.patchRec(a.id,a.votes-1))),t||0==Ze.answerRanks[e].dV||(o.DEBUG_MODE&&console.log("UR-5"),d.postRec(Ze.answerRanks[e].catans,Ze.answer.id,Ze.answerRanks[e].id,Ze.answerRanks[e].dV),n?(o.DEBUG_MODE&&console.log("UR-6"),l.patchRec(a.id,a.votes+1)):(o.DEBUG_MODE&&console.log("UR-7"),l.postRec(Ze.answerRanks[e].id))),Ze.answerRanks[e].upV==Ze.answerRanks[e].upVi&&Ze.answerRanks[e].downV==Ze.answerRanks[e].downVi||(o.DEBUG_MODE&&console.log("UR-8"),p.updateRec(Ze.answerRanks[e].catans,["upV","downV"],[Ze.answerRanks[e].upV,Ze.answerRanks[e].downV]))}if(Ze.vrows)for(var e=0;e<Ze.vrows.length;e++){var i=Ze.vrows[e].voteExists;i&&Ze.vrows[e].dVi!=Ze.vrows[e].dV&&(o.DEBUG_MODE&&console.log("UR-9"),o.cvrowvotes[Ze.vrows[e].vidx].val=Ze.vrows[e].dV,R.patchRec(Ze.vrows[e].voteid,Ze.vrows[e].dV)),i||0==Ze.vrows[e].dV||(o.DEBUG_MODE&&console.log("UR-10"),R.postRec(Ze.vrows[e].id,Ze.vrows[e].dV)),Ze.vrows[e].upV==Ze.vrows[e].upVi&&Ze.vrows[e].downV==Ze.vrows[e].downVi||(o.DEBUG_MODE&&console.log("UR-11"),x.updateRec(Ze.vrows[e].id,["upV","downV"],[Ze.vrows[e].upV,Ze.vrows[e].downV]))}st=!0}}function F(){for(var e=0;e<Ze.answerRanks.length;e++){Ze.answerRanks[e].voteRecordExists=!1;for(var t=0;t<o.cvotes.length;t++)if(o.cvotes[t].catans==Ze.answerRanks[e].catans){Ze.answerRanks[e].uservote=o.cvotes[t],Ze.answerRanks[e].uservote.ansvidx=e,Ze.answerRanks[e].voteRecordExists=!0;break}Ze.answerRanks[e].voteRecordExists?Ze.answerRanks[e].dV=Ze.answerRanks[e].uservote.vote:Ze.answerRanks[e].dV=0,j(Ze.answerRanks[e])}}function Y(){if(o.isLoggedIn)for(var e=0;e<o.cansvrows.length;e++)for(var t=0;t<o.cvrowvotes.length;t++)o.cvrowvotes[t].vrow==o.cansvrows[e].id&&(o.cansvrows[e].voteExists=!0,o.cansvrows[e].dVi=o.cvrowvotes[t].val,o.cansvrows[e].dV=o.cvrowvotes[t].val,o.cansvrows[e].voteid=o.cvrowvotes[t].id,o.cansvrows[e].vidx=t,q(o.cansvrows[e],o.cvrowvotes[t].val));re()}function q(e,t){1==t&&(e.upImage="thumbs_up_blue_table.png",e.downImage="thumbs_down_gray_table.png"),0==t&&(e.dVi=0,e.dV=0,e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_gray_table.png"),-1==t&&(e.dVi=-1,e.dV=-1,e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_blue_table.png")}function z(e){Ze.numEdits=0;for(var t=0;t<o.edits.length;t++)o.edits[t].answer==e&&Ze.numEdits++}function j(e){1==e.dV&&(e.thumbUp="#0070c0",e.thumbDn="grey"),0==e.dV&&(e.thumbUp="grey",e.thumbDn="grey"),-1==e.dV&&(e.thumbUp="grey",e.thumbDn="#0070c0")}function W(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=1,e.upV++,e.downV--;break;case 0:e.dV=1,e.upV++;break;case 1:e.dV=0,e.upV--}j(e),o.DEBUG_MODE&&console.log("UpVote")}function H(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=0,e.downV--;break;case 0:e.dV=-1,e.downV++;break;case 1:e.dV=-1,e.upV--,e.downV++}j(e),o.DEBUG_MODE&&console.log("DownVote")}function K(){o.DEBUG_MODE&&console.log("goBack"),"match"==o.previousState?n.go("match"):o.inFavMode?n.go("favs"):o.cCategory?(o.cCategory.title.indexOf("@")>-1&&(o.isCustomRank=!0),n.go("rankSummary",{index:o.cCategory.id})):Ke()}function J(e){o.title=e.title,n.go("rankSummary",{index:e.id})}function Q(){console.log("Delete Answer"),s.deleteType(function(){u.deleteRecordsbyCatans(o.cCategory.id,Ze.answer.id),p.deleteRec(Ze.answer.id,o.cCategory.id).then(function(){Ze.addctsactive=!1,ne(),Ze.dispRanks--})},function(){a.deleteAnswer(Ze.answer.id),u.deleteRecordsbyAnswer(Ze.answer.id),g.deleteEditbyAnswer(Ze.answer.id),m.deleteEditVotesbyAnswer(Ze.answer.id),p.deleteAnswer(Ze.answer.id),x.deleteVrowByAnswer(Ze.answer.id),n.go("rankSummary",{index:o.cCategory.id})})}function Z(e){var t=Ze.answer.name,n=o.content.map(function(e){return e.id}).indexOf(e.id),a=o.content[n].title;s.deleteThisCatans(t,a,function(){u.deleteRecordsbyCatans(e.id,Ze.answer.id),p.deleteRec(Ze.answer.id,e.id).then(function(){Ze.addctsactive=!1,ne(),Ze.dispRanks--})})}function ee(t){if(o.isLoggedIn)return o.DEBUG_MODE&&console.log("Answer Flagged"),e.flagAnswer("answer",Ze.answer.id,t),void s.getDialog("answerFlagged");s.loginFacebook()}function te(t){if(o.isLoggedIn)return o.DEBUG_MODE&&console.log("Answer Comment Flagged"),e.flagAnswer("comment-answer",Ze.answer.id,t),void s.getDialog("commentFlagged");s.loginFacebook()}function ne(){Ze.answerRanks=[];for(var e={},t=0;t<o.catansrecs.length;t++)if(o.catansrecs[t].answer==Ze.answer.id)for(var n=0;n<o.content.length;n++)o.content[n].id==o.catansrecs[t].category&&(e={},e=o.content[n],e.upV=o.catansrecs[t].upV,e.downV=o.catansrecs[t].downV,e.catans=o.catansrecs[t].id,e.rank=o.catansrecs[t].rank,e.uservote={},e.upVi=o.catansrecs[t].upV,e.downVi=o.catansrecs[t].downV,1==e.rank?e.icon="/assets/images/gold.png":2==e.rank?e.icon="/assets/images/silver.png":3==e.rank?e.icon="/assets/images/bronze.png":e.rank>3&&e.rank<11?e.icon="/assets/images/top10.png":e.rank>=11&&e.rank<21?e.icon="/assets/images/top20.png":e.rank>=21&&e.rank<51?e.icon="/assets/images/top50.png":e.rank>=51&&e.rank<101?e.icon="/assets/images/top100.png":e.icon="/assets/images/blank.png",Ze.answerRanks.push(e));Ze.otherRanksExist=!0,F()}function ae(e){var t=0;t=!Ze.answer.ispremium&&Ze.userIsOwner?1:e,Ze.specialsList=[];for(var n=0;n<o.specials.length;n++)o.specials[n].answer==t&&Ze.specialsList.push(o.specials[n])}function se(e){s.showSpecial(e)}function oe(e){e.showimage?e.showimage=!1:e.showimage=!0}function ie(e){var t=!1,n={},a=!1;if(void 0==o.cansvrows&&(o.cansvrows=[],a=!0),o.cvrows){for(var s=0;s<o.cvrows.length;s++)if(o.cvrows[s].answer==e){t=!1;for(var i=0;i<o.cansvrows.length;i++)o.cansvrows[i].id==o.cvrows[s].id&&(t=!0);t||(n={},n=o.cvrows[s],n.idx=s,n.voteExists=!1,n.dV=0,n.upVi=o.cvrows[s].upV,n.downVi=o.cvrows[s].downV,n.upImage="thumbs_up_gray_table.png",n.downImage="thumbs_down_gray_table.png",n.delta=n.upV-n.downV,o.isLoggedIn&&n.user==o.user.id&&ot++,o.cansvrows.push(n))}a?Y():Ze.newop="",(ot>=3||!o.isLoggedIn)&&(Ze.addvrowbutton="disabled")}}function re(){Ze.vrows=o.cansvrows}function le(){Ze.maybeRepeatedVrows=[];var e=[],t="",n=Ze.newop,a=!1;n=n.toLowerCase(),n=n.replace(","," "),n=n.replace("!"," ");for(var s=n.split(" "),o=0;o<Ze.vrows.length;o++){a=!1,t=Ze.vrows[o].title,t=t.toLowerCase(),t=t.replace(","," "),t=t.replace("!"," "),e=t.split(" ");for(var i=0;i<e.length;i++){for(var r=0;r<s.length;r++)if(e[i].length>3&&s[r].length>3)if(e[i].length>=s[r].length){if(e[i].indexOf(s[r])>-1){Ze.maybeRepeatedVrows.push(Ze.vrows[o]),a=!0;break}}else if(s[r].indexOf(e[i])>-1){Ze.maybeRepeatedVrows.push(Ze.vrows[o]),a=!0;break}if(a)break}}}function ce(){o.dataAdmin||o.isAdmin||Ze.userIsOwner&&Ze.answer.isprivate?Ze.deleteButton=!0:Ze.deleteButton=!1}function de(){s.url(Ze.answer.imageurl)}function ue(){n.go("cwrapper")}function ge(){K()}function me(){s.bizRegistration(pe)}function pe(){o.isLoggedIn?s.bindAccount(o.user.name,Ze.answer.name,he):s.getDialog("notLoggedInBiz")}function he(){o.DEBUG_MODE&&console.log("Bind business to user account"),a.updateAnswer(Ze.answer.id,["owner"],[o.user.id]).then(fe);var e={};e=Ze.answer,e.username=o.user.first_name+" "+o.user.last_name,e.email=o.user.email,b.adduseraccnt(e).then(function(t){L.newBizCreated({account:t,answer:e}).then(function(e){});for(var n=!1,a=0;a<o.useraccnts.length;a++)""!=o.useraccnts[a].email&&(n=!0);n||o.$emit("showWarning")})}function fe(){Ze.userIsOwner=!0}function ve(){
n.go("specials")}function be(){}function ye(){n.go("answerRanksManager")}function we(){if(Ze.showImageGallery=!0,Ze.igdemo)O.getImages().then(ke);else{o.blobs=[];for(var e=Ze.answer.ig_image_urls.split(";"),t=0;t<e.length;t++)if(""!=e[t]){var n={};n.url=e[t],n.type="Instagram",o.blobs.push(n)}E.getImageList().then(ke)}}function ke(){var e=[];Ze.specialsList&&(e=Ze.specialsList.map(function(e){return e.image})),o.blobs=o.blobs.filter(function(t){return-1==e.indexOf(t.url)}),Ze.igdemo?Ze.images=o.igimages:Ze.images=o.blobs,it=Ze.images.length,Ze.i=0,xe()}function xe(){Ze.i+(rt-1)<=it?Ze.e=Ze.i+rt:Ze.e=it,it<=4?(Ze.showFwd=!1,Ze.showRev=!1):(0==Ze.i?Ze.showRev=!1:Ze.showRev=!0,Ze.e==Ze.images.length-1?Ze.showFwd=!1:Ze.showFwd=!0),Ze.e>=it-1&&(Ze.showFwd=!1)}function Re(){Ze.showFwd&&(Ze.i=Ze.i+rt,xe())}function Ae(){Ze.showRev&&(Ze.i=Ze.i-rt,xe())}function Ee(e){n.go("rankSummary",{index:e.slug})}function Oe(e){o.oCategory=o.cCategory,o.oAnswer=Ze.answer,o.isCustomRank=!0,n.go("rankSummary",{index:e.id})}function Se(){var e=at.length,t=at.map(function(e){return e.id}).indexOf(Ze.answer.id),a=t-1;a<0&&(a=e-1),o.isLoggedIn&&V(),n.go("answerDetail",{index:at[a].id})}function De(){var e=at.length,t=at.map(function(e){return e.id}).indexOf(Ze.answer.id),a=t+1;a>e-1&&(a=0),o.isLoggedIn&&V(),n.go("answerDetail",{index:at[a].id})}function Ce(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=1,e.upV++,e.downV--;break;case 0:e.dV=1,e.upV++;break;case 1:e.dV=0,e.upV--}e.delta=e.upV-e.downV,Pe(e),o.DEBUG_MODE&&console.log("VRow UpVote")}function Ie(e){if(!o.isLoggedIn)return void s.loginFacebook();switch(e.dV){case-1:e.dV=0,e.downV--;break;case 0:e.dV=-1,e.downV++;break;case 1:e.dV=-1,e.upV--,e.downV++}e.delta=e.upV-e.downV,Pe(e),o.DEBUG_MODE&&console.log("DownVote")}function Pe(e){1==e.dV&&(e.upImage="thumbs_up_blue_table.png",e.downImage="thumbs_down_gray_table.png"),0==e.dV&&(e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_gray_table.png"),-1==e.dV&&(e.upImage="thumbs_up_gray_table.png",e.downImage="thumbs_down_blue_table.png")}function Te(){f.loadComments("answer",lt).then(function(){P.all(lt.comments.map(function(e){return T.getFBUserById(e.user)})).then(function(e){for(var t=0;t<lt.comments.length;t++)lt.comments[t].picture=e[t]?e[t].picture.data.url:null})})}function Me(){f.postComment("answer",lt)}function Le(e,t){e.bc=t.bc,e.fc=t.fc,e.freq=t.freq,e.edate=t.edate,e.sdate=t.sdate,e.etime=t.etime,e.etime2=t.etime2,e.stime=t.stime,e.stime2=t.stime2,e.mon=t.mon,e.tue=t.tue,e.wed=t.wed,e.thu=t.thu,e.fri=t.fri,e.sat=t.sat,e.sun=t.sun}function Ne(e){s.seePhotos(Ze.images,e,Ze.answer,Ze.userIsOwner)}function _e(e){var t="",n=-1,a=!1,s=-1,i=-1;t=Ze.addctsval;for(var l=0;l<o.content.length;l++)if(o.content[l].title==t){a=!0,n=r.id;break}if(a)console.log("rank found, posting record"),p.postRec2(Ze.answer.id,n).then(function(){Ze.addctsactive=!1,ne(),Ze.dispRanks++});else{console.log("rank not found, will create ghost"),t.indexOf(Ze.answer.cityarea)>-1&&(t=t.replace(Ze.answer.cityarea,"@Nh"),console.log("category title - ",t));for(var l=0;l<o.categories.length;l++)if(o.categories[l].category==t){s=o.categories[l].id;break}for(var l=0;l<o.locations.length;l++)if(o.locations[l].nh_name==Ze.answer.cityarea){i=o.locations[l].id;break}if(s>-1&&i>-1){var c={};c.cat=s,c.nh=i,c.isatomic=!0,D.addTable(c).then(function(e){p.postRec2(Ze.answer.id,e).then(function(){Ze.addctsactive=!1,ne(),Ze.dispRanks++})})}else console.log("Error creating ghost rank, cat, nh ",s,i)}}function $e(e){Ze.addctsopts=[];for(var t="",n=0;n<o.ctsOptions.length;n++)o.ctsOptions[n].indexOf("@Nh")>-1?(t=o.ctsOptions[n].replace("@Nh",Ze.answer.cityarea),Ze.addctsopts.push(t)):Ze.addctsopts.push(o.ctsOptions[n]);Ze.addctsactive=!0}function Be(){Ze.votemode=!0,Ze.voteonstyle="background-color:#3277b3;color:#e6e6e6",Ze.voteoffstyle="background-color:#e6e6e6;color:black"}function Ue(){Ze.votemode=!1,Ze.voteoffstyle="background-color:#3277b3;color:#e6e6e6",Ze.voteonstyle="background-color:#e6e6e6;color:black"}function Xe(){s.endorse(Ze.type),o.endorseDialogShown=!0}function Ge(){ot<3&&o.isLoggedIn?(le(),Ze.maybeRepeatedVrows.length>0?s.maybeRepeatVrows(Ze.newop,Ze.maybeRepeatedVrows,Ve):Ve()):o.isLoggedIn?s.getDialog("opinionsLimit"):s.loginFacebook()}function Ve(){x.postRec(Ze.newop).then(function(){ie(o.canswer.id)})}function Fe(){null==M.access_token()?M.login():M.getMyRecentImages().then(function(e){s.chooseImgFromIgDlg(e,Ze.answer,Ze.userIsOwner,Ze.navigateTowards)}).catch(function(e){console.log(e)}),o.$on("instagramLoggedIn",function(e,t){M.getMyRecentImages().then(function(e){s.chooseImgFromIgDlg(e,Ze.answer,Ze.userIsOwner,Ze.navigateTowards)}).catch(function(e){console.log(e)})})}function Ye(e){"next"==e?M.getNextPage().then(function(e){s.chooseImgFromIgDlg(e,Ze.answer,Ze.userIsOwner,Ze.navigateTowards)}).catch(function(e){console.log(e)}):"previous"==e&&M.getPreviousPage().then(function(e){s.chooseImgFromIgDlg(e,Ze.answer,Ze.userIsOwner,Ze.navigateTowards)}).catch(function(e){console.log(e)})}function qe(){Ze.dispRanks<=3?Ze.dispRanks=Ze.answerRanks.length:Ze.dispRanks=3}function ze(){Ze.hideCustomRanksMsg=!0,o.hideCustomRankMsg=!0}function je(){Ze.hideGetPremiumMsg=!0,o.hideGetPremiumMsg=!0}function We(){n.go("mybusiness")}function He(){for(var e=Ze.answer.family.split(":").map(Number),t=[],n=0,a=0;a<e.length;a++)n=o.answers.map(function(e){return e.id}).indexOf(e[a]),t.push(o.answers[n]);s.showLocations(t)}function Ke(){V(),"trends"==o.previousState?n.go("trends"):o.$emit("backToResults")}function Je(){Ze.linkurl=C+"answer"+Ze.answer.id+".html",Ze.tweet=Ze.answer.name+", endorse your favorite ones at: ";var e=Ze.answer.imageurl;s.shareOptions(Qe,Ze.isMobile,Ze.linkurl,"Rank-X, "+Ze.answer.name+"\n"+e,S)}function Qe(e){var t=Ze.answer.imageurl;switch(e){case"twitter":o.DEBUG_MODE&&console.log(e),N.share({provider:"twitter",attrs:{socialshareUrl:Ze.linkurl,socialshareText:Ze.tweet,socialshareHashtags:"rankxsandiego"}});break;case"facebook":o.DEBUG_MODE&&console.log(e),FB.ui({method:"feed",name:Ze.answer.name,link:Ze.linkurl,picture:t,caption:"Rank-X San Diego",description:"",message:""});break;case"email":o.DEBUG_MODE&&console.log(e),N.share({provider:"email",attrs:{socialshareSubject:"Rank-X, "+Ze.answer.name,socialshareBody:Ze.linkurl}});break;case"gplus":o.DEBUG_MODE&&console.log(e),N.share({provider:"google",attrs:{socialshareUrl:Ze.linkurl,socialshareText:Ze.answer.name,socialshareMedia:t}});break;case"pinterest":o.DEBUG_MODE&&console.log(e),N.share({provider:"pinterest",attrs:{socialshareUrl:Ze.linkurl,socialshareText:"Rank-X, "+Ze.answer.name,socialshareMedia:t}});break;case"tumblr":o.DEBUG_MODE&&console.log(e),N.share({provider:"tumblr",attrs:{socialshareUrl:Ze.linkurl,socialshareText:"Rank-X, "+Ze.answer.name,socialshareMedia:t}});break;case"reddit":o.DEBUG_MODE&&console.log(e),N.share({provider:"reddit",attrs:{socialshareUrl:Ze.linkurl,socialshareText:"Rank-X, "+Ze.answer.name,socialshareSubreddit:""}})}}var Ze=this;Ze.title="answerDetail";var et=!1,tt=0,nt=0,at=[],st=!1,ot=0;Ze.numEdits=0;var it=0,rt=0;Ze.relativetable=[],Ze.catans=[],Ze.sm=o.sm,Ze.votemode=!1,Ze.dispRanks=3,Ze.UpVote=W,Ze.DownVote=H,Ze.refresh=G,Ze.goBack=K,Ze.goPrev=Se,Ze.goNext=De,Ze.deleteAnswer=Q,Ze.flagAnswer=ee,Ze.deleteButton=!1,Ze.showUrl=de,Ze.closeRank=ue,Ze.closeAnswerDetail=ge,Ze.rankSel=J,Ze.bizRegDialog=me,Ze.openSpecials=ve,Ze.editVRows=be,Ze.getImages=we,Ze.showsimage=oe,Ze.gotoRank=Ee,Ze.vrowVoteUp=Ce,Ze.vrowVoteDown=Ie,Ze.loadComments=Te,Ze.postComment=Me,Ze.selectPhoto=Ne,Ze.cmFlag=te,Ze.deleteThisCatans=Z,Ze.addRankforAnswer=ye,Ze.votemodeON=Be,Ze.votemodeOFF=Ue,Ze.user=o.user,Ze.endorseDialog=Xe,Ze.selectInstagramImages=Fe,Ze.showRanks=qe,Ze.hideCustomRanks=ze,Ze.hideGetPremium=je,Ze.gotoMyBusiness=We,Ze.share=Je,Ze.addvrow=Ge,Ze.moreImagesRev=Ae,Ze.moreImagesFwd=Re,Ze.showSpecial=se,Ze.showLocations=He,Ze.navigateTowards=Ye,Ze.gotoCustomRank=Oe,Ze.backToResults=Ke,Ze.addCatans=$e,Ze.addctsactive=!1,Ze.addcts=_e;var lt={};lt.commLoaded=!1,lt.initials="",lt.bc="",lt.fc="",lt.comments=[],lt.newComment="",Ze.cm=lt,Ze.commentAllowed=!0,Ze.searchActive=o.searchActive;var ct=!1;Ze.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(Ze.isMobile=!0);var dt=o.$on("$stateChangeStart",function(e,t,n,a,s){"answerDetail"==a.name&&"answerDetail"!=t.name&&!st&&o.isLoggedIn&&ct&&V()}),ut=o.$on("refreshImages",function(){"answerDetail"==n.current.name&&we()}),gt=o.$on("fileUploaded",function(){"answerDetail"==n.current.name&&we()}),mt=o.$on("answerDataLoaded",function(){Ze.dataReady=!0,_()});S.$on("$destroy",ut),S.$on("$destroy",gt),S.$on("$destroy",mt),S.$on("$destroy",dt),o.answerDetailLoaded?(Ze.dataReady=!0,_()):Ze.dataReady=!1,Ze.hideCustomRanksMsg=void 0!=o.hideCustomRankMsg&&o.hideCustomRankMsg,Ze.hideGetPremiumMsg=void 0!=o.hideGetPremiumMsg&&o.hideGetPremiumMsg,window.prerenderReady=!1}angular.module("app").controller("answerDetail",e),e.$inject=["flag","$stateParams","$state","answer","dialog","$rootScope","$window","useractivity","htmlops","votes","matchrec","edit","editvote","catans","datetime","commentops","userdata","useraccnt","dataloader","$timeout","$location","vrows","vrowvotes","imagelist","instagram","$scope","table","SERVER_URL","$cookies","$q","fbusers","InstagramService","mailing","Socialshare"]}(),function(){"use strict";function e(t,n,a,s,o,i,r,l,c,d,u,g,m){function p(){s.cCategory.title.indexOf("San Diego")>-1&&(J=!0),s.cCategory.title.indexOf("Downtown")>-1&&(K=!0);for(var e=0;e<s.districts.length;e++)s.cCategory.title.indexOf(s.districts[e])>-1&&(W=!0,H=s.districts[e])}function h(){j.name=G.ev.name,j.location=G.ev.location,j.addinfo=G.ev.addinfo,j.cityarea=G.ev.cityarea,j.website=G.ev.website,j.eventloc=G.ev.eventloc}function f(){V=!0,G.ev.name.length<3&&(V=!1),F=V&&(G.numLinks>0||G.ngi)}function v(){n.go("rankSummary",{index:s.cCategory.id})}function b(){var e=[];if(h(),f(),!V)return void t.getDialog("missingDataImage");var n={};n.field="name",n.val=G.ev.name,n.cval=G.ev.name,e.push(n),r.getImageLinks(e,z,"add").then(k,y)}function y(){console.log("query failed, dont give up")}function w(){if(h(),f(),!F)return void t.getDialog("missingDataAnswer");e()}function k(e){for(var t=!1,n=0;n<e.length;n++){for(var a=0;a<q.length;a++)if(0==e[n].localeCompare(q[a])){t=!0;break}t||q.push(e[n])}G.numLinks=q.length,z++,(G.numLinks>10||z>=4)&&(G.searchDisabled="disabled"),z>1&&(G.imageCommand="Get more images"),G.linkIdx=0,G.imageURL=q[G.linkIdx],D(q[G.linkIdx],C),G.numLinks>0&&(G.imagefunctions="inline")}function x(){G.linkIdx++,G.linkIdx>=G.numLinks&&(G.linkIdx=0),G.imageURL=q[G.linkIdx],D(q[G.linkIdx],C)}function R(){G.linkIdx--,G.linkIdx<0&&(G.linkIdx=G.numLinks-1),G.imageURL=q[G.linkIdx],D(q[G.linkIdx],C)}function A(e){var t={};t.bc=e.bc,t.fc=e.fc,t.freq=e.freq,t.edate=e.edate,t.sdate=e.sdate,t.etime=e.etime,t.etime2=e.etime2,t.stime=e.stime,t.stime2=e.stime2,t.mon=e.mon,t.tue=e.tue,t.wed=e.wed,t.thu=e.thu,t.fri=e.fri,t.sat=e.sat,t.sun=e.sun;var n=JSON.stringify(t),o={};o.name=e.name,o.addinfo=e.addinfo,o.cityarea=e.cityarea,o.location=e.location,o.eventloc=e.eventloc,o.eventlocid=e.eventlocid,o.lat=e.lat,o.lng=e.lng,o.type="Event",o.website=e.website,o.phone=e.phone,o.imageurl=e.imageurl,o.views=0,o.eventstr=n,o.userid=s.user.id,o.ig_image_urls="",o.slug="",G.bind&&(o.owner=s.user.id),console.log("ansObj - ",o),L(),Z&&!J?a.addAnswer2(o,[s.cCategory.id,Q]).then(v):Z&&J?a.addAnswer2(o,[Q]).then(v):a.addAnswer(o,[s.cCategory]).then(v)}function E(){console.log("updateEventComfirmed");var e={};e.bc=j.bc,e.fc=j.fc,e.freq=j.freq,e.edate=j.edate,e.sdate=j.sdate,e.etime=j.etime,e.etime2=j.etime2,e.stime=j.stime,e.stime2=j.stime2,e.mon=j.mon,e.tue=j.tue,e.wed=j.wed,e.thu=j.thu,e.fri=j.fri,e.sat=j.sat,e.sun=j.sun;var t=JSON.stringify(e);G.bind||(G.ev.owner=0);var o=[],i=[];s.canswer.name!=G.ev.name&&(o.push("name"),i.push(G.ev.name)),s.canswer.addinfo!=G.ev.addinfo&&(o.push("addinfo"),i.push(G.ev.addinfo)),s.canswer.cityarea!=G.ev.cityarea&&(o.push("cityarea"),i.push(G.ev.cityarea),Y=!0),s.canswer.location!=G.ev.location&&(o.push("location"),i.push(G.ev.location)),s.canswer.website!=G.ev.website&&(o.push("website"),i.push(G.ev.website)),s.canswer.phone!=G.ev.phone&&(o.push("phone"),i.push(G.ev.phone)),s.canswer.imageurl!=G.imageURL&&(o.push("image"),i.push(G.imageURL)),s.canswer.eventstr!=t&&(o.push("eventstr"),i.push(t)),s.canswer.owner!=G.ev.owner&&(o.push("owner"),i.push(G.ev.owner)),s.canswer.eventloc!=G.ev.eventloc&&(o.push("eventloc"),i.push(G.ev.eventloc)),s.canswer.eventlocid!=G.ev.eventlocid&&(o.push("eventlocid"),i.push(G.ev.eventlocid)),s.canswer.lat!=G.ev.lat&&(o.push("lat"),i.push(G.ev.lat)),s.canswer.lng!=G.ev.lng&&(o.push("lng"),i.push(G.ev.lng)),s.DEBUG_MODE&&console.log("fields - ",o),s.DEBUG_MODE&&console.log("vals - ",i),Y&&O(),a.updateAnswer(G.ev.id,o,i).then(function(){n.go("answerDetail",{index:G.ev.id})})}function O(){for(var e=0,t={},n="",a=[],o=[],i=0;i<s.catansrecs.length;i++)if(s.catansrecs[i].answer==G.ev.id&&(e=s.content.map(function(e){return e.id}).indexOf(s.catansrecs[i].category),t=s.content[e],t.title.indexOf(s.canswer.cityarea)>-1)){n=t.title.replace(s.canswer.cityarea,G.ev.cityarea);for(var r=0;r<s.content.length;r++)if(s.content[r].title==n){a.push(s.catansrecs[i].id),o.push(s.content[r].id);break}}for(var i=0;i<a.length;i++)l.updateRec(a[i],["category"],[o[i]])}function S(){t.howItWorks("addEvent")}function D(e,t,n){n=n||5e3;var a,s=!1,o=new Image;o.onerror=o.onabort=function(){s||(clearTimeout(a),t(e,"error"))},o.onload=function(){s||(clearTimeout(a),t(e,"success"))},o.src=e,a=setTimeout(function(){s=!0,t(e,"timeout")},n)}function C(e,t){"error"!=t&&"timeout"!=t||(G.imageURL=s.EMPTY_IMAGE)}function I(e){G.imageURL=e?s.EMPTY_IMAGE:q[G.linkIdx]}function P(){G.char=45-G.ev.name.length}function T(e){1==e&&(G.weekly=!1,G.onetime=!0,G.ev.freq="onetime"),2==e&&(G.weekly=!0,G.onetime=!1,G.ev.freq="weekly")}function M(){j=G.ev,j.imageurl=G.imageURL,j.date=j.sdate,"add"==s.eventmode?t.createEventPreview(j,"add",A):t.createEventPreview(j,"edit",E)}function L(){var e="";if(K||W||J){if(K&&"Downtown"!=j.cityarea){e=s.cCategory.title.replace("Downtown",G.ev.cityarea);for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(Z=!0,Q=s.content[t].id)}if(W){e=s.cCategory.title.replace(H,"Downtown");for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(Z=!0,Q=s.content[t].id)}if(J){e=s.cCategory.title.replace("San Diego",G.ev.cityarea);for(var t=0;t<s.content.length;t++)s.content[t].title==e&&(Z=!0,Q=s.content[t].id)}}}function N(){if(te=[],Math.abs(G.ev.eventloc.length-ee)>2&&0!=G.ev.eventloc.length){ee=G.ev.eventloc.length;for(var e=0;e<s.answers.length;e++)s.answers[e].name==G.ev.eventloc&&te.push(s.answers[e]);1==te.length?t.confirmSameAnswer(te[0],_):te.length>1&&t.confirmSameAnswerMultiple(maybeSameAnswers,_)}ee=G.ev.eventloc.length}function _(e){var t=0;void 0!=e&&(t=e),console.log("n ",te[t],t);for(var n=0;n<s.answers.length;n++)s.answers[n].name==te[t].name&&(G.ev.location=s.answers[n].location,G.ev.cityarea=s.answers[n].cityarea,G.ev.eventloc=s.answers[n].name,G.ev.eventlocid=s.answers[n].id,G.ev.phone=s.answers[n].phone,G.ev.website=s.answers[n].website,G.ev.lat=s.answers[n].lat,G.ev.lng=s.answers[n].lng,m.$apply())}function $(){event.deleteEvent(j.id),n.go("specials")}function B(){"edit"==s.eventmode&&n.go("answerDetail",{index:s.canswer.slug}),"add"==s.eventmode&&n.go("rankSummary",{index:s.cCategory.slug})}function U(){G.timeDD=["7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM","12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM"]}function X(){n.go("cwrapper")}var G=this;G.title="addEvent",G.searchDisabled="disabled",G.modalEnable=!0,G.publicfields=[];var V=!1,F=!1,Y=(s.events,!1),q=[];G.linkIdx=0,G.numLinks=0,G.imageCommand="Get images",G.searchDisabled="";var z=1;G.imagefunctions="none",G.ev={};var j={},W=!1,H="",K=!1,J=!1,Q=0,Z=!1,ee=0,te=[];G.calladdEvent=w,G.rankSummary=v,G.callSearchImage=b,G.viewNext=x,G.viewPrev=R,G.closeRank=X,G.onNoGoodImages=I,G.showHowItWorksDialog=S,G.displayCharLength=P,G.frequencySel=T,G.showPreview=M,G.deleteSpecial=$,G.onSelect=N,G.goBack=B,G.imageURL=s.EMPTY_IMAGE,G.header=s.header,g.innerWidth<512?(G.sm=!0,G.nsm=!1):(G.sm=!1,G.nsm=!0),function(){G.locations=s.estNames.concat(s.plaNames),G.neighborhoods=s.neighborhoods.concat(s.districts),"edit"==s.eventmode&&(G.ev=JSON.parse(JSON.stringify(s.canswer)),0!=G.ev.owner&&void 0!=G.ev.owner?G.bind=!0:G.bind=!1,i.formatdatetime(G.ev),G.isEdit=!0,"onetime"==G.ev.freq&&T(1),"weekly"==G.ev.freq&&T(2),s.DEBUG_MODE&&console.log("vm.ev --- ",G.ev),G.imageURL=G.ev.imageurl),"add"==s.eventmode&&(p(),G.char=45,G.ev.fc="hsl(0, 100%, 0%)",G.ev.bc="hsl(0, 0%, 100%)",G.ev.eventlocid=-1,T(1)),U(),console.log("Add Event Activated!")}()}angular.module("app").controller("addEvent",e),e.$inject=["dialog","$state","answer","$rootScope","$modal","datetime","image","catans","getgps","$timeout","getwiki","$window","$scope"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h){function f(){a.cCategory.isatomic||(le=!0)}function v(){K.emptyarray=[],K.neighborhoods=a.neighborhoods.concat(a.districts),K.establishmentNames=a.estNames.concat(a.plaNames,a.orgNames,a.freNames),K.peopleNames=a.pplNames,K.fields=a.fields,K.type=a.cCategory.type,ve.type=K.type,K.fields.opts=[],K.fields.val=[],K.fields.textstyle=[];for(var e=0;e<K.fields.length;e++)K.fields[e].val="","cityarea"==K.fields[e].name?K.fields[e].opts="c for c in vm.neighborhoods":K.fields[e].opts="c for c in vm.emptyarray","name"==K.fields[e].name&&"Establishment"==a.cCategory.type&&(K.fields[e].opts="c for c in vm.establishmentNames"),"name"==K.fields[e].name&&"Person"==a.cCategory.type&&(K.fields[e].opts="c for c in vm.peopleNames"),"name"==K.fields[e].name&&"Place"==a.cCategory.type&&(K.fields[e].opts="c for c in vm.establishmentNames"),"name"==K.fields[e].name&&"Organization"==a.cCategory.type&&(K.fields[e].opts="c for c in vm.establishmentNames"),"name"==K.fields[e].name&&"PersonCust"==a.cCategory.type&&(K.fields[e].opts="c for c in vm.establishmentNames"),"cityarea"==K.fields[e].name&&"Establishment"==a.cCategory.type&&1==a.NhImplied&&"Downtown"!=a.NhValue&&(K.fields[e].val=a.NhValue),"addinfo"==K.fields[e].name?K.fields[e].textstyle="textarea":K.fields[e].textstyle="text"}function b(){Z||(ve.imageurl=K.imageURL,"Short-Phrase"==a.cCategory.type&&(ve.imageurl="none"),ve.upV=0,ve.downV=0,ve.type=K.type,ve.userid=a.user.id,ve.views=0,ve.ig_image_urls="",ve.slug="",K.userIsOwner&&(ve.owner=a.user.id),ie?e.checkSameAnswer(ve,be,C,P):e.addAnswer(ve,K.addToRanks,K.imageURL,C),Z=!0,u(function(){Z=!1},1e3))}function y(){for(var e=0;e<K.fields.length;e++)switch(K.fields[e].name){case"name":ve.name=K.fields[e].val;break;case"location":ve.location=K.fields[e].val;break;case"addinfo":ve.addinfo=K.fields[e].val;break;case"cityarea":ve.cityarea=K.fields[e].val;break;case"phone":ve.phone=K.fields[e].val;break;case"website":ve.website=K.fields[e].val;break;case"email":ve.email=K.fields[e].val}}function w(){J=!0;for(var e=0;e<K.fields.length;e++)if(K.fields[e].isrequired&&K.fields[e].val.length<3){J=!1;break}if("PersonCust"==a.cCategory.type)for(var e=0;e<K.fields.length;e++)if("email"==K.fields[e].name&&K.fields[e].val.length>3||"website"==K.fields[e].name&&K.fields[e].val.length>3){J=!0;break}Q="Short-Phrase"==a.cCategory.type||"PersonCust"==a.cCategory.type||"Simple"==a.cCategory.type?J:J&&(K.numLinks>0||K.ngi)}function k(){t.go("rankSummary",{index:a.cCategory.id})}function x(){var t=[];if(y(),w(),!J)return void e.getDialog("missingDataImage");t=JSON.parse(JSON.stringify(K.fields)),l.getImageLinks(t,oe,"add").then(E,R)}function R(){console.log("query failed, dont give up")}function A(){if(y(),w(),"Establishment"!=K.type&&"Person"!=K.type&&"Place"!=K.type||G(ve),!Q)return void e.getDialog("missingDataAnswer");b()}function E(e){for(var t=!1,n=0;n<e.length;n++){for(var a=0;a<se.length;a++)if(0==e[n].localeCompare(se[a])){t=!0;break}t||se.push(e[n])}K.numLinks=se.length,oe++,(K.numLinks>10||oe>=4)&&(K.searchDisabled="disabled"),oe>1&&(K.imageCommand="Get more images"),K.linkIdx=0,K.imageURL=se[K.linkIdx],U(se[K.linkIdx],X),K.numLinks>0&&(K.imagefunctions="inline")}function O(){K.linkIdx++,K.linkIdx>=K.numLinks&&(K.linkIdx=0),K.imageURL=se[K.linkIdx],U(se[K.linkIdx],X)}function S(){K.linkIdx--,K.linkIdx<0&&(K.linkIdx=K.numLinks-1),K.imageURL=se[K.linkIdx],U(se[K.linkIdx],X)}function D(e){var t=!0,n=K.fields.map(function(e){return e.name}).indexOf("cityarea");if(ge&&n>-1){if(ge!=e.cityarea){var s=[];i.getInclusiveAreas(he.id,s);var o=a.locations.map(function(e){return e.nh_name}).indexOf(e.cityarea),r=s.indexOf(a.locations[o].id)>-1;t=!!r,1==he.id&&(t=!0)}}else t=!0;return t}function C(t){if(a.DEBUG_MODE&&console.log("No, different! @addAnswerConfirmed"),D(t))if(void 0!=t.location&&""!=t.location&&null!=t.location){var s=d.getLocationGPS(t);s.then(function(){})}else if(T(),ue)le?(a.DEBUG_MODE&&console.log("P2 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de,t),n.addAnswer2(t,[de]).then(k)):(a.DEBUG_MODE&&console.log("P1 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de,t),n.addAnswer2(t,[a.cCategory.id,de]).then(k));else{if(ce)console.log("Need to create record");else{a.DEBUG_MODE&&console.log("P3 - ",t);for(var o=[],i=!1,l=0;l<K.addToRanks.length;l++)K.addToRanks[l].sel&&o.push(K.addToRanks[l]),K.addToRanks[l].isghost&&(i=!0);i?(console.log("X1 - ",o,t),r.ghostTablesWithAnswer(o,t).then(function(){u(function(){k()},1e3)})):n.addAnswer(t,o).then(k)}t=void 0}else e.getDialog("neighborhoodsDontMatch")}function I(){if(!ee)if(a.DEBUG_MODE&&console.log("@exec-addAnswerGPS"),ee=!0,T(),ue)le?(a.DEBUG_MODE&&console.log("P5 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de,ve),ve&&n.addAnswer2(ve,[de]).then(k)):(a.DEBUG_MODE&&console.log("P4 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de,ve),ve&&n.addAnswer2(ve,[a.cCategory.id,de]).then(k));else{if(ce)console.log("Need to Create Record");else if(a.DEBUG_MODE&&console.log("P6",ve),ve){for(var e=[],t=!1,s=0;s<K.addToRanks.length;s++)K.addToRanks[s].sel&&e.push(K.addToRanks[s]),K.addToRanks[s].isghost&&(t=!0);t?(console.log("X2 - ",e,ve),r.ghostTablesWithAnswer(e,ve).then(function(){u(function(){k()},1e3)})):n.addAnswer(ve,e).then(k)}ve=void 0}}function P(){a.DEBUG_MODE&&console.log("Yeah Same, @answerIsSame");var t=D(be);if(re)e.getDialog("answerDuplicated");else if(t){if(T(),a.DEBUG_MODE&&console.log("eqFound, hasSubAreas, eqRankIdx = ",ue,le,de),ue)le?(a.DEBUG_MODE&&console.log("P8 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de),c.postRec2(be.id,de).then(k)):(a.DEBUG_MODE&&console.log("P7 - eqFound,hasSubAreas,eqRankIdx - ",ue,le,de),c.postRec2(be.id,de),c.postRec2(be.id,a.cCategory.id).then(k));else if(ce)console.log("Need to create record");else if(a.DEBUG_MODE&&console.log("P9"),a.cCategory.isatomic)c.postRec(be.id).then(k);else{var n=!1,s=a.locations.map(function(e){return e.nh_name}).indexOf(be.cityarea);if(a.content.forEach(function(e){e.nh==a.locations[s].id&&e.cat==a.cCategory.cat&&(n=!0,rankid=e.id)}),n)c.postRec2(be.id,rankid).then(k);else{var o={};o.cat=a.cCategory.cat,o.nh=a.locations[s].id,o.isatomic=!0,r.addTable(o).then(function(e){c.postRec2(be.id,e).then(k)})}}ve=void 0}else e.getDialog("neighborhoodsDontMatch")}function T(){var e="";if(e=void 0==ve.cityarea?be.cityarea?be.cityarea:ge:ve.cityarea,le)for(var t=a.locations.map(function(e){return e.nh_name}).indexOf(e),n=0;n<a.content.length;n++)a.content[n].cat==a.cCategory.cat&&a.content[n].nh==a.locations[t].id&&(ue=!0,de=a.content[n].id)}function M(){"Short-Phrase"==a.cCategory.type?e.howItWorks("shortPhrase"):e.howItWorks("addAnswer")}function L(e,t){e.sel?0!=t&&(e.sel=!1):e.sel=!0,K.addToRanks=K.addToRanks.sort(_)}function N(){if(a.DEBUG_MODE&&console.log("prepareCatansOptions"),fe)console.log("added $rootScope.cCategory - ",a.cCategory),console.log("vm.addRanksEnable - ",K.addRanksEnable),K.addToRanks.push(a.cCategory);else{if(K.addToRanks.length>0){var e=h.sibblingRanks(a.cCategory,me),t=K.addToRanks.map(function(e){return e.id});e.forEach(function(e){t.indexOf(e.id)<0&&K.addToRanks.push(e)})}else K.addToRanks=h.sibblingRanks(a.cCategory,me);0==K.addToRanks.length&&K.addToRanks.push(a.cCategory),K.addToRanks.length>0&&(K.addToRanks[0].sel=!0);for(var n=1;n<K.addToRanks.length;n++)K.addToRanks[n].sel=!1;K.addToRanks=K.addToRanks.sort(_),K.addctsopts=[];for(var s="",n=0;n<a.ctsOptions.length;n++)a.ctsOptions[n].indexOf("@Nh")>-1?me&&(s=a.ctsOptions[n].replace("@Nh",me),K.addctsopts.push(s)):K.addctsopts.push(a.ctsOptions[n])}}function _(e,t){return e.sel==t.sel?t.ctr-e.ctr:t.sel?1:-1}function $(){K.addctsactive=!0}function B(){var t=!1,n={},s=a.content.map(function(e){return e.title}).indexOf(K.addctsval);if(s>-1)"Person"==a.cCategory.type&&"Person"!=a.content[s].type&&(t=!0),"Event"==a.cCategory.type&&"Event"!=a.content[s].type&&(t=!0),"Thing"==a.cCategory.type&&"Thing"!=a.content[s].type&&(t=!0),"PersonCust"==a.cCategory.type&&"PersonCust"!=a.content[s].type&&(t=!0),"Place"!=a.cCategory.type&&"Establishment"!=a.cCategory.type&&"Organization"!=a.cCategory.type||"Place"==a.content[s].type||"Establishment"==a.content[s].type||"Organization"==a.content[s].type||(t=!0),t?e.typemismatch(a.content[s].type,a.cCategory.type):(n=a.content[s],n.sel=!0,K.addToRanks.push(n),K.addToRanks=K.addToRanks.sort(_),K.addctsval="",K.addctsactive=!1);else{var o=a.categories.map(function(e){return e.category}).indexOf(K.addctsval.slice(0,9));if(a.categories[o].category.indexOf("@Nh")>-1){var i=a.locations.map(function(e){return e.nh_name}).indexOf(me),r={};r.cat=a.categories[o].id,r.nh=a.locations[i].id,r.isghost=!0,r.isatomic=!0,r.title=K.addctsval,console.log("added ghost to vm.addToRanks from addcts"),K.addToRanks.push(r)}}}function U(e,t,n){n=n||5e3;var a,s=!1,o=new Image;o.onerror=o.onabort=function(){s||(clearTimeout(a),t(e,"error"))},o.onload=function(){s||(clearTimeout(a),t(e,"success"))},o.src=e,a=setTimeout(function(){s=!0,t(e,"timeout")},n)}function X(e,t){"error"!=t&&"timeout"!=t||(K.imageURL=a.EMPTY_IMAGE)}function G(e){if("Establishment"==K.type||"Place"==K.type||"Organization"==K.type){for(var t=0;t<a.estAnswers.length;t++)if(e.name==a.estAnswers[t].name&&e.cityarea==a.estAnswers[t].cityarea){ie=!0,be=a.estAnswers[t];for(var n=0;n<a.catansrecs.length;n++)a.catansrecs[n].answer==a.estAnswers[t].id&&a.catansrecs[n].category==a.cCategory.id&&(re=!0)}}else if("Person"==K.type){for(var t=0;t<a.pplAnswers.length;t++)if(e.name==a.pplAnswers[t].name){ie=!0,be=a.pplAnswers[t];for(var n=0;n<a.catansrecs.length;n++)a.catansrecs[n].answer==a.pplAnswers[t].id&&a.catansrecs[n].category==a.cCategory.id&&(re=!0)}}else if("Establishment"==K.type||"Place"==K.type||"Organization"==K.type){for(var t=0;t<a.plaAnswers.length;t++)if(e.name==a.plaAnswers[t].name){ie=!0,be=a.plaAnswers[t];for(var n=0;n<a.catansrecs.length;n++)a.catansrecs[n].answer==a.plaAnswers[t].id&&a.catansrecs[n].category==a.cCategory.id&&(re=!0)}}else if("Establishment"==K.type||"Place"==K.type||"Organization"==K.type)for(var t=0;t<a.orgAnswers.length;t++)if(e.name==a.orgAnswers[t].name){ie=!0,be=a.orgAnswers[t];for(var n=0;n<a.catansrecs.length;n++)a.catansrecs[n].answer==a.orgAnswers[t].id&&a.catansrecs[n].category==a.cCategory.id&&(re=!0)}}function V(){for(var e="",t=0;t<K.fields.length;t++)if("name"==K.fields[t].name){e=K.fields[t].val;break}e.length>0&&g.getWiki(e)}function F(e){for(var t=0;t<K.fields.length;t++)if("addinfo"==K.fields[t].name){K.fields[t].val=e;break}}function Y(e){K.imageURL=e?a.EMPTY_IMAGE:se[K.linkIdx]}function q(){t.go("cwrapper")}function z(t){if(ae=[],"name"==t.name){if(Math.abs(t.val.length-te)>=2&&0!=t.val.length){te=t.val.length;for(var n=0;n<a.answers.length;n++)a.answers[n].name==t.val&&(1!=he.id?a.answers[n].cityarea==ge&&ae.push(a.answers[n]):ae.push(a.answers[n]));1==ae.length?(G(ae[0]),e.confirmSameAnswer(ae[0],j)):ae.length>1&&e.confirmSameAnswerMultiple(ae,j)}te=t.val.length}if("cityarea"==t.name){if(Math.abs(t.val.length-ne)>2&&0!=t.val.length){ne=t.val.length;for(var n=0;n<a.allnh.length;n++)a.allnh[n]==t.val&&(K.nhrdy=!0,me=t.val,N())}ne=t.val.length}}function j(e){be=void 0==e?ae[0]:ae[e],P()}function W(){var e=a.locations.map(function(e){return e.id}).indexOf(a.cCategory.nh);e>-1&&(ge=a.locations[e].nh_name,he=a.locations[e],me=ge,a.cCategory.isatomic&&N())}function H(){K.imageURL=a.blobimage}var K=this;K.title="addAnswer",K.header="table"+a.cCategory.id+".header",K.body="table"+a.cCategory.id+".body",K.searchDisabled="disabled",K.modalEnable=!0,K.userIsOwner=!1,K.addRanksEnable=!0,K.publicfields=[],K.ranking=a.cCategory.title;var J=!1,Q=!1,Z=!1,ee=!1,te=(a.answers,0),ne=0,ae=[],se=[];K.linkIdx=0,K.numLinks=0,K.imageCommand="Get images",K.searchDisabled="";var oe=1;K.imagefunctions="none";var ie=!1,re=!1,le=!1,ce=!1,de=0,ue=!1,ge=void 0,me=void 0,pe={},he={},fe=!1,ve={},be={};K.callAddAnswer=A,K.rankSummary=k,K.callSearchImage=x,K.viewNext=O,K.viewPrev=S,K.closeRank=q,K.getWiki=V,K.onNoGoodImages=Y,K.showHowItWorksDialog=M,K.onSelect=z,K.addCatans=$,K.addcts=B,K.selRank=L,K.imageURL=a.EMPTY_IMAGE,K.header=a.header;var ye=a.$on("answerGPSready",function(){"addAnswer"!=t.current.name||ee||I()}),we=a.$on("wikiReady",function(e,n){"addAnswer"==t.current.name&&F(n)}),ke=a.$on("fileUploaded",function(e,n){"addAnswer"==t.current.name&&(a.blobimage=n,H())});p.$on("$destroy",ye),p.$on("$destroy",we),p.$on("$destroy",ke),function(){if(a.isLoggedIn){var e=a.cCategory.owner;if(void 0!=e&&0!=e){var t=a.answers.map(function(e){return e.id}).indexOf(Number(e)),n=a.answers[t].owner
;a.user.id==n&&(K.userIsOwner=!0)}}}(),m.innerWidth<512?(K.sm=!0,K.nsm=!1):(K.sm=!1,K.nsm=!0),function(){void 0!=a.cCategory.owner&&0!=a.cCategory.owner?a.isCustomRank=!0:a.isCustomRank=!1,m.scrollTo(0,0),K.addToRanks=[],W(),v(),f(),void 0!=a.cCategory.owner&&0!=a.cCategory.owner&&(fe=!0,K.addRanksEnable=!1),a.cCategory.isatomic&&(K.nhrdy=!0,N(),pe=a.cCategory,pe.sel=!0),a.DEBUG_MODE&&console.log("Add Answer Activated!")}()}angular.module("app").controller("addAnswer",e),e.$inject=["dialog","$state","answer","$rootScope","$modal","$q","common","table","image","catans","getgps","$timeout","getwiki","$window","$scope","search"]}(),function(){"use strict";function e(e,t,n){function a(){var a=c,s=e.get(a);return t.all([s]).then(function(e){return i(e[0].data.resource),n.DEBUG_MODE&&console.log("User uploaded images: ",l.length),l},r)}function s(t){function a(e){var a=t;return a.id=e.data.resource[0].id,l.push(a),n.DEBUG_MODE&&console.log("created uui record"),n.DEBUG_MODE&&console.log("result",e),e.data}var s=c,o=[];return o.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,r)}function o(t){function a(e){return n.DEBUG_MODE&&console.log("Deleting uui record was succesful"),e.data}var s={};s.resource=[];var o={};o.id=t,s.resource.push(o);var i=c+"/"+t,d=l.map(function(e){return e.id}).indexOf(t);return d>-1&&l.splice(d,1),e.delete(i,o,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,r)}function i(e){l.length=0,e.forEach(function(e){l.push(e)})}function r(e){throw e}var l=[];n.uuis=l;var c="/api/v2/mysql/_table/useruploadedimages";return{getRecords:a,postRecord:s,deleteRecord:o}}angular.module("app").factory("useruploadedimages",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(n){function a(e){return c=e.data.resource}if(r()&&!n)return t.when(c);var s=d;return e.get(s).then(a,l)}function s(t,n){function a(e){console.log("Creating new query record was succesful")}var s={};s.resource=[];var o={};o.query=t,o.results=n,o.timestmp=Date.now(),s.resource.push(o);var i=d;return e.post(i,s,{headers:{"Content-Type":"multipart/form-data"},body:s}).then(a,l)}function o(t){function n(e){console.log("Flushing queries db was succesful")}({}).resource=t,console.log("obj ---",t);var a=d;return e.delete(a,t,{headers:{"Content-Type":"multipart/form-data"},body:t}).then(n,l)}function i(t){function n(e){return console.log("Deleting record was succesful"),e.data}var a={};a.resource=[];var s={};s.id=t,a.resource.push(s);var o=d+"/"+t;return e.delete(o,s,{headers:{"Content-Type":"multipart/form-data"},body:a}).then(n,l)}function r(){return c.length>0}function l(e){throw e}var c=[],d="/api/v2/mysql/_table/queries";return{getQueries:a,postQuery:s,flushAll:o,deleteRec:i}}angular.module("app").factory("query",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(n){function a(e){return i=e.data.resource}if(s()&&!n)return t.when(i);var l=r;return e.get(l).then(a,o)}function s(){return i.length>0}function o(e){throw e}var i=[],r="/api/v2/mysql/_table/codeprice";return{get:a}}angular.module("app").factory("codeprice",e),e.$inject=["$http","$q","$rootScope"]}(),function(){"use strict";function e(e,t,n){function a(t){function a(e){return n.DEBUG_MODE&&console.log("created new category-code paire"),e.data}var s=c,o=[];return o.push(t),l.push(t),e.post(s,o,{headers:{"Content-Type":"multipart/form-data"},body:o}).then(a,r)}function s(n){function a(e){return l=e.data.resource}if(i()&&!n)return t.when(l);var s=c;return e.get(s).then(a,r)}function o(t,a,s){function o(e){return n.DEBUG_MODE&&console.log("updating category code succesful"),e.data}var i={};i.resource=[];var d={};d.id=t;for(var u=0;u<a.length;u++)switch(a[u]){case"category":d.category=s[u]}i.resource.push(d);for(var g=c,m=l.map(function(e){return e.id}).indexOf(t),u=0;u<a.length;u++)switch(a[u]){case"category":l[m].category=s[u]}return e.patch(g,i,{headers:{"Content-Type":"multipart/form-data"},body:i}).then(o,r)}function i(){return l.length>0}function r(e){throw e}var l=[],c="/api/v2/mysql/_table/categorycode";return{get:s,post:a,update:o}}angular.module("app").factory("categorycode",e),e.$inject=["$http","$q","$rootScope"]}(),angular.module("app").directive("notificationBlock",["$rootScope","$state","answer","table","catans","$timeout","vrows","$window","cblock","color","search",function(e,t,n,a,s,o,i,r,l,c,d){"use strict";return{templateUrl:"app/admin/Partials/notification.drtv.html",transclude:!0,scope:{notifications:"="},controller:["$scope",function(e){}],link:function(e){console.log(e.notifications)}}}]),function(){"use strict";function e(e,t,n){var a=this;a.title="views",a.content=t.content,function(){console.log("views page Loaded!")}()}angular.module("app").controller("views",e),e.$inject=["$location","$rootScope","$state"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){if(!p){p=!0;var e="",n=[],a=[];m.res=[];for(var o=!0,i="",r="",c=0;c<t.cblocks.length;c++){i="",r="",o=!0,{},a=[];for(var d=0;d<t.headlines.length;d++)if(t.cblocks[c].type==t.headlines[d].type){"city"==t.cblocks[c].scope&&(e=t.headlines[d].filter+" isMP"),"rx"==t.cblocks[c].scope&&(e=t.headlines[d].filter),"nh"==t.cblocks[c].scope&&(e=t.headlines[d].filter+" "+t.cblocks[c].scopename),n=e.split(" ");break}for(var u="",g=0;g<t.content.length;g++){u=t.content[g].tags+" "+t.content[g].title,o=!0;for(var h=0;h<n.length;h++){var f=n[h].charAt(0).toUpperCase()+n[h].slice(1),v=n[h].charAt(0).toLowerCase()+n[h].slice(1);o=o&&(u.indexOf(n[h])>-1||u.indexOf(n[h].toUpperCase())>-1||u.indexOf(f)>-1||u.indexOf(v)>-1)}o&&a.push(t.content[g].id)}l(a);for(var b=0;b<a.length;b++)i=i+":"+a[b];r=i.substring(1),s.update(t.cblocks[c].id,["catstr"],[r])}}}function r(){for(var e=!1,n=[],a=0;a<t.content.length;a++)t.content[a].title.indexOf("in Hillcrest")>-1&&n.push(t.content[a]);for(var s=0;s<n.length;s++){for(var i="",r="",l=n[s].title.replace("Hillcrest","San Diego"),c=0;c<t.content.length;c++)if(l==t.content[c].title){if(null==t.content[c].catstr||void 0==t.content[c].catstr||0==t.content[c].catstr.length){var d=t.content[c].id;if(473!=d&&3125!=d&&6949!=d&&7424!=d&&7675!=d&&3124!=d&&3163!=d&&3202!=d){console.log("Found gen rank --- ",t.content[c].title," ",t.content[c].id);for(var u=t.content[c].title.replace("San Diego",""),g=0;g<t.content.length;g++)t.content[g].title.indexOf(u)>-1&&g!=c&&(i=i+":"+t.content[g].id);r=i.substring(1),console.log("final catstr ---",r),o.update(t.content[c].id,["isatomic","catstr"],[!1,r])}}break}i="",r="",l=n[s].title.replace("Hillcrest","Downtown");for(var c=0;c<t.content.length;c++)if(l==t.content[c].title){if(null==t.content[c].catstr||void 0==t.content[c].catstr||0==t.content[c].catstr.length){var d=t.content[c].id;if(473!=d&&3125!=d&&6949!=d&&7424!=d&&7675!=d&&3124!=d&&3163!=d&&3202!=d){console.log("Found gen rank --- ",t.content[c].title," ",t.content[c].id);for(var u=t.content[c].title.replace("Downtown",""),g=0;g<t.content.length;g++)if(t.content[g].title.indexOf(u)>-1&&g!=c){e=!1;for(var a=0;a<t.districts.length;a++)t.content[g].title.includes(t.districts[a])&&(e=!0);e&&(i=i+":"+t.content[g].id)}r=i.substring(1),console.log("final catstr ---",r),o.update(t.content[c].id,["isatomic","catstr"],[!1,r])}}break}}}function l(e){for(var t,n,a=e.length;0!==a;)n=Math.floor(Math.random()*a),a-=1,t=e[a],e[a]=e[n],e[n]=t;return e}function c(){if(!h){for(var e=["rankofweek","city","lifestyle","food","politics","services","social","beauty","sports","personalities","technology","dating","health"],t={},n=0;n<e.length;n++)t={},t.scope="city",t.ismp=!0,t.scopename="San Diego",t.catstr="0",t.type=e[n],s.addcblock(t);h=!0}}function d(){if(!v){for(var e=["rankofweeknh","neighborhood","lifestyle","food","services","social","beauty","health"],t={},n=0;n<f.length;n++)for(var a=0;a<e.length;a++)t={},t.scope="nh",t.ismp=!1,t.scopename=f[n],t.catstr="0",t.type=e[a],s.addcblock(t);v=!0}}function u(){if(!b){for(var e=["rxfeedback","rxsuggestion"],t={},n=0;n<e.length;n++)t={},t.scope="rx",t.scopename="RankX",t.ismp=!1,t.catstr="0",t.type=e[n],s.addcblock(t);b=!0}}function g(){for(var e=0;e<t.cblocks.length;e++)s.deleteRec(t.cblocks[e].id)}var m=this;m.title="updateHeaders",m.refresh=i,m.createCBlocksRecsCity=c,m.createCBlocksRecsNh=d,m.createCBlocksRecsRankX=u,m.deleteCBlocks=g,m.catStrings=r,m.isAdmin=t.isAdmin;var p=!1;!function(){console.log("updateHeaders page Loaded!")}();var h=!1,f=t.neighborhoods.concat(t.districts),v=!1,b=!1}angular.module("app").controller("updateHeaders",e),e.$inject=["$location","$rootScope","$state","headline","cblock","table"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(){console.log("query Answer"),p.ansOpts=[];for(var e=0;e<t.answers.length;e++)p.ansOpts.push(t.answers[e].name)}function l(){for(var e=0;e<t.answers.length;e++)p.answername==t.answers[e].name&&(p.answer=t.answers[e]);p.answer.ansLocs=[],p.locations=[],p.answer&&p.answer.family&&(p.answer.ansLocs=p.answer.family.split(":").map(Number)),d(p.answer)}function c(){for(var e=0;e<t.answers.length;e++)if(p.brothername==t.answers[e].name){for(var n=!1,a=0;a<p.answer.ansLocs.length;a++)if(p.answer.ansLocs[a]==t.answers[e].id){n=!0,console.log("flag repeated");break}t.answers[e].id==p.answer.id&&(console.log("flag2"),n=!0),n||(console.log("Added brother"),p.answer.ansLocs.push(t.answers[e].id))}console.log("@ addBrother ---\x3e vm.answer.ansLocs",p.answer.ansLocs),console.log("@ addBrother ---\x3e vm.answer",p.answer),d(),p.brothername=""}function d(){var e=0;if(p.answer.ansLocs){p.locations=[];for(var n=0;n<p.answer.ansLocs.length;n++)e=t.answers.map(function(e){return e.id}).indexOf(p.answer.ansLocs[n]),p.locations.push(t.answers[e])}}function u(e){for(var t=0;t<p.locations.length;t++)p.locations[t].id==e.id&&(p.locations.splice(t,1),p.answer.ansLocs.splice(t,1));d(),console.log("vm.answer ",p.answer)}function g(){o.confirmSiblings(p.answer,m)}function m(){var e=p.answer.ansLocs,t="";e.push(p.answer.id),console.log("bros - ",e);for(var n=0;n<e.length;n++){t="";for(var a=0;a<e.length;a++)n!=a&&(t=t+":"+e[a]);t=t.substring(1),i.updateAnswer(e[n],["family"],[t]),console.log("updated answer ",e[n]," brothers: ",t)}p.answer=void 0,p.locations=void 0,p.brothername="",p.answername=""}var p=this;p.title="sibLocs",p.selAns=l,p.addBrother=c,p.remAns=u,p.confirm=g,function(){r(),console.log("sibLocs page Loaded!")}()}angular.module("app").controller("sibLocs",e),e.$inject=["$location","$rootScope","$state","catans","$http","dialog","answer"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d){function u(){function e(e){return e}var n=new Date,a=n.getTimezoneOffset();n.setMinutes(n.getMinutes()-a);var s=e(n.getMonth()+1)+"/"+e(n.getDate())+"/"+n.getFullYear();O=o.date2number(s),g(),t.DEBUG_MODE&&console.log("rodconsole page Loaded!")}function g(){E=[],a.getall().then(function(e){E=e,E.forEach(function(e){if(e.datenum=o.date2number(e.date),e.category){var n=t.categories.map(function(e){return e.id}).indexOf(e.category);n>-1&&(e.title=t.categories[n].category.replace("@Nh","San Diego"),e.fimage=t.categories[n].fimage,e.introtext||null!=t.categories[n].introtext&&void 0!=t.categories[n].introtext&&""!=t.categories[n].introtext&&(e.introtext=t.categories[n].introtext),e.fc=t.categories[n].fc,e.bc=t.categories[n].bc,e.shade=t.categories[n].shade),void 0!=e.fimage&&""!=e.fimage?e.imageok=!0:e.imageok=!1,void 0!=e.introtext&&""!=e.introtext?e.textok=!0:e.textok=!1}}),A.dataReady=!0,A.rods=E}),A.addopts=[];for(var e=0;e<t.categories.length;e++)A.addopts.push(t.categories[e].category)}function m(){for(var e=0;e<t.categories.length;e++)A.addval==t.categories[e].category&&(console.log(A.rank.id,A.addval),a.update(A.rank.id,["category"],[t.categories[e].id]))}function p(e){if("all"==e&&(A.next20IsSelected=!1,A.allIsSelected=!0),"next20"==e&&(A.next20IsSelected=!0,A.allIsSelected=!1),A.rods=[],A.next20IsSelected)for(var t=0;t<E.length;t++)E[t].datenum>=O&&A.rods.push(E[t]);else A.rods=E}function h(e){A.overview=!1,A.detail=!0,A.addval="",A.rank=e,void 0!=A.rank.fimage&&""!=A.rank.fimage&&(A.rank.image3=A.rank.image2,A.rank.image2=A.rank.image1,A.rank.image1=A.rank.fimage),console.log("selRank",A.rank),console.log(A.rank.bc),null!=A.rank.bc?(D="h"!=A.rank.bc.charAt(0)?A.rank.bc:s.hsl2rgb(A.rank.bc),A.rank.bc2=s.shadeColor(D,A.rank.shade/10)):(A.rank.bc="hsl(240, 100%, 99%)",A.rank.bc2=s.shadeColor(A.rank.bc,-.3)),t.cmd1exe=!1}function f(){A.overview=!0,A.detail=!1}function v(){t.$emit("backToResults")}function b(){A.rank.shade=A.rank.shade+1,A.rank.shade>10&&(A.rank.shade=10),D=s.hsl2rgb(A.rank.bc),A.rank.bc2=s.shadeColor(D,A.rank.shade/10)}function y(){A.rank.shade=A.rank.shade-1,A.rank.shade<-10&&(A.rank.shade=-10),D=s.hsl2rgb(A.rank.bc),A.rank.bc2=s.shadeColor(D,A.rank.shade/10)}function w(){S?(A.rank.fimage=t.blobimage,A.rank.image1=A.rank.fimage):(A.rank.fimage=t.blobimage,A.rank.image3=A.rank.image2,A.rank.image2=A.rank.image1,A.rank.image1=A.rank.fimage),t.cmd1exe=!1}function k(){if(void 0!=A.rank.fimage&&""!=A.rank.fimage){var e=["fimage","bc","fc","shade"];"h"==A.rank.bc.charAt(0)&&(A.rank.bc=s.hsl2rgb(A.rank.bc)),"h"==A.rank.fc.charAt(0)&&(A.rank.fc=s.hsl2rgb(A.rank.fc));var n=[A.rank.fimage,A.rank.bc,A.rank.fc,A.rank.shade],a="",o=[];if(A.rank.isatomic)console.log("rank:",A.rank.title),l.update(A.rank.rankid,e,n).then(function(){i.getDialog("rodimageuploadsuccess"),loadData(),f()});else{A.dataReady=!1,A.loadText="Saving data...",a=A.rank.title.replace(" in San Diego","");for(var c=0;c<t.content.length;c++)t.content[c].title.indexOf(a)>-1&&o.push(l.update(t.content[c].id,e,n));r.all(o).then(function(){A.dataReady=!0,i.getDialog("rodimageuploadsuccess"),loadData(),f()})}}else i.getDialog("nouploadedimage")}function x(){d.update(A.rank.category,["introtext"],[A.rank.introtext]).then(function(){i.getDialog("introTextSaved"),g()});var e=A.rank.introtext;a.update(A.rank.id,["introtext"],[""]).then(function(){}),""==A.rank.introtext&&(A.rank.introtext=e)}function R(){if(void 0!=A.rank.fimage&&""!=A.rank.fimage){c.deleteBlob(A.rank.fimage);var e=t.content.map(function(e){return e.id}).indexOf(A.rank.rankid),n=s.defaultRankColor(t.content[e]),a=["fimage","bc","fc","shade"],o=["",n[0],n[1],0],d="",u=[];if(A.rank.isatomic)l.update(A.rank.rankid,a,o).then(function(){i.getDialog("rodimagedeletesuccess"),loadData(),f()});else{A.dataReady=!1,A.loadText="Deleting image...",d=A.rank.title.replace(" in San Diego","");for(var g=0;g<t.content.length;g++)t.content[g].title.indexOf(d)>-1&&u.push(l.update(t.content[g].id,a,o));r.all(u).then(function(){A.dataReady=!0,i.getDialog("rodimagedeletesuccess"),loadData(),f()})}}else i.getDialog("nouploadedimage")}var A=this;A.title="rodconsole",A.selRank=h,A.goBack=f,A.plusShade=b,A.minusShade=y,A.refreshImages=w,A.filterData=p,A.goSaveImage=k,A.goSaveText=x,A.goDeleteImage=R,A.addCategory=m,A.dataReady=!1;var E=[],O=0;A.overview=!0,A.detail=!1,A.rank={},A.sm=t.sm,A.allIsSelected=!0,A.next20IsSelected=!1,A.loadText="Loading data...";var S=!1;t.canswer={},t.canswer.id="featuredImages",A.testimage=t.EMPTY_IMAGE;var D="";t.$on("fileUploaded",function(e,a){t.cmd1exe=!!t.cmd1exe&&t.cmd1exe,"rodconsole"!=n.current.name||t.cmd1exe||(t.cmd1exe=!0,t.blobimage=a,w())}),i.enterPassword(u,v)}angular.module("app").controller("rodconsole",e),e.$inject=["$location","$rootScope","$state","rankofday","color","datetime","dialog","$q","table","imagelist","categories"]}(),function(){"use strict";function e(e,t,n,a){function s(){for(var e=0;e<o.queries.length;e++)a.deleteRec(o.queries[e].id)}var o=this;o.title="queries",o.clearDb=s,o.isAdmin=t.isAdmin,function(){a.getQueries().then(function(e){o.queries=e,console.log("Queries Loaded!")})}()}angular.module("app").controller("queries",e),e.$inject=["$location","$rootScope","$state","query"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g){function m(){console.log("Plan admin page Loaded!")}function p(e){o.changeCodePriceDlg(e,h)}function h(e,t){f.isSaving=!0,u.setCodePrice(e,t).then(function(t){f.isSaving=!1,"Custom Rank"==e.code?(f.notifications.push({message:"Custom Rank Price $ "+t.data.plan.amount/100+" has changed successfully",type:"success"}),e.price=t.data.plan.amount/100):(f.notifications.push({message:"Premium Plan "+e.code+" Price $ "+t.data.plan.amount/100+" has changed successfully",type:"success"}),e.price=t.data.plan.amount/100)}).catch(function(e){f.notifications.push({message:e.data.err.message,type:"error"})})}var f=this;f.title="plan",f.dataReady=!1,f.changeCodePrice=p,f.customranking={},f.notifications=[],f.isAdmin=t.isAdmin,f.isSaving=!1,function(){i.all([d.get(),u.getSetting()]).then(function(e){f.codeprices=e[0],f.STRIPE_COMMISSION_PERCENTAGE=e[1].STRIPE_COMMISSION_PERCENTAGE,f.CUSTOM_RANK_PRICE=e[1].CUSTOM_RANK_PRICE,f.customranking={code:"Custom Rank",price:f.CUSTOM_RANK_PRICE},f.codeprices.push(f.customranking),f.dataReady=!0,m()})}()}angular.module("app").controller("plan",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$q","useraccnt","promoter","answer","codeprice","setting","$timeout"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g){function m(){o.changeCommissionDlg(R.STRIPE_COMMISSION_PERCENTAGE,p)}function p(e){u.setSetting({STRIPE_COMMISSION_PERCENTAGE:parseInt(e)/100}).then(function(e){R.STRIPE_COMMISSION_PERCENTAGE=e.STRIPE_COMMISSION_PERCENTAGE})}function h(e){-1!=R.selectedPromoters.indexOf(e)?R.selectedPromoters.splice(R.selectedPromoters.indexOf(e),1):R.selectedPromoters.push(e)}function f(){R.selectedPromoters.forEach(function(e){R.payPromoter(e)})}function v(e){e.stripeid?r.payPromoter(e,R.STRIPE_COMMISSION_PERCENTAGE).then(function(t){R.notifications.push({message:"$"+e.balance*R.STRIPE_COMMISSION_PERCENTAGE+"transfered successfully to Promoter: "+e.firstname+" "+e.lastname,type:"success"}),e.lastPaymentDate=t.data.lastPaymentDate,e.payedThisMonth=!0}).catch(function(t){R.notifications.push({message:"$"+e.balance*R.STRIPE_COMMISSION_PERCENTAGE+"  to Promoter: "+e.firstname+" "+e.lastname+" transfer failed. ",type:"error"})}):window.alert("The promoter"+e.firstname+" "+e.lastname+" need to connect stipe account.")}function b(e){c.getAnswer(e.answer).then(function(t){e.answerObj=t})}function y(e){R.currentPromoter=e,R.detailview=!0,R.overview=!1}function w(){if(1==R.detailview)return R.overview=!0,void(R.detailview=!1)}function k(e){o.showBusinessDetailDlg(e,R.STRIPE_COMMISSION_PERCENTAGE,R.CUSTOM_RANK_PRICE)}function x(e){n.go("answerDetail",{index:e.slug})}var R=this;R.title="payment",R.dataReady=!1,R.promoters=[],R.isAdmin=t.isAdmin,R.detailview=!1,R.overview=!0,R.notifications=[],R.selectedPromoters=[],R.payPromoter=v,R.gotoanswer=x,R.goBack=w,R.goDetailView=y,R.showBusinessDetail=k,R.addOrRemovePromoter=h,R.paySelectedPromoters=f,R.changeCommission=m,function(){i.all([l.getall(),r.getallaccnts(),d.get(),u.getSetting()]).then(function(e){var n=e[1],a=e[2];R.STRIPE_COMMISSION_PERCENTAGE=e[3].STRIPE_COMMISSION_PERCENTAGE?e[3].STRIPE_COMMISSION_PERCENTAGE:.2,R.CUSTOM_RANK_PRICE=e[3].CUSTOM_RANK_PRICE,e[0].forEach(function(e){var s=angular.copy(e);s.businesses=[];for(var o=0;o<n.length;o++)if(n[o].promocode==e.code){var i=angular.copy(n[o]);"Basic"==i.status&&(i.style="background-color:#bfbfbf"),i.istrial?(i.status="On Trial "+Math.ceil(moment.duration(moment(i.discountEndDate)-moment()).asDays())+" Days left",i.style="background-color:#b3b300"):(i.status="Active",i.style="background-color:#009900");for(var r=0;r<a.length;r++)if(a[r].code==i.bizcat){i.price=a[r].price;break}i.totalCommission=0,i.ispremium&&(i.totalCommission+=i.price*R.STRIPE_COMMISSION_PERCENTAGE),i.hasranks&&(i.totalCommission+=i.ranksqty*R.CUSTOM_RANK_PRICE*R.STRIPE_COMMISSION_PERCENTAGE),s.businesses.push(i),b(s.businesses[s.businesses.length-1])}for(s.payedThisMonth=!0,s.lastPaymentDate||(s.payedThisMonth=!1),(moment(s.lastPaymentDate).year()==moment(t.setting.serverDate).year()&&moment(s.lastPaymentDate).month()<moment(t.setting.serverDate).month()||moment(s.lastPaymentDate).year()<moment(t.setting.serverDate).year())&&(s.payedThisMonth=!1),s.balance=0,o=0;o<s.businesses.length;o++)"Active"==s.businesses[o].status&&(s.balance+=s.businesses[o].monthlyCost);s.activeCount=s.businesses.filter(function(e){return"Active"==e.status}).length,s.ontrialCount=s.businesses.filter(function(e){return-1!=e.status.indexOf("On Trial")}).length,R.promoters.push(s)}),R.dataReady=!0})}(),function(){console.log("payment admin page Loaded!")}()}angular.module("app").controller("payment",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$q","useraccnt","promoter","answer","codeprice","setting","$timeout"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(){console.log("@getData"),console.log("$rootScope.catansrecs.length ",t.catansrecs.length),f.idx=v;var e={},n={},a=0,s=0;f.ans1=t.dupAns[v].ans1,f.ans2=t.dupAns[v].ans2,g(),f.ans1.catans=[],a=f.ans1.id;for(var o=0;o<t.catansrecs.length;o++)if(a==t.catansrecs[o].answer){e=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(e.rank=t.content[i].title);f.ans1.catans.push(e)}f.ans2.catans=[],s=f.ans2.id;for(var o=0;o<t.catansrecs.length;o++)if(s==t.catansrecs[o].answer){n=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(n.rank=t.content[i].title);f.ans2.catans.push(n)}console.log("vm.ans1.catans.length ",f.ans1.catans.length),console.log("vm.ans2.catans.length ",f.ans2.catans.length)}function l(e){v-=e,v<0&&(v=0),r()}function c(e){v+=e,v>=f.tot&&(v=f.tot),r()}function d(e){1==e&&(o.deleteAnswer(t.dupAns[v].ans1.id),a.deleteAnswer(t.dupAns[v].ans1.id)),2==e&&(o.deleteAnswer(t.dupAns[v].ans2.id),a.deleteAnswer(t.dupAns[v].ans2.id))}function u(e){if(1==e){f.addcts1opts=[];for(var t="",n=0;n<b.length;n++)b[n].indexOf("@neighborhood")>-1?(t=b[n].replace("@neighborhood",f.ans1.cityarea),f.addcts1opts.push(t)):f.addcts1opts.push(b[n]);f.addcts1active=!0}if(2==e){f.addcts2opts=[];for(var a="",n=0;n<b.length;n++)b[n].indexOf("@neighborhood")>-1?(a=b[n].replace("@neighborhood",f.ans2.cityarea),f.addcts2opts.push(a)):f.addcts2opts.push(b[n]);f.addcts2active=!0}}function g(){b=[];for(var e="",n=0;n<t.content.length;n++)t.content[n].title.indexOf("in Hillcrest")>-1&&(e=t.content[n].title.replace("Hillcrest","@neighborhood"),b.push(e)),t.content[n].ismp&&b.push(t.content[n].title)}function m(e){var n="",s={},o=0;1==e&&(n=f.addcts1val,s=f.ans1,void 0!=f.cat1isdup&&f.cat1isdup),2==e&&(n=f.addcts2val,s=f.ans2,void 0!=f.cat2isdup&&f.cat2isdup);for(var i=0;i<t.content.length;i++)if(t.content[i].title==n){o=t.content[i].id;break}a.postRec2(s.id,o),1==e&&(f.addcts1active=!1),2==e&&(f.addcts2active=!1),setTimeout(function(){r()},1e3)}function p(e){a.deleteRec(e.answer,e.category),setTimeout(function(){r()},1e3)}function h(e){1==e&&n.go("editAnswer",{index:f.ans1.id}),2==e&&n.go("editAnswer",{index:f.ans2.id})}var f=this;f.title="mergeAnswers";var v=0;f.goPrev=l,f.goNext=c,f.delAnswer=d,f.addCatans=u,f.addcts=m,f.delCatans=p,f.editAnswer=h,f.addcts1active=!1,f.addcts2active=!1;var b=[];!function(){f.tot=t.dupAns.length-1,g(),r(),console.log("mergeAnswers page Loaded!")}()}angular.module("app").controller("mergeAnswers",e),e.$inject=["$location","$rootScope","$state","catans","$http","answer","$stateParams"]}(),function(){"use strict";function e(e,t,n){function a(){i.uuis=e.uuis}function s(e){t.deleteRecord(e.id).then(a)}function o(e){n.deleteBlob(e.imageurl),t.deleteRecord(e.id).then(a)}var i=this;i.title="imagesmod",i.dataready=!1,i.removeImage=o,i.approveImage=s,function(){t.getRecords().then(function(){i.dataready=!0,a()}),e.DEBUG_MODE&&console.log("imagesmod page Loaded!")}()}angular.module("app").controller("imagesmod",e),e.$inject=["$rootScope","useruploadedimages","imagelist"]}(),function(){"use strict";function e(e,t,n,a,s){function o(){console.log("getRanks");for(var e="",n=0;n<t.content.length;n++)t.content[n].tags.indexOf("food")>-1&&(e=e+":"+t.content[n].id);for(var s=e.substring(1),o=s.split(":").map(Number),i={},r=0,l=0,c=[],d=!1,u="",n=0;n<t.catansrecs.length;n++){i=t.catansrecs[n];for(var g=0;g<o.length;g++)if(i.category==o[g]){if(r=i.answer,l=t.answers.map(function(e){return e.id}).indexOf(r),l<0&&(console.log("idx - ",r,"catansrec - ",i.id,i.answer,i.category),a.deleteRec(i.answer,i.category)),d=!1,c.length>0&&l>0)for(var m=0;m<c.length;m++)if(c[m].id==t.answers[l].id){d=!0;break}d||(u=u+":"+t.answers[l].id,c.push(t.answers[l]))}}console.log("Food ranks: - ",s),console.log("Food ranks length: - ",o.length),console.log("Answers Ids: - ",u.substring(1)),console.log("Food answers length: - ",c.length)}var i=this;i.title="foodRanks",i.getRanks=o,function(){console.log("foodRanks page Loaded!")}()}angular.module("app").controller("foodRanks",e),e.$inject=["$location","$rootScope","$state","catans","$http"]}(),function(){"use strict";function e(e,t,n,a,s,o,i){function r(){a.getFlags().then(function(e){p.flags=e,console.log("flags - ",p.flags);for(var t=0;t<p.flags.length;t++){if("comment-rank"==p.flags[t].type||"comment-answer"==p.flags[t].type)switch(p.flags[t].flag){case 1:p.flags[t].desc="Off-Topic";break;case 2:p.flags[t].desc="Offensive";break;case 3:p.flags[t].desc="Spam"}if("answer"==p.flags[t].type)switch(p.flags[t].flag){case 1:p.flags[t].desc="Wrong Category";break;case 2:p.flags[t].desc="No longer active";break;case 3:p.flags[t].desc="Offensive";break;case 4:p.flags[t].desc="Spam"}}})}function l(e){"answer"==e.type&&n.go("answerDetail",{index:e.number}),"comment-answer"==e.type&&n.go("answerDetail",{index:e.number}),"comment-rank"==e.type&&n.go("rankSummary",{index:e.number})}function c(e){p.viewTable=!1,p.viewDetails=!0;var n={};if(p.data={},p.catans=[],p.comments=[],p.data.type=e.type,p.data.desc=e.desc,p.data.id=e.id,"answer"==e.type){var a=t.answers.map(function(e){return e.id}).indexOf(e.number);p.data.imageurl=t.answers[a].imageurl,p.data.name=t.answers[a].name,p.data.location=t.answers[a].location,p.data.cityarea=t.answers[a].cityarea,p.data.phone=t.answers[a].phone,p.data.website=t.answers[a].website,p.data.addinfo=t.answers[a].addinfo;for(var s=0;s<t.catansrecs.length;s++)if(t.answers[a].id==t.catansrecs[s].answer){n={},n=t.catansrecs[s];for(var r=0;r<t.content.length;r++)t.catansrecs[s].category==t.content[r].id&&(n.rank=t.content[r].title);p.catans.push(n)}}if("comment-answer"==e.type){var a=t.answers.map(function(e){return e.id}).indexOf(e.number);p.data.imageurl=t.answers[a].imageurl,p.data.name=t.answers[a].name,p.data.location=t.answers[a].location,p.data.cityarea=t.answers[a].cityarea,p.data.phone=t.answers[a].phone,p.data.website=t.answers[a].website,p.data.addinfo=t.answers[a].addinfo,i.getcommentsbyanswer(e.number).then(function(e){p.comments=e})}if("comment-rank"==e.type){var a=t.content.map(function(e){return e.id}).indexOf(e.number);p.data.title=t.content[a].title,o.getcommentsbyrank(e.number).then(function(e){p.comments=e})}}function d(){p.viewTable=!0,p.viewDetails=!1}function u(e){s.deleteRec(e.answer,e.category)}function g(e){"comment-rank"==p.data.type&&o.deletecomment(e.id),"comment-answer"==p.data.type&&i.deletecomment(e.id)}function m(e){a.deleteFlag(e.id).then(function(){r()})}var p=this;p.title="flags",p.getFlags=r,p.gotoView=l,p.delCatans=u,p.delComment=g,p.seeDetails=c,p.seeFlags=d,p.deleteFlag=m,p.viewDetails=!1,p.viewTable=!0,function(){console.log("Flags page loaded!")}()}angular.module("app").controller("flags",e),e.$inject=["$location","$rootScope","$state","flag","catans","comment","comment2"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r){function l(){console.log("query Answer"),u.ansRes=[];for(var e=0,n={},a=0;a<t.answers.length;a++)t.answers[a].name.indexOf(u.val)>-1&&u.ansRes.push(t.answers[a]);for(var s=0;s<u.ansRes.length;s++){u.ansRes[s].catans=[],e=u.ansRes[s].id;for(var o=0;o<t.catansrecs.length;o++)if(e==t.catansrecs[o].answer){n=t.catansrecs[o];for(var i=0;i<t.content.length;i++)t.catansrecs[o].category==t.content[i].id&&(n.rankid=t.content[i].id,n.catid=t.content[i].cat,n.title=t.content[i].title);u.ansRes[s].catans.push(n)}}}function c(e){r.deleteRec(e.answer,e.category)}function d(e){i.deleteAnswer(e.id)}var u=this;u.title="dbQuery",u.queryAnswer=l,u.delCatans=c,u.delAnswer=d,u.isAdmin=t.isAdmin||t.dataAdmin,function(){u.isDET=t.isLoggedIn&&(12==t.user.id||30==t.user.id||41==t.user.id||42==t.user.id||30==t.user.id),console.log("dbQuery page Loaded!")}()}angular.module("app").controller("dbQuery",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","answer","catans"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h){function f(){var e={},n=!1;G.unrefans=[],G.addctsopts=[],G.ans=-1;for(var a=0;a<t.answers.length;a++){({}),e={},e=t.answers[a],n=!1;for(var s=0;s<t.catansrecs.length;s++)if(t.catansrecs[s].answer==e.id){n=!0;break}0==n&&G.unrefans.push(e)}if(G.unrefans.length>0)for(var o=0;o<t.content.length;o++)G.addctsopts.push(t.content[o].title)}function v(e){c.deleteAnswer(e.id).then(function(){f()})}function b(e){G.ans=e.id}function y(e){var n="",a=0;n=G.addctsval;for(var s=0;s<t.content.length;s++)if(t.content[s].title==n){a=t.content[s].id;break}d.postRec2(G.ans,a).then(function(){f()})}function w(){console.log("@ Show Possible Duplicated"),console.log("answers length",t.answers.length);var e={},n={};G.dupAnswers=[];for(var a=0,s=0,o="",i=0;i<t.answers.length;i++)if(s=.75*t.answers[i].name.length,e=t.answers[i],o=t.answers[i].name.slice(0,s),"Establishment"==t.answers[i].type&&o.length>8)for(var r=0;r<t.answers.length;r++)t.answers[r].name.indexOf(o)>-1&&i!=r&&(n={},n.id=a,n.add1=e.addinfo,n.nh1=e.cityarea,n.loc1=e.location,n.name1=e.name,n.image1=e.imageurl,n.id1=e.id,n.name2=t.answers[r].name,n.idx1=i,n.idx2=r,n.loc2=t.answers[r].location,n.nh2=t.answers[r].cityarea,n.add2=t.answers[r].addinfo,n.image2=t.answers[r].imageurl,n.id2=t.answers[r].id,G.dupAnswers.push(n),a++);console.log("finished")}function k(e){for(var n=0;n<t.catansrecs.length;n++)if(e.id2==t.catansrecs[n].answer){d.updateRec(t.catansrecs[n].id,["answer"],[e.id1]);break}c.deleteAnswer(e.id2),w()}function x(e){for(var n=0;n<t.catansrecs.length;n++)if(e.id1==t.catansrecs[n].answer){d.updateRec(t.catansrecs[n].id,["answer"],[e.id2]);break}c.deleteAnswer(e.id1),w()}function R(){t.dupAns=[];var e={},n={};G.dupAnsNames=[];for(var a=0,s=0;s<t.answers.length;s++){e=t.answers[s];for(var o=0;o<t.answers.length;o++)e.name==t.answers[o].name&&e.location==t.answers[o].location&&s!=o&&(!1,n={},n.ans1=e,n.ans2=t.answers[o],t.dupAns.push(n),G.dupAnsRdy=!0,a++)}}function A(){t.fields=t.typeSchema[6].fields;for(var e={},n={},a=[],s=0,o=0;o<t.answers.length;o++)if(e=t.answers[o],void 0!=e.location&&""!=e.location)for(var i=0;i<t.answers.length;i++)void 0!=t.answers[i].location&&""!=t.answers[i].location&&e.location==t.answers[i].location&&o!=i&&(n={},n.ans1=e,n.ans2=t.answers[i],a.push(n),s++);t.dupAns=a,console.log("@finished - showDuplicatedByLocation"),G.dupAnsRdy=!0}function E(){n.go("mergeAnswers")}function O(){}function S(){for(var e=[],n=0;n<t.content.length;n++)for(var a=n;a<t.content.length;a++)t.content[n].title==t.content[a].title&&n!=a&&(console.log("duplicated rank --- ",t.content[n].title),e.push(t.content[n]))}function D(){console.log("Clearing all catans vote sums to zero");for(var e=0;e<t.catansrecs.length;e++)0==t.catansrecs[e].upV&&0==t.catansrecs[e].downV||d.updateRec(t.catansrecs[e].id,["upV","downV"],[0,0])}function C(){console.log("syncUSerVotes"),u.loadAllVotes().then(function(e){t.allvotes=e,I()})}function I(){console.log("syncVotes");var e={},n={},a=[],s=[],o=0,i=0;G.syncp=[];for(var r={},l=0;l<t.catansrecs.length;l++){e=t.catansrecs[l],a=[],s=[],n={};for(var c=0;c<t.allvotes.length;c++)n=t.allvotes[c],n.catans==e.id&&(1==n.vote&&a.push(n),-1==n.vote&&s.push(n))
;a.length==e.upV&&s.length==e.downV||(r={},o=t.answers.map(function(e){return e.id}).indexOf(e.answer),i=t.content.map(function(e){return e.id}).indexOf(e.category),r.answername=t.answers[o].name,r.categorytitle=t.content[i].title,r.answer=t.answers[o].id,r.catans=e.id,r.category=t.content[i].id,r.caUpV=e.upV,r.caDownV=e.downV,r.nUpVlen=a.length,r.nDownVlen=s.length,G.syncp.push(r))}}function P(e){d.updateRec(e.catans,["upV","downV"],[e.nUpVlen,e.nDownVlen])}function T(){console.log("@estDistances, need to have GPS location stored-",t.answers.length),G.ans=-1,G.answerdist=[];for(var e=.017453292519943295,n=Math.cos,a=0,s=t.currentUserLatitude,o=t.currentUserLongitude,i=0,r=0,l=0,c={},d=0;d<t.answers.length;d++)"Establishment"==t.answers[d].type&&void 0!=t.answers[d].location&&""!=t.answers[d].location&&(i=t.answers[d].lat,r=t.answers[d].lng,c=t.answers[d],a=.5-n((i-s)*e)/2+n(s*e)*n(i*e)*(1-n((r-o)*e))/2,l=12742*Math.asin(Math.sqrt(a))/1.609,c.dist=l,(l>100||NaN==l)&&G.answerdist.push(c))}function M(e){n.go("answerDetail",{index:e.id})}function L(){for(var e=[],n={},a=1256,s=0;s<t.answers.length;s++)t.answers[s].imageurl.indexOf("http://")>-1&&(n={},n.id=a++,n.answer=t.answers[s].id,n.url=t.answers[s].imageurl,e.push(n));console.log(JSON.stringify(e))}function N(){var e=[],t="";g.get("../../../assets/images.json").then(function(n){e=n.data;for(var a=0;a<e.length;a++)e[a].url.indexOf("jpg")>-1&&(t="jpg"),e[a].url.indexOf("png")>-1&&(t="png"),e[a].url.indexOf("jpeg")>-1&&(t="jpeg"),c.updateAnswer(e[a].answer,["image"],["https://rankx.blob.core.windows.net/sandiego/"+e[a].answer+"/"+e[a].id+"."+t])})}function _(){var e={},n="";G.codes=[],G.catcode={},G.ans=-1;var a=m.get(),s=p.get();return o.all([a,s]).then(function(a){t.catcodes=a[0],t.codeprices=a[1];for(var s=0;s<t.codeprices.length;s++)G.codes.push(t.codeprices[s].code);console.log("Category-codes loaded..."),G.ansNoCode=[];for(var o=0;o<t.answers.length;o++)if(("Establishment"==t.answers[o].type||"PersonCust"==t.answers[o].type)&&(e={},e=t.answers[o],void 0==(n=h.getBizCat(e.id))||""==n||null==n)){e.cats=[];for(var i=0;i<t.catansrecs.length;i++)if(t.catansrecs[i].answer==e.id)for(var r=0;r<t.content.length;r++)t.content[r].id==t.catansrecs[i].category&&e.cats.push(t.content[r].title);G.ansNoCode.push(e)}})}function $(){m.post(G.catcode).then(function(){console.log("Added category code pair"),_()})}function B(e){console.log("selEditAddess - ",e),G.ans=e.id}function U(e){i.getLocationGPS(e).then(function(){c.updateAnswer(e.id,["location","lat","lng"],[e.location,e.lat,e.lng]).then(function(){T()})})}function X(){}var G=this;G.title="dbMaint",G.showUrefAns=f,G.delAnswer=v,G.selAns=b,G.showPossibleDuplicated=w,G.syncToFirst=k,G.syncToSecond=x,G.showDuplicatedOnlyName=R,G.showDuplicatedByLocation=A,G.findPhoneWebsite=O,G.findDuplicatedRanks=S,G.clearAllCatansVotes=D,G.syncUserVotes=C,G.getAnswerBizCode=_,G.updatecatans=P,G.estDistances=T,G.gotoAnswer=M,G.createImagesJSON=L,G.updateUrls=N,G.goMerge=E,G.getSlugs=X,G.delAnswer=v,G.addcts=y,G.selEditAddress=B,G.editAddress=U,G.addcatcode=$,G.isAdmin=t.isAdmin,G.dupAnsRdy=!1,function(){console.log("dbMaint page Loaded!")}()}angular.module("app").controller("dbMaint",e),e.$inject=["$location","$rootScope","$state","$stateParams","Upload","$q","getgps","table","dialog","answer","catans","votes","$http","categorycode","codeprice","useraccnt"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b,y){function w(e){n.go("answerDetail",{index:e.slug})}function k(){P.filteredCatans=[];var e=_.groupBy(P.catans,function(e){return"cat"+e.category+"answer"+e.answer});for(var t in e)e[t].length>1&&(e[t].dup=e[t].length,P.filteredCatans.push(e[t]));P.deletingCatans=!1,P.dtInstanceCatans={},g(function(){P.dtInstanceCatans.rerender()},1e3)}function x(){P.deletingCatans=!0;var e=P.filteredCatans.filter(function(e){return e[0].checked}),t=[];e.forEach(function(e){for(var n=1;n<e.length;n++)t.push(h.deleteCatan(e[n].id))}),i.all(t).then(function(e){e.forEach(function(e){var t=P.catans.map(function(e){return e.id}).indexOf(e.resource[0].id);P.catans.splice(t,1)}),k()})}function R(){P.filteredCategories=[];var e=P.rankings.map(function(e){return e.cat});P.filteredCategories=P.categories.filter(function(t){return-1==e.indexOf(t.id)}),P.deletingCategories=!1,P.dtInstanceCategories={},g(function(){P.dtInstanceCategories.rerender()},1e3)}function A(){P.deletingCategories=!0;var e=P.filteredCategories.filter(function(e){return e.checked}),t=[];e.forEach(function(e){t.push(f.deleteRec(e.id))}),i.all(t).then(function(e){e.forEach(function(e){var t=P.categories.map(function(e){return e.id}).indexOf(e.id);P.categories.splice(t,1)}),R()})}function E(){P.filteredAnswers=[];var e=P.catans.map(function(e){return e.answer});P.filteredAnswers=P.answers.filter(function(t){return-1==e.indexOf(t.id)}),P.deletingAnswers=!1,P.dtInstanceAnswers={},g(function(){P.dtInstanceAnswers.rerender()},1e3)}function O(){P.deletingAnswers=!0;var e=P.filteredAnswers.filter(function(e){return e.checked}),t=[];e.forEach(function(e){t.push(c.deleteAnswer(e.id))}),i.all(t).then(function(e){e.forEach(function(e){var t=P.answers.map(function(e){return e.id}).indexOf(e.id);P.answers.splice(t,1)}),E()})}function S(){P.filteredRankings=[];var e=P.catans.map(function(e){return e.category});P.filteredRankings=P.rankings.filter(function(t){return-1==e.indexOf(t.id)}),P.deletingRankings=!1,P.dtInstanceRankings={},g(function(){P.dtInstanceRankings.rerender()},1e3)}function D(){P.deletingRankings=!0;var e=P.filteredRankings.filter(function(e){return e.checked}),t=[];e.forEach(function(e){t.push(s.deleteTable(e.id))}),i.all(t).then(function(e){e.forEach(function(e){var t=P.rankings.map(function(e){return e.id}).indexOf(e.id);P.rankings.splice(t,1)}),S()})}function C(){P.filteredFImages=[];var e=P.categories.map(function(e){return e.fimage});P.filteredFImages=P.fimages.filter(function(t){return-1==e.indexOf(t.url)}),P.deletingFImages=!1,P.dtInstanceFImages={},g(function(){P.dtInstanceFImages.rerender()},1e3)}function I(){P.deletingFImages=!0;var e=P.filteredFImages.filter(function(e){return e.checked}),t=[];e.forEach(function(e){t.push(y.deleteBlob(e.url))}),i.all(t).then(function(t){e.forEach(function(e){var t=P.fimages.map(function(e){return e.url}).indexOf(e.url);P.fimages.splice(t,1)}),C()})}var P=this;P.title="cleandb",P.dataReady=!1,P.catans=[],P.accounts=[],P.rankings=[],P.categories=[],P.answers=[],P.fimages=[],P.isAdmin=t.isAdmin,P.notifications=[],P.gotoanswer=w,P.filterCatans=k,P.filterCategories=R,P.filterAnswers=E,P.filterRankings=S,P.filterFImages=C,P.deleteSelectedCatans=x,P.deleteSelectedCategories=A,P.deleteSelectedAnswers=O,P.deleteSelectedRankings=D,P.deleteSelectedFImages=I,P.dtInstanceCatans={},P.dtInstanceCategories={},P.dtInstanceAnswers={},P.dtInstanceRankings={},P.dtInstanceFImages={},P.filteredCatans=[],P.filteredCategories=[],P.filteredAnswers=[],P.filteredRankings=[],P.filteredFImages=[],function(){i.all([h.getAllcatans(),r.getallaccnts(),f.getAllCategories(),b.getAllLocations(),s.getTables(),c.getAnswers(),y.getFeatureImageList()]).then(function(e){P.catans=e[0],P.accounts=e[1],P.categories=e[2],P.locations=e[3],t.categories=e[2],t.locations=e[3],t.content=e[4],v.unwrap(),P.rankings=t.content,P.answers=e[5],P.fimages=e[6],P.dataReady=!0,k(),R(),E(),S(),C()})}()}angular.module("app").controller("cleandb",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$q","useraccnt","promoter","answer","codeprice","setting","$timeout","DTOptionsBuilder","DTColumnDefBuilder","catans","categories","dataloader","locations","imagelist"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p){function h(){console.log("bizadmin page Loaded!")}function f(e){return c.getAnswer(e.answer).then(function(t){e.answerObj=t})}function v(e){n.go("answerDetail",{index:e.slug})}function b(){return 1==A.showFilter?A.filtered=A.businesses.filter(function(e){return e.hasranks||e.haspremium}):2==A.showFilter?A.filtered=A.businesses.filter(function(e){return!(e.hasranks||e.haspremium)}):A.filtered=A.businesses}function y(){A.showFilter=1,b()}function w(){A.showFilter=2,b()}function k(){A.showFilter=0,b()}function x(){A.showUserFilter=!A.showUserFilter,b()}function R(){console.log(A.filtered.filter(function(e){return e.checked}).map(function(e){return e}))}var A=this;A.title="bizadmin",A.dataReady=!1,A.businesses=[],A.isAdmin=t.isAdmin,A.notifications=[],A.gotoanswer=v,A.filterData=b,A.showFilter=0,A.showUserFilter=!0,A.setShowPurchases=y,A.setShowAll=k,A.setShowNonPurchases=w,A.showUser=x,A.deleteSelected=R,A.dtInstance={},A.filtered=[],A.loading=!1,function(){i.all([r.getallaccnts(),u.getSetting(),d.get()]).then(function(e){e[0],e[2],A.STRIPE_COMMISSION_PERCENTAGE=e[1].STRIPE_COMMISSION_PERCENTAGE?e[1].STRIPE_COMMISSION_PERCENTAGE:.2,A.CUSTOM_RANK_PRICE=e[1].CUSTOM_RANK_PRICE,e[0].forEach(function(e){var n=angular.copy(e);t.answers.map(function(e){return e.id}).indexOf(n.answer)>-1&&(f(n).then(function(){b()}),A.businesses.push(n))}),A.dataReady=!0,b()}),h()}()}angular.module("app").controller("bizadmin",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog","$q","useraccnt","promoter","answer","codeprice","setting","$timeout","DTOptionsBuilder","DTColumnDefBuilder"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h,f,v,b,y,w){function k(){var e=a.getTables(),n=o.getAllCategories(),r=m.getAllLocations(),u=s.getAnswers(),y=p.getSpecials(),w=h.GetMatchTable(),k=f.getAllUserActivity(),x=d.getAllcatans(),R=v.getEdits(),A=c.getAllvrows(),E=i.getTables(),O=b.getallaccnts();return l.all([e,n,r,u,y,w,k,x,R,A,E,O]).then(function(e){t.content=e[0],t.categories=e[1],t.locations=e[2],t.answers=e[3],t.specials=e[4],t.mrecs=e[5],t.alluseractivity=e[6],t.catansrecs=e[7],t.edits=e[8],t.cvrows=e[9],t.customranks=e[10],t.useraccnts=e[11],g.unwrap(),g.createSearchStrings(),U.dataready=!0})}function x(){_(),U.selKeywords="active",n.go("queries")}function R(){_(),U.selViews="active",n.go("views")}function A(){_(),U.selFlags="active",n.go("flags")}function E(){_(),U.selRankings="active",n.go("addRank")}function O(){_(),U.selDbMaint="active",n.go("dbMaint")}function S(){_(),U.selQuery="active",n.go("dbQuery")}function D(){_(),U.selUpdate="active",n.go("updateHeaders")}function C(){_(),U.selFoodRanks="active",n.go("foodRanks")}function I(){_(),U.selSibLocks="active",n.go("sibLocs")}function P(){_(),U.selPayment="active",n.go("payment")}function T(){_(),U.selPlan="active",n.go("plan")}function M(){_(),U.selBizAdmin="active",n.go("bizadmin")}function L(){_(),U.selCleanDB="active",n.go("cleandb")}function N(){_(),U.selimagesMod="active",n.go("imagesmod")}function _(){U.selKeywords="",U.selViews="",U.selFlags="",U.selRankings="",U.selDbMaint="",U.selQuery="",U.selUpdate="",U.selFoodRanks="",U.selPlan="",U.selPayment="",U.selBizAdmin="",U.selSibLocks="",U.selCleanDB="",U.selimagesMod=""}function $(){n.go("content")}function B(){console.log("apply Rule")}var U=this;U.title="admin",U.selKeywords="active",U.selViews="",U.selFlags="",U.selRankings="",U.selPlan="",U.selCleanDB="",U.goBack=$,U.keywords=x,U.views=R,U.flags=A,U.addRank=E,U.dbMaint=O,U.dbQuery=S,U.update=D,U.foodranks=C,U.sibLocs=I,U.payment=P,U.plan=T,U.bizAdmin=M,U.applyRule=B,U.cleanDB=L,U.modImages=N,U.dataready=!1;var X=[];!function(){t.isAdmin||t.dataAdmin?(U.isDET=t.isLoggedIn&&("10104518570729893"==t.user.id||30==t.user.id||41==t.user.id||42==t.user.id||30==t.user.id||0xaaf2b1002387==t.user.id||0xb07a74be061a==t.user.id),U.isAdmin=t.user.is_sys_admin||t.isAdmin,U.dataAdmin=t.dataAdmin,U.modAdmin=t.modAdmin,k(),y.getFileList().then(function(e){X=e.data,console.log("static pages list ready")}),t.DEBUG_MODE&&console.log("admin page Loaded!")):n.go("cwrapper")}()}angular.module("app").controller("admin",e),e.$inject=["$location","$rootScope","$state","table","answer","categories","table2","categorycode","$q","vrows","catans","common","dataloader","locations","special","matchrec","useractivity","edit","useraccnt","staticpages","$timeout"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r){function l(){m=!("Enter a title..."==u.rankTitle||""==u.rankTitle||u.rankTitle.length<10),h=!("Enter a question..."==u.question||""==u.question||u.question.length<3),g.title=u.rankTitle+" @ "+t.canswer.name,g.tags="",g.keywords="",g.type="Simple",g.question=u.question,g.views=0,g.answers=0,g.introtext=u.introtext,g.ismp=!1,g.owner=t.canswer.id,p=!0,f=[u.bc,u.fc]}function c(){l();var e=[],a=[];if(m&&p&&h){if("add"==t.rankforAnswerMode)s.addTableforAnswer(g,f,t.canswer.id).then(function(){n.go("answerRanksManager")});else if(t.customranks[b].title!=u.rankTitle+" @ "+t.canswer.name&&(e.push("title"),a.push(u.rankTitle+" @ "+t.canswer.name)),t.customranks[b].question!=u.question&&(e.push("question"),a.push(u.question)),t.customranks[b].intro!=u.introtext&&(e.push("introtext"),a.push(u.introtext)),e.length>0&&s.update(t.customranks[b].id,e,a).then(function(){n.go("answerRanksManager")}),u.bc!=v[t.rankIdx].bc||u.fc!=v[t.rankIdx].fc){v[t.rankIdx].bc=u.bc,v[t.rankIdx].fc=u.fc;var i=JSON.stringify(v);r.updateAnswer(t.canswer.id,["ranks"],[i]).then(function(){n.go("answerRanksManager")})}}else m?h?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle")}function d(){n.go("answerRanksManager")}var u=this;u.title="addRankforAnswer",u.goBack=d;var g={},m=!0,p=!0,h=!0;u.addRankingforAnswer=c,u.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],u.isAdmin=t.isAdmin;var f=[],v=[],b=0;i.innerWidth<512?(u.sm=!0,u.nsm=!1):(u.sm=!1,u.nsm=!0),function(){void 0==t.rankforAnswerMode&&n.go("cwrapper"),"edit"==t.rankforAnswerMode?(v=JSON.parse(t.canswer.ranks),b=t.customranks.map(function(e){return e.id}).indexOf(v[t.rankIdx].id),u.rankTitle=t.customranks[b].title.replace(" @ "+t.canswer.name,""),u.question=t.customranks[b].question,u.introtext=t.customranks[b].introtext,u.bc=v[t.rankIdx].bc,u.fc=v[t.rankIdx].fc,u.buttonLabel="Edit"):(u.rankTitle="Enter a title...",u.question="Enter a question...",u.bc="gray",u.fc="lightgray",u.buttonLabel="Add",u.introtext="Tell us what your rank is about..."),t.DEBUG_MODE&&console.log("addRankforAnswer page Loaded!")}()}angular.module("app").controller("addRankforAnswer",e),e.$inject=["$location","$rootScope","$state","$stateParams","table2","dialog","$window","answer"]}(),function(){"use strict";function e(e,t,n,a,s,o){function i(){d.title=c.rankTitle,d.tags=c.tags,d.keywords=c.keywords,d.type=c.type,d.question=c.question,d.views=0,d.answers=0,(null==d.title||void 0==d.title||d.title.length<10)&&(u=!1),(null==d.question||void 0==d.question||d.question.length<10)&&(m=!1),"Person"!=d.type&&"Establishment"!=d.type&&"Short-Phrase"!=d.type&&"Event"!=d.type&&"Organization"!=d.type&&"Place"!=d.type&&"Activity"!=d.type&&"Thing"!=d.type&&"PersonCust"!=d.type&&(g=!1)}function r(){if(i(),console.log("vm.allNh --- ",c.allNh),0==c.allNh||void 0==c.allNh)u&&g&&m?(s.addTable(d),l()):u?m?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle");else if(u&&g&&m){for(var e=0;e<t.content.length;e++)if(t.content[e].title.indexOf("Yoga studios in")>-1){var n=JSON.parse(JSON.stringify(t.content[e]));n.id=void 0;var a=n.title.replace("Yoga studios in",c.rankTitle);n.title=a;var r=c.tags;n.tags=r,a.indexOf("Pacific Beach")>-1&&(n.tags=n.tags+" pb"),a.indexOf("Ocean Beach")>-1&&(n.tags=n.tags+" ob"),a.indexOf("Mission Beach")>-1&&(n.tags=n.tags+" mb"),a.indexOf("in San Diego")>-1&&(n.tags=n.tags+" isMP",n.isatomic=!1),a.indexOf("in Downtown")>-1&&(n.isatomic=!1),n.answers=0,n.views=0,n.answertags="",n.catstr="",s.addTable(n)}l()}else u?m?o.getDialog("rankType"):o.getDialog("rankQuestion"):o.getDialog("rankTitle")}function l(){d={},c.rankTitle="",c.tags="",c.keywords="",c.type="",c.isatomic=!0,c.question="",c.image1url="",c.image2url="",c.image3url=""}var c=this;c.title="addRank";var d={},u=!0,g=!0,m=!0;c.addRanking=r,c.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],c.isAdmin=t.isAdmin,function(){console.log("addRank page Loaded!")}()}angular.module("app").controller("addRank",e),e.$inject=["$location","$rootScope","$state","$stateParams","table","dialog"]}(),function(){"use strict";function e(e,t,n,a,s,o,i,r,l,c,d,u,g,m,p,h){function f(){var e=!0,t=!0,n=!0;return F.rankTitle.length<10&&(i.getDialog("rankTitle"),e=!1),F.tags<5&&(i.getDialog("rankTags"),t=!1),F.question.length<10&&(i.getDialog("rankQuestion"),n=!1),e&&t&&n}function v(){f();var e=[],a=[];if(z&&j&&W){if("add"==t.rankforAnswerMode)m.addTableforAnswer(q,H,t.canswer.id).then(function(){n.go("answerRanksManager")});else if(t.content[J].title!=F.rankTitle+" @ "+t.canswer.name&&(e.push("title"),a.push(F.rankTitle+" @ "+t.canswer.name)),t.content[J].question!=F.question&&(e.push("question"),a.push(F.question)),e.length>0&&m.update(t.content[J].id,e,a).then(function(){n.go("answerRanksManager")}),F.bc!=K[t.rankIdx].bc||F.fc!=K[t.rankIdx].fc){K[t.rankIdx].bc=F.bc,K[t.rankIdx].fc=F.fc;var s=JSON.stringify(K);l.updateAnswer(t.canswer.id,["ranks"],[s]).then(function(){n.go("answerRanksManager")})}}else z?W?i.getDialog("rankType"):i.getDialog("rankQuestion"):i.getDialog("rankTitle")}function b(){f()&&(Y={},q={},q.category=F.rankTitle,q.type=F.type,q.tags=F.tags,q.question=F.question,q.user=t.user.id,q.timestmp=Date.now(),q.bc=F.bc,q.fc=F.fc,q.shade=F.shade,q.keywords="",q.fimage=F.image,q.scope=t.SCOPE,s.addCategory(q).then(function(e){Y={},Y.views=0,Y.answers=0,Y.numcom=0,Y.ismp=!0,Y.isatomic=!0,Y.cat=e.resource[0].id,Y.nh=1,Y.scope=t.SCOPE,m.addTable(Y).then(function(e){$(Y.cat),Q=e,i.notificationWithCallback("Success!","Your ranking has been created succesfully! <br><br> Now add items to rank and don't forget to share your ranking with other users!",y)}),t.DEBUG_MODE&&console.log("category added --- ",e)}))}function y(){n.go("rankSummary",{index:Q})}function w(e){1==e&&(F.rankType="ESTABLISHMENTS",F.type="Establishment"),2==e&&(F.rankType="PEOPLE",F.type="Person"),3==e&&(F.rankType="ORGANIZATIONS",F.type="Organization"),4==e&&(F.rankType="PLACES",F.type="Place"),5==e&&(F.rankType="OPINIONS",F.type="Short-Phrase"),6==e&&(F.rankType="CONTRACTORS",F.type="PersonCust"),7==e&&(F.rankType="ITEM / OBJECTS",F.type="Thing"),8==e&&(F.rankType="EVENTS",F.type="Event"),F.step=3}function k(e){1==e&&(F.rankCat="FOOD",F.tags="food"),2==e&&(F.rankCat="LIFESTYLE",F.tags="lifestyle"),3==e&&(F.rankCat="HEALTH",F.tags="health"),4==e&&(F.rankCat="SOCIAL",F.tags="social"),5==e&&(F.rankCat="SPORTS",F.tags="sports"),6==e&&(F.rankCat="PERSONALITIES",F.tags="personalities"),7==e&&(F.rankCat="SERVICES",F.tags="services"),8==e&&(F.rankCat="BEAUTY",F.tags="beauty"),9==e&&(F.rankCat="CITY",F.tags="city"),10==e&&(F.rankCat="POLITICS",F.tags="politics"),11==e&&(F.rankCat="SCIENCE & TECH",F.tags="technology"),12==e&&(F.rankCat="LOVE & RELATIONSHIPS",F.tags="dating"),13==e&&(F.rankCat="FAMILY",F.tags="family"),F.step=2}function x(e){F.c1sel=!1,F.c2sel=!1,F.c3sel=!1,F.c4sel=!1,F.c5sel=!1,F.c6sel=!1,1==e&&(F.c1sel=!0),2==e&&(F.c2sel=!0),3==e&&(F.c3sel=!0),4==e&&(F.c4sel=!0),5==e&&(F.c5sel=!0),6==e&&(F.c6sel=!0),R(e)}function R(e){1==e&&(F.bc="brown",F.fc="#f8f8ff"),2==e&&(F.bc="#4682b4",F.fc="#f8f8ff"),3==e&&(F.bc="#008080",F.fc="#f8f8ff"),4==e&&(F.bc="gray",F.fc="#f8f8ff"),5==e&&(F.bc="#a3297a",F.fc="#f8f8ff"),6==e&&(F.bc="#c68c53",F.fc="#f8f8ff"),F.bc2=c.shadeColor(F.bc,F.shade)}function A(){F.shade=F.shade+1,F.shade>10&&(F.shade=10),F.bc2=c.shadeColor(F.bc,F.shade/10)}function E(){F.shade=F.shade-1,F.shade<-10&&(F.shade=-10),F.bc2=c.shadeColor(F.bc,F.shade/10)}function O(){if(void 0==F.rankTitle)i.getDialog("rankTitle");else if(F.rankTitle.indexOf("San Diego")<0&&F.scopeIsCity){F.rankTitle=F.rankTitle+" in San Diego";i.notificationWithCallback("We made an adjustment","Because you are adding a City Ranking, we added 'in San Diego' to your Rank Title.",S)}else S()}function S(){F.similarRanks=o.searchRanks2(F.rankTitle),F.similarRanks.length>0?F.showAlert=!0:T()}function D(){var e=F.imageQuery.replace(" ","+");F.images=[],F.i=0,F.pixabay&&(F.imageLoading=!0,d.search(e).then(function(e){t.DEBUG_MODE&&console.log("Pixabay results - ",e),F.numResults=e.length;for(var n=0;n<F.numResults;n++)F.images.push(e[n]);F.images[F.i]?(F.image=F.images[F.i].previewURL,F.selImageEnable=""):(F.selImageEnable="disabled",i.getDialog("noImages")),F.imageLoading=!1})),F.pexels&&(F.imageLoading=!0,u.reqFromServer(e).then(function(e){var n=e.data.photos;t.DEBUG_MODE&&console.log("Pexels results - ",n),F.numResults=n.length;for(var a=0;a<F.numResults;a++)F.images.push(n[a]);F.images[F.i]?(F.image=F.images[F.i].src.small,F.selImageEnable=""):(F.selImageEnable="disabled",i.getDialog("noImages")),F.imageLoading=!1}))}function C(){F.i=F.i+1,F.i>F.images.length-1&&(F.i=F.images.length-1),F.pixabay&&F.images[F.i]&&(F.image=F.images[F.i].previewURL),F.pexels&&F.images[F.i]&&(F.image=F.images[F.i].src.small)}function I(){F.i=F.i-1,F.i<0&&(F.i=0),F.pixabay&&F.images[F.i]&&(F.image=F.images[F.i].previewURL),F.pexels&&F.images[F.i]&&(F.image=F.images[F.i].src.small)}function P(){F.step=7,F.showAddButton=!0}function T(){F.showAlert=!1,F.step=4}function M(){0==F.tags.length?i.getDialog("rankTags"):F.step=6}function L(){void 0==F.question?i.getDialog("rankQuestion"):F.question.length<10?i.getDialog("rankQuestion"):F.step=5}function N(){i.whatisrankquestion()}function _(){i.getDialog("whataretags")}function $(e){var n=e,a="";F.pixabay&&(a=F.images[F.i].webformatURL),F.pexels&&(a=F.images[F.i].src.medium),a.indexOf("jpg"),a.indexOf("png"),a.indexOf("jpeg");var s=F.rankTitle.toLowerCase();s=s.replace(/ /g,"-"),s=s.replace("?",""),s=s+"-"+n;B(a,s,n),t.DEBUG_MODE&&console.log("Process Image - ",n,a,s)}function B(e,n,a){g({method:"POST",url:"https://server.rank-x.com/ImageServer/SaveImage",headers:{"X-Dreamfactory-API-Key":void 0,"X-DreamFactory-Session-Token":void 0},data:{imageurl:e,filename:n,category:a}}).then(function(e){t.DEBUG_MODE&&console.log("Processing Image Success",e)},function(e){t.DEBUG_MODE&&console.log("Error Processing Image - ",e)})}function U(){"rankSummary"==t.previousState?n.go("rankSummary",{index:t.cCategory.slug}):"answerDetail"==t.previousState?n.go("answerDetail",{index:t.canswer.slug}):t.$emit("backToResults")}function X(e){1==e&&(F.pixabay=!0,F.pexels=!1),2==e&&(F.pixabay=!1,F.pexels=!0)}function G(e){1==e&&(F.scopeIsGeneral=!0,F.scopeIsCity=!1,F.selScopeGeneralText="General"),2==e&&(F.scopeIsGeneral=!1,F.scopeIsCity=!0,F.selScopeGeneralText="City")}function V(){i.imageBank()}var F=this;F.title="addCustomRank",F.goBack=U,F.selType=w,F.selCat=k,F.minusShade=E,F.plusShade=A,F.valRank=O,F.alertOk=T,F.tagsOk=M,F.questionOk=L,F.getImages=D,F.nextImg=C,F.prevImg=I,F.selectImg=P,F.processImage=$,F.whatisrankquestion=N,F.whataretags=_,F.selImgBank=X,F.selScopeGeneral=G,F.imageBanksDialog=V,F.csel=x,F.c1sel=!0,F.showAlert=!1,F.showAddButton=!1,F.selImageEnable="disabled",F.question="Who do you recommend?";var Y={},q={},z=!0,j=!0,W=!0;F.imageLoading=!1,F.editRank=v,F.addRank=b,F.typeList=["Person","Establishment","Place","Activity","Short-Phrase","Organization","Event","Thing","PersonCust"],F.isAdmin=t.isAdmin;var H=[],K=[],J=0,Q=0;r.innerWidth<512?(F.sm=!0,F.nsm=!1):(F.sm=!1,F.nsm=!0),function(){F.resLength=-1,F.rankType="Select ranking type",F.rankCat="Choose a category",F.selScopeGeneralText="Choose Scope...",F.selScopeCityText="San Diego",F.image=t.EMPTY_IMAGE,F.i=0,F.step=1,F.shade=0,R(1),F.buttonLabel="Add Rank",X(1),t.DEBUG_MODE&&console.log("addCustomRank page Loaded!")}()}angular.module("app").controller("addCustomRank",e),e.$inject=["$location","$rootScope","$state","$stateParams","categories","search","dialog","$window","answer","color","pixabay","pexels","$http","table","$timeout","$scope"]}(),function(){"use strict";function e(e,t){var n=[{name:"promote",url:"/promote",parent:"layout",templateUrl:"app/promoters/Partials/promote.html",controller:"promote as vm"}];$(n).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var n=[{name:"login",url:"/login",templateUrl:"app/login/partials/login.html",controller:"login as vm"},{name:"bizlogin",url:"/bizlogin",templateUrl:"app/login/partials/bizlogin.html",controller:"bizlogin as vm"},{name:"register",url:"/register",templateUrl:"app/login/partials/register.html",controller:"register as  vm"}];$(n).each(function(){e.state(this)})}angular.module("login").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var n=[{name:"customer",url:"/customer",views:{"@":{templateUrl:"app/customer/Partials/customer.html",controller:"customer as vm"},"navbar@customer":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"mainphoto",parent:"customer",url:"/mainphoto",templateUrl:"app/customer/Partials/mainphoto.html",controller:"mainphoto as vm"},{name:"photogallery",parent:"customer",url:"/photogallery",templateUrl:"app/customer/Partials/photogallery.html",controller:"photogallery as vm"}];$(n).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){var n=[{name:"admin",url:"/admin",parent:"layout",templateUrl:"app/admin/Partials/admin.html",controller:"admin as vm"},{name:"queries",parent:"admin",url:"/queries",templateUrl:"app/admin/Partials/queries.html",controller:"queries as vm"},{name:"views",parent:"admin",url:"/views",templateUrl:"app/admin/Partials/views.html",controller:"views as vm"},{name:"flags",parent:"admin",url:"/flags",templateUrl:"app/admin/Partials/flags.html",controller:"flags as vm"},{name:"addRank",parent:"admin",url:"/addRank",templateUrl:"app/admin/Partials/addRank.html",controller:"addRank as vm"},{name:"dbMaint",parent:"admin",url:"/dbMaint",templateUrl:"app/admin/Partials/dbMaint.html",controller:"dbMaint as vm"},{name:"mergeAnswers",parent:"admin",url:"/mergeAnswers",templateUrl:"app/admin/Partials/mergeAnswers.html",controller:"mergeAnswers as vm"},{name:"dbQuery",parent:"admin",url:"/dbQuery",templateUrl:"app/admin/Partials/dbQuery.html",controller:"dbQuery as vm"},{name:"imagesmod",parent:"admin",url:"/imagemod",templateUrl:"app/admin/Partials/imagesmod.html",controller:"imagesmod as vm"},{name:"updateHeaders",parent:"admin",url:"/updateHeaders",templateUrl:"app/admin/Partials/updateHeaders.html",controller:"updateHeaders as vm"},{name:"foodRanks",parent:"admin",url:"/foodRanks",templateUrl:"app/admin/Partials/foodRanks.html",controller:"foodRanks as vm"},{name:"sibLocs",parent:"admin",url:"/sibLocs",templateUrl:"app/admin/Partials/sibLocs.html",controller:"sibLocs as vm"},{name:"payment",parent:"admin",url:"/payment",templateUrl:"app/admin/Partials/payment.html",controller:"payment as vm"},{name:"plan",parent:"admin",url:"/plan",templateUrl:"app/admin/Partials/plan.html",controller:"plan as vm"},{name:"bizadmin",parent:"admin",url:"/bizadmin",templateUrl:"app/admin/Partials/bizadmin.html",controller:"bizadmin as vm"},{name:"cleandb",parent:"admin",url:"/cleandb",templateUrl:"app/admin/Partials/cleandb.html",controller:"cleandb as vm"},{name:"rodconsole",url:"/rodconsole",parent:"layout",templateUrl:"app/admin/Partials/rodconsole.html",controller:"rodconsole as vm"}];$(n).each(function(){e.state(this)})}angular.module("app").config(["$stateProvider","$urlRouterProvider",e])}();var openModal=function(e,t){$(e).modal({backdrop:!t||1!=t.backdrop&&0!=t.backdrop?"static":t.backdrop,keyboard:t&&t.keyboard?t.keyboard:"false",show:"true"})},closeModal=function(e,t){$(e).modal("hide"),t&&t()};!function(){"user strict";angular.module("app").constant("INSTANCE_URL","https://api.rank-x.com").constant("APP_API_KEY","da4f7e05b7afc5beffe8d9d416abec73cf98ef89e3703beeb5144f325be5decc").constant("GOOGLE_API_KEY","AIzaSyC2gAzj80m1XpaagvunSDPgEvOCleNNe5A").constant("DEBUG_MODE",!1).constant("EMPTY_IMAGE","../../../assets/images/noimage.jpg").constant("INSTAGRAM_CLIENT_ID","c46745e083b7451a99461240e01da20b").constant("SERVER_URL","https://server.rank-x.com/").constant("STRIPE_CLIENT_ID","ca_AdOtLByD0cfx8W3d76nnKqLjruvHmGlh")}(),function(){"use strict";function e(e,t,n){t.otherwise("/home");var a=[{name:"layout",abstract:!0,url:"",views:{"@":{templateUrl:"app/layout/Partials/layout.html",controller:"layout as vm"},"navbar@layout":{templateUrl:"app/layout/Partials/navbar.html",controller:"navbar as vm"}}},{name:"cwrapper",parent:"layout",url:"/home",templateUrl:"app/layout/Partials/cwrapper.html",controller:"cwrapper as vm"},{name:"rankSummary",parent:"layout",url:"/rankSummary/:index",templateUrl:"app/rank/Partials/RankSummary.html",controller:"rankSummary as vm"},{name:"editRanking",parent:"layout",url:"/editRanking/:index",templateUrl:"app/rank/Partials/editRanking.html",controller:"editRanking as vm"},{name:"addAnswer",parent:"layout",url:"/addAnswer",templateUrl:"app/answer/Partials/addAnswer.html",controller:"addAnswer as vm"},{name:"addEvent",parent:"layout",url:"/addEvent",templateUrl:"app/answer/Partials/addEvent.html",controller:"addEvent as vm"},{name:"editAnswer",parent:"layout",url:"/editAnswer/:index",templateUrl:"app/answer/Partials/editAnswer.html",controller:"editAnswer as vm"},{name:"specials",parent:"layout",url:"/specials",templateUrl:"app/customer/Partials/specials.html",controller:"specials as vm"},{name:"editspecial",parent:"layout",url:"/editspecial",templateUrl:"app/customer/Partials/editspecial.html",controller:"editspecial as vm"},{name:"addRankforAnswer",parent:"layout",url:"/addRankforAnswer",templateUrl:"app/admin/Partials/addRankforAnswer.html",controller:"addRankforAnswer as vm"},{name:"answerDetail",parent:"layout",url:"/answerDetail/:index",templateUrl:"app/answer/Partials/answerDetail.html",controller:"answerDetail as vm"},{name:"answerRanksManager",parent:"layout",url:"/answerRanksManager",templateUrl:"app/answer/Partials/answerRanksManager.html",controller:"answerRanksManager as vm"},{name:"editvrows",parent:"layout",url:"/editvrows",templateUrl:"app/customer/Partials/editvrows.html",controller:"editvrows as vm"},{name:"addCustomRank",parent:"layout",url:"/addCustomRank",templateUrl:"app/admin/Partials/addCustomRank.html",controller:"addCustomRank as vm"},{name:"match",parent:"layout",url:"/match",templateUrl:"app/rank/Partials/match.html",controller:"match as vm"},{name:"about",url:"/about",parent:"layout",templateUrl:"app/layout/Partials/about.html",controller:"about as vm"},{name:"privacypolicy",url:"/privacypolicy",parent:"layout",templateUrl:"app/layout/Partials/privacypolicy.html",controller:"privacypolicy as vm"},{name:"cutomertos",url:"/terms-of-service/customers",parent:"layout",templateUrl:"app/layout/Partials/customertos.html",controller:"customertos as vm"},{name:"promotertos",url:"/terms-of-service/promoters",parent:"layout",templateUrl:"app/layout/Partials/promotertos.html",controller:"promotertos as vm"},{name:"mybusiness",url:"/mybusiness",parent:"layout",templateUrl:"app/layout/Partials/mybusiness.html",controller:"mybusiness as vm"},{name:"promoterconsole",url:"/promoterconsole",parent:"layout",templateUrl:"app/promoters/Partials/promoterconsole.html",controller:"promoterconsole as vm"},{name:"promotersignup",url:"/promotersignup",parent:"layout",templateUrl:"app/promoters/Partials/promotersignup.html",controller:"promotersignup as vm"},{name:"favs",parent:"layout",url:"/favs",templateUrl:"app/layout/Partials/favs.html",controller:"favs as vm"},{name:"feeds",parent:"layout",url:"/feeds",templateUrl:"app/layout/Partials/feeds.html",controller:"feeds as vm"},{name:"trends",parent:"layout",url:"/trends",templateUrl:"app/layout/Partials/trends.html",controller:"trends as vm"}];$(a).each(function(){e.state(this)}),n.html5Mode(!0)}
angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",e])}(),function(){"use strict";function e(e,t,n,a){e.interceptors.push("httpInterceptor"),n.setAppId("1102409523140826"),a.resourceUrlWhitelist(["self","https://api.instagram.com/**"])}angular.module("app").config(e),e.$inject=["$httpProvider","$locationProvider","$facebookProvider","$sceDelegateProvider"]}(),function(){"use strict";function e(e,t,n,a,s){t.defaults.headers.common["X-Dreamfactory-API-Key"]=a,t.defaults.headers.common["X-DreamFactory-Session-Token"]=e.session_token;var o=s.location.hash.replace("#access_token=","").split("&")[0];if(-1!=s.location.hash.indexOf("access_token")){console.log("opener",s.opener);s.opener.angular.element(s.opener.document).scope().$broadcast("igAccessTokenObtained",{access_token:o}),s.close()}}angular.module("app").run(e),e.$inject=["$cookies","$http","$rootScope","APP_API_KEY","$window"]}(),angular.module("app").run(["$templateCache",function(e){e.put("app/admin/Partials/addCustomRank.html",'<div class="container"><h4>Add a New Rank</h4><br><br><label><strong>Choose the best category for your ranking:</strong></label><div class="dropdown" style="padding-bottom:10px"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="nhdropdown" style="width:100%">{{vm.rankCat}}&nbsp&nbsp<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-middle"><li ng-click="vm.selCat(1)"><a>FOOD</a></li><li ng-click="vm.selCat(2)"><a>LIFESTYLE</a></li><li ng-click="vm.selCat(3)"><a>HEALTH</a></li><li ng-click="vm.selCat(4)"><a>SOCIAL</a></li><li ng-click="vm.selCat(5)"><a>SPORTS</a></li><li ng-click="vm.selCat(6)"><a>PERSONALITIES</a></li><li ng-click="vm.selCat(7)"><a>SERVICES</a></li><li ng-click="vm.selCat(8)"><a>BEAUTY</a></li><li ng-click="vm.selCat(9)"><a>CITY</a></li><li ng-click="vm.selCat(10)"><a>POLITICS</a></li><li ng-click="vm.selCat(11)"><a>SCIENCE & TECH</a></li><li ng-click="vm.selCat(12)"><a>LOVE & RELATIONSHIPS</a></li><li ng-click="vm.selCat(13)"><a>FAMILY</a></li><li ng-click="vm.selCat(14)"><a>OTHER</a></li></ul></div><div ng-if="vm.step > 1"><label><strong>What are you ranking?</strong></label><div class="dropdown" style="padding-bottom:10px"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="nhdropdown" style="width:100%">{{vm.rankType}}&nbsp&nbsp<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-middle"><li ng-click="vm.selType(1)"><a><strong>ESTABLISHMENTS</strong> - i.e. Restaurants, Shops, Gyms</a></li><li ng-click="vm.selType(2)"><a><strong>PEOPLE</strong> - i.e. Athletes, Celebrities, Politicians</a></li><li ng-click="vm.selType(3)"><a><strong>ORGANIZATIONS</strong> - i.e. Companies, Brands</a></li><li ng-click="vm.selType(4)"><a><strong>PLACES</strong> - i.e. Physical Landmarks, Beaches, Parks, etc.</a></li><li ng-click="vm.selType(5)"><a><strong>OPINIONS</strong> - i.e. Favorite things, Things people like, etc.</a></li><li ng-click="vm.selType(6)"><a><strong>CONTRACTORS</strong> - i.e. Freelancers, Handyman, Tutors, etc.</a></li><li ng-click="vm.selType(7)"><a><strong>ITEM / OBJECTS</strong> - i.e. Souvenier, Products, etc.</a></li><li ng-click="vm.selType(8)"><a><strong>EVENTS</strong> - i.e. Parties, Festivals, etc</a></li></ul></div></div><div ng-if="vm.step > 2"><label><strong>Ranking Title:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="i.e. The best fish tacos in San Diego" ng-model="vm.rankTitle"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.valRank()" type="button">Validate</button></span></div><div class="alert alert-warning" ng-if="vm.showAlert&&vm.similarRanks.length>0" style="padding-bottom:0px;margin-bottom:0px;"><strong>Please confirm.</strong> There are similar rankings to the one you are trying to create. If this ranking is different to any of the existing rankings below, click \'Continue\'. If not, please cancel and expand on the already existing rankings.<br><div ng-repeat="x in vm.similarRanks">&nbsp- {{x.title}}<br></div><div class="text-center"><button class="btn btn-default" ng-click="vm.alertOk()">Continue</button> <button class="btn btn-default" ng-click="vm.goBack()">Cancel</button></div></div><div class="alert alert-success" ng-if="vm.showAlert&&vm.similarRanks.length==0"><strong>Good one!</strong> This rank does not seem to have any duplicates.<br><div class="text-right"><button class="btn btn-default" ng-click="vm.alertOk()">Ok</button></div></div></div><div ng-if="vm.step > 3"><label><strong>Ranking Question:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="i.e. Who makes the better fish tacos?" ng-model="vm.question"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.questionOk()" type="button">Ok</button></span></div><div class="text-right"><a href="" ng-click="vm.whatisrankquestion()">What is this?</a></div></div><div ng-if="vm.step > 4"><label><strong>Tags</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="tags separated by blank space, i.e. food seafood fish" ng-model="vm.tags"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.tagsOk()" type="button">Ok</button></span></div><div class="text-right"><a href="" ng-click="vm.whataretags()">What are tags?</a></div></div><div ng-if="vm.step > 5"><div class="alert alert-info" ng-if="vm.step == 6"><strong>Select Image</strong><br>1. Enter a query and click the \'Search Images\' button.<br>2. Navigate the available images using the \'<<\' and="" \'="">>\' buttons.<br>3. When you find an image you like, click \'Select Image\'.<br><br></\'></div><br><button class="btn btn-default" ng-click="vm.imageBanksDialog()"><i class="fa fa-question"></i></button> <label><strong>Select Image Bank:</strong></label><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><img src="../../../assets/images/pixabay-logo.png" ng-click="vm.selImgBank(1)" alt="Pixabay" style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;border-color:{{vm.pixabay ? \'black\':\'white\'}}"></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><img src="../../../assets/images/pexels-logo.png" ng-click="vm.selImgBank(2)" alt="Pexels" style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;border-color:{{vm.pexels ? \'black\':\'white\'}}"></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><label><strong>Image Query:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="Enter what to search for an image, i.e. taco" ng-model="vm.imageQuery"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.getImages()" type="button">Search Images</button></span></div><div class="text-center"><div class="btn-group"><button class="btn btn-default" ng-click="vm.prevImg()">&nbsp&nbspPrev&nbsp&nbsp</button> <button class="btn btn-default" ng-click="vm.nextImg()">&nbsp&nbspNext&nbsp&nbsp</button></div><button class="btn btn-success {{vm.selImageEnable}}" ng-click="vm.selectImg()">Select Image</button></div></div><br><div ng-if="vm.step > 6"><div class="alert alert-info" ng-if="vm.step == 7"><strong>Select Title Box Background Color</strong><br>1. Select a background color.<br>2. Adjust the shade factor to create attractive visual with your image.<br>3. When you are ready to submit, click the \'Add Rank\' button.</div><label><strong>Select Color Design:</strong></label><div class="container"><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(1)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c1sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:brown"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(2)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c2sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#4682b4"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(3)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c3sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#008080"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(4)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c4sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:gray"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(5)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c5sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#a3297a"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(6)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c6sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#c68c53"></div></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><div class="row" style="padding-top:10px"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="btn-group col-xs-6"><button class="btn btn-primary" ng-click="vm.minusShade()">&nbsp&nbsp<i class="fa fa-minus"></i>&nbsp&nbsp</button> <button class="btn btn-primary" ng-click="vm.plusShade()">&nbsp&nbsp<i class="fa fa-plus"></i>&nbsp&nbsp</button></div></div></div></div><div class="container" ng-if="vm.step > 5"><div class="row"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">Preview</h3></div></div></div><div class="row" style="padding-bottom:10px"><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div><div class="container-bgbox col-xs-6 col-sm-3 col-md-2 col-lg-2"><bg-box bc="{{vm.bc}}" bc2="{{vm.bc2}}" fc="{{vm.fc}}" text="{{vm.rankTitle}}" dir="horizontal" w="100%" h="{{vm.sm ? \'150px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img ng-src="{{vm.image}}" ng-if="!vm.imageLoading" ng-attr-style="width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"><div ng-attr-style="position:relative;width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};" ng-if="vm.imageLoading"><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px;position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"></div></div><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div></div></div><br><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.addRank()" ng-show="vm.showAddButton">{{vm.buttonLabel}}</button></div><br><br></div>'),e.put("app/admin/Partials/addRank.html",'<br><div class="row" ng-if="vm.isAdmin"><div class="col-sm-1"></div><div class="col-sm-10"><h4>Add Ranking</h4><label class="checkbox-inline"><input type="checkbox" ng-model="vm.allNh" value="">All Neighborhoods</label><p>To add a ranking to all neighborhoods, type title without actual neighborhood name:</p><p>For instance, for \'Best pizza in ###? , simply type \'Best pizza in\' and select the checkbox</p><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"><br><div class="form-group text-right"><button type="button" class="btn btn-primary" ng-click="vm.addRanking()">Add</button></div></div><div class="col-sm-1"></div></div>'),e.put("app/admin/Partials/addRankforAnswer.html",'<br><h4>Add Ranking</h4><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"><div class="text-right"><a href="" ng-click="">What is this?</a></div><div class="form-group" style="padding:5px"><label class="control-label">Intro:</label> <textarea class="form-control" ng-model="vm.introtext" placeholder="{{vm.introtext}}" rows="4"></textarea></div><br><div class="row"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div><h4>Preview</h4><div class="container" ng-if="true"><div class="row" ng-if="vm.type != \'Short-Phrase\'"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header">The Favorites</h3></div></div></div><div class="row"><div class="container col-xs-6 col-sm-3 col-md-2 col-lg-2" ng-attr-style="background-color:{{vm.bc}};color:{{vm.fc}};height:{{vm.sm ? \'120px\':\'150px\'}};margin:0px;padding:0px;border:0px;position:relative;"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rankTitle}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rankTitle}}</h3></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img src="../../../assets/images/noimage.jpg" ng-attr-style="width:100%;height:{{vm.sm ? \'120px\':\'150px\'}};"></div></div></div><br><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.addRankingforAnswer()">{{vm.buttonLabel}}</button></div>'),e.put("app/admin/Partials/admin.html",'<div ui-view="navbar"></div><br><div ng-if="!vm.dataready"><h2>Please wait, loading all admin data...</h2></div><div ng-if="vm.dataready"><div class="text-center" ng-if="vm.isAdmin"><div class="btn-group"><button class="btn btn-default {{vm.selKeywords}}" ng-click="vm.keywords()">Searched-Keyword</button> <button class="btn btn-default {{vm.selViews}}" ng-click="vm.views()">Ranking-Answers Views</button> <button class="btn btn-default {{vm.selFlags}}" ng-click="vm.flags()">Answer Flags</button> <button class="btn btn-default {{vm.selAddRanking}}" ng-click="vm.addRank()">Add Ranking</button> <button class="btn btn-default {{vm.selDbMaint}}" ng-click="vm.dbMaint()">dB Maint</button> <button class="btn btn-default {{vm.selQuery}}" ng-click="vm.dbQuery()">Query</button> <button class="btn btn-default {{vm.selSibLocs}}" ng-click="vm.sibLocs()">Sibbling Locations</button> <button class="btn btn-default {{vm.selFoodRanks}}" ng-click="vm.foodranks()">Food Ranks</button> <button class="btn btn-default {{vm.selPayment}}" ng-click="vm.payment()">Payment</button> <button class="btn btn-default {{vm.selPlan}}" ng-click="vm.plan()">Plan</button> <button class="btn btn-default" ng-click="vm.bizAdmin()">Business</button> <button class="btn btn-default" ng-click="vm.cleanDB()">Clean DB</button> <button class="btn btn-default" ng-click="vm.modImages()">Moderate Images</button> <button class="btn btn-danger" ng-click="vm.applyRule()">Apply Rule</button></div></div><div ng-if="vm.dataAdmin"><button class="btn btn-default {{vm.selQuery}}" ng-click="vm.dbQuery()">Query</button> <button class="btn btn-default {{vm.selSibLocs}}" ng-click="vm.sibLocs()">Sibbling Locations</button></div><div ng-if="vm.modAdmin"><button class="btn btn-default" ng-click="vm.modImages()">Moderate Images</button></div></div><br><br><div ui-view=""></div><br><br>'),e.put("app/admin/Partials/bizadmin.html",'<br><div class="row" ng-if="vm.isAdmin"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading your business information...</p></div></div><div ng-if="vm.dataReady"><div style="margin-left:40px; margin-right:40px"><h3>Businesses</h3><div class="pull-right"><button class="btn btn-default" ng-class="vm.showFilter == 0 ? \'active\' : \'\'" ng-click="vm.setShowAll()">Show All</button> <button class="btn btn-default" ng-class="vm.showFilter == 1 ? \'active\' : \'\'" ng-click="vm.setShowPurchases()">Show Only Purchaces</button> <button class="btn btn-default" ng-class="vm.showFilter == 2 ? \'active\' : \'\'" ng-click="vm.setShowNonPurchases()">Show Only Non-Purchaces</button> <button class="btn btn-default" ng-class="vm.showUserFilter ? \'active\' : \'\'" ng-click="vm.showUser()">Show User</button> <button class="btn btn-warning" ng-class="vm.showUserFilter ? \'active\' : \'\'" ng-click="vm.deleteSelected()">Delete Selected</button></div><div class="clearfix"></div><table datatable="ng" class="table" dt-options="vm.dtOptions" dt-columns="vm.dtColumns" dt-instance="vm.dtInstance" ng-if="!vm.loading"><thead style="border-style:none;"><tr><th></th><th>Business Name</th><th>Type</th><th>Activity</th><th ng-if="vm.showUserFilter">User</th><th ng-if="vm.showUserFilter">Email</th></tr></thead><tbody><tr ng-repeat="biz in vm.filtered" style="cursor:pointer;">{{vm.filtered.length}}<td><input type="checkbox" ng-model="biz.checked"></td><td>{{biz.answerObj.name}}</td><td>{{biz.bizcat}}</td><td style="padding: 0px;display: inline; height: 100%"><div ng-if="!biz.ispreminum && !biz.hasranks" style="background-color: #ffe699; padding:10px 18px; min-width: 160px" class="text-center">Account Bind</div><div ng-if="biz.ispreminum || biz.hasranks" class="text-center" style="min-width:200px ; min-width: 160px"><div ng-if="biz.ispreminum" style="background-color: #a9d18e; float:left; width:50%; padding:10px 18px" class="text-center">Preminum</div><div ng-if="!biz.ispreminum" style="background-color: #d9d9d9;float:left; width:50%; padding:10px 18px" class="text-center">No Preminum</div><div ng-if="biz.hasranks" style="background-color: #a9d18e; float:left; width:50%; padding:10px 18px" class="text-center">{{biz.ranksqty}} Ranks</div><div ng-if="!biz.hasranks" style="background-color: #d9d9d9; float:left; width:50%; padding:10px 18px" class="text-center">No Ranks</div></div></td><td ng-if="vm.showUserFilter">{{biz.username}}</td><td ng-if="vm.showUserFilter">{{biz.email}}</td></tr></tbody></table></div></div></div>'),e.put("app/admin/Partials/cleandb.html",'<br><div class="row" ng-if="vm.isAdmin"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading your DB information...</p></div></div><div style="min-height: 200px" ng-hide="vm.dataReady"></div><div ng-if="vm.dataReady"><div style="margin-left:40px; margin-right:40px"><h3>Catans(Duplicated)</h3><div class="pull-right"><button class="btn btn-warning" ng-click="vm.deleteSelectedCatans()">Delete Duplication in Selected Catans</button></div><div class="clearfix"></div><div ng-if="!vm.deletingCatans"><table datatable="ng" class="table" dt-options="vm.dtOptions" dt-columns="vm.dtColumns" dt-instance="vm.dtInstanceCatans"><thead style="border-style:none;"><tr><th></th><th>Category</th><th>Answer</th><th>Duplication</th></tr></thead><tbody><tr ng-repeat="biz in vm.filteredCatans" style="cursor:pointer;"><td><input type="checkbox" ng-model="biz[0].checked"></td><td>{{biz[0].category}}</td><td>{{biz[0].answer}}</td><td>{{biz.length}}</td></tr></tbody></table></div><div ng-if="vm.deletingCatans"><h6>Deleting Duplication...</h6></div></div><div style="margin-left:40px; margin-right:40px"><h3>Categories(Have no Rankings)</h3><div class="pull-right"><button class="btn btn-warning" ng-click="vm.deleteSelectedCategories()">Delete Selected Unlinked Categories</button></div><div class="clearfix"></div><div ng-if="!vm.deletingCategories"><table datatable="ng" class="table" dt-options="vm.dtOptionsCategories" dt-columns="vm.dtColumnsCategories" dt-instance="vm.dtInstanceCategories"><thead style="border-style:none;"><tr><th></th><th>ID</th><th>Category</th><th>Type</th></tr></thead><tbody><tr ng-repeat="biz in vm.filteredCategories" style="cursor:pointer;"><td><input type="checkbox" ng-model="biz.checked"></td><td>{{biz.id}}</td><td>{{biz.category}}</td><td>{{biz.type}}</td></tr></tbody></table></div><div ng-if="vm.deletingCategories"><h6>Deleting Unlinked Categories...</h6></div></div><div style="margin-left:40px; margin-right:40px"><h3>Answers(Have no Reference)</h3><div class="pull-right"><button class="btn btn-warning" ng-click="vm.deleteSelectedAnswers()">Delete Selected Unreferenced Answers</button></div><div class="clearfix"></div><div ng-if="!vm.deletingAnswer"><table datatable="ng" class="table" dt-options="vm.dtOptionsAnswers" dt-columns="vm.dtColumnsAnswer" dt-instance="vm.dtInstanceAnswers"><thead style="border-style:none;"><tr><th></th><th>ID</th><th>Image</th><th>Name</th></tr></thead><tbody><tr ng-repeat="biz in vm.filteredAnswers" style="cursor:pointer;"><td><input type="checkbox" ng-model="biz.checked"></td><td>{{biz.id}}</td><td><img style="width:100px;height:100px" ng-src="{{biz.imageurl}}"></td><td>{{biz.name}}</td></tr></tbody></table></div><div ng-if="vm.deletingAnswers"><h6>Deleting Unreferenced Answers...</h6></div></div><div style="margin-left:40px; margin-right:40px"><h3>Rankings(Have no Answers)</h3><div class="pull-right"><button class="btn btn-warning" ng-click="vm.deleteSelectedRankings()">Delete Selected Unreferenced Rankings</button></div><div class="clearfix"></div><div ng-if="!vm.deletingRanking"><table datatable="ng" class="table" dt-options="vm.dtOptionsRankings" dt-columns="vm.dtColumnsRanking" dt-instance="vm.dtInstanceRankings"><thead style="border-style:none;"><tr><th></th><th>ID</th><th>Title</th><th>Type</th></tr></thead><tbody><tr ng-repeat="biz in vm.filteredRankings" style="cursor:pointer;"><td><input type="checkbox" ng-model="biz.checked"></td><td>{{biz.id}}</td><td>{{biz.title}}</td><td>{{biz.type}}</td></tr></tbody></table></div><div ng-if="vm.deletingRankings"><h6>Deleting Unreferenced Rankings...</h6></div></div><div style="margin-left:40px; margin-right:40px"><h3>Feature Images(Have no Reference)</h3><div class="pull-right"><button class="btn btn-warning" ng-click="vm.deleteSelectedFImages()">Delete Selected Unreferenced FImages</button></div><div class="clearfix"></div><div ng-if="!vm.deletingFImages"><table datatable="ng" class="table" dt-options="vm.dtOptionsFImages" dt-columns="vm.dtColumnsFImages" dt-instance="vm.dtInstanceFImages"><thead style="border-style:none;"><tr><th></th><th>Image</th></tr></thead><tbody><tr ng-repeat="biz in vm.filteredFImages" style="cursor:pointer;"><td><input type="checkbox" ng-model="biz.checked"></td><td><img style="width:100px;height:100px" ng-src="{{biz.url}}" <="" td=""></td></tr></tbody></table></div><div ng-if="vm.deletingFImages"><h6>Deleting Unreferenced Feature Images...</h6></div></div></div></div>'),e.put("app/admin/Partials/dbMaint.html",'<div class="container" ng-if="vm.isAdmin"><h1>Database Maintenance</h1><button class="btn btn-success" ng-click="vm.showUrefAns()">Unreferenced Answers</button><br><button class="btn btn-danger" ng-click="vm.deleteAnswers()">Delete Answers</button> <button class="btn btn-default" ng-click="vm.showPossibleDuplicated()">Show Possible Duplicated</button> <button class="btn btn-default" ng-click="vm.showDuplicatedOnlyName()">Show Duplicated Only Name</button> <button class="btn btn-default" ng-click="vm.showDuplicatedByLocation()">Show Duplicated By Location</button><br><button class="btn btn-default" ng-click="vm.findPhoneWebsite()">Phone Numbers & Website</button><br><button class="btn btn-default" ng-click="vm.findDuplicatedRanks()">Duplicated Ranks</button><br><button class="btn btn-default" ng-click="vm.clearAllCatansVotes()">Clear Catans Votes</button><br><button class="btn btn-default" ng-click="vm.syncUserVotes()">Sync User Votes</button><br><button class="btn btn-default" ng-click="vm.estDistances()">Establishment Distances</button><br><button class="btn btn-default" ng-click="vm.createImagesJSON()">createImagesJSON</button><br><button class="btn btn-default" ng-click="vm.updateUrls()">updateUrls</button><br><button class="btn btn-default" ng-click="vm.getAnswerBizCode()">getAnswerBizCode</button><br><button class="btn btn-default" ng-click="vm.getSlugs()">get Slugs</button><br><br><div ng-if="vm.unrefans"><div ng-repeat="x in vm.unrefans" ng-click="vm.selAns(x)"><h4 class="text-left">{{$index+1}}. {{x.name}}</h4><img src="{{x.imageurl}}" style="width:120px"><br>Id: {{x.id}} Added by User: {{x.userid}}<br>Neighborhood: {{x.cityarea}}<br>Address: {{x.location}}<br>Website: {{x.website}}<br>Phone: {{x.phone}}<br>Additional Info: {{x.addinfo}}<br><button class="btn btn-danger" ng-click="vm.delAnswer(x)">Delete Answer</button><br><div ng-if="vm.ans == x.id"><label>Add Catans</label> <input type="text" class="form-control" ng-model="vm.addctsval" bs-options="c for c in vm.addctsopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts()">Add</button></span></div></div></div><div ng-if="vm.ansNoCode"><div ng-repeat="x in vm.ansNoCode" ng-click="vm.selAns(x)"><p class="text-left"><strong>{{$index}}.&nbsp{{x.name}}&nbsp-&nbsp{{x.bizcat}}</strong></p><div ng-repeat="y in x.cats"><p class="text-left">{{y}}</p></div><div ng-if="vm.ans == x.id"><label>Category</label> <input type="text" class="form-control" ng-model="vm.catcode.category"> <label>Code</label> <input type="text" class="form-control" ng-model="vm.catcode.code" bs-options="c for c in vm.codes" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcatcode()">Add Category-Code Pair</button></span></div></div></div><div ng-repeat="x in vm.dupAnswers track by $index"><img src="{{x.image1}}" ng-attr-style="width:120px"> <img src="{{x.image2}}" style="width:120px"><p>{{x.name1}} --- {{x.idx1}} --- {{x.loc1}} --- {{x.nh1}} --- {{x.add1}} --- {{x.id1}}</p><p>{{x.name2}} --- {{x.idx2}} --- {{x.loc2}} --- {{x.nh2}} --- {{x.add2}} --- {{x.id2}}</p><button class="btn btn-default" ng-click="vm.syncToFirst(x)">Sync 1st</button> <button class="btn btn-default" ng-click="vm.syncToSecond(x)">Sync 2nd</button><p>-------------------------------------------------------</p></div><div ng-repeat="x in vm.dupAnsNames track by $index"><img src="{{x.image1}}" ng-attr-style="width:120px"> <img src="{{x.image2}}" style="width:120px"><p>{{x.name1}} --- {{x.idx1}} --- {{x.loc1}} --- {{x.nh1}} --- {{x.add1}} --- {{x.id1}}</p><p>{{x.name2}} --- {{x.idx2}} --- {{x.loc2}} --- {{x.nh2}} --- {{x.add2}} --- {{x.id2}}</p><button class="btn btn-default" ng-click="vm.syncToFirst(x)">Sync 1st</button> <button class="btn btn-default" ng-click="vm.syncToSecond(x)">Sync 2nd</button><p>-------------------------------------------------------</p></div><p ng-repeat="x in vm.resDupRanks track by $index">{{x.title}} --- {{x.id}}</p><div ng-repeat="x in vm.syncp">{{x.answername}} - {{x.categoryname}} - caUpV {{x.caUpV}} - nUpVotes {{x.nUpVlen}} - caDownV {{x.caDownV}} - nDownVotes {{x.nDownVlen}} <button class="btn btn-primary" ng-click="vm.updatecatans(x)">Fix</button></div><div ng-repeat="x in vm.answerdist"><div class="row">{{x.name}} - {{x.location}} - {{x.dist}} <button class="btn btn-default" ng-click="vm.gotoAnswer(x)">Go to Answer</button> <button class="btn btn-primary" ng-click="vm.selEditAddress(x)">Edit</button></div><div ng-if="vm.ans == x.id"><br><input type="text" class="form-control" ng-model="x.location"> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.editAddress(x)">Edit</button></span></div></div><button ng-if="vm.dupAnsRdy" class="btn btn-primary" ng-click="vm.goMerge()">Go Merge Screen</button></div>'),e.put("app/admin/Partials/dbQuery.html",'<div class="container" ng-if="vm.isAdmin"><h1>Database Query</h1><input class="form-control" ng-model="vm.val" placeholder="Enter answer to search"> <button class="btn btn-primary" ng-click="vm.queryAnswer()">Query</button><div ng-repeat="x in vm.ansRes"><h4 class="text-left">{{$index+1}}. {{x.name}}</h4><img src="{{x.imageurl}}" style="width:120px"><br>Id: {{x.id}} Added by User: {{x.userid}}<br>Neighborhood: {{x.cityarea}}<br>Address: {{x.location}}<br>Website: {{x.website}}<br>Phone: {{x.phone}}<br>Additional Info: {{x.addinfo}}<br><button class="btn btn-danger" ng-click="vm.delAnswer(x)">Delete Answer</button><br>Categories<br><div ng-repeat="y in x.catans">{{y.title}}---cat:{{y.catid}}---c:{{y.id}}---r:{{y.category}}---a:{{y.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(y)">Delete Catans</button><br></div></div></div>'),
e.put("app/admin/Partials/flags.html",'<h1>Flags</h1><br><button class="btn btn-danger" ng-click="vm.getFlags()">Get Flags</button><table class="table table-hover cursor" ng-if="vm.viewTable"><tbody><thead><tr><th>No.</th><th>Type</th><th>Flag</th><th>Details</th><th>Go To</th><th>Dismiss</th></tr></thead><tbody><tr ng-repeat="x in vm.flags"><td>{{x.id}}</td><td>{{x.type}}</td><td>{{x.desc}}</td><td><button class="btn btn-default" ng-click="vm.seeDetails(x)">Details</button></td><td><button class="btn btn-success" ng-click="vm.gotoView(x)">Go to</button></td><td><button class="btn btn-warning" ng-click="vm.deleteFlag(x)">Delete Flag</button></td></tr></tbody></tbody></table><div ng-if="vm.viewDetails"><h4>{{vm.data.id}} - {{vm.data.type}} - Reason:&nbsp{{vm.data.desc}}</h4><div ng-if="vm.data.imageurl"><img src="{{vm.data.imageurl}}" style="width:120px"><br></div><div ng-if="vm.data.name">Name: {{vm.data.name}}<br></div><div ng-if="vm.data.location">Address: {{vm.data.location}}<br></div><div ng-if="vm.data.cityarea">Neighborhood: {{vm.data.cityarea}}<br></div><div ng-if="vm.data.phone">Phone: {{vm.data.phone}}<br></div><div ng-if="vm.data.website">Website: {{vm.data.website}}<br></div><div ng-if="vm.data.title">Title: {{vm.data.title}}<br></div><div ng-if="vm.catans">Categories<br><div ng-repeat="y in vm.catans">{{y.rank}} --- {{y.id}} --- {{y.category}} --- {{y.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(y)">Delete Catans</button><br></div></div><div ng-if="vm.comments">Comments<br><div ng-repeat="x in vm.comments">{{x.user}} --- {{x.username}} --- {{x.body}} <button class="btn btn-warning" ng-click="vm.delComment(x)">Delete Comment</button><br></div></div><button class="btn btn default" ng-click="vm.seeFlags()">Back to Flags</button></div>'),e.put("app/admin/Partials/foodRanks.html",'<br><br><h1>Get Food Ranks</h1><br><br><button class="btn btn-primary" ng-click="vm.getRanks()">Get Food Ranks</button>'),e.put("app/admin/Partials/imagesmod.html",'<div class="container"><h1>Images Moderation</h1><div ng-repeat="x in vm.uuis"><img src="{{x.imageurl}}" style="width:200px;height:auto"> {{x.answername}} <button class="btn btn-success" ng-click="vm.approveImage(x)">Approve Image</button> <button class="btn btn-danger" ng-click="vm.removeImage(x)">Remove Image</button></div></div>'),e.put("app/admin/Partials/mergeAnswers.html",'<h1>Merge Answers</h1><br><h3>Pair {{vm.idx}} of {{vm.tot}}</h3><div class="row"><div class="text-left col-xs-6"><button class="btn-success" ng-click="vm.goPrev(50)">&lt;&lt;&lt</button> <button class="btn-success" ng-click="vm.goPrev(10)">&lt;&lt</button> <button class="btn-success" ng-click="vm.goPrev(1)">&lt</button></div><div class="text-right col-xs-6"><button class="btn-success" ng-click="vm.goNext(1)">&gt</button> <button class="btn-success" ng-click="vm.goNext(10)">&gt;&gt</button> <button class="btn-success" ng-click="vm.goNext(50)">&gt;&gt;&gt</button></div></div><br><div class="container"><div class="row"><div class="col-xs-6 col-sm-6 col-lg-6"><h4 class="radio"><input type="radio" ng-model="vm.ans1_NameSel" name="nameOption">{{vm.ans1.name}}</h4><div class="text-left btn-group"><button class="btn btn-danger" ng-click="vm.delAnswer(1)">Delete Answer</button> <button class="btn btn-primary" ng-click="vm.editAnswer(1)">Edit Answer</button></div><br><input type="radio" class="radio-inline" ng-model="vm.ans1_ImageSel" name="imageOption"> <img src="{{vm.ans1.imageurl}}" style="width:40%;height:100px"><p class="text-left"><input type="radio" ng-model="vm.ans1_AddressSel" name="addressOption">&nbsp{{vm.ans1.location}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_NhSel" name="nhOption">&nbsp{{vm.ans1.cityarea}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_PhoneSel" name="phoneOption">&nbsp{{vm.ans1.phone}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_WebsiteSel" name="websiteOption">&nbsp{{vm.ans1.website}}</p><p class="text-left"><input type="radio" ng-model="vm.ans1_AddinfoSel" name="addinfoOption">&nbsp{{vm.ans1.addinfo}}</p><div ng-repeat="y in vm.ans1.catans track by $index">{{y.rank}} --- {{y.id}} --- {{y.category}} --- {{y.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(y)">Delete Catans</button><br></div><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans(1)">Add Catans</button></div><div class="input-group" ng-if="vm.addcts1active"><input type="text" class="form-control" ng-model="vm.addcts1val" bs-options="c for c in vm.addcts1opts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts(1)">Add</button></span></div><label class="checkbox-inline" ng-if="vm.addcts1active"><input type="checkbox" ng-model="vm.cat1isdup">Is Dup</label></div><div class="col-xs-6 col-sm-6 col-lg-6"><h4 class="radio"><input type="radio" ng-model="vm.ans2_NameSel" name="nameOption">{{vm.ans2.name}}</h4><div class="text-left btn-group"><button class="btn btn-danger" ng-click="vm.delAnswer(2)">Delete Answer</button> <button class="btn btn-primary" ng-click="vm.editAnswer(2)">Edit Answer</button></div><br><input type="radio" class="radio-inline" ng-model="vm.ans2_ImageSel" name="imageOption"> <img src="{{vm.ans2.imageurl}}" style="width:40%;height:100px"><p class="text-left"><input type="radio" ng-model="vm.ans2_AddressSel" name="addressOption">&nbsp{{vm.ans2.location}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_NhSel" name="nhOption">&nbsp{{vm.ans2.cityarea}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_PhoneSel" name="phoneOption">&nbsp{{vm.ans2.phone}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_WebsiteSel" name="websiteOption">&nbsp{{vm.ans2.website}}</p><p class="text-left"><input type="radio" ng-model="vm.ans2_AddinfoSel" name="addinfoOption">&nbsp{{vm.ans2.addinfo}}</p><div ng-repeat="x in vm.ans2.catans track by $index">{{x.rank}} --- {{x.id}} --- {{x.category}} --- {{x.answer}} <button class="btn btn-warning" ng-click="vm.delCatans(x)">Delete Catans</button><br></div><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans(2)">Add Catans</button></div><div class="input-group" ng-if="vm.addcts2active"><input type="text" class="form-control" ng-model="vm.addcts2val" bs-options="c for c in vm.addcts2opts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts(2)">Add</button></span></div><label class="checkbox-inline" ng-if="vm.addcts2active"><input type="checkbox" ng-model="vm.cat2isdup">Is Dup</label></div></div></div>'),e.put("app/admin/Partials/notification.drtv.html",'<div><div class="alert fade in" ng-repeat="notification in notifications" ng-class="notification.type==\'success\' ? \'alert-success\' : \'alert-warning\'"><a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a> <strong>{{noticiation.type.toUpperCase()}}</strong> {{notification.message}}</div></div>'),e.put("app/admin/Partials/payment.html",'<br><div class="row" ng-if="vm.isAdmin"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading your promoters information...</p></div></div><div ng-if="vm.dataReady"><div class="container"><h3>Promoters</h3><div style="font-size: 18px; padding: 16px; background-color: darkgray; margin-bottom: 20px; border-radius: 5px;">Current Commission Fee is {{vm.STRIPE_COMMISSION_PERCENTAGE*100}}%. <button class="btn btn-primary pull-right btn-sm" ng-click="vm.changeCommission()">Change</button></div><button ng-class="vm.selectedPromoters.length == 0 ? \'disabled\' : \'\'" class="btn btn-primary pull-right" style="margin-bottom:10px" ng-click="vm.paySelectedPromoters()">Pay Selected Promoters</button><div style="clear:both"></div><table class="table" ng-if="vm.overview"><tbody><thead style="border-style:none;"><tr><th></th><th>Promoter</th><th>Code</th><th>Business On Trial</th><th>Business Active</th><th>Total Fee</th><th>Commission to Promoter</th><th>Last Payed Date</th><th></th></tr></thead><tr ng-repeat="promoter in vm.promoters" style="cursor:pointer;"><td><input type="checkbox" ng-if="!promoter.payedThisMonth" ng-click="vm.addOrRemovePromoter(promoter)"></td><td ng-click="vm.goDetailView(promoter)">{{promoter.firstname + \' \' + promoter.lastname}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.code}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.ontrialCount}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.activeCount}}</td><td ng-click="vm.goDetailView(promoter)">${{promoter.balance / 100}}</td><td ng-click="vm.goDetailView(promoter)">${{promoter.balance / 100 * vm.STRIPE_COMMISSION_PERCENTAGE}}</td><td ng-click="vm.goDetailView(promoter)">{{promoter.lastPaymentDate}}</td><td><button ng-if="!promoter.payedThisMonth" class="btn btn-primary" ng-click="vm.payPromoter(promoter)">Pay</button> <button ng-if="promoter.payedThisMonth" class="btn btn-primary disabled">Paid This Month</button></td></tr></tbody></table><div ng-if="vm.detailview"><table class="table" ng-if="vm.currentPromoter.businesses.length >= 1"><thead style="border-style:none;"><tr><th>Business</th><th>Total Commission After Trial</th><th>Status</th></tr></thead><tbody><tr ng-repeat="x in vm.currentPromoter.businesses" style="cursor:pointer;"><td ng-click="vm.gotoanswer(x.answerObj)">{{x.answerObj.name}}</td><td ng-click="vm.showBusinessDetail(x)">${{x.totalCommission}}</td><td align="middle" ng-attr-style="{{x.style}}" ng-click="vm.showBusinessDetail(x)">{{x.status}}</td></tr></tbody></table><div ng-if="vm.currentPromoter.businesses.length == 0">No Businesses.</div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div></div>'),e.put("app/admin/Partials/plan.html",'<br><div class="row" ng-if="vm.isAdmin"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading plans information...</p></div></div><div id="veil" ng-hide="!vm.isSaving"></div><div id="feedLoading" ng-hide="!vm.isSaving"><div style="text-align: center" ng-if="vm.isSaving"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">saving plan...</p></div></div><div ng-if="vm.dataReady"><div class="container"><h3>Plans</h3><div ng-if="vm.notifications.length != 0"><notification-block notifications="vm.notifications"></notification-block></div><table class="table"><tbody><thead style="border-style:none;"><tr><th>Code</th><th>Price</th><th></th></tr></thead><tr ng-repeat="codeprice in vm.codeprices" style="cursor:pointer;"><td ng-click="vm.goDetailView(promoter)">{{codeprice.code}}</td><td ng-click="vm.goDetailView(promoter)">${{codeprice.price}}</td><td ng-click="vm.goDetailView(promoter)"><button class="btn btn-primary" ng-click="vm.changeCodePrice(codeprice)">Change</button></td></tr></tbody></table></div></div></div>'),e.put("app/admin/Partials/queries.html",'<div class="container" ng-if="vm.isAdmin"><h1>Queries</h1><br><a ng-click="vm.clearDb()" class="btn btn-danger">Clear Database</a><br><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>User Input</th><th>Num. Results</th></tr></thead><tbody><tr ng-repeat="x in vm.queries | orderBy: \'-results\'"><td>{{x.query}}</td><td>{{x.results}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div></div>'),e.put("app/admin/Partials/rodconsole.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">{{vm.loadText}}</p></div></div><div ng-if="vm.dataReady"><div class="container"><div ng-if="vm.overview"><h2>Ranking of the Day Admin Console</h2><div class="row"><div class="col-xs-6"><label class="checkbox-inline"><input type="checkbox" ng-change=\'vm.filterData("all")\' ng-model="vm.allIsSelected" ng-checked="vm.allIsSelected">&nbspAll</label></div><div class="col-xs-6"><label class="checkbox-inline"><input type="checkbox" ng-change=\'vm.filterData("next20")\' ng-model="vm.next20IsSelected" ng-checked="vm.next20IsSelected">&nbspNext 20</label></div></div><br><table class="table"><tbody><thead style="border-style:none;"><tr><th>Date</th><th>Title</th><th>Category</th></tr></thead><tr ng-repeat="x in vm.rods" style="cursor:pointer;" ng-click="vm.selRank(x)"><td align="middle">{{x.datenum}}</td><td align="middle">{{x.title}}</td><td align="middle">{{x.category}}</td><td align="middle" ng-attr-style="background-color:{{x.imageok ? \'palegreen\':\'grey\'}}">{{x.imageok ? \'Ready\':\'None\'}}</td><td align="middle" ng-attr-style="background-color:{{x.textok ? \'palegreen\':\'grey\'}}">{{x.textok ? \'Ready\':\'None\'}}</td></tr></tbody></table></div><div ng-if="vm.detail"><h2>{{vm.rank.title}}</h2><br><p class="text-left"><strong>Date:</strong>{{vm.rank.date}}</p><br><div class="row"><div class="text-right col-xs-6"><label>Background Color:</label></div><div class="col-xs-6"><color-picker ng-model="vm.rank.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div></div><br><div class="row"><div class="text-right col-xs-6"><label>Font Color:</label></div><div class="col-xs-6"><color-picker ng-model="vm.rank.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div></div><br><div class="row"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="col-xs-5 sm-4 md-2 lg-2"><div class="input-group"><span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.minusShade()"><i class="fa fa-minus"></i></button></span> <input style="text-align:center" class="form-control" ng-model="vm.rank.shade" type="text" placeholder="vm.rank.shade"> <span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.plusShade()"><i class="fa fa-plus"></i></button></span></div></div></div><br><div class="row"><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" style="color:{{vm.rank.fc}};height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative; background: {{vm.rank.bc}}; background: -webkit-linear-gradient(left, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: -o-linear-gradient(right, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: -moz-linear-gradient(right, {{vm.rank.bc}}, {{vm.rank.bc2}}); background: linear-gradient(to right, {{vm.rank.bc}}, {{vm.rank.bc2}});"><h2 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rank.title}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{vm.rank.title}}</h3></div><div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.rank.image1}}" ng-attr-style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.rank.image2}}" ng-attr-style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm hidden-md col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.rank.image3}}" ng-attr-style="display:{{vm.rank.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="container col-xs-6 col-sm-6 col-md-4 col-lg-3" ng-if="vm.isShortPhrase" ng-attr-style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title1}}</h3></div></div><div class="container hidden-xs hidden-sm col-md-4 col-lg-3" ng-if="vm.isShortPhrase" ng-attr-style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title2}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-if="vm.isShortPhrase" ng-attr-style="background-color:lightgray;color:black;height:{{vm.sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.rank.title3}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.rank.title3}}</h3></div></div></div><br><div class="row"><div class="text-left col-xs-6"><blob-upload></blob-upload></div><div class="text-right col-xs-6"><button class="btn btn-danger" ng-click="vm.goDeleteImage()">Delete Image</button> <button class="btn btn-success" ng-click="vm.goSaveImage()">Save Image & Design</button></div></div><input type="text" class="form-control" ng-model="vm.addval" bs-options="c for c in vm.addopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addCategory()">Add</button></span><label class="control-label capitalize">Social Media Text:</label> <textarea id="textarea1" class="form-control" ng-model="vm.rank.introtext" rows="6">\r\n        </textarea><br><br><div class="text-right"><button class="btn btn-success" ng-click="vm.goSaveText()">Save Intro Text</button></div><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div><br><br><br></div></div>'),e.put("app/admin/Partials/sibLocs.html",'<div class="container"><br><h1>Sibbling Locations</h1><br><input type="text" class="form-control" ng-model="vm.answername" bs-options="c for c in vm.ansOpts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.selAns()">Add</button></span><br><div ng-if"vm.answer.anslocs"=""><h2>{{vm.answer.name}}</h2><h4>{{vm.answer.location}}</h4></div><br><strong>Sibbling Locations</strong><ul class="list-group"><li class="list-group-item" ng-repeat="x in vm.locations" style="cursor:pointer;">{{x.name}},&nbsp{{x.location}} <i class="glyphicon glyphicon-remove pull-right" ng-click="vm.remAns(x)"></i></li></ul><br><input type="text" class="form-control" ng-model="vm.brothername" bs-options="c for c in vm.ansOpts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-primary" type="button" ng-click="vm.addBrother()">Add Brother</button></span><br><div class="text-center"><button class="btn btn-success" type="button" ng-click="vm.confirm()">Add Sibbling Locations</button></div><br></div>'),e.put("app/admin/Partials/updateHeaders.html",'<div class="container" ng-if="vm.isAdmin"><br><br><h1>Refresh Headlines</h1><br><div class="text-center"><button ng-click="vm.catStrings()" class="btn btn-primary">Check for Empty Category Strings</button><br><br><button ng-click="vm.refresh()" class="btn btn-success">Shuffle Headers</button><br><br><button ng-click="vm.createCBlocksRecsCity()" class="btn btn-success">Create C-Blocks City</button><br><br><button ng-click="vm.createCBlocksRecsNh()" class="btn btn-success">Create C-Blocks Neighborhood</button><br><br><button ng-click="vm.createCBlocksRecsRankX()" class="btn btn-success">Create C-Blocks RankX</button><br><br><button ng-click="vm.deleteCBlocks()" class="btn btn-warning">Delete ALL C-Blocks</button></div><div ng-repeat="x in vm.res track by $index">{{x.modeNum}} - {{x.htitle}} - {{x.scope}} - {{x.title}}</div></div>'),e.put("app/admin/Partials/views.html",'<h1>Views</h1><div class="row"><div class="col-sm-2"></div><div class="col-sm-8"><table class="table table-hover cursor"><tbody><thead><tr><th>Ranking</th><th>Views</th></tr></thead><tbody><tr ng-repeat="x in vm.content | orderBy: \'-views\'"><td>{{x.title}}</td><td>{{x.views}}</td></tr></tbody></tbody></table></div><div class="col-sm-2"></div></div>'),e.put("app/answer/Partials/addAnswer.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px;"><h4>&nbsp&nbspAdd a new <span ng-if="vm.type == \'Establishment\'"><em>Establishment</em> to this list.</span> <span ng-if="vm.type == \'Organization\'"><em>Organization or Company</em> to this list.</span> <span ng-if="vm.type == \'Person\'"><em>Person</em> to this list.</span> <span ng-if="vm.type == \'PersonCust\'"><em>Professional</em> to this list.</span> <span ng-if="vm.type == \'Place\'"><em>Place</em> to this list.</span> <span ng-if="vm.type == \'Short-Phrase\'"><em>Answer</em> to this list.</span> <span ng-if="vm.type == \'Thing\'"><em>Item</em> to this list.</span> <span ng-if="vm.type == \'Event\'"><em>Event</em> to this list.</span> <span ng-if="vm.type == \'Simple\'"><em>Item</em> to this list.</span></h4></div><div class="text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it works?</u></p></div><br><div class="row" style="margin:0px;"><form class="form-horizontal col-sm-12 col-md-7" role="form" name="answerForm"><div class="form-group" ng-repeat="x in vm.fields"><label class="control-label capitalize" ng-if="!x.onlybyowner" style="padding-left:10px">{{x.isrequired ? \'**\':\'\'}}{{x.label}}:</label> <input class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" type="{{x.textstyle}}" ng-change="vm.onSelect(x)" placeholder="{{x.label}}" ng-hide="{{x.name==\'addinfo\'}}" ng-if="!x.onlybyowner" style="width:94%;margin-left:10px;margin-right:10px;"><textarea class="form-control" ng-model="x.val" placeholder="{{x.label}}" ng-model-options="{debounce: 2500}" ng-show="{{x.name==\'addinfo\'}}" rows="3" ng-if="!x.onlybyowner" id="textarea2" style="width:94%;margin-left:10px;margin-right:10px;"></textarea></div><div class="text-right" ng-if="vm.type == \'Person\'"><button ng-click="vm.getWiki()" class="btn btn-primary" style="background-color:#595959;border-color:black">Get from Wikipedia</button></div></form><div class="col-sm-12 col-md-5" ng-if="!vm.userIsOwner"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"> <img src="../../../assets/images/powered_by_google_on_white.png" ng-if="vm.type!=\'PersonCust\'"></div><div class="" ng-show="{{vm.type == \'Short-Phrase\'}}"><div class="container-answer" style="width:100%;height:auto" ng-if="vm.type == \'Short-Phrase\'"><br><h2 style="text-align:center"><strong>{{vm.fields[0].val}}</strong></h2><br><h4 style="text-align:center">{{vm.fields[1].val}}</h4></div></div><div ng-if="vm.type != \'PersonCust\'"><div class="form-group text-right"><button type="submit" class="btn btn-primary {{vm.searchDisabled}}" ng-click="vm.callSearchImage()" ng-show="{{vm.type != \'Short-Phrase\'}}">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-disabled="vm.numLinks === 0" ng-attr-style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-disabled="vm.numLinks === 0" ng-attr-style="display:{{vm.imagefunctions}}">&raquo</button> <a ng-attr-style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a></div><label class="checkbox-inline" ng-show="{{vm.type != \'Short-Phrase\'}}"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi">No good images were found</label></div><br></div><div class="col-sm-12 col-md-5" ng-if="vm.userIsOwner"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"><div ng-attr-style="display:{{vm.userIsOwner ? \'inline\':\'none\'}}"><blob-upload></blob-upload></div><br ng-if="vm.sm"></div></div><div class="col-sm-12 col-md-7" style="padding-bottom:10px"><label>Ranks (select all that apply):</label><div ng-if="!vm.nhrdy"><i>Please enter a valid neighborhood</i></div><ul class="list-group" ng-if="vm.nhrdy"><li class="list-group-item" ng-repeat="x in vm.addToRanks" ng-click="vm.selRank(x,$index)" style="color:{{x.sel?\'black\':\'lightgrey\'}};cursor:pointer;"><i ng-if="x.sel" class="fa fa-check"></i>&nbsp{{x.title}}</li></ul><div ng-if="vm.addRanksEnable" style="padding-top:10px"><div class="text-left"><button class="btn btn-primary" ng-if="!vm.addctsactive" ng-click="vm.addCatans()">Add More Ranks</button></div><div class="input-group" ng-if="vm.addctsactive"><input type="text" class="form-control" ng-model="vm.addctsval" bs-options="c for c in vm.addctsopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts()">Add</button></span></div></div></div><div class="col-sm-12 col-md-12 form-group" style="margin:0px;"><div class="text-center"><button ng-click="vm.rankSummary()" class="btn btn-danger">Cancel</button><button type="submit" class="btn btn-success" ng-click="vm.callAddAnswer()">Add Answer</button></div></div><br class="hidden-md hidden-lg hidden-xl"><br class="hidden-md hidden-lg hidden-xl"><br class="hidden-md hidden-lg hidden-xl">'),
e.put("app/answer/Partials/addEvent.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.ranking}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px;"><h4>{{ vm.isEdit ? \'Edit Event\':\'Add Event\'}}</h4></div><div class="text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it works?</u></p></div><br><div class="row" style="margin:0px;"><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-right">** Event Title:</p></div><div class="col-xs-12 col-sm-4 col-md-4"><input class="form-control" ng-model="vm.ev.name" type="text" placeholder="Event Title" ng-change="vm.displayCharLength()" maxlength="45" ng-attr-style="background-color:{{vm.ev.bc}};color:{{vm.ev.fc}}"></div><div class="col-xs-8 hidden-sm hidden-md hidden-lg hidden-xl"></div><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-left">{{vm.char}} chars left</p></div></div><br ng-if="!vm.sm"><div ng-if="!vm.sm"><div class="row" style="margin:0px;"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.ev.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.ev.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div></div><br ng-if="!vm.sm"><br><p class="text-left">Frequency</p><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.ev.freq == \'onetime\'? \'active\':\'\'}}" ng-click="vm.frequencySel(1)">One-Time</button> <button class="btn btn-primary {{vm.ev.freq == \'weekly\'? \'active\':\'\'}}" ng-click="vm.frequencySel(2)">Weekly</button></div><br><br><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">Start date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.sdate" type="text"></datepicker></div></div></div><div class="row" ng-if="vm.onetime"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">Start time:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.ev.stime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime}}</option></select></div></div></div><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">End date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.edate" type="text"></datepicker></div></div><div class="row" ng-if="vm.onetime" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">End time:</p></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" ng-attr-style="display:{{vm.onetime ? \'inline\':\'none\'}}"><select ng-model="vm.ev.etime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime}}</option></select></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">Start date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.sdate" type="text"></datepicker></div></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="{{vm.sm ? \'text-left\':\'text-right\'}}">End date:</p></div></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.ev.edate" type="text"></datepicker></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="text-center"><div class="col-xs-12 col-sm-12 col-md-12" ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.mon" value="">Mon</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.tue" value="">Tue</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.wed" value="">Wed</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.thu" value="">Thu</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.fri" value="">Fri</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.sat" value="">Sat</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.ev.sun" value="">Sun</label></div></div></div><br><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.ev.stime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.ev.stime2}}</option></select></div></div></div><div class="row" ng-if="vm.weekly" style="margin:0px;"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><p class="text-right">End time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-attr-style="display:{{vm.weekly ? \'inline\':\'none\'}}"><select ng-model="vm.ev.etime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.ev.etime2}}</option></select></div></div></div><div class="row" style="margin:0px;"><form class="form-horizontal col-xs-12 col-sm-12 col-md-6" role="form" name="answerForm"><div class="form-group" style="padding:5px"><label class="control-label">Venue / Location:</label> <input class="form-control" ng-model="vm.ev.eventloc" bs-typeahead="" bs-options="c for c in vm.locations" type="text" placeholder="{{vm.ev.eventloc.str}}" ng-change="vm.onSelect()"></div><div class="form-group" style="padding:5px"><label class="control-label">Address:</label> <input class="form-control" ng-model="vm.ev.location" type="text" placeholder="{{vm.ev.location}}"></div><div class="form-group" style="padding:5px"><label class="control-label">Neighborhood:</label> <input class="form-control" ng-model="vm.ev.cityarea" bs-typeahead="" bs-options="c for c in vm.neighborhoods" type="text" placeholder="{{vm.ev.cityarea}}"></div><div class="form-group" style="padding:5px"><label class="control-label">Phone Number:</label> <input class="form-control" ng-model="vm.ev.phone" type="text" placeholder="{{vm.ev.phone}}"></div><div class="form-group" style="padding:5px"><label class="control-label">Event Website:</label> <input class="form-control" ng-model="vm.ev.website" type="text" placeholder="{{vm.ev.website}}"></div><div class="form-group" style="padding:5px"><label class="control-label">Additional Info:</label> <textarea class="form-control" ng-model="vm.ev.addinfo" placeholder="{{vm.ev.addinfo}}" rows="4" ng-attr-style="background-color:{{vm.ev.bc}};color:{{vm.ev.fc}};width:100%"></textarea></div></form><div class="col-xs-12 col-sm-12 col-md-6"><div class="" ng-show="{{vm.type != \'Short-Phrase\'}}"><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"> <img src="../../../assets/images/powered_by_google_on_white.png"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary {{vm.searchDisabled}}" ng-click="vm.callSearchImage()" ng-show="{{vm.type != \'Short-Phrase\'}}">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-disabled="vm.numLinks === 0" ng-attr-style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-disabled="vm.numLinks === 0" ng-attr-style="display:{{vm.imagefunctions}}">&raquo</button> <a ng-attr-style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a></div><label class="checkbox-inline"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi" ng-show="{{vm.type != \'Short-Phrase\'}}">No good images were found</label></div></div><br><div class="radio"><label><input type="radio" ng-model="vm.nobind" name="optradio" checked="true">Do not bind event to my account, let anyone make changes.</label></div><div class="radio"><label><input type="radio" ng-model="vm.bind" name="optradio">Bind this event to my account, only I can make changes.</label></div><br><div class="row" style="margin:0px;"><div class="form-group text-center"><button type="button" class="btn btn-success" ng-click="vm.goBack()">Back</button> <button type="button" class="btn btn-primary" ng-click="vm.showPreview()">Preview</button> <button type="button" class="btn btn-danger" ng-click="vm.deleteSpecial()" ng-attr-style="display:{{vm.isEdit ? \'inline\':\'none\'}}">Delete</button></div></div>'),e.put("app/answer/Partials/answerDetail.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading details...</p></div></div><div ng-if="vm.dataReady" style="margin-left: -15px; margin-right: -15px"><div class="container"><div class="text-center"><button class="btn btn-default" ng-if="vm.searchActive" ng-click="vm.backToResults()" style="margin:5px; width:100%">Back to Results</button></div></div><cat-bar ng-if="vm.ranking" text="{{vm.ranking}}" left-fn="vm.goPrev()" right-fn="vm.goNext()" close-rank="vm.closeAnswerDetail()"></cat-bar><div class="row" style="margin:5px;"><div class="col-xs-6 col-sm-3 col-md-2"><div class="text-left"><small class="text-muted">&nbsp;&nbsp;&nbsp{{vm.answer.views}}&nbspviews</small></div></div><div class="col-xs-6 col-sm-9 col-md-10"><div ng-show="{{vm.type == \'Establishment\' || vm.type == \'PersonCust\' || vm.type == \'Event\' }}" class="text-right"><p ng-attr-style="display:{{vm.answer.hasOwner ? \'none\':\'inline\'}};" class="hiw" ng-click="vm.bizRegDialog()"><u>{{vm.bindtxt}}</u>{{vm.isAdmin?(\' \'+ vm.bizcat):\'\'}}</p><span class="glyphicon glyphicon-lock" ng-attr-style="display:{{vm.answer.hasOwner ? \'inline\':\'none\'}}"></span></div></div></div><answer-header ans="{{vm.answer}}" idx="{{vm.idx}}"></answer-header><div ng-if="vm.type == \'Event\'"><br><div ng-bind-html="vm.ehtml" ng-attr-style="{{vm.estyle}}"><br></div></div><div class="text-center" style="margin-right:20px"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="vm.answer.family" ng-click="vm.showLocations()" target="_blank">Other Locations&nbsp&nbsp<span class="fa fa-map-marker"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="true" ng-click="vm.share()" target="_blank">Share&nbsp&nbsp<span class="fa fa-share"></span></a></div><div class="col-xs-12" ng-if="!vm.answer.isprivate"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header text-center">Endorsements</h3></div><p class="text-left" ng-if="vm.type != \'Short-Phrase\'"><strong>{{vm.answer.name}}</strong> is featured in the following ranks:</p><div class="well well-light-ranks col-xs-12 col-sm-6 col-md-4 col-lg-4" style="padding-top:5px;" ng-repeat="r in vm.answerRanks | orderBy:\'rank\' | limitTo:vm.dispRanks"><div class="container-bgbox"><bg-box bc="#666666" shade="0" fc="#f8f8ff" text="{{(vm.type == \'Short-Phrase\') ? vm.answer.name : r.title}}" dir="horizontal" w="100%" h="40px"></bg-box></div><p class="text-center" ng-if="vm.type == \'Short-Phrase\'">on {{r.title}}</p><div class="row" ng-if="true" style="padding-bottom:5px;padding-top:5px; margin-top:0px"><img ng-attr-style="height:55px;width:auto;" class="col-xs-3 col-md-1 col-lg-1" ng-src="{{r.icon}}"><div class="col-xs-6" style="min-width:175px"><p style="padding-top:3px;margin-bottom:px;">Ranked <strong>#{{r.rank}}</strong> out of <strong>{{r.answers}}</strong></p><div class="text-center" style="margin-top:2px"><span ng-click="vm.UpVote(r)" ng-attr-style="color:{{r.thumbUp}};margin-right: {{vm.sm?\'0px\':\'20px\'}};font-size: 18px;" class="pull-left">&nbsp&nbsp <i class="fa fa-thumbs-up" aria-hidden="true"></i> <span style="color:black;font-size: 14px;">&nbsp;{{r.upV}}&nbsp;&nbsp;</span></span> <span ng-click="vm.DownVote(r)" ng-attr-style="color:{{r.thumbDn}};margin-right: {{vm.sm?\'0px\':\'20px\'}};font-size: 18px;" class="pull-right"><i class="fa fa-thumbs-down" aria-hidden="true"></i> <span style="color:black;font-size: 14px;">&nbsp;{{r.downV}}</span> &nbsp&nbsp</span></div></div><a href="" class="text-center col-xs-3" ng-click="vm.gotoRank(r)">Full ranking</a></div><p ng-attr-style="display:{{vm.deleteButton ? \'inline\':\'none\'}};color:red" ng-click="vm.deleteThisCatans(r)">&lt;&lt;Delete&gt;&gt;</p></div><p ng-show="{{vm.answerRanks.length > 3}}" style="background-color:lightgray;cursor:pointer" ng-click="vm.showRanks()">{{vm.dispRanks > 3 ? \'Show less\':(\'Show more (\' + (vm.answerRanks.length - 3) + \')\') }}</p><div ng-if="vm.isAdmin"><div class="text-left"><button class="btn btn-primary" ng-click="vm.addCatans()">Add Catans</button></div><div class="input-group" ng-if="vm.addctsactive"><input type="text" class="form-control" ng-model="vm.addctsval" bs-options="c for c in vm.addctsopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts()">Add</button></span></div></div></div><div class="container col-xs-12" ng-if="vm.answer.hasranks"><div class="row" ng-if="vm.type != \'Short-Phrase\'"><div class="col-xs-12"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header text-center">The Favorites</h3></div></div></div><div class="row" style="padding:0px;margin:0px;border:0px"><div ng-repeat="n in vm.myranks"><div class="container col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoCustomRank(n)" ng-attr-style="border-top:3px solid white;border-bottom:3px solid white;background-color:{{n.bc}};color:{{n.fc}};height:{{vm.sm ? \'90px\':\'150px\'}};margin:0px;padding:0px;position:relative;"><h3 class="hidden-xs text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%);cursor:pointer;">{{n.title}}<h4 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%);cursor:pointer;">{{n.title}}</h4></h3></div><div class="col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoCustomRank(n)" style="margin:0px;padding:0px;"><img ng-src="{{n.image}}" ng-attr-style="border-top:3px solid white;border-bottom:3px solid white;width:95%;height:{{vm.sm ? \'90px\':\'150px\'}};cursor:pointer;"></div></div></div><div class="text-right"><a href="" ng-if="vm.userIsOwner" ng-click="vm.addRankforAnswer()">Edit Ranking/List</a></div></div><div class="container col-xs-12" ng-if="vm.userIsOwner&&!vm.answer.hasranks&&!vm.hideCustomRanksMsg&&!vm.answer.isprivate"><br><div class="alert alert-info">This Favorites section contains <strong>Custom Ranks</strong> and it is <strong>only visible to you</strong> Custom Ranks are:<br><br><i class="fa fa-check"></i>&nbsp<strong>Interactive lists</strong> about anything in your business.<br><i class="fa fa-check"></i>&nbsp<strong>Showcase in detail</strong> your products and/or services.<br><i class="fa fa-check"></i>&nbspA great way to <strong>engage your audience</strong>.<br><i class="fa fa-check"></i>&nbspCan be anything from <i>Food or Drink Items</i>, <i>Newest or Best-selling Products</i>, <i>Popular Services</i>, <i>Recent Projects</i>, <i>Success Stories</i>, <i>Staff Members</i> or anything you choose.<br><br>Below are some examples on how you can use Custom Ranks to enhance your business profile.<div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header text-center">The Favorites</h3></div><div class="row" style="padding:0px;margin:0px;border:0px"><div ng-repeat="n in vm.myranks"><div class="container col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoCustomRank(n)" ng-attr-style="border-top:3px solid #D9EDF7;border-bottom:3px solid #D9EDF7;background-color:{{n.bc}};color:{{n.fc}};height:{{vm.sm ? \'90px\':\'150px\'}};margin:0px;padding:0px;position:relative;"><h3 class="hidden-xs text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%);cursor:pointer;">{{n.title}}<h4 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%);cursor:pointer;">{{n.title}}</h4></h3></div><div class="col-xs-3 col-sm-2 col-md-2 col-lg-2" ng-click="vm.gotoCustomRank(n)" style="margin:0px;padding:0px;"><img ng-src="{{n.image}}" ng-attr-style="border-top:3px solid #D9EDF7;border-bottom:3px solid #D9EDF7;width:95%;height:{{vm.sm ? \'90px\':\'150px\'}};cursor:pointer;"></div></div></div><div class="text-right"><button class="btn btn-default" ng-click="vm.gotoMyBusiness()" style="margin:5px">Purchase Custom Ranks</button> <button class="btn btn-default" ng-click="vm.hideCustomRanks()" style="margin:5px">Hide Message</button></div></div></div><div class="col-xs-12" ng-if="true"><div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header" style="justify-content:space-between;display:flex"><span class="alignleft" style="cursor:pointer" ng-click="vm.moreImagesRev()">&nbsp{{vm.showRev?\'&lt\':\' \'}}&nbsp</span> <span class="aligncenter">Photo Gallery</span> <span class="alignright" style="cursor:pointer" ng-click="vm.moreImagesFwd()">&nbsp{{vm.showFwd?\'&gt\':\' \'}}&nbsp</span></h3></div><div class="text-right" ng-if="vm.type != \'Short-Phrase\'"><button ng-if="!vm.igdemo" class="btn btn-success" ng-click="vm.getImages()" ng-attr-style="display:{{vm.showImageGallery == false ? \'inline\':\'none\'}};margin:5px;">Show Images</button></div><div ng-attr-style="display:{{vm.showImageGallery == true ? \'inline\':\'none\'}}"><div class="col-xs-6 col-sm-4 col-md-3 col-lg-2" ng-repeat="x in vm.images.slice(vm.i,vm.e)"><a ng-click="vm.selectPhoto($index)" class="thumbnail"><img ng-src="{{x.url}}" style="width:100%;height:120px"></a></div><div ng-if="vm.images.length == 0">No images in Photo Gallery.</div></div></div><div ng-if="vm.type != \'Short-Phrase\'" class="col-xs-12"><div class="row"><div class="col-xs-6" style="padding-top:20px;"><div class="text-center" ng-if="vm.showImageGallery && vm.isLoggedIn" ng-attr-style="display:{{vm.isLoggedIn ? \'inline\':\'none\'}};"><blob-upload></blob-upload></div></div><div class="col-xs-6"><div class="text-center" ng-if="vm.showImageGallery && vm.isLoggedIn">Get from Instagram&nbsp&nbsp&nbsp <img ng-src="/assets/images/glyph-logo_May2016.png" ng-click="vm.selectInstagramImages()" ng-attr-style="width:80px;display:{{vm.isLoggedIn ? \'inline\':\'none\'}};cursor:pointer"></div></div></div></div><div class="col-xs-12" ng-if="vm.answer.ispremium"><div ng-show="{{vm.type == \'Establishment\' || vm.type == \'PersonCust\' }}"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header text-center">Specials</h3></div><div class="row" style="border-left:5px solid white;border-right:5px solid white;"><div ng-repeat="x in vm.specialsList"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-click="vm.showSpecial(x)" ng-attr-style="background-color:{{x.bc}};color:{{x.fc}};cursor:pointer;border:5px solid white;"><h4 class="text-center">{{x.stitle}}</h4></div></div></div><div class="text-right"><a href="" ng-if="vm.userIsOwner" ng-click="vm.openSpecials()">Edit Specials</a></div></div></div><div class="container col-xs-12" ng-if="vm.userIsOwner&&!vm.answer.ispremium&&!vm.hideGetPremiumMsg&&!vm.answer.isprivate"><div class="alert alert-info">This Specials section below is only visible when you have <strong>Premium Membership</strong>. Premium Membership allows you to:<br><br><i class="fa fa-check"></i>&nbspCommunicate to users <strong>daily specials, events and deals</strong> real time.<br><i class="fa fa-check"></i>&nbspOffer special deals and control exactly when to start and stop an offering.<br><i class="fa fa-check"></i>&nbspSpecials are shown in the <strong>rankings summary</strong> driving <strong>more customers</strong> to your profile.<br><br>Below are examples on the type of Specials and Promotions you can show with a Premium Membership.<div class="well-sm" style="background-color:#666666;color:#f8f8ff;"><h3 class="sub-header text-center">Specials</h3></div><div class="row" style="border-left:5px solid #D9EDF7;border-right:5px solid #D9EDF7;"><div ng-repeat="x in vm.specialsList"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-click="vm.showSpecial(x)" ng-attr-style="background-color:{{x.bc}};color:{{x.fc}};cursor:pointer;border:5px solid #D9EDF7;"><h4 class="text-center" style="padding-top:10px">{{x.stitle}}</h4></div></div></div><div class="text-right"><button class="btn btn-default" ng-click="vm.gotoMyBusiness()" style="margin:5px">Purchase Premium Membership</button> <button class="btn btn-default" ng-click="vm.hideGetPremium()" style="margin:5px">Hide Message</button></div></div></div><div class="col-xs-12"><div><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header text-center">Opinions</h3></div><table class="table table-hover cursor"><tbody><tr ng-repeat="item in vm.vrows | orderBy:\'-delta\'"><td align="middle" ng-attr-style="width:10%"><img ng-src="../../../assets/images/{{item.upImage}}" style="max-height:30px;margin:0px;" ng-click="vm.vrowVoteUp(item)"></td><td align="left" style="width:10%">{{item.upV}}</td><td align="middle" style="width:60%">{{item.title}}</td><td align="right" style="width:10%">{{item.downV}}</td><td align="middle" ng-attr-style="width:10%"><img ng-src="../../../assets/images/{{item.downImage}}" style="max-height:30px;margin:0px;" ng-click="vm.vrowVoteDown(item)"></td></tr></tbody></table><div class="input-group" style="padding:0px;margin:0px;"><input type="text" class="form-control" ng-model="vm.newop" maxlength="30" placeholder="{{\'Write an opinion of \'+ vm.answer.name}}"> <span class="input-group-btn text-right"><button class="btn btn-primary {{vm.addvrowbutton}}" type="button" ng-click="vm.addvrow()">Add Opinion</button></span></div><div class="text-center" style="padding-top:5px">{{30 - vm.newop.length + \' characters left\'}}</div><br></div></div><div class="col-xs-12" ng-if="false"><div ng-show="{{vm.type != \'Establishment\' && vm.type != \'PersonCust\' && vm.type != \'Event\' }}"><div class="well-sm" style="background-color:#666666;color:#f8f8ff"><h3 class="sub-header">Versus Table</h3></div><table class="table table-hover cursor"><tbody><thead><tr><th align="middle" style="width:15%">Pct (%)</th><th align="middle" style="width:60%">vs. Opponent</th><th align="middle" style="width:15%">Pct (%)</th><th align="middle" style="width:10%">GP</th></tr></thead><tbody><tr ng-repeat="x in vm.relativetable | orderBy: \'-Rank\'"><td align="middle" style="width:15%">{{x.PctF}}</td><td align="middle" style="width:60%">{{x.vsName}}</td><td align="middle" style="width:15%">{{x.PctC}}</td><td align="middle" style="width:10%">{{x.GP}}</td></tr></tbody></tbody></table></div></div><br><br><div class="btn-group" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div><button type="button" ng-click="vm.deleteAnswer()" class="btn btn-danger" ng-if="vm.deleteButton">Delete</button><br><br></div>'),e.put("app/answer/Partials/answerRanksManager.html",'<h2>Custom Ranks Manager</h2><br><p class="text-left">You have purchased <strong>{{vm.ranksqty}}</strong> ranks that are currently active.</p><table class="table"><tbody><thead style="border-style:none;"><tr><th>Name</th><th></th><th></th></tr></thead><tr ng-repeat="x in vm.ranks" style="cursor:pointer;"><td ng-if="x.used" style="width:80%">{{x.title}}</td><td ng-if="!x.used" style="width:80%;color:#808080"><i>Empty</i></td><td ng-if="x.used" style="width:10%"><button class="btn btn-primary" ng-click="vm.editRank($index)">Edit</button></td><td ng-if="x.used" style="width:10%"><button class="btn btn-danger" ng-click="vm.deleteRank($index)">Delete</button></td><td ng-if="!x.used" style="width:10%"><button class="btn btn-success" ng-click="vm.addRank()">Add</button></td></tr></tbody></table><p class="text-left">Custom ranks are a great way to engage your audience with your products and services.</p><div class="text-center"><button class="btn btn-success">Purchase additional Ranks</button><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div>'),
e.put("app/answer/Partials/answerheader.html",'<div class="container hidden-xs" ng-if="!isShortPhrase"><div class="row"><div class="container col-sm-6 col-md-4 col-lg-4" ng-attr-style="height:{{mxheight}}px;margin:0px;padding:0px;border:0px;"><div class="container-bgbox"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{idx > 0 ? idx + \'. \' + answer.name:answer.name}}" dir="vertical" w="100%" h="120px"></bg-box></div><div class="container" ng-attr-style="width:100%; height:{{mxheight-120}}px;background-color:#d8d8d8;padding-top:5px"><strong ng-if="answer.eventloc">Location:</strong> <a ng-if="answer.eventloc" ng-click="gotoLocationAnswer()" target="_blank">{{answer.eventloc}}</a><br ng-if="answer.eventloc"><strong ng-if="answer.location">Address:</strong> <a ng-if="answer.location" href="http://maps.apple.com/maps?q={{answer.location}}" target="_blank">{{answer.location}}</a><br ng-if="answer.location"><strong ng-if="answer.cityarea">{{(answer.cityarea) ? \'Neighboorhood:\' : ""}}</strong> {{(answer.cityarea) ? answer.cityarea : ""}}<br ng-attr-style="display:{{(answer.cityarea) ? \'inline\' : \'none\'}}"><strong ng-if="answer.phone">Phone:</strong> <a ng-if="answer.phone" href="tel:{{answer.phone}}">{{answer.phone}}</a><br ng-attr-style="display:{{(answer.phone) ? \'inline\' : \'none\'}}"><strong ng-if="answer.website">Website:</strong> <a ng-if="answer.website.indexOf(\'http\') >=0" href="{{answer.website}}" target="_blank">{{answer.website}}</a> <a ng-if="answer.website.indexOf(\'http\') == -1" href="http://{{answer.website}}" target="_blank">{{answer.website}}</a><br ng-if="answer.website"><strong ng-if="answer.email">{{(answer.email) ? \'Email:\' : ""}}</strong> {{(answer.email) ? answer.email : ""}}<br ng-attr-style="display:{{(answer.email) ? \'inline\' : \'none\'}}"><i ng-attr-style="display:{{hrset ? \'inline\':\'none\'}}">{{hourstr}}</i><div class="text-center answer_info_buttons"><br><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="!answer.hasOwner || userIsOwner" ng-click="editAnswer()" target="_blank">Edit&nbsp&nbsp<span class="fa fa-pencil"></span></a><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="isMobile && answer.phone" href="tel:{{answer.phone}}" target="_blank">Call&nbsp&nbsp<span class="fa fa-phone"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" href="http://maps.apple.com/maps?q={{answer.lat}}, {{answer.lng}}" target="_blank">Directions&nbsp&nbsp<span class="fa fa-arrow-right"></span></a> <a type="button" class="btn btn-default hidden-md hidden-lg hidden-xl" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" ng-click="toggleimgmode()">{{imgmode}}&nbsp&nbsp<span class="{{imgmodeicon}}"></span></a></div></div></div><div class="col-sm-6 col-md-4 col-lg-4" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="{{answer.imageurl}}" alt="Moustiers Sainte Marie" ng-attr-style="height:{{mxheight}}px;width:100%;margin-left:auto;margin-right:auto;" ng-click="showUrl()" ng-if="modeIsImage"> <img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width2}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="!modeIsImage"></div><div class="hidden-sm col-md-4 col-lg-4" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width3}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="hasMap"><div class="container" ng-attr-style="background-color:#d8d8d8;width:{{width3}}px;height:{{mxheight}}px;margin-left:auto;margin-right:auto;" ng-if="!hasMap"></div></div></div></div><div class="container hidden-sm hidden-md hidden-lg hidden-xl" ng-if="!isShortPhrase"><div class="container-bgbox"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{idx > 0 ? idx + \'. \' + answer.name:answer.name}}" dir="vertical" w="100%" h="75px"></bg-box></div><div class="container" style="margin:0px;padding:0px;border:0px;"><img class="displayed" ng-src="{{answer.imageurl}}" alt="Moustiers Sainte Marie" style="height:auto;width:100%;" ng-click="showUrl()" ng-if="modeIsImage"> <img class="displayed" ng-src="https://maps.googleapis.com/maps/api/staticmap?center={{answer.location}}&zoom=13&size={{width}}x{{mxheight}}&maptype=roadmap &markers=color:red%7Clabel:%7C{{answer.lat}},{{answer.lng}}&key=AIzaSyDKXsql-P8czb4nAQMXjkFpm_I5HqKsQpo" ng-if="!modeIsImage"></div></div><div class="container-answer" style="width:100%;height:auto" ng-if="isShortPhrase"><br><h2 style="text-align:center"><strong>{{answer.name}}</strong></h2><br><h4 style="text-align:center">{{answer.addinfo}}</h4></div><div class="answer_info row" ng-if="!isShortPhrase" style="padding:0px;margin:0px;border:0px;"><div class="container hidden-sm hidden-md hidden-lg hidden-xl"><br ng-if="answer.eventloc"><strong ng-if="answer.eventloc">Location:</strong> <a ng-if="answer.eventloc" ng-click="gotoLocationAnswer()" target="_blank">{{answer.eventloc}}</a><br ng-if="answer.location"><strong ng-if="answer.location">Address:</strong> <a ng-if="answer.location" href="http://maps.apple.com/maps?q={{answer.location}}" target="_blank">{{answer.location}}</a><br ng-if="answer.location"><div class="row"><div class="col-xs-9"><strong ng-if="answer.cityarea">{{(answer.cityarea) ? \'Neighboorhood:\' : ""}}</strong> {{(answer.cityarea) ? answer.cityarea : ""}}<br ng-attr-style="display:{{(answer.cityarea) ? \'inline\' : \'none\'}}"><strong ng-if="answer.phone">Phone:</strong> <a ng-if="answer.phone" href="tel:{{answer.phone}}">{{answer.phone}}</a><br ng-attr-style="display:{{(answer.phone) ? \'inline\' : \'none\'}}"><strong ng-if="answer.website">Website:</strong> <a ng-if="answer.website.indexOf(\'http\') >=0" href="{{answer.website}}" target="_blank">{{answer.website}}</a> <a ng-if="answer.website.indexOf(\'http\') == -1" href="http://{{answer.website}}" target="_blank">{{answer.website}}</a><br ng-if="answer.website"><strong ng-if="answer.email">{{(answer.email) ? \'Email:\' : ""}}</strong> {{(answer.email) ? answer.email : ""}}<br ng-attr-style="display:{{(answer.email) ? \'inline\' : \'none\'}}"></div><div class="col-xs-3 text-left"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;margin-top:15px;" ng-if="!answer.hasOwner || userIsOwner" ng-click="editAnswer()" target="_blank">&nbsp&nbsp<span class="fa fa-pencil"></span></a></div></div><i ng-attr-style="display:{{hrset ? \'inline\':\'none\'}}">{{hourstr}}</i></div><div class="hidden-sm hidden-md hidden-lg hidden-xl text-center answer_info_buttons" style="padding-top:10px;"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="isMobile && answer.phone" href="tel:{{answer.phone}}" target="_blank">Call&nbsp&nbsp<span class="fa fa-phone"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" href="http://maps.apple.com/maps?q={{answer.lat}}, {{answer.lng}}" target="_blank">Directions&nbsp&nbsp<span class="fa fa-arrow-right"></span></a> <a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="answer.lat && answer.lng" ng-click="toggleimgmode()">{{imgmode}}&nbsp&nbsp<span class="{{imgmodeicon}}"></span></a></div></div><div style="padding:5px"></div><div ng-if="!isShortPhrase && !isEvent" ng-attr-style="display:{{answer.addinfo ? \'inline\':\'none\'}};"><span>{{answer.addinfo_teaser}}</span> <span ng-show="completeinfo">{{answer.addinfo_complete}}</span> <span ng-if="answer.addinfo.length > 0" ng-click="showcomplete()" style="background-color:lightgray;cursor:pointer">{{moretext}}</span><br ng-attr-style="display:{{answer.addinfo ? \'inline\':\'none\'}}"></div>'),e.put("app/answer/Partials/blobupload.html",'<button type="file" ngf-select="uploadFiles($file, $invalidFiles)" accept="image/*" ngf-max-size="3MB" class="btn btn-primary text-center" ngf-resize="{width: 100, height: 100, quality: .1, type: \'image/jpeg\', ratio: \'19:11\', centerCrop: true, pattern=\'.jpg\', restoreExif: false}" role="button" ngf-validate-after-resize="boolean" ngf-model-invalid="invalidFiles">Upload New Image</button><br><br><div style="font:smaller">{{errFile.name}} {{errorMsg}}</div><div style="font:smaller"><span class="progress" ng-show="f.progress >= 0"><div ng-attr-style="width:{{f.progress}}%" ng-bind="f.progress + \'%\'"></div></span></div><br>'),e.put("app/answer/Partials/catbar.html",'<div class="container"><div class="row"><div class="container-bgbox col-xs-1"><bg-box bc="{{bc}}" bc2="{{bc}}" fc="{{fc}}" text="<" dir="horizontal" w="100%" h="{{ht}}px" ng-click="goPrev()" style="cursor:pointer"></bg-box></div><div class="container-bgbox col-xs-10"><bg-box bc="{{bc}}" bc2="{{bc2}}" fc="{{fc}}" text="{{text}}" dir="horizontal" w="100%" h="{{ht}}px" ng-click="selRank()" style="cursor:pointer"></bg-box></div><div class="container-bgbox col-xs-1"><bg-box bc="{{bc2}}" bc2="{{bc2}}" fc="{{fc}}" text=">" dir="horizontal" w="100%" h="{{ht}}px" ng-click="goNext()" style="cursor:pointer"></bg-box></div></div></div>'),e.put("app/answer/Partials/editAnswer.html",'<div class="well-answer" ng-if="vm.nsm"><h2 class="sub-header">{{vm.answer.name}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#b3b3b3;color:#4d4d4d;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-answer" ng-if="vm.sm"><h3 class="sub-header">{{vm.answer.name}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#b3b3b3;color:#4d4d4d;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><div class="row" style="margin:0px"><div class="col-sm-6"><h3>Edit Answer Profile</h3></div><div class="col-sm-6 text-right"><p class="hiw" ng-click="vm.showHowItWorksDialog()"><u>How it Works</u></p></div></div><br><div class="row" style="margin:0px"><div class="col-sm-12 col-md-7"><form class="form-horizontal" role="form" name="answerForm" ng-repeat="x in vm.fields"><div ng-attr-style="display:{{x.field!=\'addinfo\' ? \'inline\':\'none\'}}" ng-hide="{{x.onlybyowner && !vm.userIsOwner}}"><label class="control-label capitalize">{{x.label}}:</label><div class="input-group"><input type="text" class="form-control" ng-model="x.val" bs-options="{{x.opts}}" bs-typeahead="" placeholder="{{x.cval}}"> <span class="input-group-btn text-right"><button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div></div><div class="input-group" ng-attr-style="display:{{x.field==\'addinfo\' ? \'inline\':\'none\'}}" ng-hide="{{!vm.access && (vm.type == \'PersonCust\')}}"><label class="control-label capitalize">{{x.label}}:</label> <textarea id="textarea1" class="form-control" ng-model="x.val" placeholder="{{x.cval}}" rows="5" ng-model-options="{debounce: 2500}">\r\n            </textarea><br><br><span class="input-group-btn text-right"><button ng-click="vm.getWiki()" class="btn btn-primary" style="background-color:#595959;border-color:gray;margin-right:10px" ng-if="vm.type == \'Person\'">Get from Wikipedia</button> <button class="btn btn-primary" type="button" ng-click="vm.editField(x)">Edit</button></span></div></form></div><div class="col-sm-12 col-md-5"><div class="" ng-if="vm.type!=\'Short-Phrase\'"><img class="displayed-uc" src="{{vm.imageURL}}" alt="{{image.errorLoading}}" ng-attr-style="width:100%; max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"> <img src="../../../assets/images/powered_by_google_on_white.png" ng-if="vm.type!=\'PersonCust\' && !vm.userIsOwner"></div><div class="container-answer" ng-attr-style="width:100%; max-height:300px;" ng-if="vm.type == \'Short-Phrase\'"><br><h2 style="text-align:center"><strong>{{vm.answer.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer.addinfo}}</h4></div><br><div ng-if="vm.userIsOwner" ng-attr-style="display:{{vm.userIsOwner ? \'inline\':\'none\'}}"><blob-upload></blob-upload></div><div ng-attr-style="display:{{vm.userIsOwner ? \'none\':\'inline\'}}" ng-if="vm.type!=\'PersonCust\'"><button type="submit" class="btn btn-primary" ng-click="vm.editImage()">{{vm.imageCommand}}</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewPrev()" ng-attr-style="display:{{vm.imagefunctions}}">&laquo</button> <button type="submit" class="btn btn-primary" ng-click="vm.viewNext()" ng-attr-style="display:{{vm.imagefunctions}}">&raquo</button> <a ng-attr-style="display:{{vm.imagefunctions}}">{{vm.linkIdx+1}} of {{vm.numLinks}}</a> <button type="submit" class="btn btn-success" ng-click="vm.selectImage()" ng-attr-style="display:{{vm.imagefunctions}}">Select</button></div><br><label class="checkbox-inline" ng-show="{{vm.type != \'Short-Phrase\'}}"><input type="checkbox" ng-change="vm.onNoGoodImages(vm.ngi)" ng-model="vm.ngi">No good images were found</label></div></div><div class="row"><div class="col-sm-12 col-md-7" style="padding-top:10px"><label>Ranks:</label><ul class="list-group"><li class="list-group-item" ng-repeat="x in vm.answerRanks" style="cursor:pointer;">{{x.title}} <i ng-if="$index>0" class="glyphicon glyphicon-remove pull-right" ng-click="vm.remRank(x)"></i></li></ul><div ng-if="true" style="padding-top:10px"><div class="text-left"><button class="btn btn-primary" ng-if="!vm.addctsactive" ng-click="vm.addCatans()">Add More Ranks</button></div><div class="input-group" ng-if="vm.addctsactive"><input type="text" class="form-control" ng-model="vm.addctsval" bs-options="c for c in vm.addctsopts" bs-typeahead=""> <span class="input-group-btn text-right"><button class="btn btn-success" type="button" ng-click="vm.addcts()">Add</button></span></div></div></div></div><br><div class="well well-light-edit" ng-repeat="x in vm.edits"><div ng-if="x.field != \'addinfo\'"><p><strong>{{x.username}}</strong> has edited the <strong class="capitalize"><em>{{x.field}}</em></strong> of <strong><em>{{x.name}}</em></strong> to <strong><em>{{x.nval}}</em></strong>.</p></div><div ng-if="x.field == \'addinfo\'"><p><strong>{{x.username}}</strong> has edited the information of <strong><em>{{x.name}}</em></strong> to:<br><br>{{x.nval}}.</p></div><img src="{{x.imageURL}}" class="displayed" ng-attr-style="height:150px;display:{{x.display}}"><div class="row form-group"><div class="text-center"><label>{{x.upV}}</label> <label></label> <button class="btn btn-primary {{x.agree}}" ng-click="vm.editAgree(x, $index)">Agree</button> <button type="submit" class="btn btn-primary {{x.disagree}}" ng-click="vm.editDisagree(x, $index)">Disagree</button> <label></label> <label>{{x.downV}}</label></div></div></div><div ng-if="vm.sm && vm.userIsOwner && vm.type == \'Establishment\'"><div class="text-center"><label>Service Hours</label></div><br><div ng-repeat="x in vm.openhours"><div class="container-hours"><div class="row"><div class="col-xs-6 col-sm-6 col-md-2"><p>{{x.day}}:</p></div><div class="col-xs-6 col-sm-6 col-md-2"><select ng-model="x.opn" ng-change="vm.hoursChanged()" ng-options="n for n in vm.openOptions"></select></div></div><div class="row"><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">From:</p></div><div class="col-xs-4 col-sm-4 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.st" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">To:</p></div><div class="col-xs-4 col-sm-4 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.ct" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div></div></div><br></div></div><div ng-if="vm.nsm && vm.userIsOwner && vm.type == \'Establishment\'"><div class="container" style="background-color:#e6e6e6;padding-right:50px;padding-left:10px;padding-top:10px;padding-bottom:0px;"><div class="text-center"><label>Service Hours</label></div><br><div class="container" ng-repeat="x in vm.openhours"><div class="row"><div class="col-xs-2 col-sm-2 col-md-2"><p>{{x.day}}:</p></div><div class="col-xs-2 col-sm-2 col-md-2"><select ng-model="x.opn" ng-change="vm.hoursChanged()" ng-options="n for n in vm.openOptions"></select></div><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">From:</p></div><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.st" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><p class="text-right">To:</p></div><div class="col-xs-2 col-sm-2 col-md-2" ng-attr-style="display:{{x.opn==\'OPEN\' ? \'inline\': \'none\'}}"><select ng-model="x.ct" ng-change="vm.hoursChanged()" ng-options="t for t in vm.timeDD"></select></div></div><br></div></div></div><div class="text-right" ng-if="vm.userIsOwner && vm.type == \'Establishment\'"><a ng-click="vm.updateHours()" class="btn btn-primary {{vm.updateHoursEn}}">Update Hours</a></div><br><div class="text-center"><a ng-click="vm.answerDetail()" class="btn btn-success">Back</a></div><br>'),e.put("app/common/partials/bgbox.html",'<div ng-if="dirHor"><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}}; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><h4 class="text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h4></div></div><div ng-if="dirVer"><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}}; background: {{bc}}; background: -webkit-linear-gradient({{bc}}, {{bc2}}); background: -o-linear-gradient({{bc}}, {{bc2}}); background: -moz-linear-gradient({{bc}}, {{bc2}}); background: linear-gradient({{bc}}, {{bc2}});"><h3 class="hidden-xs text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3><h4 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h4></div></div>'),e.put("app/common/partials/bgbox2.html",'<div ng-if="dirHor"><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h-30}}px;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><h4 ng-if="!isRankOfDay" class="text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:60%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h4><p ng-if="!isRankOfDay" ng-attr-style="padding:3px; margin:0px; position:absolute; bottom:0px; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{question}}</p><div ng-if="isRankOfDay" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h3 class="text-center" style="padding-top:8px">{{title}}</h3><p>{{question}}</p></div></div><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" ng-attr-style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div><div ng-if="dirVer"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}};cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient({{bc}}, {{bc2}}); background: -o-linear-gradient({{bc}}, {{bc2}}); background: -moz-linear-gradient({{bc}}, {{bc2}}); background: linear-gradient({{bc}}, {{bc2}});"><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center" ng-attr-style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)">{{text}}</h3></div><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div>'),e.put("app/common/partials/bgbox3.html",'<div ng-if="dirHor"><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:auto;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><p class="text-left">{{type}}</p><h5 ng-if="!isRankOfDay" class="text-center" ng-attr-style="padding:3px; margin:0px;">{{text}}</h5><p style="text-align:center"><img ng-src="{{imageurl}}" style="width:90%"></p></div><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" ng-attr-style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div><div ng-if="dirVer"><div class="container" style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{h}};cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient({{bc}}, {{bc2}}); background: -o-linear-gradient({{bc}}, {{bc2}}); background: -moz-linear-gradient({{bc}}, {{bc2}}); background: linear-gradient({{bc}}, {{bc2}});"><p class="text-left">{{type}}</p><h4 ng-if="!isRankOfDay" class="text-center" ng-attr-style="padding:3px; margin:0px;">{{text}}</h4><img ng-src="{{imageurl}}"></div><div class="container" ng-attr-style="color:{{fc}};margin:0px;padding:0px;border:0px;position:relative;width:{{w}};height:{{30}}px;cursor:pointer; background: {{bc}}; background: -webkit-linear-gradient(left, {{bc}}, {{bc2}}); background: -o-linear-gradient(right, {{bc}}, {{bc2}}); background: -moz-linear-gradient(right, {{bc}}, {{bc2}}); background: linear-gradient(to right, {{bc}}, {{bc2}});"><div class="text-center" style="color:white;font-size:small"><i class="fa fa-eye"></i> {{views}} | <i class="fa fa-list-ol"></i> {{answers}} | <i class="fa fa-comment"></i> {{comments}}</div></div></div>'),e.put("app/content/partials/answer-block.html",'<div ng-class="sm?\'\':\'rank-item\'" style="padding-bottom:10px"><div class="row" ng-click="ansSel(answer)"><div class="container-bgbox col-xs-6"><div style="position:absolute; z-index: 50; padding: 2px; font-size: 17px; color: #fff"><small><i class="{{answer.icon}}" aria-hidden="true"></i> <span class="tooltiptext">{{answer.itext}}</span></small></div><bg-box2 bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{answer.name}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}" stats="{{stats}}"></bg-box2></div><div class="col-xs-6" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image1}}" ng-attr-style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};cursor:pointer;"></div></div></div>'),e.put("app/content/partials/content-block.html",'<div class="row"><div class="col-xs-12 col-sm-6 col-md-4" ng-repeat="ranking in initalHomeData" ng-if="initalHomeData"><rank-item rank-object="ranking"></rank-item></div></div><div class="row"><div infinite-scroll="loadMore()" infinite-scroll-distance="0" infinite-scroll-disabled="(!pageDataLoaded || scrollDataLoading) || endReached" class="col-xs-12" id="inifinite-container" style="padding:0px;margin:0px"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-repeat="rankingID in scrollingData.slice(startIndex, currentIndex)"><rank-item rank-object="uniqueResult[rankingID]"></rank-item></div><div ng-if="(pageDataLoaded || scrollDataLoading) && !endReached" class="col-xs-12 text-center"><a><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"> Loading More...</a></div><div ng-if="endReached" class="col-xs-12 text-center" style="border: 1px solid #00b3e4;font-size: 14px">End Reached.</div></div></div>'),e.put("app/content/partials/facebook-follow.html",""),e.put("app/content/partials/rank-block.html",'<div ng-class="sm?\'\':\'rank-item\'" style="padding-bottom:10px"><div class="row" ng-click="rankSel(rank,false)"><div class="container-bgbox col-xs-6"><div style="position:absolute;background-color:red; z-index: 50; padding: 2px; font-size: 14px; color: #fff" ng-if="rod">&nbspRanking of the Day&nbsp</div><div style="position:absolute; z-index: 50; padding: 2px; font-size: 17px; color: #fff" ng-if="!rod"><small><i class="fa fa-list-ol" aria-hidden="true"></i></small></div><bg-box2 bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{title}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}" stats="{{stats}}"></bg-box2></div><div class="col-xs-6" style="margin:0px;padding:0px;border:0px;" ng-if="!isShortPhrase"><img ng-src="{{image1}}" ng-attr-style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};cursor:pointer;"></div></div></div>'),e.put("app/content/partials/rank-of-day.html",'<div ng-class="sm?\'\':\'rank-item\'" style="padding-bottom:10px"><div class="row" ng-click="rankSel(rank,false)" ng-if="isBasic"><div class="container-bgbox col-xs-12 col-sm-12" ng-if="part==\'title\'"><div style="position:absolute;background-color:red; z-index: 50; padding: 2px; font-size: 17px; color: #fff">&nbspRanking of the Day&nbsp</div><bg-box2 bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{title}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}" stats="{{stats}}" question="{{rankObject.question}}" is-rank-of-day="{{true}}"></bg-box2></div><div class="col-xs-12 col-sm-12 row" style="margin:0px; padding: 0px; border:0px;cursor:pointer;" ng-if="part==\'image\'"><div class="col-xs-6" style="padding: 0px"><img ng-src="{{image1}}" ng-attr-style="display:{{image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div><div class="col-xs-6" style="padding: 0px" ng-if="!isShortPhrase"><img ng-src="{{image2}}" ng-attr-style="display:{{image2 != undefined ? \'inline\':\'none\'}};width:100%;height:{{sm ? \'150px\':\'200px\'}};"></div><div class="container-bgbox col-xs-6" ng-if="isShortPhrase"><bg-box bc="{{bcp}}" bc2="{{bc2p}}" fc="{{fcp}}" text="{{title1}}" dir="horizontal" w="100%" h="{{sm ? \'150px\':\'200px\'}}"></bg-box></div></div></div></div>'),e.put("app/content/partials/result-block.html",'<div ng-class="sm?\'\':\'rank-item\'"><div class="row"><div class="container-bgbox col-xs-12"><bg-box3 bc="{{bc}}" shade="{{shade}}" fc="{{fc}}" text="{{title}}" dir="horizontal" w="100%" h="{{sm ? \'150\':\'200\'}}" stats="{{stats}}" type="{{type}}" imageurl="{{imageurl}}"></bg-box3></div></div></div>'),e.put("app/content/partials/search-block.html",'<div class="" ng-if="contentLoaded"><div infinite-scroll="loadMore()" infinite-scroll-distance="0.5" infinite-scroll-disabled="scrollDataLoading || endReached || disableScrolling" class="col-xs-12" id="inifinite-container" style="{{sm? \'padding-right: 5px;\':\'\'}}"><div class="col-xs-12 col-sm-6 col-md-4 col-lg-4" ng-repeat="x in displayResults"><div ng-if="!x.isAnswer" ng-click="rankSel(x,false)"><rank-item rank-object="x" views="x.views"></rank-item></div><div ng-if="x.isAnswer" ng-click="ansSel(x)"><answer-item answer-object="x"></answer-item></div></div></div><div ng-if="scrollDataLoading && !endReached" class="col-xs-12 text-center"><a><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"> Loading More...</a></div><div ng-if="endReached" class="col-xs-12 text-center" style="border: 1px solid #00b3e4;font-size: 20px">No more results.</div></div><div ng-attr-style="position:relative;width:100%;height:150px;" ng-if="!contentLoaded"><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px;position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"></div>'),
e.put("app/content/partials/trend-block.html",'<div class=""><div class=""><div class="col-xs-12 trend-tab" style="padding: 0px; background-color:#e6e6e6"><ul class="nav nav-tabs trend-tab" style="background-color: white"><li class="active" style="cursor: pointer"><a data-toggle="tab" href="#userfeed">Feed</a></li><li style="cursor: pointer"><a data-toggle="tab" href="#popular">Popular</a></li><li style="cursor: pointer"><a data-toggle="tab" href="#newest">Newest</a></li></ul><div class="tab-content" style=""><div class="tab-pane in active fade" style="padding-top:10px;padding-bottom:10px;" ng-class="showAll ==\'true\' ?\'\':\'trend-tab-single-page\'" id="userfeed"><userfeed-block show-all="true" show-qty="{{userfeedLimit}}"></userfeed-block><p class="text-center" style="color:blue; margin-top:10px" ng-if="showAll == \'true\'"><a class="btn btn-default" style="margin-right:20px;" ng-click="seeMore(\'userfeed\')">See More</a><a class="btn btn-default" ng-click="goBack()">Back</a></p></div><div class="tab-pane fade" style="padding-top:10px;padding-bottom:10px;" ng-class="showAll ==\'true\' ?\'\':\'trend-tab-single-page\'" id="popular"><div class="col-xs-12 media ranking-blog-item" ng-repeat="ranking in popularOrder | limitTo:popularLimit" style="cursor: pointer;" ng-click="rankSel(ranking)"><div class="profile-avatar-wrapper media-left"><img ng-src="{{ranking.realimage}}"></div><div class="media-body" style="vertical-align: middle;">{{ranking.title}} <span class="pull-right">{{ranking.views}} Views</span></div></div><p class="text-center" style="color:blue; margin-top:10px" ng-if="showAll == \'true\'"><a class="btn btn-default" style="margin-right:20px;" ng-click="seeMore(\'popular\')">See More</a><a class="btn btn-default" ng-click="goBack()">Back</a></p></div><div class="tab-pane fade" style="padding-top:10px;padding-bottom:10px;" id="newest" ng-class="showAll ==\'true\' ?\'\':\'trend-tab-single-page\'"><div class="col-xs-12 media ranking-blog-item" ng-repeat="ranking in newestOrder| limitTo:newestLimit" ng-click="rankSel(ranking)" style="cursor: pointer;"><div class="profile-avatar-wrapper media-left"><img ng-src="{{ranking.realimage}}"></div><div class="media-body" style="vertical-align: middle;">{{ranking.title}}<span class="pull-right">{{ranking.humanized}}</span></div></div><p class="text-center" style="color:blue; margin-top:10px" ng-if="showAll == \'true\'"><a class="btn btn-default" style="margin-right:20px;" ng-click="seeMore(\'newest\')">See More</a><a class="btn btn-default" ng-click="goBack()">Back</a></p></div></div><p class="text-center" style="color:blue;margin-top:10px" ng-if="showAll == \'false\'"><a class="btn btn-default" href="/trends">See More</a></p></div></div></div>'),e.put("app/content/partials/userfeed-block.html",'<button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="refreshFeed()"><span class="glyphicon glyphicon-refresh" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button><div ng-repeat="x in feeds | orderBy:\'-id\' | limitTo:fres" style="padding:0px;border:0px;margin-top:10px;"><div class="row" style="margin:4px"><div class="col-xs-12 media" style="padding-left: 5px;padding-right: 5px;"><div ng-if="!x.picture" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" ng-attr-style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"></div><div ng-if="x.action == \'addedAnswer\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} added <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a> to <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a>.</div><div ng-if="x.action == \'upVoted\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} endorsed <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a> in <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a>.</div><div ng-if="x.action == \'downVoted\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} voted down <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a> in <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a>.</div><div ng-if="x.action == \'commentR\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} posted a comment in <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a>.</div><div ng-if="x.action == \'commentA\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} posted a comment for <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div><div ng-if="x.action == \'editA\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} edited the information of <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div><div ng-if="x.action == \'upVotedVrow\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} endorses the opinion: <em>{{x.text2}}</em> for <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div><div ng-if="x.action == \'downVotedVrow\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} disagrees with the opinion: <em>{{x.text2}}</em> for <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div><div ng-if="x.action == \'binded\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} bound account to <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div><div ng-if="x.action == \'addedRank\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} added a new ranking <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a>.</div><div ng-if="x.action == \'addedCustomRank\'" class="media-body" style="vertical-align: middle;">{{x.actorusername}} created the ranking <a ng-click="gotoRank(x)" style="cursor:pointer">{{x.text2}}</a> for <a ng-click="gotoAnswer(x)" style="cursor:pointer">{{x.text1}}</a>.</div></div></div></div>'),e.put("app/customer/Partials/customer.html",'<div ui-view="navbar"></div><br><h2>Select business you wish to manage</h2><div ng-repeat="x in vm.answers"><label><input type="radio" name="businessradio" ng-click="vm.selAnswer(x)">&nbsp;&nbsp;{{x.name}}, {{x.location}}, {{x.cityarea}}</label></div><br><div class="text-center"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-success {{vm.loadMainPhoto}}" ng-click="vm.loadMainPhoto()">Main Photo</button> <button class="btn btn-primary {{vm.loadSpecials}}" ng-click="vm.loadSpecials()">Specials</button> <button class="btn btn-danger {{vm.loadPhotoGallery}}" ng-click="vm.loadPhotoGallery()">Photo Gallery</button></div></div><br><br><div ui-view=""></div><br><br><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer>'),e.put("app/customer/Partials/editspecial.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.header}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><h3>{{ vm.isEdit ? \'Edit Special\':\'Add Special\'}}</h3><br><div class="well"><div class="row"><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-right">Specials Title:</p></div><div class="col-xs-12 col-sm-4 col-md-4"><input class="form-control" ng-model="vm.sp.stitle" type="text" placeholder="Special Banner" ng-change="vm.displayCharLength()" maxlength="25" ng-attr-style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}}"></div><div class="col-xs-8 hidden-sm hidden-md hidden-lg hidden-xl"></div><div class="col-xs-6 col-sm-4 col-md-4"><p class="text-left">{{vm.char}} chars left</p></div></div><br><div class="row"><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Background Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.sp.bc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><p class="text-right">Font Color</p></div><div class="col-xs-6 col-sm-2 col-md-2 col-lg-2"><color-picker ng-model="vm.sp.fc" color-picker-swatch="true" color-picker-swatch-pos="\'left\'" color-picker-swatch-bootstrap="true" color-picker-swatch-only="true"></color-picker></div><div class="hidden-xs col-sm-2 col-md-2 col-lg-2"></div></div><p class="text-left">Frequency</p><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.sp.freq == \'onetime\'? \'active\':\'\'}}" ng-click="vm.frequencySel(1)">One-Time</button> <button class="btn btn-primary {{vm.sp.freq == \'weekly\'? \'active\':\'\'}}" ng-click="vm.frequencySel(2)">Weekly</button></div><br><br><br><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">Start date:</p></div></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.sdate" type="text"></datepicker></div></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><select ng-model="vm.sp.stime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime}}</option></select></div></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><div ng-if="vm.onetime"><p class="text-right">End date:</p></div></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><datepicker date-format="EEE MMM d y" date-year-title="selected title------"><input ng-model="vm.sp.edate" type="text"></datepicker></div></div><div class="row"><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><p class="text-right">End time:</p></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3" ng-if="vm.onetime"><select ng-model="vm.sp.etime" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime}}</option></select></div></div><div class="row"><div class="text-center"><div class="col-xs-12 col-sm-12 col-md-12" ng-if="vm.weekly"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.mon" value="">Mon</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.tue" value="">Tue</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.wed" value="">Wed</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.thu" value="">Thu</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.fri" value="">Fri</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sat" value="">Sat</label> <label class="checkbox-inline"><input type="checkbox" ng-model="vm.sp.sun" value="">Sun</label></div></div></div><br><div class="row"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><p class="text-right">Start time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><select ng-model="vm.sp.stime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.stime2}}</option></select></div></div></div><div class="row"><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><p class="text-right">End time:</p></div></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><div ng-if="vm.weekly"><select ng-model="vm.sp.etime2" ng-options="x for x in vm.timeDD"><option value="">{{vm.sp.etime2}}</option></select></div></div></div><br><div class="row"><div class="col-sm-0 col-md-3 col-lg-3"></div><div class="container col-sm-12 col-md-6 col-lg-6"><p>Event Details</p><textarea class="form-control" ng-model="vm.sp.details" placeholder="{{x.label}}" rows="4" ng-attr-style="background-color:{{vm.sp.bc}};color:{{vm.sp.fc}};width:100%"></textarea></div><div class="col-sm-0 col-md-3 col-lg-3"></div><br></div><div class="row"><div class="col-sm-0 col-md-3 col-lg-3"></div><div class="container col-sm-12 col-md-6 col-lg-6"><div class=""><p>Event Image</p><img src="{{vm.imageURL}}" alt="{{image.errorLoading}}" style="width:100%; max-height:300px"><div ng-if="vm.userIsOwner"><blob-upload></blob-upload></div></div></div><div class="col-sm-0 col-md-3 col-lg-3"></div><br></div><br><div class="form-group text-center"><button type="button" class="btn btn-success" ng-click="vm.goBack()">Back</button> <button type="button" class="btn btn-primary" ng-click="vm.showPreview()">Preview</button> <button type="button" class="btn btn-danger" ng-click="vm.deleteSpecial()" ng-attr-style="display:{{vm.isEdit ? \'inline\':\'none\'}}">Delete</button></div></div>'),e.put("app/customer/Partials/editvrows.html",'<div class="container"><div class="well-sm"><h3 class="sub-header">{{vm.header}} <span class="nomargin"><button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" ng-click="vm.closeRank()"><span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span></button></span></h3></div></div><div ng-repeat="x in vm.vrows track by $index"><div ng-attr-style="display:{{x.shdr ? \'inline\':\'none\'}}"><br></div><div class="row"><div ng-attr-style="display:{{x.shdr ? \'inline\':\'none\'}}"><div class="col-xs-10" style="background-color:gray;color:white;"><p>{{x.gtitle}}</p></div><div class="col-xs-2"><button type="button" class="btn btn-default" ng-click="vm.editVRowGroupDiag(x)"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></div></div></div><div ng-attr-style="display:{{x.title != \'-\' ? \'inline\':\'none\'}}"><div class="row"><div class="col-xs-10" style="background-color:#d9d9d9;padding-top:2px;padding-bottom:2px;">{{x.title}}</div><div class="col-xs-2"><div class="btn-group"><button type="button" class="btn btn-default" ng-click="vm.deleteVRowDiag(x)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div></div></div></div><div ng-attr-style="display:{{x.saddr ? \'inline\':\'none\'}}"><div class="row"><div class="col-xs-10"><div class="text-right"><button type="button" class="btn btn-default" ng-click="vm.addVRowDiag(x)">Add Vote Row</button></div></div><div class="col-xs-2"></div></div></div></div><br><div class="text-left"><button type="button" class="btn btn-default" ng-click="vm.addVRowGroupDiag()">Add Group</button></div><div class="text-right"><button type="button" class="btn btn-success" ng-click="vm.closeRank()">Go Back</button></div>'),e.put("app/customer/Partials/mainphoto.html","<h1>Main Photo</h1>"),e.put("app/customer/Partials/photogallery.html","<h1>Photo Gallery</h1>"),e.put("app/customer/Partials/specials.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading specials...</p></div></div><div ng-if="vm.dataReady"><h2>Specials Manager</h2><br><p class="text-left">You have purchased premium membership for this Establishment. You can add up to 7 specials and promotions.</p><table class="table"><tbody><thead style="border-style:none;"><tr><th>Special</th><th></th><th></th></tr></thead><tr ng-repeat="x in vm.specialsList" style="cursor:pointer;"><td ng-if="x.used" style="width:80%">{{x.stitle}}</td><td ng-if="!x.used" style="width:80%;color:#808080"><i>Empty</i></td><td ng-if="x.used" style="width:10%"><button class="btn btn-primary" ng-click="vm.selSpecial(x)">Edit</button></td><td ng-if="x.used" style="width:10%"><button class="btn btn-danger" ng-click="vm.deleteSpecial(x)">Delete</button></td><td ng-if="!x.used" style="width:10%"><button class="btn btn-success" ng-click="vm.addSpecial()">Add</button></td></tr></tbody></table><p class="text-left">Specials are a great way to let people know all the great offers you have at any time.</p><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div></div>'),e.put("app/layout/Partials/about.html",'<div class="container"><div class="jumbotron"><br><div class="row"><div class="col-sm-0 col-md-2 col-lg-3"></div><div class="col-sm-12 col-md-8 col-lg-6"><img src="{{vm.logoimage}}" class="displayed-uc" alt="Cinque Terre" ng-attr-style="width:100%;height:{{vm.sm ? \'100px\':\'200px\'}}"></div><div class="col-sm-0 col-md-2 col-lg-3"></div></div><br><br><p>Rank-X collects users preferences to generate truly collective rankings on all things about your city.</p><br></div><div class="well"><div class="form-group text-left"><p>San Diego, CA - 2016</p><p>Contact: contact@rank-x.com</p></div></div><br><div class="form-group text-center"><button type="button" class="btn btn-primary" ng-click="vm.goBack()">Back</button></div></div>'),e.put("app/layout/Partials/city-selection.html",'<div class="modal fade" id="selectCityModal" tabindex="-1" role="dialog" aria-labelledby="selectCityModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="selectCityModalLabel">Select City</h4></div><div class="modal-body" ng-attr-style="height: 2*{{50px"><div class="col-md-12" style="height: 250px"><div class="col-md-6"><input placeholder="Search City" class="form-control" ng-model="searchCity"></div><div class="clearfix" style="margin-bottom: 24px"></div><div class="col-md-3" ng-repeat="city in cities | searchObject : searchCity : \'name\' | orderObjectBy : \'name\'"><a href="#" ng-click="selectCity(city)" ng-if="city.is_active">{{city.name}}</a></div><div class="col-md-12 text-center" style="height: 150px;padding-top: 50px" ng-if="(cities | searchObject : searchCity : \'name\' | objectLength) == 0"><span class="text-muted">City not found.</span></div></div></div></div></div></div>'),
e.put("app/layout/Partials/customertos.html",'<style>\r\n    #ppBody {\r\n        font-size: 11pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n        text-align: justify;\r\n    }\r\n    \r\n    #ppHeader {\r\n        font-family: verdana;\r\n        font-size: 21pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n    }\r\n    \r\n    .ppConsistencies {\r\n        display: none;\r\n    }\r\n\r\n\r\n    #ppBody > ol > li {\r\n        margin-bottom: 30px;\r\n    }\r\n    \r\n    #ppBody > ol > li > ul > li{\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    #ppBody > ol > li > ul > li > ol >li{\r\n        margin-bottom: 10px;\r\n    }\r\n</style><div class="container"><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><div id="ppHeader"><span><img src="/assets/images/logo_sq.png" style="width:80px"></span> Rank-X Terms of Use</div><div id="ppBody">These terms of service constitute a legally binding agreement (the Agreement) between you and Rank-X, LLC (Rank-X we, us or our) governing your use of the Rank-X application, website, and technology platform (collectively, the Rank-X Platform). PLEASE BE ADVISED: THIS AGREEMENT CONTAINS PROVISIONS THAT GOVERN HOW CLAIMS YOU AND RANK-X HAVE AGAINST EACH OTHER CAN BE BROUGHT (SEE SECTION 16 BELOW). THESE PROVISIONS WILL, WITH LIMITED EXCEPTION, REQUIRE YOU TO SUBMIT CLAIMS YOU HAVE AGAINST RANK-X TO BINDING AND FINAL ARBITRATION ON AN INDIVIDUAL BASIS, NOT AS A PLAINTIFF OR CLASS MEMBER IN ANY CLASS, GROUP OR REPRESENTATIVE ACTION OR PROCEEDING. AS A DRIVER, YOU HAVE AN OPPORTUNITY TO OPT OUT OF ARBITRATION WITH RESPECT TO CERTAIN CLAIMS AS PROVIDED IN SECTION 17. By entering into to this Agreement, you expressly acknowledge that you understand this Agreement (including the dispute resolution and arbitration provisions Section 16) and accept all of its terms. IF YOU DO NOT AGREE TO BE BOUND BY THE TERMS AND CONDITIONS OF THIS AGREEMENT, YOU MAY NOT USE OR ACCESS THE RANK-X PLATFORM.<ol><li><b>The Rank-X Platform</b> The Rank-X Platform provides an online platform that creates lists, rankings, and forums about businesses, activities, locations, and venues (Collectively Businesses). The lists, rankings, and forums within the Rank-X Platform are generated by persons who use the site (Users) to rank and comment on Businesses they have experienced. The Rank-X Platform also allows persons to promote Rank-X to various Businesses (Promoters) in exchange for a commission-based percentage of the revenue generated by Businesses who the Promoter successfully signs up for Rank-Xs Premium Membership. Each individual Promoter will be assigned a unique alphanumeric code (Code). Each Business that signs up for Rank-Xs Premium Membership will use the Code assigned to the Promoter that contacted them to gain access to Rank-Xs Premium Membership benefits. When a Business uses this Code, the Business will be given sixty (60) days of free access to the Premium Membership. If a Business, after the 60-day free period expires, chooses to continue accessing Rank-Xs Premium Membership benefits, it will do so by using the Promoters Code to sign up for continued Premium Membership benefits at the specified cost.</li><li><b>Modification to the Agreement</b> In the event Rank-X modifies the terms and conditions of this Agreement, such modifications shall be binding on you only upon your acceptance of the modified Agreement. Rank-X reserves the right to modify any information referenced in the hyperlinks from this Agreement from time to time, and such modifications shall become effective upon posting. Continued use of the Rank-X Platform or Services after any such changes shall constitute your consent to such changes. Unless material changes are made to the arbitration provisions herein, you agree that modification of this Agreement does not create a renewed opportunity to opt out of arbitration (if applicable).</li><li><b>Eligibility</b> The Rank-X Platform may only be used by individuals and businesses who can form legally binding contracts under applicable law. The Rank-X Platform is not available to children (persons under the age of 18) or Premium Members who have had their Premium Member account temporarily or permanently deactivated. By becoming a Premium Member of Rank-Xs Platform, you represent and warrant that you are at least 18 years old and that you have the right, authority and capacity to enter into and abide by the terms and conditions of this Agreement. You may not allow other persons to use your Businesss Rank-X account, and you agree that you are the sole authorized user of your account.</li><li><b>Costs and Fees</b> If you are a business, you may obtain the benefits of Rank-Xs Premium Membership by paying the specified monthly membership fee. Rank-Xs Premium Membership fees are set out in Section 4(b) below.<ol type="a"><li><b>Costs and Fees</b> A Business may sign up for and purchase Rank-Xs Premium Membership in order to utilize the various benefits of doing so. Premium Membership for purposes of this agreement refers to a Businesss ability to promote the Businesss menu, specials, and activities, which drives additional online traffic to the Businesss profile, in exchange for a monthly Premium Membership fee. Rank-X reserves the right to change the pricing schedule for Premium Memberships at any time in our discretion based upon local market factors, and we will provide you with notice if our prices do change.</li><li><b>Membership Fees and Payment Schedule.</b> Rank-Xs Premium Membership costs vary depending on the industry and business type that the business is associated with, as set out in Section 4(c) below. Additionally, Businesses may purchase custom rankings at the price of $45.00 per month. Rank-X charges Businesses once per month for Premium Membership benefits, which will continue to be accessible by Businesses until and unless this Agreement has been materially breached or terminated with or without cause.</li><li><b>Premium Membership Fee Schedule.</b> Premium Membership pricing is determined by the industry and size of the Business (Business Class) purchasing the Premium Membership. For example, a large, national, and well known company or brand will pay a higher monthly Premium Membership fee than a small mom and pop caf or retail shop. A Business that fits within more than one Business Class will pay the higher Premium Membership fee. Thus, for example, if a Business fits within the Small Business Enterprise Business Class as well as the Restaurants and Bars Business Class, the Business will pay the Restaurants and Bars Business Class rate because that rate is higher than the Small Business Enterprise Business Class.<ol type="i"><li><b>The Premium Membership Pricing of Each Business Class is as Follows:</b><ol><li>Enterprise (ENT)  Large National Brands (e.g., AT&T, Verizon, Starbucks, etc.)</li><li>Large Business (LBZ)  Large Companies (e.g., Car Dealerships, etc.)</li><li>Restaurants and Bars (REB)  Food and Beverage Industry (e.g., Diners, Bars, Clubs, etc.)</li><li>Medium Size Business (MBZ)  Mid-Sized Companies (e.g., Auto Repair Shops, Sporting Supplies, etc.)</li><li>Small Business Establishment (SBZ)  Small Businesses (e.g., Hair Salons, Flower Shops, Computer Repair Shops, Crossfit Gyms, etc.)</li><li>Personal Business/Sole Proprietorship (PER)  (e.g., Personal Trainers, Yoga Instructors, Music Teachers, Mobile Auto-Repair, etc.)</li></ol></li><li><b>Which Business Class a Business falls into is determined with the sole and absolute discretion of Rank-X. The Business Class that a Business falls into can be changed at any time if it is determined by Rank-X that the Business has changed in such a way that warrants a change in Business Class.</b></li></ol></li></ol></li></ol><li><b>Communications</b> By becoming a Premium Member, you agree to receive communications from us, including via e-mail, text message, calls, and push notifications. You agree that texts, calls or prerecorded messages may be generated by automatic telephone dialing systems. Communications from Rank-X, its affiliated companies and/or Drivers, may include but are not limited to: operational communications concerning your Premium Member account or use of the Rank-X Platform or Services, updates concerning new and existing features on the Rank-X Platform, communications concerning promotions run by us or our third-party partners, and news concerning Rank-X and industry developments. Standard text messaging charges applied by your cell phone carrier will apply to text messages we send.<br>IF YOU WISH TO OPT OUT OF PROMOTIONAL EMAILS, YOU CAN UNSUBSCRIBE FROM OUR PROMOTIONAL EMAIL LIST BY FOLLOWING THE UNSUBSCRIBE OPTIONS IN THE PROMOTIONAL EMAIL ITSELF. YOU ACKNOWLEDGE THAT YOU ARE NOT REQUIRED TO CONSENT TO RECEIVE PROMOTIONAL TEXTS OR CALLS AS A CONDITION OF USING THE PLATFORM OR THE SERVICES. IF YOU WISH TO OPT OUT OF ALL TEXTS OR CALLS FROM (INCLUDING OPERATIONAL OR TRANSACTIONAL TEXTS OR CALLS), YOU CAN NOTIFY US VIA EMAIL, HOWEVER YOU ACKNOWLEDGE THAT OPTING OUT OF RECEIVING ALL TEXTS MAY IMPACT YOUR USE OF THE Rank-X PLATFORM OR THE SERVICES.</li><li><b>Your Information</b> Your Information is any information you provide, publish or post to or through the Rank-X Platform (including any profile information you provide) or send to other Users or Premium Members (including via in-application feedback, any email feature, or through any -related Facebook, Twitter or other social media posting) (your Information). You consent to us using your Information to create a Premium Member account that will allow you to use the Platform and participate in the Services. Our collection and use of personal information in connection with the Rank-X Platform and Services is as provided in Rank-Xs Privacy Policy located at www.Rank-X.com/privacy. You are solely responsible for your Information and your interactions with other members of the public, and we act only as a passive conduit for your online posting of your Information. You agree to provide and maintain accurate, current and complete information and that we and other members of the public may rely on your Information as accurate, current and complete. To enable Rank-X to use your Information, you grant to us a non-exclusive, worldwide, perpetual, irrevocable, royalty-free, transferable, sub-licensable (through multiple tiers) right and license to exercise the copyright, publicity, and database rights you have in your Information, and to use, copy, perform, display and distribute such Information to prepare derivative works, or incorporate into other works, such Information, in any media now known or not currently known. Rank-X does not assert any ownership over your Information; rather, as between you and Rank-X, subject to the rights granted to us in this Agreement, you retain full ownership of all of your Information and any intellectual property rights or other proprietary rights associated with your Information.<br>You may be able to create or log-in to your Rank-X Premium Member account through online accounts you may have with third party social networking sites (each such account, an "SNS Account"). By connecting to Rank-X through an SNS Account, you understand that Rank-X may access, store, and make available any SNS Account content according to the permission settings of your SNS Account (e.g., friends, mutual friends, contacts or following/followed lists (the SNS Content)). You understand that SNS Content may be available on and through the Rank-X Platform to other Users. Unless otherwise specified in this Agreement, all SNS Content, if any, shall be considered to be your Information.</li><li><b>Promotions and Referral Programs</b> Rank-X, at its sole discretion, may make available promotions with different features to any Premium Members or prospective Premium Members. These promotions, unless made to you, shall have no bearing whatsoever on your Agreement or relationship with Rank-X. Rank-X reserves the right to withhold or deduct credits or benefits obtained through a promotion in the event that Rank-X determines or believes that the redemption of the promotion or receipt of the credit or benefit was in error, fraudulent, illegal, or in violation of the applicable promotion terms or this Agreement.</li><li><b>Restricted Activities</b><ol type="a">With respect to your use of the Rank-X Platform and your participation in the Premium Membership, you agree that you will not:<li>impersonate any person, business, or government entity;</li><li>stalk, threaten, or otherwise harass any person or entity, or carry any weapons;</li><li>violate any law, statute, rule, permit, ordinance or regulation;</li><li>interfere with or disrupt the Services or the Rank-X Platform or the servers or networks connected to the Rank-X Platform;</li><li>post Information or interact on the Rank-X Platform or Services in a manner which is false, inaccurate, misleading (directly or by omission or failure to update information), defamatory, libelous, abusive, obscene, profane, offensive, sexually oriented, threatening, harassing, or illegal;</li><li>use the Rank-X Platform in any way that infringes any third partys rights, including but not limited to: intellectual property rights, copyright, patent, trademark, trade secret or other proprietary rights or rights of publicity or privacy;</li><li>post, email or otherwise transmit any malicious code, files or programs designed to interrupt, damage, destroy or limit the functionality of any computer software or hardware or telecommunications equipment or surreptitiously intercept or expropriate any system, data or personal information;</li><li>forge headers or otherwise manipulate identifiers in order to disguise the origin of any information transmitted through the Rank-X Platform;</li><li>frame or mirror any part of the Rank-X Platform, without our prior written authorization or use meta tags or code or other devices containing any reference to us in order to direct any person to any other web site for any purpose; or</li><li>modify, adapt, translate, reverse engineer, decipher, decompile or otherwise disassemble any portion of the Rank-X Platform or any software used on or for the Rank-X Platform;</li><li>rent, lease, lend, sell, redistribute, license or sublicense the Rank-X Platform or access to any portion of the Rank-X Platform;</li><li>use any robot, spider, site search/retrieval application, or other manual or automatic device or process to retrieve, index, scrape, data mine, or in any way reproduce or circumvent the navigational structure or presentation of the Rank-X Platform or its contents;</li><li>link directly or indirectly to any other web sites;</li><li>transfer or sell your Premium Member account, password and/or identification to any other party</li><li>discriminate against or harass anyone on the basis of race, national origin, religion, gender, gender identity, physical or mental disability, medical condition, marital status, age or sexual orientation, or</li><li>cause any third party to engage in the restricted activities above.</li></ol></li><li><b>Intellectual Property</b> All intellectual property rights in the Rank-X Platform shall be owned by Rank-X absolutely and in their entirety. These rights include and are not limited to database rights, copyright, design rights (whether registered or unregistered), trademarks (whether registered or unregistered) and other similar rights wherever existing in the world together with the right to apply for protection of the same. All other trademarks, logos, service marks, company or product names set forth in the Rank-X Platform are the property of their respective owners. You acknowledge and agree that any questions, comments, suggestions, ideas, feedback or other information (Submissions) provided by you to us are non-confidential and shall become the sole property of Rank-X. Rank-X shall own exclusive rights, including all intellectual property rights, and shall be entitled to the unrestricted use and dissemination of these Submissions for any purpose, commercial or otherwise, without acknowledgment or compensation to you.<br>Rank-X and other Rank-X logos, designs, graphics, icons, scripts and service names are registered trademarks, trademarks or trade dress of Rank-X in the United States and/or other countries (collectively, the Rank-X Marks). If you provide Services as a Premium Member, Rank-X grants to you, during the term of this Agreement, and subject to your compliance with the terms and conditions of this Agreement, a limited, revocable, non-exclusive license to display and use the Rank-X Marks solely in connection with providing the Services through the Rank-X Platform (License). The License is non-transferable and non-assignable, and you shall not grant to any third party any right, permission, license or sublicense with respect to any of the rights granted hereunder without Rank-Xs prior written permission, which it may withhold in its sole discretion. The Rank-X Marks may not be used in any manner that is likely to cause confusion.<br>You acknowledge that Rank-X is the owner and licensor of the Rank-X Marks, including all goodwill associated therewith, and that your use of the Rank-X Marks will confer no additional interest in or ownership of the Rank-X Marks in you but rather inures to the benefit of Rank-X. You agree to use the Rank-X Marks strictly in accordance with Rank-Xs Terms and Conditions and any other guidelines as may be provided to you and revised from time to time, and to immediately cease any use that Rank-X determines to nonconforming or otherwise unacceptable.<br>You agree that you will not: (1) create any materials that incorporate the Rank-X Marks or any derivatives of the Rank-X Marks other than as expressly approved by Rank-X in writing; (2) use the Rank-X Marks in any way that tends to impair their validity as proprietary trademarks, service marks, trade names or trade dress, or use the Rank-X Marks other than in accordance with the terms, conditions and restrictions herein; (3) take any other action that would jeopardize or impair Rank-Xs rights as owner of the Rank-X Marks or the legality and/or enforceability of the Rank-X Marks, including, without limitation, challenging or opposing Rank-Xs ownership in the Rank-X Marks; (4) apply for trademark registration or renewal of trademark registration of any of the Rank-X Marks, any derivative of the Rank-X Marks, any combination of the Rank-X Marks and any other name, or any trademark, service mark, trade name, symbol or word which is similar to the Rank-X Marks; (5) use the Rank-X Marks on or in connection with any product, service or activity that is in violation of any law, statute, government regulation or standard.<br>Violation of any provision of this License may result in immediate termination of the License, in Rank-Xs sole discretion. If you create any materials bearing the Rank-X Marks (in violation of this Agreement or otherwise), you agree that upon their creation Rank-X exclusively owns all right, title and interest in and to such materials, including without limitation any modifications to the Rank-X Marks or derivative works based on the Rank-X Marks. You further agree to assign any interest or right you may have in such materials to Rank-X, and to provide information and execute any documents as reasonably requested by Rank-X to enable Rank-X to formalize such assignment.<br>Rank-X respects the intellectual property of others, and expects Premium Members to do the same. If you believe, in good faith, that any materials on the Rank-X Platform or Services infringe upon your copyrights, please contact us via email.<br></li><li><b>Disclaimers</b> The following disclaimers are made on behalf of Rank-X, our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, and shareholders.<br>The Rank-X Platform is provided on an as is basis and without any warranty or condition, express, implied or statutory. We do not guarantee and do not promise any specific results from use of the Rank-X Platform and/or the Services, including the ability to provide or receive Services at any given location or time. We specifically disclaim any implied warranties of title, merchantability, fitness for a particular purpose and non-infringement. Some states do not allow the disclaimer of implied warranties, so the foregoing disclaimer may not apply to you.<br>We do not warrant that your use of the Rank-X Platform or Services will be accurate, complete, reliable, current, secure, uninterrupted, always available, or error- free, or will meet your requirements, that any defects in the Rank-X Platform will be corrected, or that the Rank-X Platform is free of viruses or other harmful components. We disclaim liability for, and no warranty is made with respect to, connectivity and availability of the Rank-X Platform or Services.<br>We cannot guarantee that each User of the Rank-X Platform is who he or she claims to be. Please use common sense when using the Rank-X Platform and Services. Please note that there are also risks of dealing with underage persons or people acting under false pretense, and we do not accept responsibility or liability for any content, communication or other use or access of the Rank-X Platform by persons under the age of 18 in violation of this Agreement.<br>Rank-X is not responsible for the conduct, whether online or offline, of any User of the Rank-X Platform or Services. You are solely responsible for your interactions with other Users.<br>Rank-X expressly disclaims any liability arising from the unauthorized use of your Premium Member account. Should you suspect that any unauthorized party may be using your Premium Member account or you suspect any other breach of security, you agree to notify us immediately.<br>Please carefully select the type of information that you post on the Rank-X Platform or through the Services or release to others. We disclaim all liability, regardless of the form of action, for the acts or omissions of other Users (including unauthorized users, or hackers).<br>Opinions, advice, statements, offers, or other information or content concerning Rank-X or made available through the Rank-X Platform, but not directly by us, are those of their respective authors, and should not necessarily be relied upon. Such authors are solely responsible for such content. Under no circumstances will we be responsible for any loss or damage resulting from your reliance on information or other content posted by third parties, whether on the Rank-X Platform or otherwise. We reserve the right, but we have no obligation, to monitor the materials posted on the Rank-X Platform and remove any such material that in our sole opinion violates, or is alleged to violate, the law or this agreement or which might be offensive, illegal, or that might violate the rights, harm, or threaten the safety of Users or others.<br>This paragraph applies to any version of the Rank-X Platform that you acquire from the Apple App Store. This Agreement is entered into between you and Rank-X. Apple, Inc. (Apple) is not a party to this Agreement and shall have no obligations with respect to the Rank-X Platform. Rank-X, not Apple, is solely responsible for the Rank-X Platform and the content thereof as set forth hereunder. However, Apple and Apples subsidiaries may be third party beneficiaries of this Agreement. Upon your acceptance of this Agreement, Apple shall have the right (and will be deemed to have accepted the right) to enforce this Agreement against you as a third party beneficiary thereof. This Agreement incorporates by reference Apples Licensed Application End User License Agreement, for purposes of which, you are the end-user. In the event of a conflict in the terms of the Licensed Application End User License Agreement and this Agreement, the terms of this Agreement shall control.</li><li><b>Indemnity</b> You will defend, indemnify, and hold Rank-X including our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, or shareholders harmless from any claims, actions, suits, losses, costs, liabilities and expenses (including reasonable attorneys fees) relating to or arising out of your use of the Rank-X Platform and participation in the Services, including: (1) your breach of this Agreement or the documents it incorporates by reference; (2) your violation of any law or the rights of a third party, including, without limitation, Drivers, Riders, other motorists, and pedestrians, as a result of your own interaction with such third party; (3) any allegation that any materials that you submit to us or transmit through the Rank-X Platform or to us infringe or otherwise violate the copyright, trademark, trade secret or other intellectual property or other rights of any third party; (4) your ownership, use or operation of a motor vehicle or passenger vehicle, including your provision of Services as a Driver; and/or (5) any other activities in connection with the Services. This indemnity shall be applicable without regard to the negligence of any party, including any indemnified person.</li><li><b>Limitation of Liability</b> IN NO EVENT WILL RANK-X, INCLUDING OUR AFFILIATES, SUBSIDIARIES, PARENTS, SUCCESSORS AND ASSIGNS, AND EACH OF OUR RESPECTIVE OFFICERS, DIRECTORS, EMPLOYEES, AGENTS, OR SHAREHOLDERS (COLLECTIVELY RANK-X FOR PURPOSES OF THIS SECTION), BE LIABLE TO YOU FOR ANY INCIDENTAL, SPECIAL, EXEMPLARY, PUNITIVE, CONSEQUENTIAL, OR INDIRECT DAMAGES (INCLUDING, BUT NOT LIMITED TO, DAMAGES FOR DELETION, CORRUPTION, LOSS OF DATA, LOSS OF PROGRAMS, FAILURE TO STORE ANY INFORMATION OR OTHER CONTENT MAINTAINED OR TRANSMITTED BY THE RANK-X PLATFORM, SERVICE INTERRUPTIONS, OR FOR THE COST OF PROCUREMENT OF SUBSTITUTE SERVICES) ARISING OUT OF OR IN CONNECTION WITH THE RANK-X PLATFORM, THE SERVICES, OR THIS AGREEMENT, HOWEVER ARISING INCLUDING NEGLIGENCE, EVEN IF WE OR OUR AGENTS OR REPRESENTATIVES KNOW OR HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. THE RANK-X PLATFORM MAY BE USED BY YOU TO REQUEST AND SCHEDULE TRANSPORTATION, GOODS, OR OTHER SERVICES WITH THIRD PARTY PROVIDERS, BUT YOU AGREE THAT RANK-X HAS NO RESPONSIBILITY OR LIABILITY TO YOU RELATED TO ANY TRANSPORTATION, GOODS OR OTHER SERVICES PROVIDED TO YOU BY THIRD PARTY PROVIDERS OTHER THAN AS EXPRESSLY SET FORTH IN Their TERMS. CERTAIN JURISDICTIONS MAY NOT ALLOW THE EXCLUSION OR LIMITATION OF CERTAIN DAMAGES. IF THESE LAWS APPLY TO YOU, SOME OR ALL OF THE ABOVE DISCLAIMERS, EXCLUSIONS OR LIMITATIONS MAY NOT APPLY TO YOU, AND YOU MAY HAVE ADDITIONAL RIGHTS.</li><li><b>Term and Termination</b> This Agreement is effective upon your creation of a Premium Member account. This Agreement may be terminated: a) by Premium Member, without cause, upon seven (7) days prior written notice to Rank-X; or b) by either Party immediately, without notice, upon the other Partys material breach of this Agreement, including but not limited to any breach of Section 8 or breach of Section 9 of this Agreement. In addition, Rank-X may terminate this Agreement or deactivate your User account immediately in the event: (1) you no longer qualify to provide Services or to operate the approved vehicle under applicable law, rule, permit, ordinance or regulation; (2) you fall below Rank-Xs star rating or cancellation threshold; (3) Rank-X has the good faith belief that such action is necessary to protect the safety of the Rank-X community or third parties, provided that in the event of a deactivation pursuant to (1)-(3) above, you will be given notice of the potential or actual deactivation and an opportunity to attempt to cure the issue to Rank-Xs reasonable satisfaction prior to Rank-X permanently terminating the Agreement. For all other breaches of this Agreement, you will be provided notice and an opportunity to cure the breach. If the breach is cured in a timely manner and to Rank-Xs satisfaction, this Agreement will not be permanently terminated. Sections 2, 4, 6, 9 (with respect to the license), 10-12, 14-16 shall survive any termination or expiration of this Agreement.</li><li><b>Confidentiality</b> You agree not to use any technical, financial, strategic and other proprietary and confidential information relating to Rank-Xs business, operations and properties, including Premium Member information (Confidential Information) disclosed to you by Rank-X for your own use or for any purpose other than as contemplated herein. You shall not disclose or permit disclosure of any Confidential Information to third parties. You agree to take all reasonable measures to protect the secrecy of and avoid disclosure or use of Confidential Information of Rank-X in order to prevent it from falling into the public domain. Notwithstanding the above, you shall not have liability to Rank-X with regard to any Confidential Information which you can prove: was in the public domain at the time it was disclosed by Rank-X or has entered the public domain through no fault of yours; was known to you, without restriction, at the time of disclosure, as demonstrated by files in existence at the time of disclosure; is disclosed with the prior written approval of Rank-X; becomes known to you, without restriction, from a source other than Rank-X without breach of this Agreement by you and otherwise not in violation of Rank-Xs rights; or is disclosed pursuant to the order or requirement of a court, administrative agency, or other governmental body; provided, however, that You shall provide prompt notice of such court order or requirement to Rank-X to enable Rank-X to seek a protective order or otherwise prevent or restrict such disclosure.</li><li><b>General</b> Except as provided in Section 16, this Agreement shall be governed by the laws of the State of California without regard to choice of law principles. This choice of law provision is only intended to specify the use of California law to interpret this Agreement and is not intended to create any other substantive right to non-Californians to assert claims under California law whether by statute, common law, or otherwise. If any provision of this Agreement is or becomes invalid or non-binding, the parties shall remain bound by all other provisions hereof. In that event, the parties shall replace the invalid or non- binding provision with provisions that are valid and binding and that have, to the greatest extent possible, a similar effect as the invalid or non-binding provision, given the contents and purpose of this Agreement. You agree that this Agreement and all incorporated agreements may be automatically assigned by Rank-X, in our sole discretion by providing notice to you. Except as explicitly stated otherwise, any notices to Rank-X shall be given by certified mail, postage prepaid and return receipt requested to Rank-X. Any notices to you shall be provided to you through the Rank-X Platform or given to you via the email address or physical you provide to Rank-X during the registration process. Headings are for reference purposes only and in no way define, limit, construe or describe the scope or extent of such section. A partys failure to act with respect to a breach by the other party does not constitute a waiver of the partys right to act with respect to subsequent or similar breaches. This Agreement sets forth the entire understanding and agreement between you and Rank-X with respect to the subject matter hereof and supersedes all previous understandings and agreements between the parties, whether oral or written.</li><li><b>Dispute Resolution and Arbitration Agreement</b><ol type="a"><li><b>Agreement to Binding Arbitration Between You and Rank-X.</b> YOU AND RANK-X MUTUALLY AGREE TO WAIVE OUR RESPECTIVE RIGHTS TO RESOLUTION OF DISPUTES IN A COURT OF LAW BY A JUDGE OR JURY AND AGREE TO RESOLVE ANY DISPUTE BY ARBITRATION, as set forth below. This agreement to arbitrate (Arbitration Agreement) is governed by the Federal Arbitration Act and survives after the Agreement terminates or your relationship with Rank-X ends. ANY ARBITRATION UNDER THIS AGREEMENT WILL TAKE PLACE ON AN INDIVIDUAL BASIS; CLASS ARBITRATIONS AND CLASS ACTIONS ARE NOT PERMITTED. Except as expressly provided below, this Arbitration Agreement applies to all Claims (defined below) between you and Rank-X, including our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, or shareholders.<br>Except as expressly provided below, ALL DISPUTES AND CLAIMS BETWEEN US (EACH A CLAIM AND COLLECTIVELY, CLAIMS) SHALL BE EXCLUSIVELY RESOLVED BY BINDING ARBITRATION SOLELY BETWEEN YOU AND RANK-X. These Claims include, but are not limited to, any dispute, claim or controversy, whether based on past, present, or future events, arising out of or relating to: this Agreement and prior versions thereof (including the breach, termination, enforcement, interpretation or validity thereof), the Rank-X Platform, the Services, any other goods or services made available through the Rank-X Platform, your relationship with Rank-X, the threatened or actual suspension, deactivation or termination of your Premium Member Account or this Agreement, payments made by you or any payments made or allegedly owed to you, any promotions or offers made by Rank-X, any city, county, state or federal wage-hour law, trade secrets, unfair competition, compensation, breaks and rest periods, expense reimbursement, wrongful termination, discrimination, harassment, retaliation, fraud, defamation, emotional distress, breach of any express or implied contract or covenant, claims arising under federal or state consumer protection laws; claims arising under antitrust laws, claims arising under the Telephone Consumer Protection Act and Fair Credit Reporting Act; and claims arising under the Uniform Trade Secrets Act, Civil Rights Act of 1964, Americans With Disabilities Act, Age Discrimination in Employment Act, Older Workers Benefit Protection Act, Family Medical Leave Act, Fair Labor Standards Act, Employee Retirement Income Security Act (except for individual claims for employee benefits under any benefit plan sponsored by Rank-X and covered by the Employee Retirement Income Security Act of 1974 or funded by insurance), and state statutes, if any, addressing the same or similar subject matters, and all other federal and state statutory and common law claims. All disputes concerning the arbitrability of a Claim (including disputes about the scope, applicability, enforceability, revocability or validity of the Arbitration Agreement) shall be decided by the arbitrator, except as expressly provided below.<br>BY AGREEING TO ARBITRATION, YOU UNDERSTAND THAT YOU AND RANK-X ARE WAIVING THE RIGHT TO SUE IN COURT OR HAVE A JURY TRIAL FOR ALL CLAIMS, EXCEPT AS EXPRESSLY OTHERWISE PROVIDED IN THIS ARBITRATION AGREEMENT. This Arbitration Agreement is intended to require arbitration of every claim or dispute that can lawfully be arbitrated, except for those claims and disputes which by the terms of this Arbitration Agreement are expressly excluded from the requirement to arbitrate.</li><li><b>Prohibition of Class Actions and Non-Individualized Relief.</b> YOU UNDERSTAND AND AGREE THAT YOU AND RANK-X MAY EACH BRING CLAIMS IN ARBITRATION AGAINST THE OTHER ONLY IN AN INDIVIDUAL CAPACITY AND NOT ON A CLASS, COLLECTIVE ACTION, OR REPRESENTATIVE BASIS (CLASS ACTION WAIVER). YOU UNDERSTAND AND AGREE THAT YOU AND RANK-X BOTH ARE WAIVING THE RIGHT TO PURSUE OR HAVE A DISPUTE RESOLVED AS A PLAINTIFF OR CLASS MEMBER IN ANY PURPORTED CLASS, COLLECTIVE OR REPRESENTATIVE PROCEEDING. NOTWITHSTANDING THE FOREGOING, THIS SUBSECTION (B) SHALL NOT APPLY TO REPRESENTATIVE PRIVATE ATTORNEYS GENERAL ACT CLAIMS BROUGHT AGAINST RANK-X, WHICH ARE ADDRESSED SEPARATELY IN SECTION 17(C).<br>The arbitrator shall have no authority to consider or resolve any Claim or issue any relief on any basis other than an individual basis. The arbitrator shall have no authority to consider or resolve any Claim or issue any relief on a class, collective, or representative basis.<br>Notwithstanding any other provision of this Agreement, the Arbitration Agreement or the AAA Rules, disputes regarding the scope, applicability, enforceability, revocability or validity of the Class Action Waiver may be resolved only by a civil court of competent jurisdiction and not by an arbitrator. In any case in which: (1) the dispute is filed as a class, collective, or representative action and (2) there is a final judicial determination that the Class Action Waiver is unenforceable as to any Claims, the class, collective, and/or representative action on such Claims must be litigated in a civil court of competent jurisdiction, but the Class Action Waiver shall be enforced in arbitration on an individual basis as to all other Claims to the fullest extent possible.</li><li><b>Representative PAGA Waiver.</b> Notwithstanding any other provision of this Agreement or the Arbitration Agreement, to the fullest extent permitted by law: (1) you and Rank-X agree not to bring a representative action on behalf of others under the Private Attorneys General Act of 2004 (PAGA), California Labor Code  2698 et seq., in any court or in arbitration, and (2) for any claim brought on a private attorney general basis, including under the California PAGA, both you and Rank-X agree that any such dispute shall be resolved in arbitration on an individual basis only (i.e., to resolve whether you have personally been aggrieved or subject to any violations of law), and that such an action may not be used to resolve the claims or rights of other individuals in a single or collective proceeding (i.e., to resolve whether other individuals have been aggrieved or subject to any violations of law) (collectively, representative PAGA Waiver). Notwithstanding any other provision of this Agreement, the Arbitration Agreement or the AAA Rules, disputes regarding the scope, applicability, enforceability, revocability or validity of this representative PAGA Waiver may be resolved only by a civil court of competent jurisdiction and not by an arbitrator. If any provision of this representative PAGA Waiver is found to be unenforceable or unlawful for any reason: (i) the unenforceable provision shall be severed from this Agreement; (ii) severance of the unenforceable provision shall have no impact whatsoever on the Arbitration Agreement or the requirement that any remaining Claims be arbitrated on an individual basis pursuant to the Arbitration Agreement; and (iii) any such representative PAGA or other representative private attorneys general act claims must be litigated in a civil court of competent jurisdiction and not in arbitration. To the extent that there are any Claims to be litigated in a civil court of competent jurisdiction because a civil court of competent jurisdiction determines that the representative PAGA Waiver is unenforceable with respect to those Claims, the Parties agree that litigation of those Claims shall be stayed pending the outcome of any individual Claims in arbitration.</li><li><b>Rules Governing the Arbitration.</b> Any arbitration conducted pursuant to this Arbitration Agreement shall be administered by the American Arbitration Association (AAA) pursuant to its Consumer Arbitration Rules that are in effect at the time the arbitration is initiated, as modified by the terms set forth in this Agreement. Copies of these rules can be obtained at the AAAs website (www.adr.org) (the AAA Rules) or by calling the AAA at 1-800-778-7879. Notwithstanding the foregoing, if requested by you and if proper based on the facts and circumstances of the Claims presented, the arbitrator shall have the discretion to select a different set of AAA Rules, but in no event shall the arbitrator consolidate more than one persons Claims, or otherwise preside over any form of representative, collective, or class proceeding.<br>As part of the arbitration, both you and Rank-X will have the opportunity for reasonable discovery of non-privileged information that is relevant to the Claim. The arbitrator may award any individualized remedies that would be available in court. The arbitrator may award declaratory or injunctive relief only in favor of the individual party seeking relief and only to the extent necessary to provide relief warranted by that party\'s individual claims. The arbitrator will provide a reasoned written statement of the arbitrators decision which shall explain the award given and the findings and conclusions on which the decision is based.<br>The arbitrator will decide the substance of all claims in accordance with applicable law, and will honor all claims of privilege recognized by law. The arbitrator shall not be bound by rulings in prior arbitrations involving different Riders or Drivers, but is bound by rulings in prior arbitrations involving the same Rider or Driver to the extent required by applicable law. The arbitrators award shall be final and binding and judgment on the award rendered by the arbitrator may be entered in any court having jurisdiction thereof, provided that any award may be challenged in a court of competent jurisdiction.</li><li><b>Arbitration Fees and Awards.</b> The payment of filing and arbitration fees will be governed by the relevant AAA Rules subject to the following modifications:<ol type="i"><li>If you initiate arbitration under this Arbitration Agreement after participating in the optional Negotiation process described in subsection (k) below and are otherwise required to pay a filing fee under the relevant AAA Rules, Rank-X agrees that, unless your claim is for $5,000 or more, your share of the filing and arbitration fees is limited to $50, and that, after you submit proof of payment of the filing fee to Rank-X, Rank-X will promptly reimburse you for all but $50 of the filing fee. If, however, the arbitrator finds that either the substance of your claim or the relief sought in the claim is frivolous or brought for an improper purpose (as measured by the standards set forth in Federal Rule of Civil Procedure 11(b)), then the payment of all such fees will be governed by the AAA Rules.</li><li>Rank-X initiates arbitration under this Arbitration Agreement, Rank-X will pay all AAA filing and arbitration fees.</li><li>With respect to any Claims brought by Rank-X against a Premium Member, or for Claims brought by a Premium Member against Rank-X that: (A) arise out of, or relate to, Rank-Xs actual deactivation of a Premium Members account or a threat by Rank-X to deactivate a Premium Members account; or (C) arise out of, or relate to, Rank-Xs actual termination of a Premium Members Agreement with Rank-X under the termination provisions of this Agreement, or a threat by Rank-X to terminate a Premium Members Agreement, Rank-X shall pay all costs unique to arbitration (as compared to the costs of adjudicating the same claims before a court), including the regular and customary arbitration fees and expenses (to the extent not paid by Rank-X pursuant to the fee provisions above). However, if you are the party initiating the Premium Member Claim, you shall be responsible for contributing up to an amount equal to the filing fee that would be paid to initiate the claim in the court of general jurisdiction in the state in which you provide Services to Businesses, unless a lower fee amount would be owed by you pursuant to the AAA Rules, applicable law, or subsection (e)(1) above. Any dispute as to whether a cost is unique to arbitration shall be resolved by the arbitrator.</li><li>Except as provided in Federal Rule of Civil Procedure 68 or any state equivalents, each party shall pay its own attorneys fees and pay any costs that are not unique to the arbitration (i.e., costs that each party would incur if the claim(s) were litigated in a court such as costs to subpoena witnesses and/or documents, take depositions and purchase deposition transcripts, copy documents, etc.).</li><li>At the end of any arbitration, the arbitrator may award reasonable fees and costs or any portion thereof to you if you prevail, to the extent authorized by applicable law.<br>vi. If the arbitrator issues you an award that is greater than the value of Rank-Xs last written settlement offer made after you participated in good faith in the optional Negotiation process described in subsection (j) below, then Rank-X will pay you the amount of the award or U.S. $1,000, whichever is greater.</li></ol></li><li><b>Location and Manner of Arbitration.</b> Unless you and Rank-X agree otherwise, any arbitration hearings between Rank-X and a Premium Member will take place in the county of Rank-Xs Principal Office, and any arbitration hearings between Rank-X and a Premium Member will take place in the county in which Rank-X maintains its Principal Office. If AAA arbitration is unavailable in such county, the arbitration hearings will take place in the nearest available location for a AAA arbitration. If your Claim is for $10,000 or less, Rank-X agrees that you may choose whether the arbitration will be conducted solely on the basis of documents submitted to the arbitrator, through a telephonic hearing, or by an in-person hearing as determined by the AAA Rules. If your Claim exceeds $10,000, the right to a hearing will be determined by the AAA Rules.</li><li><b>Exceptions to Arbitration.</b> This Arbitration Agreement shall not require arbitration of the following types of claims: (1) small claims actions brought on an individual basis that are within the scope of such small claims courts jurisdiction; (2) a representative action brought on behalf of others under PAGA or other private attorneys general acts, to the extent the representative PAGA Waiver in Section 17(c) of such action is deemed unenforceable by a court of competent jurisdiction; (3) claims for workers compensation, state disability insurance and unemployment insurance benefits; and (4) claims that may not be subject to arbitration as a matter of law.<br>Nothing in this Arbitration Agreement prevents you from making a report to or filing a claim or charge with the Equal Employment Opportunity Commission, U.S. Department of Labor, Securities Exchange Commission, National Labor Relations Board, or Office of Federal Contract Compliance Programs, or similar local, state or federal agency, and nothing in this Arbitration Agreement shall be deemed to preclude or excuse a party from bringing an administrative claim before any agency in order to fulfill the party\'s obligation to exhaust administrative remedies before making a claim in arbitration, however you knowingly and voluntarily waive the right to seek or recover money damages of any type pursuant to any administrative complaint and instead may seek such relief only through arbitration under this Agreement. Nothing in this Agreement or Arbitration Agreement prevents your participation in an investigation by a government agency of any report, claim or charge otherwise covered by this Arbitration Provision.</li><li><b>Severability.</b> In addition to the severability provisions in subsections (c) above, in the event that any portion of this Arbitration Agreement is deemed illegal or unenforceable, such provision shall be severed and the remainder of the Arbitration Agreement shall be given full force and effect.</li></ol></li><div class="innerText">Rank-X welcomes your questions or comments regarding this Statement of Privacy. If you believe that Rank-X has not adhered to this Statement, please contact Rank-X at:<br></div><br><div class="innerText">Rank-X, LLC</div><div class="innerText">1650 Adams Av.</div><div class="innerText">San Diego, California, 92116</div><br><div class="innerText">Email Address:</div><div class="innerText">contact@rank-x.com</div><br><div class="innerText">Telephone number:</div><div class="innerText"><br>Effective as of May 31, 2017</div><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><br></div></div>'),
e.put("app/layout/Partials/cwrapper.html",""),e.put("app/layout/Partials/favs.html",'<ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#myfavs">My Favorites</a></li><li><a data-toggle="tab" href="#myfriends">My Friends</a></li></ul><div class="tab-content"><div id="myfavs" class="tab-pane fade in active"><div ng-controller="myfavs as vm"><h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mylifestyleans | limitTo:vm.maxRes2" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfoodans | limitTo:vm.maxRes1" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myservicesans | limitTo:vm.maxRes3" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myhealthans | limitTo:vm.maxRes4" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mybeautyans | limitTo:vm.maxRes5" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist6"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;">{{vm.headline6}}</th><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mysocialans | limitTo:vm.maxRes6" ng-click="vm.answerDetail(6,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(6)" ng-if="vm.cb6gt5">&lt;&lt;{{vm.btext6}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist7"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;">{{vm.headline7}}</th><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfamilyans | limitTo:vm.maxRes7" ng-click="vm.answerDetail(7,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(7)" ng-if="vm.cb7gt5">&lt;&lt;{{vm.btext7}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div><div id="myfriends" class="tab-pane fade"><div ng-controller="myfriends as vm"><h3>My Friends\' Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.lifestyleans | limitTo:vm.maxRes2 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(2,x)">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.foodans | limitTo:vm.maxRes1 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(1,x)">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.servicesans | limitTo:vm.maxRes3 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(3,x)">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.healthans | limitTo:vm.maxRes4 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(4,x)">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.beautyans | limitTo:vm.maxRes5 track by $index" style="cursor:pointer;"><td style="width:50%;line-height: 35px" ng-click="vm.answerDetail(5,x)">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td><td><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs | limitTo:1" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div></td><td style="line-height: 35px"><div ng-show="x.userObjs.length > 1" style="display: inline"><span class="badge btn-primary" ng-click="vm.showAllFriendsList(x.userObjs, x.name)">{{x.userObjs.length}}</span></div></td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist6"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;">{{vm.headline6}}</th><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.socialans | limitTo:vm.maxRes6" ng-click="vm.answerDetail(6,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(6)" ng-if="vm.cb6gt5">&lt;&lt;{{vm.btext6}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist7"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;">{{vm.headline7}}</th><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.familyans | limitTo:vm.maxRes7" ng-click="vm.answerDetail(7,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(7)" ng-if="vm.cb7gt5">&lt;&lt;{{vm.btext7}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div></div>'),e.put("app/layout/Partials/feedback.html",'<div class="row"><div class="col-lg-6"><content-block type="rxfeedback" dynamic="false"></content-block></div><div class="col-lg-6"><content-block type="rxsuggestion" dynamic="false"></content-block></div></div>'),e.put("app/layout/Partials/feeds.html",'<userfeed-block show-all="true" class="show-all"></userfeed-block>'),e.put("app/layout/Partials/layout.html",'<div ui-view="navbar" style="position: fixed; z-index: 1000; width: 100%"></div><div class="container" style="padding-left:5px;padding-right:5px; margin-bottom: 20px;"><div id="veil" ng-show="vm.isLoading"></div><div id="feedLoading" ng-show="vm.isLoading"><div style="text-align: center" ng-if="vm.isLoading"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">{{vm.veilMsg}}</p></div></div><div ng-hide="vm.isLoading"><div class="container" style="margin-top: 60px" ng-show="vm.barIsActive"><div class="row" style="padding-bottom:10px"><div class="col-xs-12" style="padding-left:0px;padding-right:0px;"><div class="col-xs-7" style="padding-left:0px;padding-right:0px;"><div class="input-group"><input type="text" class="form-control" placeholder="Search San Diego" ng-model="vm.val" ng-change="vm.getResults()" id="SearchInput"><div class="input-group-btn"><button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button></div></div></div><div class="col-xs-3" style="padding-left:0px;padding-right:0px"><button class="btn btn-default" style="width:100%" ng-click="vm.goAddRank()">Add Rank&nbsp&nbsp</button></div><button class="col-xs-2 btn btn-default pull-right" ng-click="vm.showTrends()"><i class="fa fa-rss" aria-hidden="true"></i></button></div></div></div><div class="input-group" style="width:100%" ng-if="vm.isAdmin"><div class="text-center" ng-attr-style="display:{{vm.isAdmin ? \'inline\':\'none\'}}"><div class="btn-group col-sm-6 col-md-6"><button class="btn btn-primary {{vm.selEditRank}}" ng-click="vm.editRank()">Edit Mode</button> <button class="btn btn-primary {{vm.selViewRank}}" ng-click="vm.viewRank()">View Mode</button></div></div></div><div ng-show="!vm.childActive"><search-block ng-click="vm.hideSearch()" query="{{vm.val}}" ans="true" ranks="true" length="vm.slen" init="vm.initready" data="vm.dataready" rod="vm.rodready" scrollactive="!vm.childActive"></search-block></div><br ng-if="vm.childActive"><br ng-if="vm.childActive"><br ng-if="vm.childActive"><div ui-view="" ng-if="!vm.isLoading && vm.childActive" class="container" id="page-containter" style=""></div></div><a href="#" class="back-to-top" style="display: inline;"><i class="fa fa-arrow-up" aria-hidden="true"></i></a></div><br><br><footer class="footer" style="position: fixed; bottom: 0px; background: white; width: 100%; padding-top: 20px;"><div class="container"><p class="text-muted">Rank-X is a registered trademark property of Rank-X LLC. San Diego, CA - 2017 <span><a ng-click="vm.goPrivacyPolicy()">Privacy Policy</a></span> <span><a ng-click="vm.goRankofDayConsole()">RoD</a></span></p></div></footer>'),e.put("app/layout/Partials/mybusiness.html",'<div ui-view="navbar"></div><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading your business accounts...</p></div></div><div ng-if="vm.dataReady"><div><div ng-if="!vm.noAns&&vm.overview" id="mybiztable-container"><h3>My Business</h3><table class="table" id="mybiztable"><tbody><thead style="border-style:none;"><tr><th class="text-center">Name</th><th text-align="center" class="text-center">Premium Membership</th><th text-align="center" class="text-center">Custom Ranks</th><th></th><th></th></tr></thead><tr ng-repeat="x in vm.mybizs" style="cursor:pointer;"><td>{{x.name}}</td><td align="center" ng-attr-style="{{x.style}}">{{x.status}}</td><td align="center" ng-attr-style="{{x.style2}}">{{x.status2}}</td><td align="center"><a href="" ng-click="vm.gotomanage(x)">{{(x.isPremium || x.hasRanks) ? \'Manage\':\'Purchase Features\'}}</a></td><td align="center"><a href="" ng-click="vm.gotoanswer(x)">Go to Listing</a></td></tr></tbody></table><div ng-if="vm.noAns"><br><p>You have not bound your account to any business. If you own or represent a business in this city, bound your account so you can manage its account.</p></div></div><div ng-if="vm.manageview"><h3>{{vm.business.name}}</h3><h4 align="center" style="background-color:#b3b3b3;padding:5px">Contact Info</h4><div><p class="text-left"><strong>Name:</strong>&nbsp{{vm.business.firstname}} {{vm.business.lastname}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.business.email}}</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.editContact()" class="btn btn-default">Edit</button></div><h4 align="center" style="background-color:#b3b3b3;padding:5px">Business Info</h4><div><p class="text-left"><strong>Business Name:</strong>&nbsp{{vm.business.name}}</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.business.location}}</p><p class="text-left"><strong>Phone:</strong>&nbsp{{vm.business.phone}}</p><p class="text-left"><strong>Membership:</strong>&nbsp{{vm.business.status}}</p></div><div class="text-right"><a href="" ng-click="vm.unbind(vm.business.id)">Unbind this business from my account</a></div><h4 align="center" style="background-color:#b3b3b3;padding:5px" ng-if="vm.business.isPremium||vm.business.hasRanks">Subscriptions</h4><div class="text-right"><div class="btn-group" ng-if="vm.business.isPremium||vm.business.hasRanks" style="padding-bottom:5px"><button type="button" class="btn btn-default" ng-class="vm.showPaymentInfo?\'active\':\'\'" ng-click="vm.showPaymentInfoEditClicked()">{{vm.showPaymentInfo?\'Hide Payment Info\':\'Show Payment Info\'}}</button> <button type="button" class="btn btn-default" ng-class="vm.showInvoices?\'active\':\'\'" ng-click="vm.showInvoicsClicked()">{{vm.showInvoices?\'Hide Invoices\':\'Show Invoices\'}}</button></div></div><div ng-if="vm.showPaymentInfo && !vm.business.loadingInvoices"><h3>Payment Information</h3><hr><div class="text-center"><span>Now you are billing with {{vm.business.customer.sources.data[0].brand}} Card <code> **** - **** - **** - {{vm.business.customer.sources.data[0].last4}} </code> Please Click here to change the card.</span><br><button id="updateCardButton" name="updateCardButton" class="btn btn-success" onclick="updateCardNumberButton()" style="margin-top:10px">Update Card Details</button></div><form action="https://server.rank-x.com/StripeServer/changeSource" method="POST" ng-submit="changeCardNumber()" id="updateCardNumberForm"><div style="display: none"><script src="https://checkout.stripe.com/checkout.js" class="stripe-button" data-key="pk_test_q9kbYzvzE6uMwZH9ZUjfK6Xq" data-email="{{vm.business.email}}" data-label="Update Card Details" data-name="Rank-X" data-description="Update Card Details" data-panel-label="Subscribe" data-image="/assets/images/rankx-logo-small-2-square.png" data-locale="auto" data-zip-code="true">\r\n            <\/script></div><input type="hidden" id="userId" name="userId" value="{{vm.business.user}}"> <input type="hidden" id="useraccntId" name="useraccntId" value="{{vm.business.accountid}}"> <input type="hidden" id="stripeId" name="stripeId" value="{{vm.business.stripeid}}"></form></div><div ng-if="vm.showInvoices && !vm.business.loadingInvoices"><h3>Invoices</h3><hr><table class="table"><thead style="border-style:none;"><tr><th style="width:25%" text-align="center">Date</th><th style="width:15%" text-align="center">SubTotal</th><th style="width:15%" text-align="center">Discount</th><th style="width:15%" text-align="center">Total</th><th style="width:20%" class="text-center">Status</th><th style="width:20%"></th></tr></thead><tbody><tr ng-repeat="invoice in vm.business.invoices"><td>{{invoice.date}}</td><td>{{invoice.subtotal/100 + \' \' + invoice.currency.toUpperCase()}}</td><td>{{invoice.discountMsg}}</td><td>{{invoice.total/100 + \' \' + invoice.currency.toUpperCase()}}</td><td>{{invoice.paid ? \'Paid\' : \'\'}}</td><td></td></tr></tbody></table><button class="btn btn-default pull-right" ng-click="vm.hideInvoices()">Hide Invoices</button></div><div ng-if="vm.business.isPremium||vm.business.hasRanks"><h3>Subscriptions</h3><hr><table class="table"><tbody><thead style="border-style:none;"><tr><th style="width:45%" text-align="center">Subscription</th><th style="width:15%" text-align="center">Monthly Cost</th><th style="width:20%"></th><th style="width:20%"></th></tr></thead><tr ng-if="vm.business.isPremium" style="cursor:pointer;"><td style="width:45%">Premium Membership</td><td style="width:15%">${{vm.business.price}}</td><td style="width:20%"></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelPremium()">Cancel</button></td></tr><tr ng-if="vm.business.hasRanks" style="cursor:pointer;"><td style="width:45%">{{vm.business.ranksQty}} Custom Ranks</td><td style="width:15%">${{vm.business.ranksQty*vm.CUSTOM_RANK_PRICE}}</td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.editRanks()">Edit</button></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelAllRanks()">Cancel</button></td></tr><tr style="cursor:pointer;"><td style="width:45%"></td><td style="width:15%"></td><td style="width:20%"></td><td style="width:20%"><button class="btn btn-default" style="width:100%" ng-click="vm.cancelAll()" ng-if="vm.business.hasranks&&vm.business.ispremium">Cancel All</button></td></tr></tbody></table></div><div class="well" ng-if="!vm.business.isPremium"><h2 class="text-center">Upgrade to Premium</h2><h3 class="text-center">${{vm.business.price}} / month</h3><i class="fa fa-check"></i><strong>&nbspGet more exposure</strong> within San Diego<br><i class="fa fa-check"></i>&nbspLet people know all your <strong>specials, promotions and special events</strong><br><i class="fa fa-check"></i>&nbspOffer <strong>coupons and promotions</strong>real time.<br><i class="fa fa-check"></i><strong>&nbspDrive more traffic</strong> to your business profile<br><i class="fa fa-check"></i><strong>&nbspGet</strong>more customers<br><div class="text-center"><a href="" ng-click="vm.showLearnMore(1)">Learn More</a></div><label class="checkbox-inline"><input type="checkbox" ng-model="vm.getPremium" value="">Get Premium Membership</label></div><div class="well" ng-if="!vm.business.hasRanks"><h2 class="text-center">Purchase Rankings</h2><h3 class="text-center">${{vm.CUSTOM_RANK_PRICE}} / month each</h3><i class="fa fa-check"></i>&nbspCreate <strong>unique rankings and lists</strong> for your own products and services<br><i class="fa fa-check"></i>&nbspUse for: <strong>Menu Items, Recent Projects, Top-Selling Products, Team Members</strong> and more.<br><i class="fa fa-check"></i>&nbsp<strong>Put the spotlight</strong> on any area of your business<br><i class="fa fa-check"></i><strong>&nbspEngage the audience</strong> with the best of what you offer<br><i class="fa fa-check"></i><strong>&nbspGet feedback</strong> from your customers on your specific products or services<br><div class="text-center"><a href="" ng-click="vm.showLearnMore(2)">Learn More</a></div><div class="row"><div class="col-xs-12 col-sm-9 col-md-10 col-lg-10"><label class="checkbox-inline"><input type="checkbox" ng-model="vm.getRanks" value="">Purchase Ranks</label></div><div class="col-xs-12 col-sm-3 col-md-2 col-lg-2"><div class="input-group" ng-if="vm.getRanks"><span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.minusQty()"><i class="fa fa-minus"></i></button></span> <input style="text-align:center" class="form-control" ng-model="vm.ranksQty" type="text" placeholder="vm.ranksQty"> <span class="input-group-btn"><button class="btn btn-primary" ng-click="vm.plusQty()"><i class="fa fa-plus"></i></button></span></div></div></div></div><div class="row" ng-if="vm.sell"><br><div class="col-xs-12 col-sm-12 col-md-2 col-lg-2"><label>Promo Code:</label></div><div class="col-xs-12 col-sm-12 col-md-10 col-lg-10"><div class="input-group"><input class="form-control" style="color:red;" ng-model="vm.promocode" type="text" placeholder="Enter code..."> <span class="input-group-btn"><button class="btn btn-default" ng-click="vm.checkcode()">Check Code</button></span></div></div></div><div class="text-center" ng-if="vm.sell"><br><p><i>{{vm.codeMsg}}</i></p></div><div class="text-center" ng-if="vm.sell"><br><button class="btn btn-success" ng-click="vm.goCheckout()" ng-class="(vm.getPremium || vm.getRanks) ? \'\' : \'disabled\'">Checkout</button></div></div><div ng-if="vm.checkout"><h3>Checkout</h3><br><p style="text-align:center">You are purchasing the following subscriptions for the business <strong>{{vm.business.name}}</strong>:</p><br><table class="table"><tbody><thead style="border-style:none;"><tr><th class="text-center">Name</th><th class="text-center">Quantity</th><th class="text-center">Total</th><th class="text-center"></th></tr></thead><tr ng-if="vm.getPremium"><td style="width:70%">Premium Membership</td><td style="width:15%" align="center">1</td><td style="width:15%" align="center">${{vm.business.price}}</td></tr><tr ng-if="vm.getRanks"><td style="width:70%">Custom Rankings</td><td style="width:15%" align="center">{{vm.ranksQty}}</td><td style="width:15%" align="center">${{vm.ranksQty*vm.CUSTOM_RANK_PRICE}}</td></tr><tr><td style="width:85%" colspan="2">Total</td><td style="width:15%" align="center">${{vm.total}}</td></tr></tbody></table><p ng-if="vm.codeOk">You have a valid code to try the above subscriptions free for 60 days. You will not be charged until the 60 day trial period expires. Afterwards your card will be charged <strong>${{vm.total}}</strong> monthly. You can log in to cancel or make modifications to your account at any time.</p><p ng-if="!vm.codeOk">Your card will be charged <strong>${{vm.total}}</strong> monthly. You can log in to cancel or make modifications to your account at any time.</p><label class="checkbox-inline"><input type="checkbox" ng-model="vm.acceptTOS" value="">I have read and understood the <a ng-click="vm.showTOSCustomersDlg()" target="_blank">Terms of Service</a></label><div class="text-center"><br><button id="checkoutButton" name="checkoutButton" class="btn btn-success" ng-class="vm.acceptTOS ? \'\' : \'disabled\'" onclick="clickStripeButton()">Pay with Card</button><br><div ng-show="!vm.showCurrentPlan"><form action="https://server.rank-x.com/StripeServer/charge" method="POST"><div style="display:none"><script src="https://checkout.stripe.com/checkout.js" class="stripe-button" data-key="pk_test_q9kbYzvzE6uMwZH9ZUjfK6Xq" data-email="{{vm.business.email}}" data-label="Pay with Card" data-name="Rank-X" data-description="Premium Membership Subscription" data-panel-label="Subscribe" data-image="/assets/images/rankx-logo-small-2-square.png" data-locale="auto" data-zip-code="true">\r\n            <\/script></div><input type="hidden" id="userEmail" name="userEmail" value="{{vm.business.email}}"> <input type="hidden" id="userName" name="userName" value="{{vm.business.firstname + \' \' + vm.business.lastname}}"> <input type="hidden" id="bizName" name="bizName" value="{{vm.business.name}}"> <input type="hidden" id="userId" name="userId" value="{{vm.business.user}}"> <input type="hidden" id="useraccntId" name="useraccntId" value="{{vm.business.accountid}}"> <input type="hidden" id="answerId" name="answerId" value="{{vm.business.id}}"> <input type="hidden" id="stripeId" name="stripeId" value="{{vm.business.stripeid}}"> <input type="hidden" id="getPremiumPlan" name="getPremiumPlan" value="{{vm.getPremium}}"> <input type="hidden" id="getCustomRanks" name="getCustomRanks" value="{{vm.getRanks}}"> <input type="hidden" id="ranksQuantity" name="ranksQuantity" value="{{vm.ranksQty}}"> <input type="hidden" id="couponValid" name="couponValid" value="{{vm.codeOk}}"> <input type="hidden" id="couponValid" name="promoCode" value="{{vm.promocode}}"> <input type="hidden" id="bizcat" name="bizcat" value="{{vm.business.bizcat}}"></form></div></div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div><br><br></div></div><script>\r\n        function eventFire(el, etype){\r\n          if (el.fireEvent) {\r\n            el.fireEvent(\'on\' + etype);\r\n          } else {\r\n            var evObj = document.createEvent(\'Events\');\r\n            evObj.initEvent(etype, true, false);\r\n            el.dispatchEvent(evObj);\r\n          }\r\n        }\r\n        function clickCancelPlanButton() {\r\n          showLoaderBriefDouble();\r\n          console.log("about to fire click event");\r\n          var resultOfEventFire = eventFire(document.getElementById(\'confirmCancelPlan\'), \'click\');\r\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\r\n        }\r\n        function clickStripeButton() {\r\n          console.log("about to fire click event");\r\n          var resultOfEventFire = eventFire(document.getElementsByClassName(\'stripe-button-el\')[0], \'click\');\r\n\r\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\r\n        }\r\n\r\n        function updateCardNumberButton() {\r\n          console.log("about to fire update stripe info event");\r\n\t\t  var resultOfEventFire = eventFire($(\'#updateCardNumberForm .stripe-button-el\')[0], \'click\');\r\n\r\n          console.log("done firing click event, resultOfEventFire: " + resultOfEventFire);\r\n        }\r\n        <\/script>'),
e.put("app/layout/Partials/myfavs.html",'<h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mylifestyleans | limitTo:vm.maxRes2" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfoodans | limitTo:vm.maxRes1" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myservicesans | limitTo:vm.maxRes3" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myhealthans | limitTo:vm.maxRes4" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mybeautyans | limitTo:vm.maxRes5" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist6"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;">{{vm.headline6}}</th><th ng-attr-style="background-color:{{vm.bgc6}};color:{{vm.fc6}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.mysocialans | limitTo:vm.maxRes6" ng-click="vm.answerDetail(6,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(6)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext6}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist7"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;">{{vm.headline7}}</th><th ng-attr-style="background-color:{{vm.bgc7}};color:{{vm.fc7}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.myfamilyans | limitTo:vm.maxRes7" ng-click="vm.answerDetail(7,x)" style="cursor:pointer;"><td style="width:50%;">{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(7)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext7}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div>'),e.put("app/layout/Partials/myfriends.html",'<h3>My Favorites</h3><table class="table" ng-if="vm.answerExist2"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;">{{vm.headline2}}</th><th ng-attr-style="background-color:{{vm.bgc2}};color:{{vm.fc2}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.lifestyleans | limitTo:vm.maxRes2 track by $index" ng-click="vm.answerDetail(2,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(2)" ng-if="vm.cb2gt5">&lt;&lt;{{vm.btext2}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist1"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;">{{vm.headline1}}</th><th ng-attr-style="background-color:{{vm.bgc1}};color:{{vm.fc1}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.foodans | limitTo:vm.maxRes1 track by $index" ng-click="vm.answerDetail(1,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" ng-repeat="userObj in x.userObjs" align="middle" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(1)" ng-if="vm.cb1gt5">&lt;&lt;{{vm.btext1}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist3"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;">{{vm.headline3}}</th><th ng-attr-style="background-color:{{vm.bgc3}};color:{{vm.fc3}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.servicesans | limitTo:vm.maxRes3 track by $index" ng-click="vm.answerDetail(3,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(3)" ng-if="vm.cb3gt5">&lt;&lt;{{vm.btext3}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist4"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;">{{vm.headline4}}</th><th ng-attr-style="background-color:{{vm.bgc4}};color:{{vm.fc4}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.healthans | limitTo:vm.maxRes4 track by $index" ng-click="vm.answerDetail(4,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(4)" ng-if="vm.cb4gt5">&lt;&lt;{{vm.btext4}}&gt;&gt;</p><table class="table" ng-if="vm.answerExist5"><tbody><thead style="border-style:none;"><tr><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;">{{vm.headline5}}</th><th ng-attr-style="background-color:{{vm.bgc5}};color:{{vm.fc5}};width:50%;"></th></tr></thead><tr ng-repeat="x in vm.beautyans | limitTo:vm.maxRes5 track by $index" ng-click="vm.answerDetail(5,x)" style="cursor:pointer;"><td style="width:50%;"><div class="profile-avatar-wrapper media-left" align="middle" ng-repeat="userObj in x.userObjs" style="display: inline"><img ng-src="{{userObj.picture.data.url}}" class="img-responsive img-circle profile-avatar" style="display: inline"></div>{{x.name}}</td><td ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">{{x.sp_title}}</td></tr></tbody></table><p class="text-right" style="color:blue;" ng-click="vm.seeMore(5)" ng-if="vm.cb5gt5">&lt;&lt;{{vm.btext5}}&gt;&gt;</p><div ng-if="vm.noAns"><br><p>You have not endorsed any Establishments yet. Places that you endorse will show up here so you can have quick access to all their specials and promotions.</p></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div>'),e.put("app/layout/Partials/navbar.html",'<nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/cwrapper" ng-click="vm.gotoHome()" style="cursor:pointer;padding:0px;border:0px;margin:0px;"><img src="/assets/images/logosqwborder.jpg" style="width:60px;"></a> <a class="navbar-brand home-link" ng-click="vm.selCity()" style="font-size:medium">San Diego</a> <a class="navbar-brand navbar-profile-picture-wrapper" ng-show="vm.user" href="/favs" ng-click="vm.gotofavs()"><img class="img-responsive img-circle navbar-profile-picture" ng-src="{{vm.user.picture.data.url}}"> <span style="font-size:medium">{{vm.user.first_name}}</span></a> <a class="navbar-brand" ng-if="vm.warning" style="background-color:#33cccc;color:black;margin:2px" ng-click="vm.goWarning()"><i class="fa fa-warning"></i></a> <a class="navbar-brand" ng-if="vm.coordsRdy" ng-click="vm.goCoords()" style="margin:0px;"><i class="fa fa-location-arrow"></i></a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li ng-if="vm.hasBusiness"><a href="/mybusiness" ng-click="vm.gotomybusiness()">My Business</a></li><li ng-if="vm.isPromoter"><a href="/promoterconsole" ng-click="vm.goPromoterConsole()">Promote</a></li><li><a href="/about" ng-click="vm.gotoAbout()">About</a></li><li><a href="/tour" ng-click="vm.gotoTour()">Tour</a></li><li ng-if="vm.isAdmin"><a href="" ng-click="vm.gotoAdmin()">Admin</a></li><li ng-if="!vm.isLoggedIn"><a href="/login" ng-click="vm.goToLogin()">Login</a></li><li ng-if="vm.isLoggedIn"><a href="/logout" ng-click="vm.logout()" class="">Logout</a></li></ul></div></div></nav>'),e.put("app/layout/Partials/privacypolicy.html",'<style>\r\n    #ppBody {\r\n        font-size: 11pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n        text-align: justify;\r\n    }\r\n    \r\n    #ppHeader {\r\n        font-family: verdana;\r\n        font-size: 21pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n    }\r\n    \r\n    .ppConsistencies {\r\n        display: none;\r\n    }\r\n</style><div class="container"><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><div id="ppHeader"><span><img src="/assets/images/logo_sq.png" style="width:80px"></span> Rank-X Privacy Policy</div><div id="ppBody"><div class="ppConsistencies"><div class="col-2"><div class="quick-links text-center">Information Collection</div></div><div class="col-2"><div class="quick-links text-center">Information Usage</div></div><div class="col-2"><div class="quick-links text-center">Information Protection</div></div><div class="col-2"><div class="quick-links text-center">Cookie Usage</div></div><div class="col-2"><div class="quick-links text-center">3rd Party Disclosure</div></div><div class="col-2"><div class="quick-links text-center">3rd Party Links</div></div><div class="col-2"></div></div><div style="clear:both;height:10px;"></div><div class="ppConsistencies"><div class="col-2"><div class="col-12 quick-links2 gen-text-center">Google AdSense</div></div><div class="col-2"><div class="col-12 quick-links2 gen-text-center">Fair Information Practices<div class="col-8 gen-text-left gen-xs-text-center" style="font-size:12px;position:relative;left:20px;">Fair information<br>Practices</div></div></div><div class="col-2"><div class="col-12 quick-links2 gen-text-center coppa-pad">COPPA</div></div><div class="col-2"><div class="col-12 quick-links2 quick4 gen-text-center caloppa-pad">CalOPPA</div></div><div class="col-2"><div class="quick-links2 gen-text-center">Our Contact Information<br></div></div></div><div style="clear:both;height:10px;"></div><div class="innerText">Protecting your private information is our priority. This Statement of Privacy applies to <a href="http://www.rank-x.com">http://www.rank-x.com</a> and Rank-X, LLC and governs data collection and usage. For the purposes of this Privacy Policy, unless otherwise noted, all references to Rank-X, LLC include http://www.rank-x.com and Rank-X. The Rank-X website is a Online Advertising and Marketing site. By using the Rank-X website, you consent to the data practices described in this statement.</div><br></div><span id="infoCo"></span><br><div class="grayText"><strong>Collection of your Personal Information</strong></div><br><div class="innerText">Rank-X may collect personally identifiable information, such as your:<ul style="list-style-type: none"><li>- Name</li><li>- Address</li><li>- E-mail Address</li></ul><br>Please keep in mind that if you directly disclose personally identifiable information or personally sensitive data through Rank-X\'s public message boards, this information may be collected and used by others.</div><div class="innerText">Rank-X encourages you to review the privacy statements of websites you choose to link to from Rank-X so that you can understand how those websites collect, use and share your information. Rank-X is not responsible for the privacy statements or other content on websites outside of the Rank-X website.</div><br><div class="grayText"><strong>Use of your Personal Information</strong></div><br><div class="innerText">Rank-X collects and uses your personal information to operate its website(s) and deliver the services you have requested.<br>Rank-X may also use your personally identifiable information to inform you of other products or services available from Rank-X and its affiliates. Rank-X may also contact you via surveys to conduct research about your opinion of current services or of potential new services that may be offered.<br>Rank-X does not sell, rent or lease its customer lists to third parties.<br>Rank-X may, from time to time, contact you on behalf of external business partners about a particular offering that may be of interest to you. In those cases, your unique personally identifiable information (e-mail, name, address, telephone number) is not transferred to the third party. Rank-X may share data with trusted partners to help perform statistical analysis, send you email or postal mail, provide customer support, or arrange for deliveries. All such third parties are prohibited from using your personal information except to provide these services to Rank-X, and they are required to maintain the confidentiality of your information.<br>Rank-X may keep track of the websites and pages our users visit within Rank-X, in order to determine what Rank-X services are the most popular. This data is used to deliver customized content and advertising within Rank-X to customers whose behavior indicates that they are interested in a particular subject area.<br>Rank-X will disclose your personal information, without notice, only if required to do so by law or in the good faith belief that such action is necessary to: (a) conform to the edicts of the law or comply with legal process served on Rank-X or the site; (b) protect and defend the rights or property of Rank-X; and, (c) act under exigent circumstances to protect the personal safety of users of Rank-X, or the public.<br></div><span id="infoUs"></span><br><div class="grayText"><strong>Automatically Collected Information</strong></div><br><div class="innerText">Information about your computer hardware and software may be automatically collected by Rank-X. This information can include: your IP address, browser type, domain names, access times and referring website addresses. This information is used for the operation of the service, to maintain quality of the service, and to provide general statistics regarding use of the Rank-X website.<br><br></div><div class="grayText"><strong>Use of Cookies</strong></div><div class="innerText">The Rank-X website may use "cookies" to help you personalize your online experience. A cookie is a text file that is placed on your hard disk by a web page server. Cookies cannot be used to run programs or deliver viruses to your computer. Cookies are uniquely assigned to you, and can only be read by a web server in the domain that issued the cookie to you.<br>One of the primary purposes of cookies is to provide a convenience feature to save you time. The purpose of a cookie is to tell the Web server that you have returned to a specific page. For example, if you personalize Rank-X pages, or register with Rank-X site or services, a cookie helps Rank-X to recall your specific information on subsequent visits. This simplifies the process of recording your personal information, such as billing addresses, shipping addresses, and so on. When you return to the same Rank-X website, the information you previously provided can be retrieved, so you can easily use the Rank-X features that you customized.<br>You have the ability to accept or decline cookies. Most Web browsers automatically accept cookies, but you can usually modify your browser setting to decline cookies if you prefer. If you choose to decline cookies, you may not be able to fully experience the interactive features of the Rank-X services or websites you visit.<br><br></div><div class="grayText"><strong>Security of your Personal Information</strong></div><br><div class="innerText">Rank-X secures your personal information from unauthorized access, use, or disclosure. Rank-X uses the following methods for this purpose:<br><ul style="list-style-type: none"><li>- SSL Protocol</li><li>- Malware Scanning</li></ul><br>When personal information (such as a credit card number) is transmitted to other websites, it is protected through the use of encryption, such as the Secure Sockets Layer (SSL) protocol.</div><br><div class="grayText"><strong>Children Under Thirteen</strong></div><br><div class="innerText">Rank-X does not knowingly collect personally identifiable information from children under the age of thirteen. If you are under the age of thirteen, you must ask your parent or guardian for permission to use this website.<br></div><br><div class="grayText"><strong>Disconnecting your Rank-X Account from Third Party Websites</strong></div><br><div class="innerText">You will be able to connect your Rank-X account to third party accounts. BY CONNECTING YOUR RANK-X ACCOUNT TO YOUR THIRD PARTY ACCOUNT, YOU ACKNOWLEDGE AND AGREE THAT YOU ARE CONSENTING TO THE CONTINUOUS RELEASE OF INFORMATION ABOUT YOU TO OTHERS (IN ACCORDANCE WITH YOUR PRIVACY SETTINGS ON THOSE THIRD PARTY SITES). IF YOU DO NOT WANT INFORMATION ABOUT YOU, INCLUDING PERSONALLY IDENTIFYING INFORMATION, TO BE SHARED INTHIS MANNER, DO NOT USE THE THIS FEATURE. You may disconnect your account from a third party account at any time. Users may learn how to disconnect their accounts from third-party websites by visiting their "My Account" page. Users may also contact us via email.<br></div><br><div class="grayText"><strong>Account Termination</strong></div><br><div class="innerText">We will remove your public posts from view and/or dissociate them from your account profile, but we may retain information about you for the purposes authorized under this Privacy Policy unless prohibited by law. For example, we may retain information to prevent, investigate, or identify possible wrongdoing in connection with the Service or to comply with legal obligations. Please note that businesses cannot remove their business listings, ratings, or reviews by closing their accounts.<br></div><br><div class="grayText"><strong>Opt-Out &amp; Unsubscribe</strong></div><br><div class="innerText">We respect your privacy and give you an opportunity to opt-out of receiving announcements of certain information. Users may opt-out of receiving any or all communications from Rank-X by contacting us here:<br><ul style="list-style-type: none"><li>- Web page: _________________</li><li>- Email: _________________</li><li>- Phone: _________________</li></ul><br></div><br><div class="grayText"><strong>California Residents: Your California Privacy Rights</strong></div><br><div class="innerText">Rank-X does not disclose your personal information to third parties for the purpose of directly marketing their services to you unless you first agree to such disclosure. If you have any questions regarding this policy, or would like to change your preferences, you may contact us at the address listed below.<br></div><br><div class="grayText"><strong>Changes to this Statement</strong></div><br><div class="innerText">Rank-X will occasionally update this Statement of Privacy to reflect company and customer feedback. Rank-X encourages you to periodically review this Statement to be informed of how Rank-X is protecting your information.<br></div><br><div class="grayText"><strong>Contact Information</strong></div><br><div class="innerText">Rank-X welcomes your questions or comments regarding this Statement of Privacy. If you believe that Rank-X has not adhered to this Statement, please contact Rank-X at:<br></div><br><div class="innerText">Rank-X, LLC</div><div class="innerText">1650 Adams Av.</div><div class="innerText">San Diego, California, 92116</div><br><div class="innerText">Email Address:</div><div class="innerText">contact@rank-x.com</div><br><div class="innerText">Telephone number:</div><div class="innerText"></div><br><div class="innerText"><br>Effective as of May 31, 2017</div><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><br></div>'),
e.put("app/layout/Partials/promotertos.html",'<style>\r\n    #ppBody {\r\n        font-size: 13pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n        text-align: justify;\r\n    }\r\n    #ppHeader {\r\n        font-family: verdana;\r\n        font-size: 21pt;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n    }\r\n    \r\n    .ppConsistencies {\r\n        display: none;\r\n    }\r\n\r\n\r\n    #ppBody > ol > li {\r\n        margin-bottom: 30px;\r\n    }\r\n    \r\n    #ppBody > ol > li > ul > li{\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    #ppBody > ol > li > ul > li > ol >li{\r\n        margin-bottom: 10px;\r\n    }\r\n</style><div class="container"><br><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><div id="ppHeader"><span><img src="/assets/images/logo_sq.png" style="width:80px"></span> Rank-X Terms of Use</div><div id="ppBody">These terms of service constitute a legally binding agreement (the Agreement) between you and Rank-X, LLC (Rank-X we, us or our) governing your use of the Rank-X application, website, and technology platform (collectively, the Rank-X Platform). PLEASE BE ADVISED: THIS AGREEMENT CONTAINS PROVISIONS THAT GOVERN HOW CLAIMS YOU AND RANK-X HAVE AGAINST EACH OTHER CAN BE BROUGHT (SEE SECTION 16 BELOW). THESE PROVISIONS WILL, WITH LIMITED EXCEPTION, REQUIRE YOU TO SUBMIT CLAIMS YOU HAVE AGAINST RANK-X TO BINDING AND FINAL ARBITRATION ON AN INDIVIDUAL BASIS, NOT AS A PLAINTIFF OR CLASS MEMBER IN ANY CLASS, GROUP OR REPRESENTATIVE ACTION OR PROCEEDING. AS A DRIVER, YOU HAVE AN OPPORTUNITY TO OPT OUT OF ARBITRATION WITH RESPECT TO CERTAIN CLAIMS AS PROVIDED IN SECTION 17. By entering into to this Agreement, you expressly acknowledge that you understand this Agreement (including the dispute resolution and arbitration provisions Section 16) and accept all of its terms. IF YOU DO NOT AGREE TO BE BOUND BY THE TERMS AND CONDITIONS OF THIS AGREEMENT, YOU MAY NOT USE OR ACCESS THE RANK-X PLATFORM.<ol><li><b>The Rank-X Platform</b> The Rank-X Platform provides an online platform that creates lists, rankings, and forums about businesses, activities, locations, and venues (Collectively Businesses). The lists, rankings, and forums within the Rank-X Platform are generated by persons who use the site (Users) to rank and comment on Businesses they have experienced. The Rank-X Platform also allows persons to promote Rank-X to various Businesses (Promoters) in exchange for a commission-based percentage of the revenue generated by Businesses who the Promoter successfully signs up for Rank-Xs Premium Membership. Each individual Promoter will be assigned a unique alphanumeric code (Code). Each Business that signs up for Rank-Xs Premium Membership will use the Code assigned to the Promoter that contacted them to gain access to Rank-Xs Premium Membership benefits. When a Business uses this Code, the Business will be given sixty (60) days of free access to the Premium Membership. If a Business, after the 60-day free period expires, chooses to continue accessing Rank-Xs Premium Membership benefits, it will do so by using the Promoters Code to sign up for continued Premium Membership benefits at the specified cost.</li><li><b>Modification to the Agreement</b> In the event Rank-X modifies the terms and conditions of this Agreement, such modifications shall be binding on you only upon your acceptance of the modified Agreement. Rank-X reserves the right to modify any information referenced in the hyperlinks from this Agreement from time to time, and such modifications shall become effective upon posting. Continued use of the Rank-X Platform or Services after any such changes shall constitute your consent to such changes. Unless material changes are made to the arbitration provisions herein, you agree that modification of this Agreement does not create a renewed opportunity to opt out of arbitration (if applicable).</li><li><b>Eligibility</b> The Rank-X Platform may only be used by individuals and businesses who can form legally binding contracts under applicable law. The Rank-X Platform is not available to children (persons under the age of 18) or Premium Members who have had their Premium Member account temporarily or permanently deactivated. By becoming a Premium Member of Rank-Xs Platform, you represent and warrant that you are at least 18 years old and that you have the right, authority and capacity to enter into and abide by the terms and conditions of this Agreement. You may not allow other persons to use your Businesss Rank-X account, and you agree that you are the sole authorized user of your account.</li><li><b>Payments</b> If you are a Promoter, you will receive payment for your efforts in promoting after successfully signing Businesses up for Rank-Xs Premium Memberships (Services). All payments are subject to Rank-X Commission, discussed below. Rank-X will process all payments due to you through its third party payments processor. You acknowledge and agree that such amounts shall not include any interest and will be net of any amounts that we are required to withhold by law.<ol type="a"><li><b>a. Commission</b> In exchange for successfully signing Businesses up for Rank-Xs Premium Memberships, Rank-X agrees to pay the Promoter a commission based on the revenue generated by his or her Services. The amount of the applicable Commission is set out in Exhibit 1 herein, and will apply once you accept these Terms of Service. Rank-X reserves the right to change the applicable Commission at any time in Rank-Xs discretion based upon local market factors, and Rank-X will provide you with notice in the event of such change. Commission for each Account generated by Promoter shall continue unless and until this relationship is expressly terminated and/or the Business cancels its Premium Membership. Continued use of the Rank-X Platform after any such change in the Commission calculation shall constitute your consent to such change. The amount of monthly Commission paid by Rank-X to any individual Promoter shall not exceed $5,000.00 United States Dollars per month. Similarly, no individual Promoter may receive commission for more than one hundred (100) Businesses that they sign up for Rank-Xs Premium Memberships (Accounts).</li><li><b>Membership Fees and Payment Schedule.</b> Rank-Xs Premium Membership costs vary depending on the industry and business type that the business is associated with, as set out in Section 4(c) below. Additionally, Businesses may purchase custom rankings at the price of $45.00 per month. Rank-X charges Businesses once per month for Premium Membership benefits, which will continue to be accessible by Businesses until and unless this Agreement has been materially breached or terminated with or without cause.</li><li><b>Premium Memberships and Pricing</b> A Business may sign up for and purchase Rank-Xs Premium Membership in order to utilize the various benefits of doing so. Premium Membership for purposes of this agreement refers to a Businesss ability to promote the Businesss specials and activities, which drives additional online traffic to the Businesss profile, in exchange for a monthly Premium Membership fee. Rank-X reserves the right to change the pricing schedule for Premium Memberships at any time in our discretion based upon local market factors, and we will provide you with notice in the event of changes to the base Premium Membership fees that would result in a change in the applicable commission rate.</li><li><b>Payment Schedule.</b> Promoters shall be paid once per month (twelve times per year) for the cumulative commission earned in that month, based on the Commission Schedule, that is generated by the Accounts they have obtained for Rank-X.</li><li><b>No Other Payments.</b> No other fees and/or expenses will be paid to the Promoter, unless such fees and/or expenses have been approved in advance by the appropriate executive on behalf of the Recipient in writing. The Promoter shall be solely responsible for any and all taxes, Social Security contributions or payments, disability insurance, unemployment taxes, and other payroll type taxes applicable to such compensation. The Contractor has the right of control over the method of payment for services.</li></ol></li><li><b>Communications</b> By becoming a Premium Member, you agree to receive communications from us, including via e-mail, text message, calls, and push notifications. You agree that texts, calls or prerecorded messages may be generated by automatic telephone dialing systems. Communications from Rank-X, its affiliated companies and/or Drivers, may include but are not limited to: operational communications concerning your Premium Member account or use of the Rank-X Platform or Services, updates concerning new and existing features on the Rank-X Platform, communications concerning promotions run by us or our third-party partners, and news concerning Rank-X and industry developments. Standard text messaging charges applied by your cell phone carrier will apply to text messages we send.<br>IF YOU WISH TO OPT OUT OF PROMOTIONAL EMAILS, YOU CAN UNSUBSCRIBE FROM OUR PROMOTIONAL EMAIL LIST BY FOLLOWING THE UNSUBSCRIBE OPTIONS IN THE PROMOTIONAL EMAIL ITSELF. YOU ACKNOWLEDGE THAT YOU ARE NOT REQUIRED TO CONSENT TO RECEIVE PROMOTIONAL TEXTS OR CALLS AS A CONDITION OF USING THE PLATFORM OR THE SERVICES. IF YOU WISH TO OPT OUT OF ALL TEXTS OR CALLS FROM (INCLUDING OPERATIONAL OR TRANSACTIONAL TEXTS OR CALLS), YOU CAN NOTIFY US VIA EMAIL, HOWEVER YOU ACKNOWLEDGE THAT OPTING OUT OF RECEIVING ALL TEXTS MAY IMPACT YOUR USE OF THE Rank-X PLATFORM OR THE SERVICES.</li><li><b>Your Information</b> Your Information is any information you provide, publish or post to or through the Rank-X Platform (including any profile information you provide) or send to other Users or Premium Members (including via in-application feedback, any email feature, or through any -related Facebook, Twitter or other social media posting) (your Information). You consent to us using your Information to create a Premium Member account that will allow you to use the Platform and participate in the Services. Our collection and use of personal information in connection with the Rank-X Platform and Services is as provided in Rank-Xs Privacy Policy located at www.Rank-X.com/privacy. You are solely responsible for your Information and your interactions with other members of the public, and we act only as a passive conduit for your online posting of your Information. You agree to provide and maintain accurate, current and complete information and that we and other members of the public may rely on your Information as accurate, current and complete. To enable Rank-X to use your Information, you grant to us a non-exclusive, worldwide, perpetual, irrevocable, royalty-free, transferable, sub-licensable (through multiple tiers) right and license to exercise the copyright, publicity, and database rights you have in your Information, and to use, copy, perform, display and distribute such Information to prepare derivative works, or incorporate into other works, such Information, in any media now known or not currently known. Rank-X does not assert any ownership over your Information; rather, as between you and Rank-X, subject to the rights granted to us in this Agreement, you retain full ownership of all of your Information and any intellectual property rights or other proprietary rights associated with your Information.<br>You may be able to create or log-in to your Rank-X Premium Member account through online accounts you may have with third party social networking sites (each such account, an "SNS Account"). By connecting to Rank-X through an SNS Account, you understand that Rank-X may access, store, and make available any SNS Account content according to the permission settings of your SNS Account (e.g., friends, mutual friends, contacts or following/followed lists (the SNS Content)). You understand that SNS Content may be available on and through the Rank-X Platform to other Users. Unless otherwise specified in this Agreement, all SNS Content, if any, shall be considered to be your Information.</li><li><b>Promotions and Referral Programs</b> Rank-X, at its sole discretion, may make available promotions with different features to any Premium Members or prospective Premium Members. These promotions, unless made to you, shall have no bearing whatsoever on your Agreement or relationship with Rank-X. Rank-X reserves the right to withhold or deduct credits or benefits obtained through a promotion in the event that Rank-X determines or believes that the redemption of the promotion or receipt of the credit or benefit was in error, fraudulent, illegal, or in violation of the applicable promotion terms or this Agreement.</li><li><b>Restricted Activities</b><ol type="a">With respect to your use of the Rank-X Platform and your participation in the Premium Membership, you agree that you will not:<li>impersonate any person, business, or government entity;</li><li>stalk, threaten, or otherwise harass any person or entity, or carry any weapons;</li><li>violate any law, statute, rule, permit, ordinance or regulation;</li><li>interfere with or disrupt the Services or the Rank-X Platform or the servers or networks connected to the Rank-X Platform;</li><li>post Information or interact on the Rank-X Platform or Services in a manner which is false, inaccurate, misleading (directly or by omission or failure to update information), defamatory, libelous, abusive, obscene, profane, offensive, sexually oriented, threatening, harassing, or illegal;</li><li>use the Rank-X Platform in any way that infringes any third partys rights, including but not limited to: intellectual property rights, copyright, patent, trademark, trade secret or other proprietary rights or rights of publicity or privacy;</li><li>post, email or otherwise transmit any malicious code, files or programs designed to interrupt, damage, destroy or limit the functionality of any computer software or hardware or telecommunications equipment or surreptitiously intercept or expropriate any system, data or personal information;</li><li>forge headers or otherwise manipulate identifiers in order to disguise the origin of any information transmitted through the Rank-X Platform;</li><li>frame or mirror any part of the Rank-X Platform, without our prior written authorization or use meta tags or code or other devices containing any reference to us in order to direct any person to any other web site for any purpose; or</li><li>modify, adapt, translate, reverse engineer, decipher, decompile or otherwise disassemble any portion of the Rank-X Platform or any software used on or for the Rank-X Platform;</li><li>rent, lease, lend, sell, redistribute, license or sublicense the Rank-X Platform or access to any portion of the Rank-X Platform;</li><li>use any robot, spider, site search/retrieval application, or other manual or automatic device or process to retrieve, index, scrape, data mine, or in any way reproduce or circumvent the navigational structure or presentation of the Rank-X Platform or its contents;</li><li>link directly or indirectly to any other web sites;</li><li>transfer or sell your Premium Member account, password and/or identification to any other party</li><li>discriminate against or harass anyone on the basis of race, national origin, religion, gender, gender identity, physical or mental disability, medical condition, marital status, age or sexual orientation, or</li><li>cause any third party to engage in the restricted activities above.</li></ol></li><li><b>Intellectual Property</b> All intellectual property rights in the Rank-X Platform shall be owned by Rank-X absolutely and in their entirety. These rights include and are not limited to database rights, copyright, design rights (whether registered or unregistered), trademarks (whether registered or unregistered) and other similar rights wherever existing in the world together with the right to apply for protection of the same. All other trademarks, logos, service marks, company or product names set forth in the Rank-X Platform are the property of their respective owners. You acknowledge and agree that any questions, comments, suggestions, ideas, feedback or other information (Submissions) provided by you to us are non-confidential and shall become the sole property of Rank-X. Rank-X shall own exclusive rights, including all intellectual property rights, and shall be entitled to the unrestricted use and dissemination of these Submissions for any purpose, commercial or otherwise, without acknowledgment or compensation to you.<br>Rank-X and other Rank-X logos, designs, graphics, icons, scripts and service names are registered trademarks, trademarks or trade dress of Rank-X in the United States and/or other countries (collectively, the Rank-X Marks). If you provide Services as a Premium Member, Rank-X grants to you, during the term of this Agreement, and subject to your compliance with the terms and conditions of this Agreement, a limited, revocable, non-exclusive license to display and use the Rank-X Marks solely in connection with providing the Services through the Rank-X Platform (License). The License is non-transferable and non-assignable, and you shall not grant to any third party any right, permission, license or sublicense with respect to any of the rights granted hereunder without Rank-Xs prior written permission, which it may withhold in its sole discretion. The Rank-X Marks may not be used in any manner that is likely to cause confusion.<br>You acknowledge that Rank-X is the owner and licensor of the Rank-X Marks, including all goodwill associated therewith, and that your use of the Rank-X Marks will confer no additional interest in or ownership of the Rank-X Marks in you but rather inures to the benefit of Rank-X. You agree to use the Rank-X Marks strictly in accordance with Rank-Xs Terms and Conditions and any other guidelines as may be provided to you and revised from time to time, and to immediately cease any use that Rank-X determines to nonconforming or otherwise unacceptable.<br>You agree that you will not: (1) create any materials that incorporate the Rank-X Marks or any derivatives of the Rank-X Marks other than as expressly approved by Rank-X in writing; (2) use the Rank-X Marks in any way that tends to impair their validity as proprietary trademarks, service marks, trade names or trade dress, or use the Rank-X Marks other than in accordance with the terms, conditions and restrictions herein; (3) take any other action that would jeopardize or impair Rank-Xs rights as owner of the Rank-X Marks or the legality and/or enforceability of the Rank-X Marks, including, without limitation, challenging or opposing Rank-Xs ownership in the Rank-X Marks; (4) apply for trademark registration or renewal of trademark registration of any of the Rank-X Marks, any derivative of the Rank-X Marks, any combination of the Rank-X Marks and any other name, or any trademark, service mark, trade name, symbol or word which is similar to the Rank-X Marks; (5) use the Rank-X Marks on or in connection with any product, service or activity that is in violation of any law, statute, government regulation or standard.<br>Violation of any provision of this License may result in immediate termination of the License, in Rank-Xs sole discretion. If you create any materials bearing the Rank-X Marks (in violation of this Agreement or otherwise), you agree that upon their creation Rank-X exclusively owns all right, title and interest in and to such materials, including without limitation any modifications to the Rank-X Marks or derivative works based on the Rank-X Marks. You further agree to assign any interest or right you may have in such materials to Rank-X, and to provide information and execute any documents as reasonably requested by Rank-X to enable Rank-X to formalize such assignment.<br>Rank-X respects the intellectual property of others, and expects Premium Members to do the same. If you believe, in good faith, that any materials on the Rank-X Platform or Services infringe upon your copyrights, please contact us via email.<br></li><li><b>Disclaimers</b> The following disclaimers are made on behalf of Rank-X, our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, and shareholders.<br>The Rank-X Platform is provided on an as is basis and without any warranty or condition, express, implied or statutory. We do not guarantee and do not promise any specific results from use of the Rank-X Platform and/or the Services, including the ability to provide or receive Services at any given location or time. We specifically disclaim any implied warranties of title, merchantability, fitness for a particular purpose and non-infringement. Some states do not allow the disclaimer of implied warranties, so the foregoing disclaimer may not apply to you.<br>We do not warrant that your use of the Rank-X Platform or Services will be accurate, complete, reliable, current, secure, uninterrupted, always available, or error- free, or will meet your requirements, that any defects in the Rank-X Platform will be corrected, or that the Rank-X Platform is free of viruses or other harmful components. We disclaim liability for, and no warranty is made with respect to, connectivity and availability of the Rank-X Platform or Services.<br>We cannot guarantee that each User of the Rank-X Platform is who he or she claims to be. Please use common sense when using the Rank-X Platform and Services. Please note that there are also risks of dealing with underage persons or people acting under false pretense, and we do not accept responsibility or liability for any content, communication or other use or access of the Rank-X Platform by persons under the age of 18 in violation of this Agreement.<br>Rank-X is not responsible for the conduct, whether online or offline, of any User of the Rank-X Platform or Services. You are solely responsible for your interactions with other Users.<br>Rank-X expressly disclaims any liability arising from the unauthorized use of your Premium Member account. Should you suspect that any unauthorized party may be using your Premium Member account or you suspect any other breach of security, you agree to notify us immediately.<br>Please carefully select the type of information that you post on the Rank-X Platform or through the Services or release to others. We disclaim all liability, regardless of the form of action, for the acts or omissions of other Users (including unauthorized users, or hackers).<br>Opinions, advice, statements, offers, or other information or content concerning Rank-X or made available through the Rank-X Platform, but not directly by us, are those of their respective authors, and should not necessarily be relied upon. Such authors are solely responsible for such content. Under no circumstances will we be responsible for any loss or damage resulting from your reliance on information or other content posted by third parties, whether on the Rank-X Platform or otherwise. We reserve the right, but we have no obligation, to monitor the materials posted on the Rank-X Platform and remove any such material that in our sole opinion violates, or is alleged to violate, the law or this agreement or which might be offensive, illegal, or that might violate the rights, harm, or threaten the safety of Users or others.<br>This paragraph applies to any version of the Rank-X Platform that you acquire from the Apple App Store. This Agreement is entered into between you and Rank-X. Apple, Inc. (Apple) is not a party to this Agreement and shall have no obligations with respect to the Rank-X Platform. Rank-X, not Apple, is solely responsible for the Rank-X Platform and the content thereof as set forth hereunder. However, Apple and Apples subsidiaries may be third party beneficiaries of this Agreement. Upon your acceptance of this Agreement, Apple shall have the right (and will be deemed to have accepted the right) to enforce this Agreement against you as a third party beneficiary thereof. This Agreement incorporates by reference Apples Licensed Application End User License Agreement, for purposes of which, you are the end-user. In the event of a conflict in the terms of the Licensed Application End User License Agreement and this Agreement, the terms of this Agreement shall control.</li><li><b>Indemnity</b> You will defend, indemnify, and hold Rank-X including our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, or shareholders harmless from any claims, actions, suits, losses, costs, liabilities and expenses (including reasonable attorneys fees) relating to or arising out of your use of the Rank-X Platform and participation in the Services, including: (1) your breach of this Agreement or the documents it incorporates by reference; (2) your violation of any law or the rights of a third party, including, without limitation, Drivers, Riders, other motorists, and pedestrians, as a result of your own interaction with such third party; (3) any allegation that any materials that you submit to us or transmit through the Rank-X Platform or to us infringe or otherwise violate the copyright, trademark, trade secret or other intellectual property or other rights of any third party; (4) your ownership, use or operation of a motor vehicle or passenger vehicle, including your provision of Services as a Driver; and/or (5) any other activities in connection with the Services. This indemnity shall be applicable without regard to the negligence of any party, including any indemnified person.</li><li><b>Limitation of Liability</b> IN NO EVENT WILL RANK-X, INCLUDING OUR AFFILIATES, SUBSIDIARIES, PARENTS, SUCCESSORS AND ASSIGNS, AND EACH OF OUR RESPECTIVE OFFICERS, DIRECTORS, EMPLOYEES, AGENTS, OR SHAREHOLDERS (COLLECTIVELY RANK-X FOR PURPOSES OF THIS SECTION), BE LIABLE TO YOU FOR ANY INCIDENTAL, SPECIAL, EXEMPLARY, PUNITIVE, CONSEQUENTIAL, OR INDIRECT DAMAGES (INCLUDING, BUT NOT LIMITED TO, DAMAGES FOR DELETION, CORRUPTION, LOSS OF DATA, LOSS OF PROGRAMS, FAILURE TO STORE ANY INFORMATION OR OTHER CONTENT MAINTAINED OR TRANSMITTED BY THE RANK-X PLATFORM, SERVICE INTERRUPTIONS, OR FOR THE COST OF PROCUREMENT OF SUBSTITUTE SERVICES) ARISING OUT OF OR IN CONNECTION WITH THE RANK-X PLATFORM, THE SERVICES, OR THIS AGREEMENT, HOWEVER ARISING INCLUDING NEGLIGENCE, EVEN IF WE OR OUR AGENTS OR REPRESENTATIVES KNOW OR HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. THE RANK-X PLATFORM MAY BE USED BY YOU TO REQUEST AND SCHEDULE TRANSPORTATION, GOODS, OR OTHER SERVICES WITH THIRD PARTY PROVIDERS, BUT YOU AGREE THAT RANK-X HAS NO RESPONSIBILITY OR LIABILITY TO YOU RELATED TO ANY TRANSPORTATION, GOODS OR OTHER SERVICES PROVIDED TO YOU BY THIRD PARTY PROVIDERS OTHER THAN AS EXPRESSLY SET FORTH IN Their TERMS. CERTAIN JURISDICTIONS MAY NOT ALLOW THE EXCLUSION OR LIMITATION OF CERTAIN DAMAGES. IF THESE LAWS APPLY TO YOU, SOME OR ALL OF THE ABOVE DISCLAIMERS, EXCLUSIONS OR LIMITATIONS MAY NOT APPLY TO YOU, AND YOU MAY HAVE ADDITIONAL RIGHTS.</li><li><b>Term and Termination</b> This Agreement is effective upon your creation of a Premium Member account. This Agreement may be terminated: a) by Premium Member, without cause, upon seven (7) days prior written notice to Rank-X; or b) by either Party immediately, without notice, upon the other Partys material breach of this Agreement, including but not limited to any breach of Section 8 or breach of Section 9 of this Agreement. In addition, Rank-X may terminate this Agreement or deactivate your User account immediately in the event: (1) you no longer qualify to provide Services or to operate the approved vehicle under applicable law, rule, permit, ordinance or regulation; (2) you fall below Rank-Xs star rating or cancellation threshold; (3) Rank-X has the good faith belief that such action is necessary to protect the safety of the Rank-X community or third parties, provided that in the event of a deactivation pursuant to (1)-(3) above, you will be given notice of the potential or actual deactivation and an opportunity to attempt to cure the issue to Rank-Xs reasonable satisfaction prior to Rank-X permanently terminating the Agreement. For all other breaches of this Agreement, you will be provided notice and an opportunity to cure the breach. If the breach is cured in a timely manner and to Rank-Xs satisfaction, this Agreement will not be permanently terminated. Sections 2, 4, 6, 9 (with respect to the license), 10-12, 14-16 shall survive any termination or expiration of this Agreement.</li><li><b>Confidentiality</b> You agree not to use any technical, financial, strategic and other proprietary and confidential information relating to Rank-Xs business, operations and properties, including Premium Member information (Confidential Information) disclosed to you by Rank-X for your own use or for any purpose other than as contemplated herein. You shall not disclose or permit disclosure of any Confidential Information to third parties. You agree to take all reasonable measures to protect the secrecy of and avoid disclosure or use of Confidential Information of Rank-X in order to prevent it from falling into the public domain. Notwithstanding the above, you shall not have liability to Rank-X with regard to any Confidential Information which you can prove: was in the public domain at the time it was disclosed by Rank-X or has entered the public domain through no fault of yours; was known to you, without restriction, at the time of disclosure, as demonstrated by files in existence at the time of disclosure; is disclosed with the prior written approval of Rank-X; becomes known to you, without restriction, from a source other than Rank-X without breach of this Agreement by you and otherwise not in violation of Rank-Xs rights; or is disclosed pursuant to the order or requirement of a court, administrative agency, or other governmental body; provided, however, that You shall provide prompt notice of such court order or requirement to Rank-X to enable Rank-X to seek a protective order or otherwise prevent or restrict such disclosure.</li><li><b>Relationship with Rank-X</b> As a Promoter on the Rank-X Platform, you acknowledge and agree that you and Rank-X are in a direct business relationship, and the relationship between the parties under this Agreement is solely that of independent contracting parties. You and Rank-X expressly agree expressly agree that (1) this is not an employment agreement and does not create an employment relationship between you and Rank-X; and (2) no joint venture, franchisor-franchisee, partnership, or agency relationship is intended or created by this Agreement. You have no authority to bind Rank-X, and you undertake not to hold yourself out as an employee, agent or authorized representative of Rank-X.<br>Rank-X does not, and shall not be deemed to, direct or control you generally or in your performance under this Agreement specifically, including in connection with your provision of Services, your acts or omissions, or your operation and maintenance of your vehicle. You retain the sole right to determine when, where, and for how long you will utilize the Rank-X Platform. You retain the option to accept or to decline or ignore a Rank-X or any Third Party request for Services via the Rank-X Platform, or to cancel your Promoter Code via the Rank-X Platform, subject to Rank-Xs then-current cancellation policies. With the exception of any signage required by law or permit/license rules or requirements, Rank-X shall have no right to require you to: (a) display Rank-Xs names, logos or colors when you are Promoting the Company; or (b) wear a uniform or any other clothing displaying Rank-Xs names, logos or colors. You acknowledge and agree that you have complete discretion to provide Services or otherwise engage in other business or employment activities. The Promoter has no desk or other equipment either located at or furnished by Rank-X.</li><li><b>General</b> Except as provided in Section 16, this Agreement shall be governed by the laws of the State of California without regard to choice of law principles. This choice of law provision is only intended to specify the use of California law to interpret this Agreement and is not intended to create any other substantive right to non-Californians to assert claims under California law whether by statute, common law, or otherwise. If any provision of this Agreement is or becomes invalid or non-binding, the parties shall remain bound by all other provisions hereof. In that event, the parties shall replace the invalid or non- binding provision with provisions that are valid and binding and that have, to the greatest extent possible, a similar effect as the invalid or non-binding provision, given the contents and purpose of this Agreement. You agree that this Agreement and all incorporated agreements may be automatically assigned by Rank-X, in our sole discretion by providing notice to you. Except as explicitly stated otherwise, any notices to Rank-X shall be given by certified mail, postage prepaid and return receipt requested to Rank-X. Any notices to you shall be provided to you through the Rank-X Platform or given to you via the email address or physical you provide to Rank-X during the registration process. Headings are for reference purposes only and in no way define, limit, construe or describe the scope or extent of such section. A partys failure to act with respect to a breach by the other party does not constitute a waiver of the partys right to act with respect to subsequent or similar breaches. This Agreement sets forth the entire understanding and agreement between you and Rank-X with respect to the subject matter hereof and supersedes all previous understandings and agreements between the parties, whether oral or written.</li><li><b>Dispute Resolution and Arbitration Agreement</b><ol type="a"><li><b>Agreement to Binding Arbitration Between You and Rank-X.</b> YOU AND RANK-X MUTUALLY AGREE TO WAIVE OUR RESPECTIVE RIGHTS TO RESOLUTION OF DISPUTES IN A COURT OF LAW BY A JUDGE OR JURY AND AGREE TO RESOLVE ANY DISPUTE BY ARBITRATION, as set forth below. This agreement to arbitrate (Arbitration Agreement) is governed by the Federal Arbitration Act and survives after the Agreement terminates or your relationship with Rank-X ends. ANY ARBITRATION UNDER THIS AGREEMENT WILL TAKE PLACE ON AN INDIVIDUAL BASIS; CLASS ARBITRATIONS AND CLASS ACTIONS ARE NOT PERMITTED. Except as expressly provided below, this Arbitration Agreement applies to all Claims (defined below) between you and Rank-X, including our affiliates, subsidiaries, parents, successors and assigns, and each of our respective officers, directors, employees, agents, or shareholders.<br>Except as expressly provided below, ALL DISPUTES AND CLAIMS BETWEEN US (EACH A CLAIM AND COLLECTIVELY, CLAIMS) SHALL BE EXCLUSIVELY RESOLVED BY BINDING ARBITRATION SOLELY BETWEEN YOU AND RANK-X. These Claims include, but are not limited to, any dispute, claim or controversy, whether based on past, present, or future events, arising out of or relating to: this Agreement and prior versions thereof (including the breach, termination, enforcement, interpretation or validity thereof), the Rank-X Platform, the Services, any other goods or services made available through the Rank-X Platform, your relationship with Rank-X, the threatened or actual suspension, deactivation or termination of your Premium Member Account or this Agreement, payments made by you or any payments made or allegedly owed to you, any promotions or offers made by Rank-X, any city, county, state or federal wage-hour law, trade secrets, unfair competition, compensation, breaks and rest periods, expense reimbursement, wrongful termination, discrimination, harassment, retaliation, fraud, defamation, emotional distress, breach of any express or implied contract or covenant, claims arising under federal or state consumer protection laws; claims arising under antitrust laws, claims arising under the Telephone Consumer Protection Act and Fair Credit Reporting Act; and claims arising under the Uniform Trade Secrets Act, Civil Rights Act of 1964, Americans With Disabilities Act, Age Discrimination in Employment Act, Older Workers Benefit Protection Act, Family Medical Leave Act, Fair Labor Standards Act, Employee Retirement Income Security Act (except for individual claims for employee benefits under any benefit plan sponsored by Rank-X and covered by the Employee Retirement Income Security Act of 1974 or funded by insurance), and state statutes, if any, addressing the same or similar subject matters, and all other federal and state statutory and common law claims. All disputes concerning the arbitrability of a Claim (including disputes about the scope, applicability, enforceability, revocability or validity of the Arbitration Agreement) shall be decided by the arbitrator, except as expressly provided below.<br>BY AGREEING TO ARBITRATION, YOU UNDERSTAND THAT YOU AND RANK-X ARE WAIVING THE RIGHT TO SUE IN COURT OR HAVE A JURY TRIAL FOR ALL CLAIMS, EXCEPT AS EXPRESSLY OTHERWISE PROVIDED IN THIS ARBITRATION AGREEMENT. This Arbitration Agreement is intended to require arbitration of every claim or dispute that can lawfully be arbitrated, except for those claims and disputes which by the terms of this Arbitration Agreement are expressly excluded from the requirement to arbitrate.</li><li><b>Prohibition of Class Actions and Non-Individualized Relief.</b> YOU UNDERSTAND AND AGREE THAT YOU AND RANK-X MAY EACH BRING CLAIMS IN ARBITRATION AGAINST THE OTHER ONLY IN AN INDIVIDUAL CAPACITY AND NOT ON A CLASS, COLLECTIVE ACTION, OR REPRESENTATIVE BASIS (CLASS ACTION WAIVER). YOU UNDERSTAND AND AGREE THAT YOU AND RANK-X BOTH ARE WAIVING THE RIGHT TO PURSUE OR HAVE A DISPUTE RESOLVED AS A PLAINTIFF OR CLASS MEMBER IN ANY PURPORTED CLASS, COLLECTIVE OR REPRESENTATIVE PROCEEDING. NOTWITHSTANDING THE FOREGOING, THIS SUBSECTION (B) SHALL NOT APPLY TO REPRESENTATIVE PRIVATE ATTORNEYS GENERAL ACT CLAIMS BROUGHT AGAINST RANK-X, WHICH ARE ADDRESSED SEPARATELY IN SECTION 17(C).<br>The arbitrator shall have no authority to consider or resolve any Claim or issue any relief on any basis other than an individual basis. The arbitrator shall have no authority to consider or resolve any Claim or issue any relief on a class, collective, or representative basis.<br>Notwithstanding any other provision of this Agreement, the Arbitration Agreement or the AAA Rules, disputes regarding the scope, applicability, enforceability, revocability or validity of the Class Action Waiver may be resolved only by a civil court of competent jurisdiction and not by an arbitrator. In any case in which: (1) the dispute is filed as a class, collective, or representative action and (2) there is a final judicial determination that the Class Action Waiver is unenforceable as to any Claims, the class, collective, and/or representative action on such Claims must be litigated in a civil court of competent jurisdiction, but the Class Action Waiver shall be enforced in arbitration on an individual basis as to all other Claims to the fullest extent possible.</li><li><b>Representative PAGA Waiver.</b> Notwithstanding any other provision of this Agreement or the Arbitration Agreement, to the fullest extent permitted by law: (1) you and Rank-X agree not to bring a representative action on behalf of others under the Private Attorneys General Act of 2004 (PAGA), California Labor Code  2698 et seq., in any court or in arbitration, and (2) for any claim brought on a private attorney general basis, including under the California PAGA, both you and Rank-X agree that any such dispute shall be resolved in arbitration on an individual basis only (i.e., to resolve whether you have personally been aggrieved or subject to any violations of law), and that such an action may not be used to resolve the claims or rights of other individuals in a single or collective proceeding (i.e., to resolve whether other individuals have been aggrieved or subject to any violations of law) (collectively, representative PAGA Waiver). Notwithstanding any other provision of this Agreement, the Arbitration Agreement or the AAA Rules, disputes regarding the scope, applicability, enforceability, revocability or validity of this representative PAGA Waiver may be resolved only by a civil court of competent jurisdiction and not by an arbitrator. If any provision of this representative PAGA Waiver is found to be unenforceable or unlawful for any reason: (i) the unenforceable provision shall be severed from this Agreement; (ii) severance of the unenforceable provision shall have no impact whatsoever on the Arbitration Agreement or the requirement that any remaining Claims be arbitrated on an individual basis pursuant to the Arbitration Agreement; and (iii) any such representative PAGA or other representative private attorneys general act claims must be litigated in a civil court of competent jurisdiction and not in arbitration. To the extent that there are any Claims to be litigated in a civil court of competent jurisdiction because a civil court of competent jurisdiction determines that the representative PAGA Waiver is unenforceable with respect to those Claims, the Parties agree that litigation of those Claims shall be stayed pending the outcome of any individual Claims in arbitration.</li><li><b>Rules Governing the Arbitration.</b> Any arbitration conducted pursuant to this Arbitration Agreement shall be administered by the American Arbitration Association (AAA) pursuant to its Consumer Arbitration Rules that are in effect at the time the arbitration is initiated, as modified by the terms set forth in this Agreement. Copies of these rules can be obtained at the AAAs website (www.adr.org) (the AAA Rules) or by calling the AAA at 1-800-778-7879. Notwithstanding the foregoing, if requested by you and if proper based on the facts and circumstances of the Claims presented, the arbitrator shall have the discretion to select a different set of AAA Rules, but in no event shall the arbitrator consolidate more than one persons Claims, or otherwise preside over any form of representative, collective, or class proceeding.<br>As part of the arbitration, both you and Rank-X will have the opportunity for reasonable discovery of non-privileged information that is relevant to the Claim. The arbitrator may award any individualized remedies that would be available in court. The arbitrator may award declaratory or injunctive relief only in favor of the individual party seeking relief and only to the extent necessary to provide relief warranted by that party\'s individual claims. The arbitrator will provide a reasoned written statement of the arbitrators decision which shall explain the award given and the findings and conclusions on which the decision is based.<br>The arbitrator will decide the substance of all claims in accordance with applicable law, and will honor all claims of privilege recognized by law. The arbitrator shall not be bound by rulings in prior arbitrations involving different Riders or Drivers, but is bound by rulings in prior arbitrations involving the same Rider or Driver to the extent required by applicable law. The arbitrators award shall be final and binding and judgment on the award rendered by the arbitrator may be entered in any court having jurisdiction thereof, provided that any award may be challenged in a court of competent jurisdiction.</li><li><b>Arbitration Fees and Awards.</b> The payment of filing and arbitration fees will be governed by the relevant AAA Rules subject to the following modifications:<ol type="i"><li>If you initiate arbitration under this Arbitration Agreement after participating in the optional Negotiation process described in subsection (k) below and are otherwise required to pay a filing fee under the relevant AAA Rules, Rank-X agrees that, unless your claim is for $5,000 or more, your share of the filing and arbitration fees is limited to $50, and that, after you submit proof of payment of the filing fee to Rank-X, Rank-X will promptly reimburse you for all but $50 of the filing fee. If, however, the arbitrator finds that either the substance of your claim or the relief sought in the claim is frivolous or brought for an improper purpose (as measured by the standards set forth in Federal Rule of Civil Procedure 11(b)), then the payment of all such fees will be governed by the AAA Rules.</li><li>Rank-X initiates arbitration under this Arbitration Agreement, Rank-X will pay all AAA filing and arbitration fees.</li><li>With respect to any Claims brought by Rank-X against a Premium Member, or for Claims brought by a Premium Member against Rank-X that: (A) arise out of, or relate to, Rank-Xs actual deactivation of a Premium Members account or a threat by Rank-X to deactivate a Premium Members account; or (C) arise out of, or relate to, Rank-Xs actual termination of a Premium Members Agreement with Rank-X under the termination provisions of this Agreement, or a threat by Rank-X to terminate a Premium Members Agreement, Rank-X shall pay all costs unique to arbitration (as compared to the costs of adjudicating the same claims before a court), including the regular and customary arbitration fees and expenses (to the extent not paid by Rank-X pursuant to the fee provisions above). However, if you are the party initiating the Premium Member Claim, you shall be responsible for contributing up to an amount equal to the filing fee that would be paid to initiate the claim in the court of general jurisdiction in the state in which you provide Services to Businesses, unless a lower fee amount would be owed by you pursuant to the AAA Rules, applicable law, or subsection (e)(1) above. Any dispute as to whether a cost is unique to arbitration shall be resolved by the arbitrator.</li><li>Except as provided in Federal Rule of Civil Procedure 68 or any state equivalents, each party shall pay its own attorneys fees and pay any costs that are not unique to the arbitration (i.e., costs that each party would incur if the claim(s) were litigated in a court such as costs to subpoena witnesses and/or documents, take depositions and purchase deposition transcripts, copy documents, etc.).</li><li>At the end of any arbitration, the arbitrator may award reasonable fees and costs or any portion thereof to you if you prevail, to the extent authorized by applicable law.<br>vi. If the arbitrator issues you an award that is greater than the value of Rank-Xs last written settlement offer made after you participated in good faith in the optional Negotiation process described in subsection (j) below, then Rank-X will pay you the amount of the award or U.S. $1,000, whichever is greater.</li></ol></li><li><b>Location and Manner of Arbitration.</b> Unless you and Rank-X agree otherwise, any arbitration hearings between Rank-X and a Premium Member will take place in the county of Rank-Xs Principal Office, and any arbitration hearings between Rank-X and a Premium Member will take place in the county in which Rank-X maintains its Principal Office. If AAA arbitration is unavailable in such county, the arbitration hearings will take place in the nearest available location for a AAA arbitration. If your Claim is for $10,000 or less, Rank-X agrees that you may choose whether the arbitration will be conducted solely on the basis of documents submitted to the arbitrator, through a telephonic hearing, or by an in-person hearing as determined by the AAA Rules. If your Claim exceeds $10,000, the right to a hearing will be determined by the AAA Rules.</li><li><b>Exceptions to Arbitration.</b> This Arbitration Agreement shall not require arbitration of the following types of claims: (1) small claims actions brought on an individual basis that are within the scope of such small claims courts jurisdiction; (2) a representative action brought on behalf of others under PAGA or other private attorneys general acts, to the extent the representative PAGA Waiver in Section 17(c) of such action is deemed unenforceable by a court of competent jurisdiction; (3) claims for workers compensation, state disability insurance and unemployment insurance benefits; and (4) claims that may not be subject to arbitration as a matter of law.<br>Nothing in this Arbitration Agreement prevents you from making a report to or filing a claim or charge with the Equal Employment Opportunity Commission, U.S. Department of Labor, Securities Exchange Commission, National Labor Relations Board, or Office of Federal Contract Compliance Programs, or similar local, state or federal agency, and nothing in this Arbitration Agreement shall be deemed to preclude or excuse a party from bringing an administrative claim before any agency in order to fulfill the party\'s obligation to exhaust administrative remedies before making a claim in arbitration, however you knowingly and voluntarily waive the right to seek or recover money damages of any type pursuant to any administrative complaint and instead may seek such relief only through arbitration under this Agreement. Nothing in this Agreement or Arbitration Agreement prevents your participation in an investigation by a government agency of any report, claim or charge otherwise covered by this Arbitration Provision.</li><li><b>Severability.</b> In addition to the severability provisions in subsections (c) above, in the event that any portion of this Arbitration Agreement is deemed illegal or unenforceable, such provision shall be severed and the remainder of the Arbitration Agreement shall be given full force and effect.</li></ol></li></ol><div class="innerText">Rank-X welcomes your questions or comments regarding this Statement of Privacy. If you believe that Rank-X has not adhered to this Statement, please contact Rank-X at:<br></div><br><div class="innerText">Rank-X, LLC</div><div class="innerText">1650 Adams Av.</div><div class="innerText">San Diego, California, 92116</div><br><div class="innerText">Email Address:</div><div class="innerText">contact@rank-x.com</div><br><div class="innerText">Telephone number:</div><div class="innerText"><br>Effective as of May 31, 2017</div><div class="text-right"><button class="btn btn-default" ng-click="vm.goBack()">Back</button></div><br></div></div>'),
e.put("app/layout/Partials/searchresults.html",'<div ng-show="vm.searchActive"><search-block></search-block></div>'),e.put("app/layout/Partials/trends.html",'<trend-block show-all="true"></trend-block>'),e.put("app/login/partials/add-user-detail.html",'<div class="modal fade" id="addUserDetailModal" tabindex="-1" role="dialog" aria-labelledby="addUserDetailModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h4 class="modal-title" id="addUserDetailModalLabel">Add User Detail</h4></div><div class="modal-body" style="height: 214px"><div class="col-md-12"><form class="form-horizontal" role="form" name="answerForm"><div class="col-md-12"><div class="form-group"><label for="birthdate">Birth Date:</label><datepicker date-year-title="selected year" date-max-limit="{{maxDate}}" date-format="yyyy/MM/dd" date-month-title="selected year"><input id="birthdate" ng-model="user.birth_date" class="form-control"></datepicker></div><div class="form-group"><label>Gender:</label><div class="clearfix"></div><label class="radio-inline"><input name="gender" type="radio" value="Male" ng-model="user.gender">Male</label> <label class="radio-inline"><input name="gender" type="radio" value="Female" ng-model="user.gender">Female</label> <label class="radio-inline"><input name="gender" type="radio" value="Other" ng-model="user.gender">Other</label></div><div class="row form-group"><button type="submit" class="btn btn-success" ng-click="addUserDetail()">Add Detail</button><p class="hiw" ng-click="whyThisInfoDialog()"><u>why you need this?</u></p></div></div></form></div></div></div></div></div>'),e.put("app/login/partials/bizlogin.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">Rank-X</h1><h1 class="text-center">Business Registration</h1></div><div class="panel-body"><form ng-submit="vm.submit()" ng-if="!vm.isProgressing"><div class="form-group"><label>Email</label> <input type="email" class="form-control" ng-model="vm.username"></div><div class="form-group"><label>Password</label> <input type="password" class="form-control" ng-model="vm.password"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary">Sign In</button></div></form><div style="text-align: center" ng-if="vm.isProgressing"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p class="text-muted">Loading...</p></div></div></div>'),e.put("app/login/partials/login.html",'<div class="panel panel-primary signin-card"><div class="panel-heading" style="background-color:lightgray;"><img src="/assets/images/rankxlogo_noheadline.png" style="width:100%; padding:10px;"></div><div class="panel-body"><form ng-submit="vm.submit()" ng-if="!vm.isProgressing"><div class="form-group text-center"><button type="button" class="btn btn-primary form-control" ng-click="vm.facebookLogin()"><i class="fa fa-facebook"></i> Login</button><br><br><button type="button" class="btn btn-default form-control" style="vertical-align:middle;" ng-click="vm.goBack()">Cancel</button></div><br><p class="hiw" ng-click="vm.whyFacebookDialog()"><u>why Facebook?</u></p></form><div style="text-align: center" ng-if="vm.isProgressing"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p class="text-muted">Loading...</p></div></div></div>'),e.put("app/login/partials/register.html",'<div class="panel panel-primary signin-card"><div class="panel-heading"><h1 class="text-center">Register</h1></div><div class="panel-body"><form name="registerForm"><div class="form-group"><label>First Name</label> <input type="text" name="firstName" class="form-control" ng-model="vm.firstName"></div><div class="form-group"><label>Last Name</label> <input type="text" name="lastName" class="form-control" ng-model="vm.lastName"></div><div class="form-group"><label>Email</label> <input type="email" class="form-control" ng-model="vm.username"></div><div class="form-group"><label>Password</label> <input type="password" name="password" class="form-control" ng-model="vm.password"></div><div class="form-group"><label>Confirm Password</label> <input type="password" name="confirm" class="form-control" ng-model="vm.confirm"></div><div class="form-group text-right"><button type="submit" class="btn btn-primary" ng-click="vm.signIn()">Sign In</button> <button type="button" class="btn btn-primary" ng-click="vm.register()">Register</button></div></form></div></div>'),e.put("app/promoters/Partials/promote.html",'<br><div class="container"><h2>Become a Rank-X Promoter</h2><br><p class="text-left">Thank you for your interest in becoming a Rank-X promotor. Please read carefully the information below.</p><div class="accordion" role="tablist" aria-multiselectable="true"><div class-="" "card"=""><div class="card-header" role="tab" id="headingOne" ng-click="vm.show(1)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">What is Rank-X?</a></h3></div><div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne" ng-show="vm.showOne"><div class="card-block"><p class="text-left">Rank-X is a San Diego based company with a web application designed to create interactive content in the forms of rankings, lists and opinions. We like to focus on things on our city but also cover general topics. Our goal is to be the best source of information for the best services, food, events and things happening around our city in a clean and elegant way. In addition to best deals and specials that different businesses offer. If you have not already done so, please take a time to look at the website. <span><a href="/#!/home">Click here</a></span></p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingTwo" ng-click="vm.show(2)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseTwo">What does Rank-X sells?</a></h3></div><div id="collapseTwo" class="collapse show" role="tabpanel" aria-labelledby="headingTwo" ng-show="vm.showTwo"><div class="card-block"><p class="text-left">Rank-X sells premium memberships to businesses and brands that wish to stand out from others, and to those that wish to promote their specials and promotions with users.</p><div class="row"><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img1.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">All of the content is generated by lists.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img2.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">When content is presented, a far right column is saved for specials. <i>Premium Business</i> (Demo Restaurant 1) gets highlighted with a short description of the current special.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img3.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">Inside an Establishment detail, a <i>Premium Business</i> can create detail boxes to advertise their specials.</p></div><div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><img src="/assets/images/promote_img4.jpg" style="width:100%; height:auto; border-style:solid;border-width:3px; border-color:lightgray"><p style="margin-top:5px">Each special can contain an image that can be displayed. Images can contain <strong>coupons</strong>, <strong>flyers</strong>, <strong>bar codes</strong>, etc. It is up to the business the content of the image to be displayed.</p></div></div><p class="text-left"><i>Premium Business</i> can edit and control real-time the specials and promotions that are shown.</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingThree" ng-click="vm.show(3)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">How much do businesses pay for Premium Membership?</a></h3></div><div id="collapseThree" class="collapse show" role="tabpanel" aria-labelledby="headingThree" ng-show="vm.showThree"><div class="card-block"><p class="text-left">Premium memberships for Rank-X cost $99 per month. When using a promo code businneses get 60 days free trial.</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingFour" ng-click="vm.show(4)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseFour">What does it mean to be a Rank-X Promotor?</a></h3></div><div id="collapseFour" class="collapse show" role="tabpanel" aria-labelledby="headingFour" ng-show="vm.showFour"><div class="card-block"><p class="text-left">Rank-X promotors are people working as independent contractors that help us promote, advertise and give feedback about the application. The success of Rank-X will depend strongly on its ability to spread the word out about its exsitance to businesses and to get business to subscribe to Rank-X to advertise their specials and promotions. Thus, Rank-X promotors have three basic responsibilities.</p><p class="text-left"><strong>1. Become familiar with the app.</strong> Rank-X Promotors are expected to understand the working of the application, to participate regularly in the rankings, add content and do their best so the content of the application is always engaging, accurate and useful.</p><p class="text-left"><strong>2. Market the application.</strong> Rank-X Promotors are expected to connect with business owners in their area show the value that Rank-X can have in their bussiness. The amount of money earned by a Rank-X promoter will be directly proportional to the amount of businesses they get to sign up.</p><p class="text-left"><strong>3. Provide constant Feedback.</strong> Rank-X Promotors are expected to provide feedback of the workings of the app so it can be continually improved. By keeping the application running smoothly, with help customer retention and</p></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingFive" ng-click="vm.show(5)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseFive">What are the benefits of becoming a Rank-X Promotor?</a></h3></div><div id="collapseFive" class="collapse show" role="tabpanel" aria-labelledby="headingFive" ng-show="vm.showFive"><div class="card-block"><p class="text-left">All payments to promotors are strictly based on commissions. Rank-X offers lasting commissions on all accounts that a Rank-X promotor closes. As long as the account that the promoter closed are active, the Promotor will continue receiving commission. There is no limit on how much money a promotor can make.</p><p class="text-left">Consider the example of a Rank-X promoter that closes one business per month and receives $30 commission per business (actual commission might vary). Promoter sign ups come with a 60 days free trial for that business. After free trial expires, and business start paying subscription, Rank-X promoter will get paid commission for that account as shown in the table below.</p><table class="table table-hover cursor"><thead><tr><th align="middle">Month</th><th align="middle">Accnt 1</th><th align="middle">Accnt 2</th><th align="middle">Accnt 3</th><th align="middle">Commission</th></tr></thead><tbody align="middle"><tr><td>1st</td><td>On trial</td><td>-</td><td>-</td><td>$0.00</td></tr><tr><td>2nd</td><td>On trial</td><td>On trial</td><td>-</td><td>$0.00</td></tr><tr><td>3rd</td><td>Active</td><td>On trial</td><td>On trial</td><td>$30.00</td></tr><tr><td>4th</td><td>Active</td><td>Active</td><td>On trial</td><td>$60.00</td></tr><tr><td>5th</td><td>Active</td><td>Active</td><td>Active</td><td>$90.00</td></tr></tbody></table></div></div></div><div class-="" "card"=""><div class="card-header" role="tab" id="headingSix" ng-click="vm.show(6)"><h3 class="mb-0" style="background-color:#b3b3b3;padding:5px"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapseOne">How do I become a Rank-X promoter?</a></h3></div><div id="collapseSix" class="collapse show" role="tabpanel" aria-labelledby="headingSix" ng-show="vm.showSix"><div class="card-block"><p class="text-left">Becoming a Rank-X promoter is very simple. Only requirement is that you must have an active Facebook account. There is no cost to becoming a promoter, its completely free. To begin, login to Rank-X using your Facebook account. Once you are logged in, click the \'Promote\' link at the bottom of the page. It will redirect you to the Promoter Console, where you will be asked to fill in a form and you will get your Promoter Code right away.</p></div></div></div><footer class="footer"><div class="container"><p class="text-muted">Rank-X is property of Rank-X LLC. San Diego, CA - 2016</p></div></footer></div></div>'),e.put("app/promoters/Partials/promoterconsole.html",'<div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading your accounts...</p></div></div><div ng-if="vm.dataReady"><div class="container"><h3>Promoter Console</h3><div ng-if="vm.userIsPromoter"><h4 align="center" style="background-color:#b3b3b3;padding:5px">Account Information</h4><div ng-if="!vm.promoter.stripeid" style="padding: 10px;background-color: indianred;border-radius: 10px;text-align: center;margin-bottom:10px">You should link your stripe account to get payed. <a class="btn btn-primary" ng-click="vm.connectStripe()">Connect with Stripe</a></div><div ng-if="vm.notifications.length != 0"><notification-block notifications="vm.notifications"></notification-block></div><p class="text-left"><strong>First Name:</strong>&nbsp{{vm.promoter.firstname}}</p><p class="text-left"><strong>Last Name:</strong>&nbsp{{vm.promoter.lastname}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.promoter.email}}</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.promoter.address}}</p><p class="text-left"><strong>Phone Number:</strong>&nbsp{{vm.promoter.phone}}</p><p class="text-left"><strong>Promoter Code:</strong>&nbsp{{vm.promoter.code}}</p><div class="text-right" role="group"><button type="button" ng-click="vm.goEdit()" class="btn btn-default">Edit</button></div><h4 align="center" style="background-color:#b3b3b3;padding:5px">Accounts</h4><table class="table" ng-if="!vm.noAns&&vm.overview"><tbody><thead style="border-style:none;"><tr><th class="text-center">Business Name</th><th class="text-center">Status</th><th class="text-center">Commission (after trial)</th></tr></thead><tr ng-repeat="x in vm.myaccnts" style="cursor:pointer;"><td ng-click="vm.gotoanswer(x.answerObj)">{{x.name}}</td><td align="middle" ng-attr-style="{{x.style}}" ng-click="vm.gotomanage(x)">{{x.status}}</td><td ng-click="vm.gotomanage(x)" style="text-align:right">${{x.totalCommission}}</td></tr></tbody></table><div ng-if="vm.manageview"><p class="text-left"><strong>Business Name:</strong>&nbsp{{vm.business.answerObj.name}}</p><p class="text-left"><strong>Email:</strong>&nbsp{{vm.business.email}}</p><p class="text-left"><strong>Owner/Contact Name:</strong>&nbsp{{vm.business.username}}</p><p class="text-left"><strong>Last Name:</strong>&nbsp{{vm.promoter.lastname}}</p><p class="text-left"><strong>Status:</strong><span align="middle" ng-attr-style="{{x.style}}">{{x.business.status}}</span></p><p class="text-left"><table class="table" ng-if="vm.business.status==\'Active\'"><tbody><thead style="border-style:none;"><tr><th style="width:45%" text-align="center">Subscription</th><th style="width:15%" text-align="center">Commission</th></tr></thead><tr ng-if="vm.business.ispremium" style="cursor:pointer;"><td style="width:45%">Premium Membership</td><td style="width:15%">${{vm.business.price*vm.STRIPE_COMMISSION_PERCENTAGE}}</td></tr><tr ng-if="vm.business.hasranks" style="cursor:pointer;"><td style="width:45%">{{vm.business.ranksqty}} Custom Ranks</td><td style="width:15%">${{vm.business.ranksqty*vm.CUSTOM_RANK_PRICE*vm.STRIPE_COMMISSION_PERCENTAGE}}</td></tr><tr><td style="width:45%">Total</td><td style="width:15%; background-color: darkgray;">${{vm.business.totalCommission}}</td></tr></tbody></table></p><p class="text-left" ng-if="vm.business.status.indexOf(\'On Trial\') != -1">Will be active from {{vm.business.discountEndDate}}.</p><p class="text-left"><strong>Address:</strong>&nbsp{{vm.promoter.address}}</p><p class="text-left"><strong>Phone Number:</strong>&nbsp{{vm.promoter.phone}}</p></div><div ng-if="vm.noAns"><br><p>No businesses have signed up using your promoter code. For tips and suggestions on how to get businesses to sign up using your promoter code <a href="" ng-click="vm.gotoPromotePage()">click here</a>.</p></div></div><div ng-if="!vm.userIsPromoter"><p>You are currently not registered to be a Promoter. Rank-X promoters help spread the word out about the app to local businesses, as well as monitoring the accuracy of content of the application. In exchange, promoters get paid monthly commissions on all businesses accounts they bring to Rank-X.</p><div class="text-center"><button type="button" ng-click="vm.goSignup()" class="btn btn-success">Sign Up</button> <button type="button" ng-click="vm.gotoPromotePage()" class="btn btn-primary">Learn More</button></div></div><div class="text-right" role="group"><button type="button" ng-click="vm.goBack()" class="btn btn-default">Back</button></div></div></div>'),e.put("app/promoters/Partials/promotersignup.html",'<div class="container"><h3>Promoter Sign Up</h3><br><form class="form-horizontal" role="form" name="answerForm"><div class="form-group"><label class="control-label capitalize" style="padding-left:10px">First Name:</label> <input class="form-control" ng-model="vm.promoter.firstname" placeholder="{{vm.promoter.firstname}}" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Last Name:</label> <input class="form-control" ng-model="vm.promoter.lastname" placeholder="{{vm.promoter.lastname}}" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Email:</label> <input class="form-control" ng-model="vm.promoter.email" placeholder="Your email address" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Phone:</label> <input class="form-control" ng-model="vm.promoter.phone" placeholder="123-123-1234" style="width:94%;margin-left:10px;margin-right:10px;"> <label class="control-label capitalize" style="padding-left:10px">Address:</label> <input class="form-control" ng-model="vm.promoter.address" placeholder="Your address" style="width:94%;margin-left:10px;margin-right:10px;"></div><label class="checkbox-inline"><input type="checkbox" ng-model="vm.acceptTOS" value="">I have read and understood the <a ng-click="vm.showTOSPromotersDlg()" target="_blank">Terms of Service</a></label></form><br><div class="row"><div class="col-xs-3 col-sm-3 col-md-2"><div class="text-right"><button class="btn btn-primary" ng-click="vm.getcode()">Get Code</button></div></div><div class="col-xs-9 col-sm-9 col-md-10"><h3 style="color:blue; margin:2px">{{vm.code}}</h3></div><br></div><br><div class="text-center"><button class="btn btn-success" ng-click="vm.submit()" ng-class="vm.acceptTOS ? \'\' : \'disabled\'">Submit</button></div><br></div>'),e.put("app/rank/Partials/RankChat.html",'<div class="container"><div class="row"><div class="col-md-6"><h1 class="page-heading">This is a test</h1></div></div></div>'),
e.put("app/rank/Partials/RankSummary.html",'<div ng-if="!vm.foodNearMe"><div id="veil" ng-hide="vm.dataReady"></div><div id="feedLoading" ng-hide="vm.dataReady"><div style="text-align: center" ng-if="!vm.dataReady"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">loading rank...</p></div></div></div><div ng-if="vm.foodNearMe"><div id="veil" ng-show="vm.loadingAnswers"></div><div id="feedLoading" ng-show="vm.loadingAnswers"><div style="text-align: center"><div><img src="/assets/images/loading.gif" class="img" style="width:50px;height:50px"></div><p style="font-size:large">Wait a moment, finding some delicious food near by...</p></div></div></div><div ng-if="vm.dataReady && !vm.loadingAnswers"><div class="text-left"><button class="btn btn-default" ng-click="vm.backToResults()" style="margin:5px; width:100%">Back to Results</button> <button class="btn btn-default" ng-if="vm.hasParent" ng-click="vm.gotoParentRank()" style="margin:5px; width:100%">{{vm.parentRank.title}}</button></div><div class="text-left" ng-if="vm.isCustomRank"><button class="btn btn-default" ng-click="vm.answerDetail(vm.rankOwner)" style="margin:5px; width:100%">Return to {{vm.rankOwner.name}}</button></div><div class="container"><div class="row"><div class="container-bgbox col-xs-6 col-sm-4 col-md-4 col-lg-3"><bg-box bc="{{vm.bc}}" shade="{{vm.shade}}" fc="{{vm.fc}}" text="{{vm.ranking}}" dir="horizontal" w="100%" h="{{vm.sm ? \'150px\':\'200px\'}}"></bg-box></div><div ng-if="!vm.isShortPhrase"><div class="col-xs-6 col-sm-4 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image1}}" ng-attr-style="display:{{vm.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs col-sm-4 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image2}}" ng-attr-style="display:{{vm.image2 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="hidden-xs hidden-sm hidden-md col-lg-3" style="margin:0px;padding:0px;border:0px;" ng-if="!vm.isShortPhrase"><img ng-src="{{vm.image3}}" ng-attr-style="display:{{vm.image3 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div></div><div ng-if="vm.isShortPhrase&&vm.hasfimage"><div class="col-xs-6 col-sm-4 col-md-4 col-lg-3" style="margin:0px;padding:0px;border:0px;"><img ng-src="{{vm.fimage}}" ng-attr-style="display:{{vm.image1 != undefined ? \'inline\':\'none\'}};width:100%;height:{{vm.sm ? \'150px\':\'200px\'}};"></div><div class="container hidden-xs col-sm-4 col-md-4 col-lg-3" ng-attr-style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title1}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-attr-style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title2}}</h3></div></div></div><div ng-if="vm.isShortPhrase&&!vm.hasfimage"><div class="container col-xs-6 col-sm-4 col-md-4 col-lg-3" ng-attr-style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title1}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title1}}</h3></div></div><div class="container hidden-xs col-sm-4 col-md-4 col-lg-3" ng-attr-style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title2}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title2}}</h3></div></div><div class="container hidden-xs hidden-sm hidden-md col-lg-3" ng-attr-style="background-color:lightgray;color:black;height:{{sm ? \'150px\':\'200px\'}};margin:0px;padding:0px;border:0px;position:relative;"><div style="padding:3px; margin:0px; position:absolute; top:50%; left:50%; margin-right:-50%;transform: translate(-50%,-50%)"><h2 class="hidden-xs text-center">{{vm.title3}}</h2><h3 class="hidden-sm hidden-md hidden-lg hidden-xl text-center">{{vm.title3}}</h3></div></div></div></div></div><br ng-if="vm.introtext"><p class="text-left">{{vm.introtext}}</p><br><div class="row" style="margin:0px;padding:0px;"><div class="col-sm-9 col-md-9 col-lg-10 hidden-xs"><div class="btn-group text-left"><button class="btn btn-default" ng-click="vm.sortbyHelpDialog()"><i class="fa fa-question-circle"></i></button> <span style="float: left;margin-left: 10px; margin-right: 10px;line-height: 32px">{{vm.sm ? \'\':\'Sort by:\'}}</span> <button class="btn btn-default {{vm.selRank}}" ng-click="vm.sortByRank()" ng-if="vm.type != \'Event\' && !vm.fnm">Rank</button> <button class="btn btn-default {{vm.selUpV}}" ng-click="vm.sortByUpV()">Popular</button> <button class="btn btn-default {{vm.selDistance}}" ng-click="vm.sortByDistance()" ng-show="{{vm.type == \'Establishment\' || vm.type == \'Event\'}}">Distance</button> <button class="btn btn-default {{vm.selDate}}" ng-click="vm.sortByDate()" ng-show="{{vm.type == \'Event\'}}">Date</button> <button class="btn btn-default {{vm.selTrending}}" ng-click="vm.sortByTrending()">Trending</button></div></div><div class="col-xs-8 visible-xs" style="margin-bottom: 20px"><div class="dropdown"><button class="btn btn-default" ng-click="vm.sortbyHelpDialog()"><i class="fa fa-question-circle"></i></button> <span style="line-height:32px; margin: 0px 10px;">Sort By:</span> <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">{{vm.sortByName}} <span class="caret"></span></button><ul class="dropdown-menu"><li><a class="btn btn-default {{vm.selRank}}" ng-click="vm.sortByRank()" ng-if="vm.type != \'Event\' && !vm.fnm">Rank</a></li><li><a class="btn btn-default {{vm.selUpV}}" ng-click="vm.sortByUpV()">Popular</a></li><li><a class="btn btn-default {{vm.selDistance}}" ng-click="vm.sortByDistance()" ng-show="{{vm.type == \'Establishment\'}}">Distance</a></li><li><a class="btn btn-default {{vm.selDate}}" ng-click="vm.sortByDate()" ng-show="{{vm.type == \'Event\'}}">Date</a></li><li><a class="btn btn-default {{vm.selTrending}}" ng-click="vm.sortByTrending()">Trending</a></li></ul></div></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-2 btn-group text-center"><a type="button" class="btn btn-default" style="vertical-align:middle;color:#0059b3;border-color:#0059b3;" ng-if="true" ng-click="vm.share()" target="_blank">Share&nbsp&nbsp<span class="fa fa-share"></span></a></div></div><div style="margin:0px; margin-top: 10px;" class="text-center" ng-if="!vm.fnm"><button ng-click="vm.changeMode(\'endorse\')" class="btn btn-primary" ng-if="vm.mode==\'specials\'">Endorse</button> <button ng-click="vm.changeMode(\'specials\')" class="btn btn-primary" ng-if="vm.mode==\'endorse\'">Specials</button> <button ng-click="vm.goRank()" class="btn btn-success {{vm.rankDisabled}}">Rank</button> <span style="line-height: 32px">&nbsp;&nbsp;&nbsp;Contributors: <b style="color:blue;"><i>{{vm.numContributors}}&nbsp&nbsp</i></b></span></div><br><table class="table table-hover cursor"><tbody><thead><tr><th ng-if="vm.mode==\'specials\'" align="middle">{{vm.showR ? \'Rank\' : \'Votes\'}}</th><th ng-if="!vm.sm && !vm.fnm && !vm.isE && vm.mode==\'specials\'" align="middle">Votes</th><th class="capitalize" ng-repeat="h in vm.fields | filter:{isrequired:true}" align="middle">{{h.label}}</th><th ng-if="vm.type == \'Establishment\' && vm.haveLocation && vm.mode==\'specials\'" align="middle">Distance (mi)</th><th ng-if="vm.type == \'Event\' && vm.mode==\'specials\'" align="middle">Date</th><th ng-if="vm.type == \'Establishment\' && vm.mode==\'specials\'" align="middle">Specials</th><th ng-if="vm.mode == \'endorse\'" align="middle">Endorsements</th></tr></thead><tbody><tr ng-repeat="x in vm.answers | limitTo: vm.limit"><td ng-click="vm.answerDetail(x)" ng-if="vm.mode==\'specials\'">{{vm.showR ? x.Rank : x.upV}}</td><td ng-if="!vm.sm && !vm.fnm && !vm.isE && vm.mode==\'specials\'" ng-click="vm.answerDetail(x)">{{x.upV}}</td><td ng-repeat="h in vm.fields | filter:{isrequired:true}"><a ng-attr-style="text-decoration: none;" href="{{\'/answerDetail/\' + x.slug }}" ng-click="vm.answerDetail(x)">{{ x[h.name]}}</a></td><td ng-if="vm.type == \'Establishment\' && vm.haveLocation && vm.mode==\'specials\'" ng-click="vm.answerDetail(x)">{{x.dist}}</td><td ng-if="vm.type == \'Event\' && vm.mode == \'specials\'" ng-click="vm.answerDetail(x)">{{x.date}}</td><td ng-show="vm.type == \'Establishment\' && vm.mode==\'specials\'" ng-attr-style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}" ng-click="vm.answerDetail(x)">{{x.sp_title}}</td><td ng-if="vm.mode==\'endorse\'" style="width:{{vm.sm?\'150px\':\'200px\'}}"><div><span ng-click="vm.UpVote(x,$event)" ng-attr-style="color:{{x.thumbUp}};margin-right: {{vm.sm?\'0px\':\'20px\'}};font-size: 18px;" class="pull-left">&nbsp&nbsp <i class="fa fa-thumbs-up" aria-hidden="true"></i> <span style="color:black;font-size: 14px;">&nbsp;{{x.upV}}&nbsp;&nbsp;</span></span> <span ng-click="vm.DownVote(x,$event)" ng-attr-style="color:{{x.thumbDn}};margin-right: {{vm.sm?\'0px\':\'20px\'}};font-size: 18px;" class="pull-right"><i class="fa fa-thumbs-down" aria-hidden="true"></i> <span style="color:black;font-size: 14px;">&nbsp;{{x.downV}}</span> &nbsp&nbsp</span></div></td></tr></tbody></tbody></table><div class="text-center" ng-if="vm.thereIsMore"><button class="btn btn-default" ng-click="vm.seeMore()">See More</button></div><div class="row" style="margin:0px;" ng-if="!vm.hasAnswerParent || vm.userIsOwner"><div class="col-xs-2" style="padding:0px"><a class="btn btn-primary" ng-click="vm.addAnswer()">+</a></div><div class="col-xs-10" ng-attr-style="display:{{vm.hideInfoBox ? \'none\':\'inline\'}};padding:0px;" ng-if="!vm.addInfoMsgAck || vm.noAnswers"><div class="alert alert-warning" style="padding-top: 5px;padding-bottom: 5px;"><a class="close" data-dismiss="alert" aria-label="close" ng-click="vm.closeAddInfoMsg()">&times;</a> <span class="glyphicon glyphicon-arrow-left"></span><strong>&nbsp;&nbsp; {{vm.noAnswers ? \'Oops, we have nothing on this list.\':\'Are we missing one?\'}}</strong>&nbsp;&nbsp;Use the \'+\' button to add a new <span ng-if="vm.type == \'Establishment\'">Establishment.</span> <span ng-if="vm.type == \'Organization\'">Organization or Company.</span> <span ng-if="vm.type == \'Person\'">Person.</span> <span ng-if="vm.type == \'PersonCust\'">Professional.</span> <span ng-if="vm.type == \'Place\'">Place.</span> <span ng-if="vm.type == \'Short-Phrase\'">Answer.</span> <span ng-if="vm.type == \'Thing\'">Item.</span> <span ng-if="vm.type == \'Event\'">Event.</span> <span ng-if="vm.type == \'Simple\'">Item.</span></div></div></div><br><br ng-if="!vm.sm"><div class="text-center"><button ng-click="vm.loadComments()" class="btn btn-default" ng-class="vm.cm.commLoaded ? \'disabled\' : \'\'" style="background-color:#e6e6e6;width:100%">COMMENTS ({{vm.numcom}})</button></div><br ng-if="!vm.sm"><div ng-attr-style="display:{{vm.cm.commLoaded ? \'inline\':\'none\'}}"><div ng-repeat="x in vm.cm.comments"><div class="col-xs-12 media"><div ng-if="!x.picture" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" ng-attr-style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body">{{x.body}}<br><small style="color:#bfbfbf">{{x.username}} - {{x.date}}&nbsp&nbsp <span class="dropdown"><i type="button" class="fa fa-flag dropdown-toggle" data-toggle="dropdown"></i><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="vm.cmFlag(1)">Off-Topic</a></li><li><a ng-click="vm.cmFlag(2)">Offensive</a></li><li><a ng-click="vm.cmFlag(3)">Spam</a></li></ul></span></small></div></div><br></div><div ng-attr-style="display:{{(vm.cm.commLoaded && vm.cm.comments.length == 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>Nobody has commented yet. Be the first. Log in, endorse answers and leave a comment.</small></p></div><div ng-attr-style="display:{{(vm.cm.commLoaded && vm.cm.comments.length > 0 && !vm.isLoggedIn) ? \'inline\':\'none\'}}"><br><p><small>You must log in and endorse one or more answers to leave a comment.</small></p></div><div ng-attr-style="display:{{(vm.cm.commLoaded && vm.isLoggedIn && !vm.commentAllowed) ? \'inline\':\'none\'}}"><br><p><small>Endorse one or more answers to leave a comment.</small></p></div><div ng-attr-style="display:{{(vm.isLoggedIn && vm.commentAllowed) ? \'inline\':\'none\'}}"><div class="media"><div ng-if="!user.picture.data.url" class="profile-avatar-wrapper media-left"><div class="empty-profile-avatar-wrapper" ng-attr-style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div></div><div ng-if="user.picture.data.url" class="profile-avatar-wrapper media-left" align="middle"><img ng-src="{{user.picture.data.url}}" class="img-responsive img-circle profile-avatar"></div><div class="media-body"><textarea class="form-control" ng-model="vm.cm.newComment" placeholder="Leave a comment" style="margin-left:0px;margin-right:0px;"></textarea></div></div><div class="text-right"><button ng-click="vm.postComment()" class="btn btn-primary">Post</button></div></div></div><br></div>'),e.put("app/rank/Partials/editRanking.html",'<div class="container"><h3>Edit Ranking</h3><div class="row" style="padding-bottom:10px"><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div><div class="container-bgbox col-xs-6 col-sm-3 col-md-2 col-lg-2"><bg-box bc="{{vm.bc}}" bc2="{{vm.bc2}}" fc="{{vm.fc}}" text="{{vm.rankTitle}}" dir="horizontal" w="100%" h="{{vm.sm ? \'200px\':\'200px\'}}"></bg-box></div><div class="col-xs-6 col-sm-3 col-md-2 col-lg-2" style="margin:0px;padding:0px;border:0px;"><img ng-src="{{vm.image}}" ng-attr-style="width:100%;height:{{vm.sm ? \'200px\':\'200px\'}};"></div><div class="hidden-xs col-sm-3 col-md-4 col-lg-4"></div></div><br><label><strong>Select Image Bank:</strong></label><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><img src="../../../assets/images/pixabay-logo.png" ng-click="vm.selImgBank(1)" alt="Pixabay" style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;border-color:{{vm.pixabay ? \'black\':\'white\'}}"><div class="text-center"><a href="https://www.pixabay.com/">Visit Pixabay</a></div></div><div class="col-xs-6 col-sm-3 col-md-3 col-lg-3"><img src="../../../assets/images/pexels-logo.png" ng-click="vm.selImgBank(2)" alt="Pexels" style="width:100%;height:45px;padding:3px;border-style:solid;border-width:1px;border-color:{{vm.pexels ? \'black\':\'white\'}}"><div class="text-center"><a href="https://www.pexels.com/">Visit Pexels</a></div></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><div><br><label><strong>Image Query:</strong></label><div class="input-group" style="padding-bottom:10px"><input type="text" class="form-control" placeholder="Enter what to search for an image, i.e. taco" ng-model="vm.imageQuery"> <span class="input-group-btn"><button class="btn btn-secondary" ng-click="vm.getImages()" type="button">Search Images</button></span></div><div class="text-center"><div class="btn-group"><button class="btn btn-default" ng-click="vm.prevImg()">&nbsp&nbspPrev&nbsp&nbsp</button> <button class="btn btn-default" ng-click="vm.nextImg()">&nbsp&nbspNext&nbsp&nbsp</button> <button class="btn btn-default" ng-click="vm.selectImg()">Select Image</button></div></div></div><br><div><label><strong>Select Color Design:</strong></label><div class="container"><div class="row"><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(1)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c1sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:brown"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(2)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c2sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#4682b4"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(3)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c3sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#008080"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(4)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c4sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:gray"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(5)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c5sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#a3297a"></div></div><div class="col-xs-2 col-sm-1 col-md-1 col-lg-1" ng-click="vm.csel(6)" ng-attr-style="padding:15px;border-style:solid;border-width:1px;border-color:{{vm.c6sel ? \'black\':\'white\'}};"><div style="height:30px;background-color:#c68c53"></div></div><div class="hidden-xs col-sm-3 col-md-3 col-lg-3"></div></div><div class="row" style="padding-top:10px"><div class="text-right col-xs-6"><label>Shade Factor:</label></div><div class="btn-group col-xs-6"><button class="btn btn-primary" ng-click="vm.minusShade()">&nbsp&nbsp<i class="fa fa-minus"></i>&nbsp&nbsp</button> <button class="btn btn-primary" ng-click="vm.plusShade()">&nbsp&nbsp<i class="fa fa-plus"></i>&nbsp&nbsp</button></div></div></div></div><br><label><strong>Title:</strong></label> <input class="form-control" ng-model="vm.rankTitle" type="text" placeholder="{{vm.rankTitle}}"> <label><strong>Question:</strong></label> <input class="form-control" ng-model="vm.question" type="text" placeholder="{{vm.question}}"> <label><strong>Tags:</strong></label> <input class="form-control" ng-model="vm.tags" type="text" placeholder="{{vm.tags}}"> <label><strong>Keywords:</strong></label> <input class="form-control" ng-model="vm.keywords" type="text" placeholder="{{vm.keywords}}"> <label><strong>AnswerTags:</strong></label> <input class="form-control" ng-model="vm.answertags" type="text" placeholder="{{vm.answertags}}"> <label><strong>IsAtomic:</strong></label> <input class="form-control" ng-model="vm.isatomic" type="text" placeholder="{{vm.isatomic}}"> <label><strong>Category-Strings:</strong></label> <input class="form-control" ng-model="vm.catstr" type="text" placeholder="{{vm.catstr}}"> <label><strong>Type:</strong></label> <input class="form-control" ng-model="vm.type" bs-typeahead="" type="text" placeholder="{{vm.type}}" bs-options="c for c in vm.typeList"> <label><strong>fimage:</strong></label> <input class="form-control" ng-model="vm.image" type="text" placeholder="{{vm.image}}"> <label><strong>isMP Flag:</strong></label> <input class="form-control" ng-model="vm.ismp" type="text" placeholder="{{vm.ismp}}"> <label><strong>Scope:</strong></label> <input class="form-control" ng-model="vm.scope" type="text" placeholder="{{vm.scope}}"><br><div class="form-group text-right"><button type="button" class="btn btn-default" ng-click="vm.goBack()">Cancel</button> <button type="button" class="btn btn-primary" ng-click="vm.goEdit()">Edit</button> <button type="button" class="btn btn-danger" ng-click="vm.goDelete()">Delete</button></div><br></div>'),e.put("app/rank/Partials/match.html",'<div class="well-rank" ng-if="vm.nsm" style="margin:0px;"><h2 class="sub-header">{{vm.table.title}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h2></div><div class="well-rank" ng-if="vm.sm" style="margin:0px;"><h3 class="sub-header">{{vm.table.title}} <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" ng-click="vm.closeRank()"></button></span></h3></div><h3>{{vm.table.question}}</h3><div class="form-group text-center"><div class="well well-dark">Rank match <strong>{{vm.GP}}</strong> of <strong>{{vm.Tot}}</strong></div></div><div class="row"><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer1.name) ? vm.answer1.name : ""}} {{(f.name == "cityarea" && vm.answer1.cityarea) ? " - "+ vm.answer1.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer1.imageurl}}" ng-click="vm.selectAnswer(1)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; height:auto;" ng-click="vm.selectAnswer(1)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer1.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer1.addinfo}}</h4></div></div><div class="col-xs-6 col-md-6 col-lg-6"><div class="well well-light" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type != \'Short-Phrase\'}}"><span ng-repeat="f in vm.fields | filter:(f.isrequired=true)">{{(f.name == "name" && vm.answer2.name) ? vm.answer2.name : ""}} {{(f.name == "cityarea" && vm.answer2.cityarea) ? " - "+ vm.answer2.cityarea : ""}}</span></div><img class="displayed" src="{{vm.answer2.imageurl}}" ng-click="vm.selectAnswer(2)" style="width:100%;max-height:300px" ng-show="{{vm.type != \'Short-Phrase\'}}"><div class="container-answer" style="width:100%; height:auto;" ng-click="vm.selectAnswer(2)" ng-show="{{vm.type == \'Short-Phrase\'}}"><br><h2 style="text-align:center"><strong>{{vm.answer2.name}}</strong></h2><br><h4 style="text-align:center">{{vm.answer2.addinfo}}</h4></div></div></div><br><div class="row"><div class="form-group text-left col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(1)" type="button" class="btn btn-success">Details</button></div><div class="form-group text-right col-xs-6 col-md-6 col-lg-6"><button ng-click="vm.answerDetail(2)" type="button" class="btn btn-success">Details</button></div></div><div class="form-group text-center"><button ng-click="vm.skipMatch()" type="button" class="btn btn-default">I don\'t know, Skip</button> <button ng-click="vm.rankSummary()" type="button" class="btn btn-danger">Stop</button></div><br>')}]);