<div id="veil" ng-hide="vm.dataReady"></div>
    <div id="feedLoading" ng-hide="vm.dataReady">
        <div style="text-align: center" ng-if="!vm.dataReady">
            <div class="loading-pulse"></div>
            <p style="font-size:large">loading rank...</p>
        </div>
    </div>
<div ng-if="vm.dataReady">

<!-- ---------------------------- main page -->

<!-- <img src="/assets/images/rankxlogo_noheadline.png" style="height:50px;margin:0px"> -->
<!--<div class="container">-->
    <div class="well-rank" ng-if="vm.nsm" style="margin:0px;">
        <h2 class="sub-header">{{vm.ranking}}
          <!--  <span class="nomargin">
                    <button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" 
                    ng-click="vm.closeRank()">
                    <span class="glyphicon glyphicon-remove" style="padding-top:0px;padding-bottom:0px;" aria-hidden="true"></span>
            </button>
            </span> -->
            <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" 
            style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" 
            ng-click="vm.closeRank()"></button></span>
        </h2>
    </div>
    <div class="well-rank" ng-if="vm.sm" style="margin:0px;">
        <h3 class="sub-header">{{vm.ranking}}
            <!-- <span class="nomargin"> -->
               <!--     <button type="button" class="btn btn-default pull-right" style="vertical-align:middle;" 
                    ng-click="vm.closeRank()">-->
                    <!--
                    <span class="glyphicon glyphicon-remove pull-right" style="font-size:small;color:white;glyph-orientation-vertical:middle" ng-click="vm.closeRank()"></span>
                    -->
                    <span class="nomargin"><button type="button" class="glyphicon glyphicon-remove pull-right" 
                    style="margin:0px;padding:0px;border:0px;background-color:#006dcc;color:#002699;font-size:medium;" 
                    ng-click="vm.closeRank()"></button></span>
            <!--</button> -->
            <!-- </span> -->
        </h3>
    </div>
<!--</div>-->
<!-- Images -->
<div class="row" style="display:{{vm.isShortPhrase == false? 'inline':'none'}};margin:0px;">
    <div class="col-sm-6 col-md-6 col-lg-4">
        <img class="displayed" src="{{vm.image1}}" ng-if="vm.image1ok"
        style="width:100%;max-height:200px;display:{{vm.image1 != undefined ? 'inline':'none'}}">
    </div>
    <div class="hidden-xs col-sm-6 col-md-6 col-lg-4">
        <img class="displayed" src="{{vm.image2}}" ng-if="vm.image2ok"
        style="width:100%;max-height:200px;display:{{vm.image2 != undefined ? 'inline':'none'}}">
    </div>
    <div class="hidden-xs hidden-sm hidden-md col-lg-4">
        <img class="displayed" src="{{vm.image3}}" ng-if="vm.image3ok"
        style="width:100%;max-height:200px;display:{{vm.image3 != undefined ? 'inline':'none'}}">
    </div>
</div>
<!-- Short-Phrases -->
<div class="row" style="display:{{vm.isShortPhrase == true? 'inline':'none'}};margin:0px;">
    <div class="col-sm-6 col-md-6 col-lg-4">
        <div class="container-answer" style="width:100%; max-height:300px;">
            <br>
            <h2 style="text-align:center"><strong>{{vm.title1}}</strong></h2>
            <br>
            <h4 style="text-align:center">{{vm.addinfo1}}</h4>
        </div>
    </div>
    <div class="hidden-xs col-sm-6 col-md-6 col-lg-4">
        <div class="container-answer" style="width:100%; max-height:300px;">
            <br>
            <h2 style="text-align:center"><strong>{{vm.title2}}</strong></h2>
            <br>
            <h4 style="text-align:center">{{vm.addinfo2}}</h4>
        </div>
    </div>
    <div class="hidden-xs hidden-sm hidden-md col-lg-4">
        <div class="container-answer" style="width:100%; max-height:300px;">
            <br>
            <h2 style="text-align:center"><strong>{{vm.title3}}</strong></h2>
            <br>
            <h4 style="text-align:center">{{vm.addinfo3}}</h4>
        </div>
    </div>
</div>
<br>
<br class="hidden-md hidden-lg hidden-xl">
<p class="text-left" ng-if="vm.sm">&nbsp&nbspSort by:</p>
<div class="row" style="margin:0px;padding:0px;">
    <div class="col-xs-9 col-sm-10 col-md-10 col-lg-10">
        <div class="btn-group text-left">
            <p>{{vm.sm ? '':'Sort by:'}}<span>        
        <button class="btn btn-default {{vm.selRank}} " ng-click="vm.sortByRank()" ng-if="vm.type != 'Event' && !vm.fnm">Rank</button>
        <button class="btn btn-default {{vm.selUpV}} " ng-click="vm.sortByUpV()">Popular</button>
        <button class="btn btn-default {{vm.selDistance}} " ng-click="vm.sortByDistance()"
            ng-show="{{vm.type == 'Establishment'}}">Distance</button>
        <button class="btn btn-default {{vm.selDate}} " ng-click="vm.sortByDate()"
            ng-show="{{vm.type == 'Event'}}">Date</button>               
        <!--  <button type="button " class="btn btn-primary ">{{"rankSummary.Filtered " | translate}}</button> -->
        </span></p>
        </div>
    </div>
    <div class="col-xs-3 col-sm-2 col-md-2 col-lg-2 btn-group text-right">
        <button class="btn btn-default" ng-click="vm.share()" style="padding-right:5px">Share&nbsp&nbsp<span class="glyphicon glyphicon-share"></span></button>
    </div>
</div>
<div class="row" style="margin:0px;">
    <div class="col-xs-6 text-right">
            <button ng-click="vm.goRank() " class="btn btn-success {{vm.rankDisabled}}">Rank</button>
    </div>
    <div class="col-xs-6 btn-group text-right">
        <h4>Contributors: <b style="color:blue; "><i>{{vm.numContributors}}&nbsp&nbsp</i></b></h4>
    </div>
</div>    
<!--
<div ng-show="{{vm.type == 'Establishment'}}">
    <div class="text-right" style="display:{{vm.haveLocation ? 'none':'inline'}}">
        <p class="hiw text-right" ng-click="vm.whyNoDistance()"><u>why cant I see distances?</u></p>
    </div>
</div>
-->
<br>

<table class="table table-hover cursor ">
    <tbody>
        <thead>
            <tr>
                <th>{{vm.showR ? 'Rank' : 'Votes'}}</th>
                <th ng-show="{{!vm.sm && !vm.fnm && !vm.isE}}">Votes</th>
                <th class="capitalize " ng-repeat="h in vm.fields | filter:{isrequired:true}">{{h.label}}</th>
                <th ng-show="{{vm.type == 'Establishment' && vm.haveLocation}}">Distance (mi)</th>
                <th ng-show="{{vm.type == 'Event'}}">Date</th>
                <th ng-show="{{vm.type == 'Establishment'}}">Specials</th>
                <!-- ng-show="{{vm.type == 'Establishment'}}" -->
            </tr>
        </thead>
        <tbody>
            <!--| orderBy: '-Rank' -->
            <tr ng-repeat="x in vm.answers track by $index" ng-click="vm.answerDetail(x)">
                <td>{{vm.showR ? x.Rank : x.upV}}</td>
                <td ng-show="{{!vm.sm && !vm.fnm && !vm.isE}}">{{x.upV}}</td>
                <!--<td>{{x.Rank}}</td>-->
                <!--<td ng-repeat="h in vm.answers.public ">{{x[h]}}</td>-->
                <td ng-repeat="h in vm.fields | filter:{isrequired:true}">{{ x[h.name]}}</td> 
                <!-- style="background-color:{{x.bc}};color:{{x.fc}}"> -->
                <td ng-show="{{vm.type == 'Establishment' && vm.haveLocation}}">{{x.dist}}</td>
                <td ng-show="{{vm.type == 'Event'}}">{{x.date}}</td>
                <!-- style="background-color:{{x.bc}};color:{{x.fc}}" -->
                <td ng-show="{{vm.type == 'Establishment'}}" style="background-color:{{x.sp_bc}};color:{{x.sp_fc}}">
                    {{x.sp_title}}</td>
            </tr>
        </tbody>
</table>

<div class="row" style="margin:0px;">
    <div class="col-xs-2" style="padding:0px">
        <a class="btn btn-primary" ng-click="vm.addAnswer()" class="btn btn-primary">+</a>
    </div>
    <div class="col-xs-10" style="display:{{vm.hideInfoBox ? 'none':'inline'}};padding:0px;" ng-if="!vm.addInfoMsgAck || vm.noAnswers">
        <div class="alert alert-warning" style="padding-top: 5px;padding-bottom: 5px;">
            <a class="close" data-dismiss="alert" aria-label="close" ng-click="vm.closeAddInfoMsg()">&times;</a>
            <span class="glyphicon glyphicon-arrow-left"></span><strong>&nbsp;&nbsp;
                {{vm.noAnswers ? 'Oops, we have nothing on this list.':'Are we missing one?'}}
                </strong>&nbsp;&nbsp;Use
            the '+' button to add a new 
            <span ng-if="vm.type == 'Establishment'">Establishment.</span>
            <span ng-if="vm.type == 'Organization'">Organization or Company.</span>
            <span ng-if="vm.type == 'Person'">Person.</span>
            <span ng-if="vm.type == 'PersonCust'">Professional.</span>
            <span ng-if="vm.type == 'Place'">Place.</span>
            <span ng-if="vm.type == 'Short-Phrase'">Answer.</span>
            <span ng-if="vm.type == 'Thing'">Item.</span>
            <span ng-if="vm.type == 'Event'">Event.</span>
        </div>
    </div>
</div>

<!-- <a ui-sref="match " class="btn btn-success ">{{"rankSummary.GoRank " | translate}}</a> -->
<br>
<br ng-if="!vm.sm">
<div class="text-center">
    <button ng-click="vm.loadComments()" class="btn btn-default"  ng-class="vm.cm.commLoaded ? 'disabled' : ''" style="background-color:#e6e6e6;width:100%">COMMENTS ({{vm.numcom}})</button>
</div>
<br ng-if="!vm.sm">
<div style="display:{{vm.cm.commLoaded ? 'inline':'none'}}">
    <div ng-repeat="x in vm.cm.comments">
        <div class="col-xs-12 media">

            <div ng-if="!x.picture" class="profile-avatar-wrapper media-left">
                <div class="empty-profile-avatar-wrapper"  style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div>
            </div>
            <div ng-if="x.picture" class="profile-avatar-wrapper media-left" align="middle">
                <img ng-src="{{x.picture}}" class="img-responsive img-circle profile-avatar"/>
            </div>
            <div class="media-body">
                {{x.body}}
                <br>
                <small style="color:#bfbfbf">{{x.username}} - {{x.date}}&nbsp&nbsp                    
                    <span class="dropdown ">
                        <i type="button" class="fa fa-flag dropdown-toggle" data-toggle="dropdown"></i>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a ng-click="vm.cmFlag(1)">Off-Topic</a></li>
                            <li><a ng-click="vm.cmFlag(2)">Offensive</a></li>
                            <li><a ng-click="vm.cmFlag(3)">Spam</a></li>
                        </ul>
                    </span>                   
                </small>
            </div>
        </div>
        <br>
    </div>
    <div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length == 0 && !vm.isLoggedIn) ? 'inline':'none'}}">
        <br>
        <p><small> Nobody has commented yet. Be the first. Log in, endorse answers and leave a comment. </small></p>
    </div>
    <div style="display:{{(vm.cm.commLoaded && vm.cm.comments.length > 0 && !vm.isLoggedIn) ? 'inline':'none'}}">
        <br>
        <p><small> You must log in and endorse one or more answers to leave a comment. </small></p>
    </div>
    <div style="display:{{(vm.cm.commLoaded && vm.isLoggedIn && !vm.commentAllowed) ? 'inline':'none'}}">
        <br>
        <p><small> Endorse one or more answers to leave a comment. </small></p>
    </div>
    <div style="display:{{(vm.isLoggedIn && vm.commentAllowed) ? 'inline':'none'}}">
        <div class="media">
            <div ng-if="!user.picture.data.url" class="profile-avatar-wrapper media-left">
                <div class="empty-profile-avatar-wrapper"  style="background-color:{{x.bc}};color:{{x.fc}};">{{x.initials}}</div>
            </div>
            <div ng-if="user.picture.data.url" class="profile-avatar-wrapper media-left" align="middle">
                <img ng-src="{{user.picture.data.url}}" class="img-responsive img-circle profile-avatar"/>
            </div>
            <div class="media-body">
                <!--
                <input type="text" class="form-control" ng-model="vm.comment" placeholder="Leave a comment" 
                style="margin-left:0px;margin-right:0px;">-->
                <textarea class="form-control" ng-model="vm.cm.newComment" placeholder="Leave a comment"  
                   style="margin-left:0px;margin-right:0px;"></textarea>
            </div>            
        </div> 
        <div class="text-right">
                <button ng-click="vm.postComment()" class="btn btn-primary">Post</button>
        </div>
    </div> 
</div>
</div>